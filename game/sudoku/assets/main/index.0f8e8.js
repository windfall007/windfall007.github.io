window.__require=function t(e,i,o){function n(r,s){if(!i[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var d=i[r]={exports:{}};e[r][0].call(d.exports,function(t){return n(e[r][1][t]||t)},d,d.exports,t,e,i,o)}return i[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)n(o[r]);return n}({Creator:[function(t,e,i){"use strict";cc._RF.push(e,"77b848PH0BISYS7vYKq3Ogo","Creator"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("Solver"),n=t("Puzzle"),a=t("PuzzleCell"),r=function(){function t(t){t&&(this.seed=t)}return t.prototype.seedRandom=function(){return null==this.seed?Math.random():(this.seed=(9301*this.seed+49297)%233280,this.seed/233280)},t.prototype.getRandomIntBetween=function(t,e){var i=Math.ceil(t),o=Math.floor(e);return Math.floor(this.seedRandom()*(o-i+1))+i},t.prototype.getRandomData=function(t,e,i){void 0===i&&(i=3);var o=this.createRandom(t,t,e,i-1),n=[];return o.cells.forEach(function(t){n.push(t.solution)}),n},t.prototype.createRandom=function(e,i,a,r){var s,c,l,d,u=!1,p="number"==typeof a&&a>=0&&a<=1,h=[],f=[],g=0,v=1;for(this.puzzle=new n.default(e,i);!1===u;){for(c=p?a:this.getRandomIntBetween(200,800)/1e3,h.length=0,f.length=0,s=0,d=0;d<this.puzzle.totalCells;d++)l=this.seedRandom()<c?1:0,r&&(0==l&&1==v&&g++,g>r&&(l=1,g--),v=l),s+=l,d%this.puzzle.width==0&&d>0&&(v=1,g=0,h.push(f),f=[]),f.push(l);0!==s&&s!==this.puzzle.totalCells&&(h.push(f),this.puzzle=t._populatePuzzleFromGrid(this.puzzle,h),new o.default(this.puzzle).solve()&&(u=!0))}return this.puzzle.creator=this,this.puzzle},t.prototype.createFromGrid=function(e){var i;new Date;var a=0,r=0;if(!(e instanceof Array))throw"grid is not an array";return e.forEach(function(t,e){if(!(t instanceof Array))throw"grid is not a multi-dimensional array";if(0===a)a=t.length;else if(t.length!==a)throw"row "+e+" has an invalid length ("+t.length+") - expecting "+a;r++}),i=new n.default(a,r),this.puzzle=t._populatePuzzleFromGrid(i,e),this.puzzle.creator=this,!!new o.default(this.puzzle).solve()&&this.puzzle},t.prototype.createFromHints=function(t){var e,i,r,s,c=this;if("object"!=typeof t||!t.row||!t.column)throw'parameter passed to createFromHints() must be an object containing "row" and "column" properties';if(!(t.row instanceof Array&&t.column instanceof Array))throw"hints.row or hints.column must be an array.";return e=t.column.length,i=t.row.length,(r=new n.default(e,i)).rowHints=t.row,r.columnHints=t.column,r.creator=this,r.grid.forEach(function(t,e){t.forEach(function(t,i){r.cells.push(new a.default({index:e*r.width+i,column:i,row:e}))})}),this.puzzle=r,!!(s=new o.default(this.puzzle)).solve()&&(s.puzzle.cells.forEach(function(t,e){var i=c.puzzle.getCellByIndex(e);i.aiSolution=t.aiSolution,i.solution=t.aiSolution}),this.puzzle)},t._populatePuzzleFromGrid=function(t,e){var i,o,n,r,s,c,l,d,u,p,h;for(t.reset(),t.grid=e,o=0;o<t.grid.length;o++){for(n=t.grid[o],u=[],t.rowHints[o]=[],r=0;r<n.length;r++)l=s=n[r],d=r>0?t.grid[o][r-1]:0,t.cells.push(new a.default({index:o*t.width+r,column:r,row:o,solution:s})),1===l&&0===d?u.push(1):0===l&&1===d?u.push(0):1===l&&1===d&&u[u.length-1]++;for(p=0;p<u.length;p++)(h=u[p])>0&&t.rowHints[o].push(h)}for(r=0;r<t.width;r++){for(t.columnHints[r]=[],i=[],c=r;c<t.totalCells;c+=t.width)n=Math.floor(c/t.width),l=t.grid[n][r],d=n>0?t.grid[n-1][r]:0,1===l&&0===d?i.push(1):0===l&&1===d?i.push(0):1===l&&1===d&&i[i.length-1]++;for(p=0;p<i.length;p++)(h=i[p])>0&&t.columnHints[r].push(h)}return t},t}();i.default=r,cc._RF.pop()},{Puzzle:"Puzzle",PuzzleCell:"PuzzleCell",Solver:"Solver"}],IServerCfg:[function(t,e,i){"use strict";cc._RF.push(e,"0bcfbD71yFNrYEKzKfhcP4r","IServerCfg"),Object.defineProperty(i,"__esModule",{value:!0}),cc._RF.pop()},{}],NumberUtils:[function(t,e,i){"use strict";cc._RF.push(e,"26435KE1/pIvr8//0gRYvdJ","NumberUtils"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.parseNum=function(t,e){return void 0===e&&(e=0),"string"==typeof t?t=parseInt(t):isNaN(t)&&(t=0),0===t?e:t},t.FormatCurrency=function(t){return"string"==typeof t&&(t=parseInt(t)),t>=this.TENBILLION?parseInt(t/this.TENBILLION+"")+"B":t>=this.MILLION?parseInt(t/this.MILLION+"")+"M":t>=this.KILO?parseInt(t/this.KILO+"")+"K":t.toString()},t.RandomInt=function(t,e){return Math.ceil(Math.random()*(e-t+1)+t-1)},t.stringToNumArr=function(t){var e=[];if(!t)return e;for(var i=t.split(";"),o=0,n=i.length;o<n;o++)e.push(this.parseNum(i[o]));return e},t.clamp=function(t,e,i){return e>i&&(e=[i,i=e][0]),t>i&&(t=i),(t<e||Number.isNaN(t))&&(t=e),t},t.KILO=1e3,t.MILLION=1e6,t.TENBILLION=1e9,t.BILLION=1e8,t.TENKILO=1e4,t}();i.default=o,cc._RF.pop()},{}],PopupLoading:[function(t,e,i){"use strict";cc._RF.push(e,"4e230uEA9dEv6CDagtCkl4n","PopupLoading"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadingIcon=null,e.loadingTxt=null,e.speed=.5,e.bgNode=null,e.charPoint=[".","..","..."],e.charIndex=0,e}return __extends(e,t),e.prototype.onLoad=function(){this.bgNode.height=this.node.height=cc.winSize.height},e.prototype.onEnable=function(){this.start()},e.prototype.onDisable=function(){cc.Tween.stopAllByTarget(this.loadingIcon),this.unschedule(this.txtAppend)},e.prototype.onShow=function(){this.loadingIcon.angle=0;var t=cc.tween().by(.6,{angle:-90}).by(.6,{angle:-180}).by(.6,{angle:-90});cc.tween(this.loadingIcon).repeatForever(t).start()},e.prototype.onHide=function(){},e.prototype.start=function(){this.charIndex=0,this.onShow(),this.unschedule(this.txtAppend),this.schedule(this.txtAppend,this.speed,cc.macro.REPEAT_FOREVER)},e.prototype.txtAppend=function(){this.loadingTxt.string="loading"+this.charPoint[this.charIndex],this.charIndex++,this.charIndex>this.charPoint.length-1&&(this.charIndex=0)},e.prototype.update=function(){},__decorate([a(cc.Node)],e.prototype,"loadingIcon",void 0),__decorate([a(cc.Label)],e.prototype,"loadingTxt",void 0),__decorate([a(cc.Integer)],e.prototype,"speed",void 0),__decorate([a(cc.Node)],e.prototype,"bgNode",void 0),__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],PuzzleCell:[function(t,e,i){"use strict";cc._RF.push(e,"d167dLHxotLS6RqGxYST/a2","PuzzleCell"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t){this.index=-1,this.column=-1,this.row=-1,this.solution=null,this.userSolution=null,this.aiSolution=null,Object.assign(this,t)},cc._RF.pop()},{}],PuzzleLine:[function(t,e,i){"use strict";cc._RF.push(e,"1d7a9hUs9pK9rzKlQnQWDCz","PuzzleLine"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t){this.type="",this.index=-1,this.length=0,this.minimumSectionLength=0,this.sections=[],this.cells=[],this.solved=!1,Object.assign(this,t)},cc._RF.pop()},{}],Puzzle:[function(t,e,i){"use strict";cc._RF.push(e,"4cbfbVyuLJBPbnN8fp3n4Nt","Puzzle"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("Utility"),n=function(){function t(t,e){if(void 0===t||void 0===e)throw"width and height are required constructor parameters.";if(t<=0||e<=0||1===t&&1===e)throw"invalid dimensions: "+t.toString()+" x "+e.toString();this.width="number"==typeof t?t:parseInt(t.toString(),10),this.height="number"==typeof e?e:parseInt(e.toString(),10),this.totalCells=this.width*this.height,this.reset()}return t.prototype.reset=function(){var t=this,e=o.default.getZeroFilledArray;this.creator=null,this.cells=[],this.rowHints=[],this.columnHints=[],this.grid=e(this.height).map(function(){return e(t.width)})},t.prototype.checkUserSolution=function(){return this.cells.every(function(t){var e=1===t.userSolution?1:0;return t.solution===e})},t.prototype.getRowCells=function(t){var e,i=[],o=t*this.width,n=o+this.width;for(e=o;e<n;e++)i.push(this.cells[e]);return i.length>0&&i},t.prototype.getColumnCells=function(t){var e,i=[];for(e=t;e<this.cells.length;e+=this.width)i.push(this.cells[e]);return i.length>0&&i},t.prototype.getCellByIndex=function(t){var e="number"!=typeof t?parseInt(t,10):t;return!!this.cells[e]&&this.cells[e]},t}();i.default=n,cc._RF.pop()},{Utility:"Utility"}],Solver:[function(t,e,i){"use strict";cc._RF.push(e,"f4a76CUybNNl5+41191uovc","Solver"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("PuzzleLine"),n=t("Utility"),a=function(){function t(t){this.puzzle=t,this._reset()}return t.prototype.solve=function(){var t,e,i,o,n=(new Date).getTime(),a=-1;for(this.isReset||this._reset(),this.isReset=!1;this._getProgress()>a&&this._getTotalSolved()<this.puzzle.cells.length;){for((new Date).getTime(),a=this._getProgress(),i=0;i<this.lines.length;i++)(o=this.lines[i]).solved||this.eliminateImpossibleFits(o),o.solved||this.findKnownPositivesAndNegatives(o),o.solved||this.findSectionDefiningChains(o),o.solved||this.findAnchoredSections(o),o.solved||this.findCompletedSections(o),o.solved||this.findCompletedLines(o);(new Date).getTime()}return t=this._getTotalSolved()===this.puzzle.cells.length,e=((new Date).getTime()-n)/1e3,this.elapsedTime=e,t},t.prototype.eliminateImpossibleFits=function(t){var e,i,o,a,r,s,c,l,d,u,p=0,h=t.length-t.minimumSectionLength;if(0===t.sections.length)for(d=0;d<t.cells.length;d++)this._setCellSolution(t.cells[d],0);for(u=0;u<t.length&&0===t.cells[u].aiSolution;u++)p++;for(u=t.length-1;u>=0&&0===t.cells[u].aiSolution;u--)h--;for(r=0;r<t.sections.length;r++){for(i=t.sections[r],a=n.default.cloneArray(i.possibleStartIndexes),s=0;s<i.possibleStartIndexes.length;s++)for(o=i.possibleStartIndexes[s],c=t.cells[o+i.length],(o<p||o>h)&&(a=n.default.removeFromArray(a,o)),c&&1===c.aiSolution&&(a=n.default.removeFromArray(a,o)),l=(l=o+i.length-1)>t.length-1?t.length-1:l,e=o;e<=l;e++)(e>t.length-1||0===t.cells[e].aiSolution)&&(a=n.default.removeFromArray(a,o));p+=i.length+1,h+=i.length+1,i.possibleStartIndexes=a}},t.prototype.findKnownPositivesAndNegatives=function(t){var e,i,o,a,r,s,c,l,d,u,p=n.default.getZeroFilledArray(t.length);for(e=0;e<t.sections.length;e++){for(i=t.sections[e],o=n.default.getZeroFilledArray(t.length),a=0;a<i.possibleStartIndexes.length;a++)for(s=(r=i.possibleStartIndexes[a])+i.length-1,c=r;c<=s;c++)o[c]++,p[c]++;for(l=0;l<o.length;l++)d=o[l],(u=t.cells[l])&&null===u.aiSolution&&d===i.possibleStartIndexes.length&&this._setCellSolution(u,1)}for(l=0;l<p.length;l++)d=p[l],(u=t.cells[l])&&null===u.aiSolution&&0===d&&this._setCellSolution(u,0)},t.prototype.findAnchoredSections=function(t){var e,i,o,n;if(t.sections.length>0){for(o=t.sections[0],n=t.sections[t.sections.length-1],i=null,e=0;e<t.cells.length&&null!==t.cells[e].aiSolution;e++)if(1===t.cells[e].aiSolution){i=[e,e+o.length-1];break}if(null!==i){for(e=i[0];e<=i[1];e++)t.cells[e]&&this._setCellSolution(t.cells[e],1);t.cells[e]&&this._setCellSolution(t.cells[e],0)}for(i=null,e=t.cells.length-1;e>=0&&null!==t.cells[e].aiSolution;e--)if(1===t.cells[e].aiSolution){i=[e-n.length+1,e];break}if(null!==i){for(e=i[0];e<=i[1];e++)t.cells[e]&&this._setCellSolution(t.cells[e],1);t.cells[i[0]-1]&&this._setCellSolution(t.cells[i[0]-1],0)}}},t.prototype.findSectionDefiningChains=function(t){var e,i,o,a,r,s=[],c=0;for(r=n.default.cloneArray(t.sections).sort(function(t,e){return t.length>e.length?-1:1})[0],e=0;e<t.cells.length;e++)1===(i=t.cells[e]).aiSolution&&(1!==c?(o={start:e,length:1},s.push(o)):o&&o.length++),c=i.aiSolution;for(a=0;a<s.length;a++)(o=s[a]).length===r.length&&(t.cells[o.start-1]&&this._setCellSolution(t.cells[o.start-1],0),t.cells[o.start+r.length]&&this._setCellSolution(t.cells[o.start+r.length],0),r.solved=!0)},t.prototype.findCompletedSections=function(t){var e,i,o,n;for(e=0;e<t.sections.length;e++)(i=t.sections[e]).solved||1!==i.possibleStartIndexes.length||(o=i.possibleStartIndexes[0]-1,n=i.possibleStartIndexes[0]+i.length,t.cells[o]&&null===t.cells[o].aiSolution&&this._setCellSolution(t.cells[o],0),t.cells[n]&&null===t.cells[n].aiSolution&&this._setCellSolution(t.cells[n],0),i.solved=!0)},t.prototype.findCompletedLines=function(t){var e,i,o,n=0,a=0;for(e=0;e<t.sections.length;e++)n+=t.sections[e].length;for(i=0;i<t.cells.length;i++)a+=1===(o=t.cells[i]).aiSolution?1:0;if(n===a)for(i=0;i<t.cells.length;i++)null===(o=t.cells[i]).aiSolution&&this._setCellSolution(o,0)},t.prototype._reset=function(){var t,e,i,n,a,r,s,c,l,d,u=[],p=[];for(this.isReset=!0,this.elapsedTime=0,this.solutionLog=[],this.lines=[],e=0;e<this.puzzle.cells.length;e++)this.puzzle.cells[e].aiSolution=null;for(t=0;t<this.puzzle.width;t++)u.push(t);for(t=0;t<this.puzzle.height;t++)p.push(t);for(i=0;i<this.puzzle.rowHints.length;i++)if(n=this.puzzle.rowHints[i],a=this.puzzle.getRowCells(i)){for(r=new o.default({type:"row",index:i,length:this.puzzle.width,cells:a}),s=0;s<n.length;s++)c=n[s],r.sections.push({index:s,length:c,possibleStartIndexes:u,knownIndexes:[],solved:!1}),r.minimumSectionLength+=c+1;r.minimumSectionLength--,this.lines.push(r)}for(l=0;l<this.puzzle.columnHints.length;l++){for(d=this.puzzle.columnHints[l],r=new o.default({type:"column",index:l,length:this.puzzle.height,cells:this.puzzle.getColumnCells(l)}),s=0;s<d.length;s++)c=d[s],r.sections.push({index:s,length:c,possibleStartIndexes:p,knownIndexes:[],solved:!1}),r.minimumSectionLength+=c+1;r.minimumSectionLength--,this.lines.push(r)}},t.prototype._setCellSolution=function(t,e){var i,o,n,a,r,s,c;if(null===t.aiSolution)for(i=0;i<this.lines.length;i++)if(n="row"===(o=this.lines[i]).type&&o.index===t.row,a="column"===o.type&&o.index===t.column,r=0,n||a){for(s=0;s<o.cells.length;s++)(c=o.cells[s]).index===t.index?(c.aiSolution=e,r++):null!==c.aiSolution&&r++;r===o.length&&(o.solved=!0)}},t.prototype._getTotalSolved=function(){var t,e=0;for(t=0;t<this.puzzle.cells.length;t++)e+=null!==this.puzzle.cells[t].aiSolution?1:0;return e},t.prototype._getProgress=function(){var t,e,i,o=0,n=0;for(t=0;t<this.lines.length;t++)for(o+=(e=this.lines[t]).sections.length*("row"===e.type?this.puzzle.width:this.puzzle.height),i=0;i<e.sections.length;i++)n+=e.sections[i].possibleStartIndexes.length;return o-n},t}();i.default=a,cc._RF.pop()},{PuzzleLine:"PuzzleLine",Utility:"Utility"}],Utility:[function(t,e,i){"use strict";cc._RF.push(e,"35509Oblm1OqYii3D8KZBBq","Utility"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.removeFromArray=function(t,e){var i=t.indexOf(e);return-1!==i&&t.splice(i,1),t},t.getZeroFilledArray=function(t){return new Array(t).fill(0)},t.cloneArray=function(t){return t.slice(0)},t}();i.default=o,cc._RF.pop()},{}],adC:[function(t,e,i){"use strict";var o;cc._RF.push(e,"80b6eItmFZEdbpPpK3DOIed","adC"),Object.defineProperty(i,"__esModule",{value:!0}),i.VEnum=i.VEnum2=void 0,(o=i.VEnum2||(i.VEnum2={}))[o.SHORT=15]="SHORT",o[o.MEDIUM=30]="MEDIUM",o[o.LONG=60]="LONG",i.VEnum={15:"adunit-c0d0468d71e666b4",30:"adunit-c0d0468d71e666b4",60:"adunit-c0d0468d71e666b4"},cc._RF.pop()},{}],ali:[function(t,e,i){"use strict";cc._RF.push(e,"1ea91av6hxDDJyMqyRofUmH","ali"),Object.defineProperty(i,"__esModule",{value:!0}),i.my=void 0;var o=t("c"),n=t("com"),a=t("env"),r=t("evts"),s=t("pConst"),c=t("request"),l=t("sound"),d=t("time"),u=t("uData"),p=t("pInfo"),h=function(t){function e(){var e=t.call(this)||this;e.isSharing=!1,e.sdkSwitch=s.DefaultSDKSwitch,e.videoCheckedMap={},e.videoCheckedLastT={},e.uniqueVideoUnitId="ad_tiny_2021004133656183_202401292200080698",e.isLoading=!1,e.isLoggedIn=!1,e.onHideT=0,e.noAd=!1,e.noVideo=!1,e.lastInterAdShowT=0,e.switchesInitd=!1,e.gameRecorder=null,e.ta=null,e.m_nStartRecordT=0,e.m_nRecordT=0,e.m_bIsRecording=!1,e.m_nAutoStopVideoId=0,e.m_strVideoPath="",e.cDeskCatch=!1,e.isRejed=!1,e.onKeyboardComplete=null===i.my||void 0===i.my?void 0:i.my.onKeyboardComplete,i.my=e.string()===s.PFCode.Alipay?window.my:globalThis.my,XMLHttpRequest.prototype.getResponseHeader=function(){};var o=console.log;return console.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t.some(function(t){return"string"==typeof t&&t.includes("\u5185\u5bb9\u5de1\u68c0")});i||o.apply(console,t)},e}return __extends(e,t),Object.defineProperty(e.prototype,"appId",{get:function(){return"2021004133656183"},enumerable:!1,configurable:!0}),e.prototype.string=function(){return s.PFCode.Alipay},e.prototype.init=function(){this.initAliListener(),this.initCommonSetting()},e.prototype.initTga=function(){},e.prototype.isSwitchedInitd=function(){return this.switchesInitd},e.prototype.initAliListener=function(){var t=this;i.my.onShow(function(e){r.default.plE.emit({onShow:!0,isSharing:t.isSharing}),u.default.ins.syncLaunchOption(e),t.isSharing||t.reenter(),t.bySlider="gamecenter"==e.query.sourceChannel,t.checkDesktopExist().then(function(){r.default.opE.emit({action:r.default.Desktop_Chg})}),r.default.opE.emit({action:r.default.Slider_Chg})}),t.sidebarExist=t.canUse("10.5.60"),i.my.onHide(function(){t.onHideT=d.default.ins.serverTime,r.default.plE.emit({onHide:!0})}),i.my.onError(function(t){a.env.mode!==a.EM.PROD&&i.my.alert({title:t.error||"\u5f02\u5e38\u62a5\u9519",content:t.stack||t+"",showCancel:!1,buttonText:"\u597d\u7684"})});var e=s.SDKConfig.shareData(),o="iOS"===this.getSystemData().platform||"iPhone OS"===this.getSystemData().platform?"https://tjkj300.oss-cn-shenzhen.aliyuncs.com/web/tjkj300web/other/share.jpg":e.imageUrl;i.my.onShareAppMessage=function(){return{title:e.title,desc:"",bgImgUrl:o,success:function(){l.default.ins.playBGM()},fail:function(){l.default.ins.playBGM()}}},i.my.onMemoryWarning&&i.my.onMemoryWarning(function(){i.my.triggerGC&&i.my.triggerGC()});var n=this.uniqueVideoUnitId;null==this.videoAd&&(this.videoAd=i.my.createRewardedAd({adUnitId:n})),null==this.videoAd&&this.videoAd.load()},e.prototype.initCommonSetting=function(){u.default.ins.syncLaunchOption(i.my.getLaunchOptionsSync()),i.my.getNetworkType({success:function(){},fail:function(){}}),r.default.chE.on(function(){})},e.prototype.setAccountID=function(){a.env.mode,a.EM.TEST},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,new Promise(function(t){i.my.getAuthCode({scopes:"auth_base",success:function(e){var i={};i.code=e.authCode;try{t(i)}catch(o){}},fail:function(e){console.error("my.getAuthCode \u8c03\u7528\u5931\u8d25",e),t({})}})})]})})},e.prototype.initCloud=function(){return Promise.resolve(null)},e.prototype.syncTime=function(){return Promise.resolve(null)},e.prototype.reenter=function(){},e.prototype.getStorage=function(t){try{var e=i.my.getStorageSync({key:t});return e.success?null==e.data||""==e.data?null:JSON.parse(e.data):null==e||""==e?null:JSON.parse(e)}catch(o){}},e.prototype.setStorage=function(t,e){try{var o=i.my.setStorageSync({key:t,data:JSON.stringify(e)});o.success||console.error("setStorageSync fail",o.errorMessage,"\n",o.error)}catch(n){}},e.prototype.clearStorage=function(){try{i.my.clearStorageSync()}catch(t){}},e.prototype.removeStorage=function(t){try{i.my.removeStorageSync(t)}catch(e){}},e.prototype.trackLogin=function(){},e.prototype.trackUserSet=function(){},e.prototype.trackUserSetOnce=function(){},e.prototype.trackEvent=function(){},e.prototype.getSeq=function(){},e.prototype.consumeSeq=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return t.sequenceInfo.type!=s.STDSeqType.VIDEO?[3,2]:[4,this.doWatchAD(t)];case 1:e.sent(),this.doShare(),e.label=2;case 2:return[2]}})})},e.prototype.doWatchAD=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(){return this.noAd?[2]:this.noVideo?(console.error("[error] no video"),[2,Promise.reject(s.VideoFailCode.NO_AD)]):(r.default.adE.emit(o.ADE.VIDEO),this.showLoading(),e=this,[2,new Promise(function(i,n){e.videoAd.onClose(function(a){null!=a&&a.isEnded?(r.default.adE.emit(o.ADE.VIDEO_END),e.trackEvent("video",{step:"complete",unit:void 0,type:t.videoSource,item:t.item}),i(1)):(r.default.adE.emit(o.ADE.VIDEO_END),n(s.VideoFailCode.CANCELED))}),e.videoAd.load().then(function(){e.videoAd.show().then(function(){e.hideLoading()}).catch(function(){e.hideLoading(),r.default.adE.emit(o.ADE.VIDEO_END),e.videoAd=null,n(s.VideoFailCode.NO_AD)})}).catch(function(){e.hideLoading(),n(s.VideoFailCode.NO_AD)}).then(function(){})})])})})},e.prototype.doShare=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2]})})},e.prototype._askReShare=function(){},e.prototype.canUse=function(t){return n.default.ins.compareVersion(this.getSystemData().version,t)>=0},e.prototype.getSystemData=function(){if(null==this.systemInfoCache)try{this.systemInfoCache=i.my.getSystemInfoSync()}catch(t){return s.DefaultSystemInfo}return this.systemInfoCache},e.prototype.getSwitches=function(){},e.prototype.vibrate=function(t){t==s.VEnum4.SHORT?i.my.vibrateShort("heavy"):t==s.VEnum4.LONG&&i.my.vibrateLong({success:function(){},fail:function(){}})},e.prototype.preloadVideo=function(){return!1},e.prototype.showConfirm=function(t){return new Promise(function(e){i.my.confirm(Object.assign(Object.assign({},t),{success:function(t){t.confirm?e(!0):e(!1)},fail:function(){e(!1)}}))})},e.prototype.refreshGame=function(){location.reload()},e.prototype.showLoading=function(){this.isLoading=!0,i.my.showLoading({content:"\u52a0\u8f7d\u4e2d",mask:!0})},e.prototype.hideLoading=function(){this.isLoading&&(i.my.hideLoading(),this.isLoading=!1)},e.prototype.log=function(){},e.prototype.getMenuBounding=function(){},e.prototype.createShareImage=function(){},e.prototype.preloadInterstitialAD=function(){},e.prototype.showInterstitialAD=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,null]})})},e.prototype.canShowBanner=function(){return!1},e.prototype.getBannerSize=function(){return new cc.Size(0,0)},e.prototype.showBanner=function(){},e.prototype.hideBanner=function(){},e.prototype.getSubscribeCnt=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,0]})})},e.prototype.subscribe=function(){},e.prototype.initVideoRecorder=function(){},e.prototype.startVideoRecord=function(){},e.prototype.pauseVideoRecord=function(){},e.prototype.resumeVideoRecord=function(){},e.prototype.stopVideoRecord=function(){},e.prototype.startStopRecordTimeout=function(){},e.prototype.clearStopRecordTimeout=function(){},e.prototype.autoStopVideoRecord=function(){},e.prototype.onVideoRecordStart=function(){},e.prototype.onVideoRecordEnd=function(){},e.prototype.onVideoRecordError=function(){},e.prototype.hasVideoRecord=function(){},e.prototype.shareVideoRecord=function(){},e.prototype.uploadAdEvent=function(){},e.prototype.PostMessage=function(){},e.prototype.SetUserCloudStorage=function(){},e.prototype.GetOpenDataContext=function(){},e.prototype.addShortcut=function(){},e.prototype.checkDesktopExist=function(){var t=this;return new Promise(function(e){var i=c.default.ins;t.cDeskCatch=!1,i.addHomepageConsult().then(function(i){if(1===i.status){var o=u.default.ins.getLocalData().aliAddHome,n="N"===i.data?1:0;1===o&&0===n&&r.default.opE.emit({action:r.default.ALIPAY_MAIN}),p.default.ins.setAliAddHome(n),e(1)}else t.cDeskCatch=!0,e(0)}).catch(function(i){t.cDeskCatch=!0,e(0),console.error(i)})})},e.prototype.addGamesetlattice=function(){this.navigateToMiniProgramBySchema("alipays://platformapi/startapp?appId=2021003125685383&url=https%3A%2F%2Frender.alipay.com%2Fp%2Fyuyan%2F180020010001206617%2Findex.html%3FcaprMode%3Dsync&chInfo=gamesetlattice&sms=YES&appClearTop=false",function(){},function(){})},e.prototype.share=function(){return new Promise(function(t){i.my.showSharePanel({from:"code",success:function(){l.default.ins.playBGM(),t(1)},fail:function(e){console.error("alisharedata fail:",e),l.default.ins.playBGM(),t(0)}})})},e.prototype.getUserInfo=function(){var t=this;return new Promise(function(e,o){i.my.getAuthCode&&i.my.getAuthCode({scopes:"auth_user",success:function(){i.my.getAuthUserInfo({success:function(t){var i=t.avatar;t.avatar=i.replace("http://","https://"),e(t)},fail:function(t){o(t)}})},fail:function(){t.showRefuseTip(e,o)}})})},e.prototype.showRefuseTip=function(t,e){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(){return this.showConfirm({title:"\u53cb\u60c5\u63d0\u793a",content:"\u7533\u8bf7\u4f7f\u7528\u60a8\u7684\u7528\u6237\u4fe1\u606f\uff0c\u5c55\u793a\u6392\u884c\u699c\u3002",confirmButtonText:"\u5141\u8bb8",cancelButtonText:"\u62d2\u7edd"}).then(function(i){i?t.getUserInfo():e()}),[2]})})},e.prototype._getUserInfo=function(){},e.prototype.schemaToParams=function(t){if(!t.startsWith("alipays:"))return{message:"! \u975e alipays: \u5f00\u5934"};for(var e={},i=0,o=t.replace(/^.*?\?/,"").split("&").map(function(t){var e=t.includes("=")?t.indexOf("="):t.length;return[t.slice(0,e),t.slice(e+1)].map(decodeURIComponent)});i<o.length;i++){var n=o[i],a=n[0],r=n[1];if("appId"==a){if(16!=r.length)return{message:"! \u975e 16 \u4f4d appId '"+r+"'"};e[a]=r}else if("chInfo"===a){var s=e.startParam||{};s[a]=r,e.startParam=s;continue}}return{params:e}},e.prototype.navigateToMiniProgramBySchema=function(t,e,o){var n=this.schemaToParams(t),a=n.params,r=n.message;a?i.my.navigateToMiniProgram(__assign(__assign({},a),{success:e,fail:o})):o&&o({error:-1,errorMessage:"\u65e0\u6548\u7684\u5c0f\u7a0b\u5e8f schema "+t+": "+r})},e.prototype.navigateToScene=function(t){void 0===t&&(t="sidebar"),this.navigateToMiniProgramBySchema("alipays://platformapi/startapp?appId=2021003125685383&url=https%3A%2F%2Frender.alipay.com%2Fp%2Fyuyan%2F180020010001206617%2Findex.html%3FcaprMode%3Dsync&chInfo=returnvisit&sms=YES&appClearTop=false",function(){},function(){})},e.prototype.reportEvent=function(t,e){void 0===e&&(e={})},e.prototype.showModal=function(t){var e=t.title,i=t.content,o=t.confirmText,n=(t.showCancel,{title:e,content:i,buttonText:o});return this.showAlert(n)},e.prototype.showAlert=function(t){return new Promise(function(e,o){i.my.alert(Object.assign(Object.assign({},t),{success:function(){e(1)},fail:function(t){console.error(t),o(t)}}))})},e.prototype.requestSubscribeMessage=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Promise(function(e,o){i.my.getSetting({withSubscriptions:!0,success:function(n){n.authSetting.subscriptionsSetting.mainSwitch?e(1):i.my.requestSubscribeMessage({entityIds:t,success:function(t){t.success&&"subscribe"===t.behavior&&e(1)},fail:function(t){o(t)}})},fail:function(){o()}})})},e}(t("pf").default);i.default=h,cc._RF.pop()},{c:"c",com:"com",env:"env",evts:"evts",pConst:"pConst",pInfo:"pInfo",pf:"pf",request:"request",sound:"sound",time:"time",uData:"uData"}],androidP:[function(t,e,i){"use strict";var o;cc._RF.push(e,"65e81r/NHpIf7QB9ks4KiDS","androidP"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("pConst"),a=function(t){function e(){var e=t.call(this)||this;return o=jsb.reflection.callStaticMethod,e}return __extends(e,t),Object.defineProperty(e.prototype,"appId",{get:function(){return"dev_nonogram"},enumerable:!1,configurable:!0}),e.prototype.string=function(){return n.PFCode.Android},e.prototype.vibrate=function(){o("org/cocos2dx/javascript/InstantAppActivity","vibrate","()V")},e.prototype.login=function(){return t.prototype.login.call(this)},e.prototype.setStorage=function(t,e){var i=jsb.fileUtils.getWritablePath()+t;jsb.fileUtils.isDirectoryExist(i)||jsb.fileUtils.createDirectory(i),jsb.fileUtils.writeStringToFile(JSON.stringify(e),i+"/android_nonogram.txt")},e.prototype.getStorage=function(t){var e=jsb.fileUtils.getWritablePath()+t;jsb.fileUtils.isDirectoryExist(e)||(jsb.fileUtils.createDirectory(e),jsb.fileUtils.writeStringToFile("",e+"/android_nonogram.txt"));var i=jsb.fileUtils.getStringFromFile(e+"/android_nonogram.txt");return null==i||""==i?null:JSON.parse(i)},e.prototype.setCloudData=function(){},e.prototype.doWatchAD=function(){var t=this;return new Promise(function(e,i){t.resolve=e,t.reject=i,o("org/cocos2dx/javascript/InstantAppActivity","playAd","()V")})},e}(t("nativeP").default);i.default=a,cc._RF.pop()},{nativeP:"nativeP",pConst:"pConst"}],bagMgr:[function(t,e,i){"use strict";cc._RF.push(e,"dfb15KhzmROJKM0MC8wEsot","bagMgr"),Object.defineProperty(i,"__esModule",{value:!0}),i.bagItem=void 0;var o=t("evts"),n=t("idx"),a=t("cfgMgr"),r=t("lang"),s=t("pInfo"),c=function(){function t(){if(this._propTag="props",t._ins)throw new Error("bagMgr can only be one\uff01");t._ins=this}return Object.defineProperty(t,"ins",{get:function(){return t._ins||new t,t._ins},enumerable:!1,configurable:!0}),t.prototype.initBag=function(t){if(t){var e=a.default.serverCfg.qw_line_rules.rules.times.set.basic_times.val;this.chgItemCount("qw_line_ticket",e,!1),this.updItem()}},Object.defineProperty(t.prototype,"bagItem",{get:function(){return this._bagItem||(this._bagItem=s.default.ins.Bag),this._bagItem},enumerable:!1,configurable:!0}),t.prototype.clearItem=function(){this._bagItem=null},t.prototype.updItem=function(){s.default.ins.Bag=this._bagItem},t.prototype.useItem=function(t,e,i){if(void 0===e&&(e=1),t)if(this.bagItem[t]){this.bagItem[t]-=e,this.bagItem[t]<=0&&delete this.bagItem[t],this.updItem();var a="\u62fc\u56fe";r.gemeTypeKey[i]&&(a=r.gemeTypeKey[i]),n.platform.reportEvent(n.ERepEvt.useItem,{gameType:a,itemId:r.reportKey[t]}),o.default.opE.emit({action:o.default.UPD_MAIN_RED})}else cc.log("\u4f7f\u7528\u5931\u8d25\uff0c\u65e0\u8be5\u9053\u5177\uff1a"+t)},t.prototype.checkItemEnough=function(t,e){return void 0===e&&(e=1),this.bagItem[t]&&this.bagItem[t]>=e},t.prototype.addItem=function(t,e,i,n){void 0===e&&(e=1),void 0===i&&(i=!0),void 0===n&&(n=!0),this.specialItemCheck(t,e)||t&&(null==this.bagItem[t]&&(this.bagItem[t]=0),this.bagItem[t]+=e,i&&this.updItem(),"puzzle_pieces"!==t&&"newYear_pieces"!==t||o.default.opE.emit({action:o.default.UPDJIGSAWGAME}),n&&o.default.opE.emit({action:o.default.UPD_MAIN_RED}))},t.prototype.chgItemCount=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=!0),t&&(null==this.bagItem[t]&&(this.bagItem[t]=0),this.bagItem[t]=e,i&&this.updItem())},t.prototype.getItemCount=function(t){return t&&this.bagItem[t]?this.bagItem[t]:0},t.prototype.specialItemCheck=function(t,e){switch(t){case"coin":return s.default.ins.addCoin(e),!0;case"exp":return s.default.ins.addExp(e),!0;case"times":return s.default.ins.addPower(e),!0;default:return!1}},t}();i.default=c,i.bagItem=function(){this.count=0},cc._RF.pop()},{cfgMgr:"cfgMgr",evts:"evts",idx:"idx",lang:"lang",pInfo:"pInfo"}],banner:[function(t,e,i){"use strict";cc._RF.push(e,"b491bWadyVEz4fDbYZRH4YG","banner"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("com"),n=t("lang"),a=t("pInfo"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ani=null,e.par=null,e.bannerLabel=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t=a.default.ins.getRecordData().heWins,e=t>=50?40002:40001;40001===e&&(t=o.default.ins.rad(80,99)),this.bannerLabel.string=n.lang[e].format(t)},e.prototype.play=function(){this.ani.play(),this.par.resetSystem()},__decorate([c(cc.Animation)],e.prototype,"ani",void 0),__decorate([c(cc.ParticleSystem)],e.prototype,"par",void 0),__decorate([c(cc.Label)],e.prototype,"bannerLabel",void 0),__decorate([s],e)}(cc.Component);i.default=l,cc._RF.pop()},{com:"com",lang:"lang",pInfo:"pInfo"}],baseUI:[function(t,e,i){"use strict";var o;cc._RF.push(e,"7d5a9qK3IdB0LQLFV0VPhWU","baseUI"),Object.defineProperty(i,"__esModule",{value:!0}),i.HIERARCHY=void 0;var n,a=t("com"),r=t("idx"),s=cc._decorator,c=s.ccclass,l=s.property;(n=o=i.HIERARCHY||(i.HIERARCHY={}))[n.None=0]="None",n[n.Left=1]="Left",n[n.Right=2]="Right",n[n.Down=3]="Down";var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ctx=null,e.closeBtn=null,e.sAni=!0,e.hAni=!0,e.panelHierachy=o.Down,e.a=.5,e.cb=null,e.b=null,e.c=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.closeBtn&&this.closeBtn.node.on("click",this.hideThis,this)},e.prototype.hideThis=function(){},e.prototype.show=function(t,e){void 0===e&&(e=this.a),this.c=t,this.init(this.c),this.uD(this.c),this.aUI(),this.checkShow(e)},e.prototype.hide=function(t){if(!this.isHideing){this.isHideing=!0;var e=this;a.default.ins.a(t,1),a.default.ins.b(this.node,!0);var i=this.node,o=this.getK(e,i);return o?new Promise(function(t){o.call(function(){t(1)}).start()}):new Promise(function(t){i.active=!1,e.onHide&&e.onHide(),a.default.ins.b(e.node,!1),e.cb&&e.cb(i,e.b),t(1)})}},e.prototype.getK=function(t,e){switch(this.panelHierachy){case o.Down:return cc.tween(this.ctx).to(.1,{y:60}).to(.2,{y:-(cc.winSize.height+e.height)/2}).call(function(){e.active=!1,t.onHide&&t.onHide(),a.default.ins.b(t.node,!1),t.cb&&t.cb(e,t.b)});case o.Left:return this.moveHideAni(t,e,-cc.view.getVisibleSize().width);case o.Right:return this.moveHideAni(t,e,cc.view.getVisibleSize().width);default:return null}},e.prototype.moveHideAni=function(t,e,i){return cc.tween(this.ctx).to(.25,{x:i},{easing:this.customEaseInOut}).call(function(){e.active=!1,t.onHide&&t.onHide(),a.default.ins.b(t.node,!1),t.cb&&t.cb(e,t.b)})},e.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.aUI=function(){if(r.platform.canShowBanner()){var t=r.platform.getBannerSize().height/r.platform.getSystemData().windowHeight*cc.view.getVisibleSize().height;if(null!=this.ctx){var e=(cc.view.getVisibleSize().height-cc.view.getDesignResolutionSize().height)/2;e<t&&(this.ctx.y+=t-e)}}var i=this.ctx.getComponent(cc.Widget);i&&(i.enabled=!0,i.updateAlignment(),i.enabled=!1);var o=this.ctx.getComponentsInChildren(cc.Widget);if(o)for(var n=0;n<o.length;n++){var a=o[n];a.enabled=!0,a.updateAlignment(),a.enabled=!1}},e.prototype.uD=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.onShow=function(){},e.prototype.onHide=function(){},e.prototype.setCb=function(t){this.cb=t},e.prototype.showAni=function(t){var e=this;if(null!=this.ctx&&this.sAni){var i=this.ctx;i.active=!0,i.scale=.5,i.opacity=0,cc.tween(i).to(t,{scale:1,opacity:255},{easing:"backOut"}).call(function(){e.onShow&&e.onShow()}).start()}else this.onShow&&this.onShow()},e.prototype.downAni=function(){var t=this;if(null!=this.ctx&&this.sAni){var e=this.ctx;e.active=!0,e.y=-(cc.winSize.height+e.height)/2,cc.tween(e).to(.2,{y:60}).to(.1,{y:-20}).to(.04,{y:0}).call(function(){t.onShow&&t.onShow()}).start()}else this.onShow&&this.onShow()},e.prototype.moveAni=function(t,e){if(this.ctx){this.ctx.x=e;var i=this;i.onShow&&i.onShow(),cc.tween(this.ctx).to(t,{x:0},{easing:this.customEaseInOut}).call(function(){i.onShow&&i.onShow()}).start()}},e.prototype.customEaseInOut=function(t){return t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2},e.prototype.checkShow=function(t){switch(this.panelHierachy){case o.Right:this.moveAni(t,cc.view.getVisibleSize().width);break;case o.Down:this.downAni();break;case o.Left:this.moveAni(t,-cc.view.getVisibleSize().width);break;default:this.onShow&&this.onShow()}this.node.active=!0},__decorate([l(cc.Node)],e.prototype,"ctx",void 0),__decorate([l(cc.Button)],e.prototype,"closeBtn",void 0),__decorate([l(cc.Boolean)],e.prototype,"sAni",void 0),__decorate([l(cc.Boolean)],e.prototype,"hAni",void 0),__decorate([l({displayName:"\u5165\u573a\u65b9\u5f0f",tooltip:"\u8bbe\u7f6e\u5f53\u524d\u754c\u9762\u7684\u5165\u573a\u65b9\u5f0f\uff1a\nPop-\u5f39\u7a97\u8fdb\u5165\nLeft-\u5de6\u8fb9\u6ed1\u52a8\u8fdb\u5165\uff0c\nRight-\u53f3\u8fb9\u6ed1\u52a8\u8fdb\u5165\uff0c\nDown-\u4ece\u5e95\u90e8\u5f39\u51fa",type:cc.Enum(o)})],e.prototype,"panelHierachy",void 0),__decorate([c],e)}(cc.Component);i.default=d,cc._RF.pop()},{com:"com",idx:"idx"}],cfgMgr:[function(t,e,i){"use strict";cc._RF.push(e,"f62a8NIu0RKNrbUIyQ8mN40","cfgMgr"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("res"),a=function(){function t(){}return t.syncServerCfg=function(e){t.serverCfg=e.times?e:Object.assign(Object.assign({},this.serverCfg),e),o.default.opE.emit({action:o.default.REFRESH_CFGDATA})},t.init=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return t.serverCfg?[3,2]:[4,n.default.ins.l("json/serverCfgBackup",cc.JsonAsset)];case 1:(e=i.sent())&&(t.serverCfg=e.json),i.label=2;case 2:return[2]}})})},t}();i.default=a,cc._RF.pop()},{evts:"evts",res:"res"}],challengeMgr:[function(t,e,i){"use strict";cc._RF.push(e,"fcc69/466NH/5HdjeFaWPR1","challengeMgr"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("NumberUtils"),n=t("request"),a=t("time"),r=t("uData"),s=(t("global"),t("pInfo")),c=function(){function t(){this.firstYear=2024,this.firstMonth=2,this.lvDatas=[],this.defalutLvData=[{id:1,type:1,diff:3,count:500},{id:2,type:2,diff:4,size:15,denstiy:.6,count:10},{id:3,type:3,diff:3,size:15,denstiy:.6,count:5},{id:4,type:1,diff:3,count:501},{id:5,type:2,diff:4,size:15,denstiy:.6,count:10},{id:6,type:3,diff:3,size:15,denstiy:.6,count:5},{id:7,type:1,diff:3,count:502},{id:8,type:2,diff:4,size:15,denstiy:.6,count:10},{id:9,type:3,diff:3,size:15,denstiy:.6,count:5},{id:10,type:1,diff:3,count:503},{id:11,type:2,diff:4,size:15,denstiy:.6,count:10},{id:12,type:3,diff:3,size:15,denstiy:.6,count:5},{id:13,type:1,diff:3,count:504},{id:14,type:2,diff:4,size:15,denstiy:.6,count:10},{id:15,type:3,diff:3,size:15,denstiy:.6,count:5},{id:16,type:1,diff:3,count:505},{id:17,type:2,diff:4,size:15,denstiy:.6,count:10},{id:18,type:3,diff:3,size:15,denstiy:.6,count:5},{id:19,type:1,diff:3,count:506},{id:20,type:2,diff:4,size:15,denstiy:.6,count:10},{id:21,type:3,diff:3,size:15,denstiy:.6,count:5},{id:22,type:1,diff:3,count:507},{id:23,type:2,diff:4,size:15,denstiy:.6,count:10},{id:24,type:3,diff:3,size:15,denstiy:.6,count:5},{id:25,type:1,diff:3,count:508},{id:26,type:2,diff:4,size:15,denstiy:.6,count:10},{id:27,type:3,diff:3,size:15,denstiy:.6,count:5},{id:28,type:1,diff:3,count:509},{id:29,type:2,diff:4,size:15,denstiy:.6,count:10},{id:30,type:3,diff:3,size:15,denstiy:.6,count:5},{id:31,type:1,diff:3,count:600}]}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t)},enumerable:!1,configurable:!0}),t.prototype.initNowMonthData=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,o,n,r=this;return __generator(this,function(){return this.loaded?[2]:(this.loaded=1,t=1e3*a.default.ins.serverTime,e=new Date(t),i=e.getFullYear(),o=e.getMonth()+1,n=this.getIdxByDate(i,o),cc.resources.load("challenge",cc.JsonAsset,function(t,e){!t&&e&&e.json?r.lvDatas[n]=e.json:r.lvDatas[n]=r.defalutLvData}),[2])})})},t.prototype.getTodayIsFin=function(){var t=1e3*a.default.ins.serverTime,e=new Date(t),i=e.getFullYear(),o=e.getMonth()+1,n=e.getDate()-1;return this.getfinData(i,o)[n]},t.prototype.getMonthData=function(t,e){var i=new Date(t,e-1,1).getDay();return[i=0==i?7:i,new Date(t,e,0).getDate()]},t.prototype.getfinData=function(t,e){var i=this.getIdxByDate(t,e);this.getLvData(i,t,e);for(var o=s.default.ins.getChallengeData()[i]||0,n=[],a=0;a<31;a++){var r=this.getIsFin(o,a);n.push(r)}return n},t.prototype.getLastUnFinIdx=function(t,e){for(var i=this.getfinData(t,e),o=this.getMonthData(t,e),n=(o[0],o[1]),a=0,r=0;r<n;r++)i[r]||this.isLocked(t,e,r)||(a=r);return a},t.prototype.getFinLvNum=function(t,e){for(var i=this.getfinData(t,e),o=0,n=0,a=i.length;n<a;n++)i[n]&&o++;return o},t.prototype.getTheMonthIsFin=function(t,e){for(var i=this.getfinData(t,e),o=this.getMonthData(t,e),n=(o[0],o[1]),a=0,r=0;r<n;r++)i[r]&&a++;return a>=n},t.prototype.getIsFin=function(t,e){return(t&1<<e)>>e!=0},t.prototype.getLvData=function(t){var e=this;if(!(t<0)){var i=this.lvDatas[t];if(i)return i;cc.resources.load("challenge",cc.JsonAsset,function(i,o){!i&&o&&o.json&&Array.isArray(o.json)?e.lvDatas[t]=o.json:e.lvDatas[t]=e.defalutLvData})}},t.prototype.getLvDataByDate=function(t,e,i){var n=this.getIdxByDate(t,e),a=this.lvDatas[n];if(a){var r=a[i],s=o.default.RandomInt(0,this.defalutLvData.length-1);return r||(r=this.defalutLvData[s]),r}return this.getLvData(n,t,e),this.defalutLvData[i]},t.prototype.winChallenge=function(t){var e=t.year,i=t.month,o=t.day;if(!this.getfinData(e,i)[o-1]){var n=this.getIdxByDate(e,i),a=s.default.ins.getChallengeData(),c=a[n]||0;c+=Math.pow(2,o-1),a[n]=c,s.default.ins.setChallengeData(a),this.updateChallengeData(e,i,o),r.default.ins._setLocalAndCloudData()}},t.prototype.updateChallengeData=function(t,e,i){var o=t+this.addZeroToNum(e)+this.addZeroToNum(i);n.default.ins.updateChallengeData(o)},t.prototype.getRequestChallengeData=function(t,e){var i=t+this.addZeroToNum(e);return n.default.ins.getChallengeData(i)},t.prototype.addZeroToNum=function(t){if(t<0)return"";var e="";return t<10&&(e="0"),e+t},t.prototype.getIdxByDate=function(t,e){return 12*(t-this.firstYear)+(e-this.firstMonth)},t.prototype.isLocked=function(t,e,i){var o=1e3*a.default.ins.serverTime,n=new Date(o),r=n.getFullYear(),s=n.getMonth()+1,c=n.getDate()-1;return t!=r?t>r:e!=s?e>s:i>c},t.prototype.getChaPackData=function(t,e){for(var i=this.getIdxByDate(t,e),o=s.default.ins.getChallengePackData()[i]||0,n=[],a=0;a<4;a++){var r=this.getIsFin(o,a);n.push(r)}return n},t.prototype.setChaPackData=function(t,e,i){var o=this.getIdxByDate(t,e),n=s.default.ins.getChallengePackData(),a=n[o]||0;a+=Math.pow(2,i),n[o]=a,s.default.ins.setChallengePackData(n)},t.prototype.getMonthRed=function(t,e){for(var i=this.getFinLvNum(t,e),o=this.getChaPackData(t,e),n=0,a=0;a<4;a++)i>=7*(a+1)&&!o[a]&&n++;return n},t.prototype.getBeforeMonthRed=function(t,e){for(var i=t,o=e,n=this.getIdxByDate(i,o)+1,a=0,r=0;r<n;r++)a+=this.getMonthRed(i,o),--o<1&&(i-=1,o=12);return a},t.prototype.getAllMonthRed=function(){var t=1e3*a.default.ins.serverTime,e=new Date(t),i=e.getFullYear(),o=e.getMonth()+1;return this.getBeforeMonthRed(i,o)},t}();i.default=c,cc._RF.pop()},{NumberUtils:"NumberUtils",global:"global",pInfo:"pInfo",request:"request",time:"time",uData:"uData"}],chaptBtn:[function(t,e,i){"use strict";cc._RF.push(e,"9caaaxFVHdG34DDZ87Jv+Sy","chaptBtn"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprNode=null,e.lbls=[],e.redNumLb=null,e.flag=!0,e}return __extends(e,t),e.prototype.start=function(){this.u()},e.prototype.getState=function(){return this.flag},e.prototype.setLb=function(t){this.lbls.forEach(function(e){e.string=t})},e.prototype.setState=function(t){this.flag=t,this.u()},e.prototype.u=function(){null!=this.sprNode&&(this.sprNode.active=this.flag)},e.prototype.setRed=function(t){this.redNumLb&&(t?(this.redNumLb.string=t+"",this.redNumLb.node.parent.active=!0):this.redNumLb.node.parent.active=!1)},__decorate([a(cc.Node)],e.prototype,"sprNode",void 0),__decorate([a([cc.Label])],e.prototype,"lbls",void 0),__decorate([a(cc.Label)],e.prototype,"redNumLb",void 0),__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],chapterItem:[function(t,e,i){"use strict";cc._RF.push(e,"b3964ueQUBM7pwnBS90wcFu","chapterItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("global"),r=t("levelMgr"),s=t("panelMgr"),c=t("pInfo"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLbl=null,e.pro=null,e.proLbl=null,e.goBtn=null,e.pics=[],e.grayMater=null,e.normalMater=null,e}return __extends(e,t),e.prototype.init=function(t,e){var i=this;this.posObj=e,this._chapter=t,this.nameLbl.string="\u7b2c"+t+"\u7ae0";var o=c.default.ins.getPuzzleLvl();this.pro.progress=0;var n=o-(54*(this._chapter-1)+1);n=n<0?0:n,a.default.levelDone&&(n=54);var s=0;n>0&&(s=Math.floor(n/9)),o>54*this._chapter&&(s=6,n=54),r.default.ins.getchapterBunder().then(function(){for(var t=""+(100+i._chapter),e=function(e){r.default.ins.getJigsawIcon(e,t).then(function(t){t&&(i.pics[e-1].spriteFrame=t,e<=s?i.pics[e-1].setMaterial(0,i.normalMater):i.pics[e-1].setMaterial(0,i.grayMater))}).catch(function(){console.error("getJigsawIconErr")})},o=1;o<=6;o++)e(o)}).catch(function(){console.error("getChapterBundleErr")}),this.updPro()},e.prototype.updPro=function(){if(this._chapter){var t=c.default.ins.getPuzzleLvl();this.pro.progress=0;var e=t-(54*(this._chapter-1)+1);e=(e=e<0?0:e)>54?54:e,cc.tween(this.pro).to(.5,{progress:e/54}).start(),this.proLbl.string=e+"/54"}},e.prototype.unuse=function(){},e.prototype.reuse=function(){},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.onGoBtn=function(){n.platform.showLoading();var t=a.default.levelTmp=this._chapter;r.default.ins.updateTmpData(t).then(function(){n.platform.hideLoading(),s.default.ins.closeAllPanel(),o.default.opE.emit({action:o.default.UPDATA_LEVEL_TMP})})},e.prototype.onDestroy=function(){var t=""+(100+this._chapter);r.default.ins.getchapterBunder().then(function(e){cc.assetManager.releaseAsset(e.get(t+"/chapter",cc.SpriteFrame))}).catch(function(){console.error("getBundleErr")})},__decorate([u(cc.Label)],e.prototype,"nameLbl",void 0),__decorate([u(cc.ProgressBar)],e.prototype,"pro",void 0),__decorate([u(cc.Label)],e.prototype,"proLbl",void 0),__decorate([u(cc.Button)],e.prototype,"goBtn",void 0),__decorate([u([cc.Sprite])],e.prototype,"pics",void 0),__decorate([u(cc.Material)],e.prototype,"grayMater",void 0),__decorate([u(cc.Material)],e.prototype,"normalMater",void 0),__decorate([d],e)}(cc.Component);i.default=p,cc._RF.pop()},{evts:"evts",global:"global",idx:"idx",levelMgr:"levelMgr",pInfo:"pInfo",panelMgr:"panelMgr"}],chgBtn:[function(t,e,i){"use strict";cc._RF.push(e,"db62fK//GZEhp0t7svoB+gK","chgBtn"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.lbSpr=null,e.offBg=null,e.onBg=null,e.offLb=null,e.onLb=null,e.flag=!1,e}return __extends(e,t),e.prototype.start=function(){this.u()},e.prototype.setState=function(t){this.flag=t,this.u()},e.prototype.u=function(){null!=this.bg&&(this.bg.spriteFrame=this.flag?this.onBg:this.offBg),null!=this.lbSpr&&(this.lbSpr.spriteFrame=this.flag?this.onLb:this.offLb)},__decorate([a(cc.Sprite)],e.prototype,"bg",void 0),__decorate([a(cc.Sprite)],e.prototype,"lbSpr",void 0),__decorate([a(cc.SpriteFrame)],e.prototype,"offBg",void 0),__decorate([a(cc.SpriteFrame)],e.prototype,"onBg",void 0),__decorate([a(cc.SpriteFrame)],e.prototype,"offLb",void 0),__decorate([a(cc.SpriteFrame)],e.prototype,"onLb",void 0),__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],com:[function(t,e,i){"use strict";function o(t,e){t.interactable=!e}function n(t){for(var e=t.length-1;e>=0;e--){var i=Math.floor(Math.random()*(e+1)),o=t[i];t[i]=t[e],t[e]=o}return t}function a(t){return t&&"object"==typeof t&&!Array.isArray(t)}cc._RF.push(e,"5120eEchVJEpIIgUMDKJDde","com"),Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(){this.bigs=[,"K","M","B","T","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],this.e=n,this.f=function t(e,i){for(var o,n,r=[],c=1;c<arguments.length;c++)r[c-1]=arguments[c];if(!r.length)return e;var l=r.shift();if(a(e)&&a(l))for(var d in l)a(l[d])?(e[d]||Object.assign(e,((o={})[d]={},o)),t(e[d],l[d])):Object.assign(e,((n={})[d]=l[d],n));return t.apply(void 0,s([e],r))}}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),t.prototype.randSort=function(t){return t.sort(function(){return Math.random()-.5}),t},t.prototype.bigNum=function(t){if(t<1e3)return t+"";for(var e=0;t>999;)t/=1e3,e++;var i=this.bigs[e]||"z";return Math.floor(100*t)/100+i},t.prototype.a=function(t,e){if(void 0===e&&(e=0),null!=t){t instanceof cc.Event.EventTouch&&(t=t.target);var i=null;if(t instanceof cc.Button?i=t:t instanceof cc.Node&&(i=t.getComponent(cc.Button)),null!=i){var n=function(){o(i,!1)};return o(i,!0),i.scheduleOnce(n,e),function(){n(),i.unschedule(n)}}}},t.prototype.b=function(t,e){e?t.pauseSystemEvents(!0):t.resumeSystemEvents(!0)},t.prototype.rad=function(t,e){return Math.round(Math.random()*(e-t))+t},t.prototype.compareVersion=function(t,e){for(var i=t.split("."),o=e.split("."),n=Math.max(i.length,o.length);i.length<n;)i.push("0");for(;o.length<n;)o.push("0");for(var a=0;a<n;a++){var r=parseInt(i[a]),s=parseInt(o[a]);if(r>s)return 1;if(r<s)return-1}return 0},t}();i.default=r;var s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,o=0,n=arguments.length;o<n;o++)i+=arguments[o].length;var a=Array(i),r=0;for(o=0;o<n;o++)for(var s=arguments[o],c=0,l=s.length;c<l;c++,r++)a[r]=s[c];return a};String.prototype.format=function(){if(!arguments.length)return this;for(var t=this,e=0,i=arguments.length;e<i;e++)t=t.replace("{"+e+"}",arguments[e]);return t},cc._RF.pop()},{}],c:[function(t,e,i){"use strict";var o;cc._RF.push(e,"68495iWIy9Gaa3DMhCPw98o","c"),Object.defineProperty(i,"__esModule",{value:!0}),i.ADE=void 0,(o=i.ADE||(i.ADE={}))[o.VIDEO=0]="VIDEO",o[o.VIDEO_END=1]="VIDEO_END",o[o.SHARE=2]="SHARE",o[o.SHARE_END=3]="SHARE_END",cc._RF.pop()},{}],dateItem:[function(t,e,i){"use strict";cc._RF.push(e,"fd235ZZ7QVCtYwyn8Ct+nY3","dateItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.bgTypes=[],e.dateLb=null,e.select=null,e.finish=null,e}var i;return __extends(e,t),i=e,e.prototype.setDate=function(t){this.dateLb.string=t},e.prototype.setLocked=function(t){t?(this.bg.spriteFrame=this.bgTypes[1],this.dateLb.node.color=i.color2,this.dateLb.node.opacity=180):(this.bg.spriteFrame=this.bgTypes[0],this.dateLb.node.color=i.color1,this.dateLb.node.opacity=255)},e.prototype.setSelected=function(t){this.select.active=t},e.prototype.setFinish=function(t){this.finish.active=t,t&&(this.bg.spriteFrame=this.bgTypes[2],this.dateLb.node.color=cc.Color.WHITE,this.dateLb.node.opacity=255)},e.color1=new cc.Color(201,103,23),e.color2=new cc.Color(255,231,209),__decorate([a(cc.Sprite)],e.prototype,"bg",void 0),__decorate([a([cc.SpriteFrame])],e.prototype,"bgTypes",void 0),__decorate([a(cc.Label)],e.prototype,"dateLb",void 0),__decorate([a(cc.Node)],e.prototype,"select",void 0),__decorate([a(cc.Node)],e.prototype,"finish",void 0),i=__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],dayReward:[function(t,e,i){"use strict";cc._RF.push(e,"15b97t+7MtFCLfTRDvhWmnX","dayReward"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("res"),n=t("item"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maskNode=null,e.recivedNode=null,e.canRecive=null,e.rewardItem=null,e.rewards=null,e.aniDatas=[],e.lightNode=null,e.showLight=!1,e}return __extends(e,t),e.prototype.initItem=function(t){var e=this;if(t){var i=0,a=function(a){var s=t[a],c=r.rewards.children[i];c||(c=cc.instantiate(r.rewardItem)),o.default.ins.getBundleByString("resSps").then(function(t){t.load("spine/light/action",sp.SkeletonData,function(t,i){if(!t&&e.node&&e.node.isValid){var o=new cc.Node,n=o.addComponent(sp.Skeleton);n.skeletonData=i,n.animation="animation",o.parent=c,e.lightNode=o,o.active=e.showLight}})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)}),c.parent=r.rewards;var l=c.getComponent(n.default);l&&l.initByData(a,s);var d={};d.itemId=a,d.itemNode=c,d.value=Number(s),r.aniDatas.push(d),i++},r=this;for(var s in t)a(s)}},e.prototype.setDefault=function(){this.maskNode.active=!1,this.recivedNode.active=!1,this.canRecive.active=!1,this.showLight=!0,this.lightNode&&(this.lightNode.active=!0)},e.prototype.setCanRecive=function(){this.maskNode.active=!1,this.recivedNode.active=!1,this.canRecive.active=!0,this.showLight=!0,this.lightNode&&(this.lightNode.active=!0)},e.prototype.setRecived=function(){this.maskNode.active=!0,this.recivedNode.active=!0,this.canRecive.active=!1,this.showLight=!1,this.lightNode&&(this.lightNode.active=!1)},__decorate([s(cc.Node)],e.prototype,"maskNode",void 0),__decorate([s(cc.Node)],e.prototype,"recivedNode",void 0),__decorate([s(cc.Node)],e.prototype,"canRecive",void 0),__decorate([s(cc.Node)],e.prototype,"rewardItem",void 0),__decorate([s(cc.Node)],e.prototype,"rewards",void 0),__decorate([r],e)}(cc.Component);i.default=c,cc._RF.pop()},{item:"item",res:"res"}],dynamicBtnBg:[function(t,e,i){"use strict";cc._RF.push(e,"fa179uJATZCx7GK8QWUgMQD","dynamicBtnBg"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("res"),n=cc._decorator,a=n.ccclass,r=n.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.url="",e}return __extends(e,t),e.prototype.start=function(){var t=this;this.node.active=!1,this.url&&o.default.ins.l(this.url,cc.SpriteFrame,"resSps").then(function(e){t.node&&t.node.isValid&&(t.bg.spriteFrame=e,t.node.active=!0,t.destroy())}).catch(function(){console.error("getResSpErr")})},__decorate([r(cc.Sprite)],e.prototype,"bg",void 0),__decorate([r(cc.String)],e.prototype,"url",void 0),__decorate([a],e)}(cc.Component);i.default=s,cc._RF.pop()},{res:"res"}],env:[function(t,e,i){"use strict";cc._RF.push(e,"d6367RuL4ROs7ur5md6t/Gj","env"),Object.defineProperty(i,"__esModule",{value:!0}),i.env=i.EM=void 0,i.EM={PROD:"PROD",TEST:"TEST"},i.env={version:"1.0.0",mode:i.EM.PROD,network:{server:"",retryT:2,defaultRetryCnt:3,resourceURL:""},game:"sudoku",name:"\u6bcf\u5929\u6570\u72ec",logo:0,noAds:!1},cc._RF.pop()},{}],errorCode:[function(t,e,i){"use strict";var o;cc._RF.push(e,"12906Gi7KRMjKBS+7tO7/q6","errorCode"),Object.defineProperty(i,"__esModule",{value:!0}),i.errorCode=void 0,(o=i.errorCode||(i.errorCode={}))[o.LOGIN_ERR=1]="LOGIN_ERR",o[o.PF_LOGIN_ERR=2]="PF_LOGIN_ERR",o[o.PF_CLOUD_ERR=3]="PF_CLOUD_ERR",o[o.LOGIN_STATE_ERR=4]="LOGIN_STATE_ERR",o[o.PARSE_JSON_ERR=5]="PARSE_JSON_ERR",o[o.PARSE_JSON_ERR2=6]="PARSE_JSON_ERR2",o[o.CANGET_DATE_ERR=7]="CANGET_DATE_ERR",o[o.HTTP_ERR=8]="HTTP_ERR",cc._RF.pop()},{}],evts:[function(t,e,i){"use strict";cc._RF.push(e,"42cc1Gb2IdEbZRAT34iQX1H","evts"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("tE"),n=function(){function t(){}return t.chE=new o.default,t.plE=new o.default,t.usE=new o.default,t.adE=new o.default,t.laE=new o.default,t.opE=new o.default,t.COIN_CHG="COIN_CHG",t.POWER_CHG="POWER_CHG",t.EXP_CHG="EXP_CHG",t.LEV_CHG="LEV_CHG",t.Slider_Chg="Slider_Chg",t.MAIL_Chg="MAIL_Chg",t.FINISH_PUZZLE="FINISH_PUZZLE",t.UNLOCK_PUZZLE="UNLOCK_PUZZLE",t.PURCHASED="PURCHASED",t.LOSEHEART="LOSEHEART",t.UPDATESCORE="UPDATESCORE",t.MAINJUMP="MAINJUMP",t.UPDTASK="UPDTASK",t.UPDJIGSAW="UPDJIGSAW",t.SHOWVIDEOSHARE="SHOWVIDEOSHARE",t.UPDMAIL="UPDMAIL",t.UPDJIGSAWGAME="UPDJIGSAWGAME",t.UPD_MAIN_RED="UPD_MAIN_RED",t.UPD_PANEL="UPD_PANEL",t.FINISH_PUZZLELV="FINISH_PUZZLELV",t.UPD_NEW_GIFT="UPD_NEW_GIFT",t.HIDE_WX_BTNS="HIDE_WX_BTNS",t.CHECK_WX_BTNS="CHECK_WX_BTNS",t.POP_FESTIVAL="POP_FESTIVAL",t.UPD_TOP_HEADINFO="UPD_TOP_HEADINFO",t.UPD_FES_RED="UPD_FES_RED",t.AD_MAX="AD_MAX",t.UPDATA_LEVEL_TMP="UPDATA_LEVEL_TMP",t.ADD_DESKTOP="ADD_DESKTOP",t.Desktop_Chg="Desktop_Chg",t.ALIPAY_MAIN="ALIPAY_MAIN",t.SKIN_CHG="SKIN_CHG",t.SIGN_RED="SIGN_RED",t.REFRESH_CFGDATA="REFRESH_CFGDATA",t}();i.default=n,cc._RF.pop()},{tE:"tE"}],festivalMgr:[function(t,e,i){"use strict";var o;cc._RF.push(e,"b79dds9PTVL16Wia/aps1uK","festivalMgr"),Object.defineProperty(i,"__esModule",{value:!0}),i.fesTaskKey=void 0;var n,a=t("time"),r=t("cfgMgr"),s=t("pInfo"),c=t("bagMgr"),l=cc._decorator,d=l.ccclass;l.property,(n=o=i.fesTaskKey||(i.fesTaskKey={})).raceScore="race_score",n.raceTimes="race_times",n.costPower="cost_power",n.throughMain="through_main",n.finishPuzzle="finish_puzzle";var u=function(){function t(){this.fesBeginTime=0,this.fesEndTime=0,this.fesTaskDatas=null,this.jigsawNum=1}var e;return e=t,Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new e)},enumerable:!1,configurable:!0}),t.prototype.isFesEnd=function(){var t=a.default.ins.serverTime;return t<this.fesBeginTime||t>=this.fesEndTime},t.prototype.isFesNotOpen=function(){return a.default.ins.serverTime<this.fesBeginTime},t.prototype.getTodayMaxPro=function(){var t=a.default.ins.serverTime,e=Math.floor((t-this.fesBeginTime)/86400);return e<0?0:e},t.prototype.getNowTaskIdx=function(){var t=this.getTodayMaxPro(),e=s.default.ins.getFesPro();return Math.min(e,t,24)},t.prototype.getNowTaskPro=function(){return s.default.ins.getFesTaskPro()},t.prototype.getFesPro=function(){return s.default.ins.getFesPro()},t.prototype.getNowTaskData=function(){var t=this.getNowTaskIdx();return this.fesTaskDatas[t]},t.prototype.isTaskLocked=function(){return s.default.ins.getFesPro()>this.getTodayMaxPro()},t.prototype.isTaskAllFinished=function(){return s.default.ins.getFesPro()>=this.fesTaskDatas.length},t.prototype.updPro=function(t,e){if(!this.isTaskLocked()&&this.fesTaskDatas&&this.getNowTaskData().get_by==t){var i=s.default.ins.getFesTaskPro(),n=0;switch(t){case o.raceScore:n=e;break;default:n=e+Number(i)}s.default.ins.setFesTaskPro(n)}},t.prototype.finishFesTask=function(){var t=s.default.ins,e=t.getFesPro();t.setFesPro(e+1),t.setFesTaskPro(0)},t.prototype.isPuzzleLocked=function(){return this.getFesPuzzleLv()-1>this.getTodayMaxPro()},t.prototype.getFesPuzzleLv=function(){return s.default.ins.getFesPuzzleLv()},t.prototype.finishFesPuzzleLv=function(){var t=s.default.ins.getFesPuzzleLv();s.default.ins.setFesPuzzleLv(t+1)},t.prototype.clearFesPuzzleLv=function(){var t=s.default.ins;t.setFesPuzzleLv(1),t.setFesPro(0),t.setFesTaskPro(0)},t.prototype.getRedNum=function(){var t=0;if(!this.fesTaskDatas)return t;if(this.isPuzzleLocked()||t++,!this.isTaskLocked()){var e=this.getNowTaskData().nums;this.getNowTaskPro()>=e&&t++}return t},t.prototype.updateFestivalData=function(){var t;return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(o){switch(o.label){case 0:return e=null===(t=r.default.serverCfg)||void 0===t?void 0:t.festival_tasks,i=(null==e?void 0:e.fesName)||"newYear",s.default.ins.getFesName()!=i&&(s.default.ins.setFesName(i),this.clearFesPuzzleLv()),this.fesBeginTime=Number(null==e?void 0:e.beginTime)||1707148800,this.fesEndTime=Number(null==e?void 0:e.endTime)||this.fesBeginTime+216e4,this.fesTaskDatas=null==e?void 0:e.rules,this.jigsawNum=(null==e?void 0:e.jigsawNum)||1,[2];case 1:return[2,o.sent()]}})})},t.prototype.getFesPuzzleInfo=function(){var t=this.fesPuzzleData,e=t[0],i=t[1],o=this.getFesPuzzleLv()-1,n=t[2+i+(0==o?0:t[2+o-1]+o)];return{id:o,type:e,size:255&n,diff:n>>8&255}},t.prototype.getFesPuzzleData=function(){for(var t=this.fesPuzzleData,e=t[1],i=this.getFesPuzzleLv()-1,o=0==i?0:t[2+i-1]+i,n=t[2+i]+i,a=t[2+e+o],r=Math.pow(255&a,2),s=2+e+n+1,c=[],l=0,d=2+e+o+1;d<s;d++){for(var u=t[d],p=0;p<32;p++){var h=1<<p&4294967295;if(c[l++]=(u&h)==h?1:0,l==r)break}if(l==r)break}return c},t.prototype.getFesPuzzleDiff=function(){return this.getFesPuzzleInfo().diff},t.prototype.getFesLevelCost=function(){var t=e.ins.getFesPuzzleDiff(),i=r.default.serverCfg.difficulty_rules.rules,o=10,n=1;for(var a in i){var s=i[a];if(o=Number(s.times_val),n===t)break;n++}return o},t.prototype.getFesPuzzleSprFrame=function(){var t=this;return new Promise(function(e,i){t.bundle.load("levels/"+t.getFesPuzzleLv(),cc.SpriteFrame,function(t,o){t?i():e(o)})})},t.prototype.getFesDownSprFrame=function(){var t=this;return new Promise(function(e,i){t.bundle.load("chapter",cc.SpriteFrame,function(t,o){t?i():e(o)})})},t.prototype.isPuzzleMax=function(){return e.ins.getFesPuzzleLv()>25},t.prototype.isJigsawMax=function(){return c.default.ins.getItemCount("newYear_pieces")>=105*this.jigsawNum},t.prototype.getJigsawNum=function(){return this.jigsawNum},e=__decorate([d],t)}();i.default=u,cc._RF.pop()},{bagMgr:"bagMgr",cfgMgr:"cfgMgr",pInfo:"pInfo",time:"time"}],flyio:[function(t,e){"use strict";cc._RF.push(e,"51480P4Eh5Njbdz0SzmweFP","flyio");var i=new(t("fly"));e.exports=i,cc._RF.pop()},{fly:"fly"}],fly:[function(t,e,i){"use strict";cc._RF.push(e,"5cb399zOCVMQ7XhcfvghvHe","fly"),function(t,o){if("object"==typeof i&&"object"==typeof e)e.exports=o();else if("function"==typeof define&&define.amd)define([],o);else{var n=o();for(var a in n)("object"==typeof i?i:void 0)[a]=n[a]}}(0,function(){return function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.i=function(t){return t},i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t){var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports={type:function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},isObject:function(t,i){return i?"object"===this.type(t):t&&"object"===(void 0===t?"undefined":e(t))},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},trim:function(t){return t.replace(/(^\s*)|(\s*$)/g,"")},encode:function(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")},formatParams:function(t){var e="",i=!0,o=this;return this.isObject(t)?(function t(n,a){var r=o.encode,s=o.type(n);if("array"==s)n.forEach(function(e,i){o.isObject(e)||(i=""),t(e,a+"%5B"+i+"%5D")});else if("object"==s)for(var c in n)t(n[c],a?a+"%5B"+r(c)+"%5D":r(c));else i||(e+="&"),i=!1,e+=a+"="+r(n)}(t,""),e):t},merge:function(t,e){for(var i in e)t.hasOwnProperty(i)?this.isObject(e[i],1)&&this.isObject(t[i],1)&&this.merge(t[i],e[i]):t[i]=e[i];return t}}},,function(t,e,i){var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=i(0),r="undefined"!=typeof document,s=function(){function t(e){function i(t){var e=void 0,i=void 0;function o(){t.p=e=i=null}a.merge(t,{lock:function(){e||(t.p=new Promise(function(t,o){e=t,i=o}))},unlock:function(){e&&(e(),o())},clear:function(){i&&(i("cancel"),o())}})}n(this,t),this.engine=e||XMLHttpRequest,this.default=this;var o=this.interceptors={response:{use:function(t,e){this.handler=t,this.onerror=e}},request:{use:function(t){this.handler=t}}},r=o.request;i(o.response),i(r),this.config={method:"GET",baseURL:"",headers:{},timeout:0,params:{},parseJson:!0,withCredentials:!1}}return o(t,[{key:"request",value:function(t,e,i){var o=this,n=new this.engine,s="Content-Type",c=s.toLowerCase(),l=this.interceptors,d=l.request,u=l.response,p=d.handler,h=new Promise(function(l,h){function f(t){return t&&t.then&&t.catch}function g(t,e){t?t.then(function(){e()}):e()}function v(i){e=i.body,t=a.trim(i.url);var o=a.trim(i.baseURL||"");if(t||!r||o||(t=location.href),0!==t.indexOf("http")){var d="/"===t[0];if(!o&&r){var p=location.pathname.split("/");p.pop(),o=location.protocol+"//"+location.host+(d?"":p.join("/"))}if("/"!==o[o.length-1]&&(o+="/"),t=o+(d?t.substr(1):t),r){var v=document.createElement("a");v.href=t,t=v.href}}var m=a.trim(i.responseType||""),y=-1!==["GET","HEAD","DELETE","OPTION"].indexOf(i.method),_=a.type(e),b=i.params||{};y&&"object"===_&&(b=a.merge(e,b));var S=[];(b=a.formatParams(b))&&S.push(b),y&&e&&"string"===_&&S.push(e),S.length>0&&(t+=(-1===t.indexOf("?")?"?":"&")+S.join("&")),n.open(i.method,t);try{n.withCredentials=!!i.withCredentials,n.timeout=i.timeout||0,"stream"!==m&&(n.responseType=m)}catch(C){}var w=i.headers[s]||i.headers[c],T="application/x-www-form-urlencoded";for(var I in a.trim((w||"").toLowerCase())===T?e=a.formatParams(e):a.isFormData(e)||-1===["object","array"].indexOf(a.type(e))||(T="application/json;charset=utf-8",e=JSON.stringify(e)),w||y||(i.headers[s]=T),i.headers)if(I===s&&a.isFormData(e))delete i.headers[I];else try{n.setRequestHeader(I,i.headers[I])}catch(C){}function D(t,e,o){g(u.p,function(){if(t){o&&(e.request=i);var n=t.call(u,e,Promise);e=void 0===n?e:n}f(e)||(e=Promise[0===o?"resolve":"reject"](e)),e.then(function(t){l(t)}).catch(function(t){h(t)})})}function k(t){t.engine=n,D(u.onerror,t,-1)}function N(t,e){this.message=t,this.status=e}n.onload=function(){try{var t=n.response||n.responseText;t&&i.parseJson&&-1!==(n.getResponseHeader(s)||"").indexOf("json")&&!a.isObject(t)&&(t=JSON.parse(t));var e=n.responseHeaders;if(!e){e={};var o=(n.getAllResponseHeaders()||"").split("\r\n");o.pop(),o.forEach(function(t){if(t){var i=t.split(":")[0];e[i]=n.getResponseHeader(i)}})}var r=n.status,c=n.statusText,l={data:t,headers:e,status:r,statusText:c};if(a.merge(l,n._response),r>=200&&r<300||304===r)l.engine=n,l.request=i,D(u.handler,l,0);else{var d=new N(c,r);d.response=l,k(d)}}catch(d){k(new N(d.msg,n.status))}},n.onerror=function(t){k(new N(t.msg||"Network Error",0))},n.ontimeout=function(){k(new N("timeout [ "+n.timeout+"ms ]",1))},n._options=i,setTimeout(function(){n.send(y?null:e)},0)}a.isObject(t)&&(t=(i=t).url),(i=i||{}).headers=i.headers||{},g(d.p,function(){a.merge(i,JSON.parse(JSON.stringify(o.config)));var n=i.headers;n[s]=n[s]||n[c]||"",delete n[c],i.body=e||i.body,t=a.trim(t||""),i.method=i.method.toUpperCase(),i.url=t;var r=i;p&&(r=p.call(d,i,Promise)||i),f(r)||(r=Promise.resolve(r)),r.then(function(t){t===i?v(t):l(t)},function(t){h(t)})})});return h.engine=n,h}},{key:"all",value:function(t){return Promise.all(t)}},{key:"spread",value:function(t){return function(e){return t.apply(null,e)}}}]),t}();s.default=s,["get","post","put","patch","head","delete"].forEach(function(t){s.prototype[t]=function(e,i,o){return this.request(e,i,a.merge({method:t},o))}}),["lock","unlock","clear"].forEach(function(t){s.prototype[t]=function(){this.interceptors.request[t]()}}),t.exports=s}])}),cc._RF.pop()},{}],game:[function(t,e,i){"use strict";var o,n,a,r,s,c,l,d;cc._RF.push(e,"a1e2eOdqJJNRYqNOnj+M+iI","game"),Object.defineProperty(i,"__esModule",{value:!0}),i.grilAni=void 0;var u,p=t("com"),h=t("evts"),f=t("idx"),g=t("mySafeArea"),v=t("pConst"),m=t("res"),y=t("sound"),_=t("uData"),b=t("vb"),S=t("uvAni"),w=t("cfgMgr"),T=t("grid"),I=t("heart"),D=t("item"),k=t("random_notice"),N=t("Creator"),C=t("global"),M=t("bagMgr"),R=t("challengeMgr"),L=t("festivalMgr"),P=t("levelMgr"),A=t("panelMgr"),E=t("taskMgr"),B=t("pInfo"),F=t("tipMgr"),x=t("banner"),O=cc._decorator,V=O.ccclass,U=O.property,z=Math.floor,H=(cc.color(230,234,247),cc.color(252,254,94)),G=cc.color(181,142,34,255);(s=o||(o={}))[s.X=0]="X",s[s.O=1]="O",s[s.Empty=3]="Empty",(u=n||(n={}))[u.None=0]="None",u[u.HeadRow=1]="HeadRow",u[u.HeadCol=2]="HeadCol",u[u.Grid=3]="Grid",function(t){t[t.None=0]="None",t[t.Vertical=1]="Vertical",t[t.Horizontal=2]="Horizontal"}(a||(a={})),function(t){t[t.None=0]="None",t[t.Set=1]="Set",t[t.Clean=2]="Clean"}(r||(r={})),function(t){t.run="run",t.idle="idle",t.happy="happy",t.sad="sad"}(c=i.grilAni||(i.grilAni={})),function(t){t.showBtns="showBtns",t.hideBtns="hideBtns",t.gameLose="gameLose",t.gameRelife="gameRelife",t.gameWin="gameWin",t.gameWinFailSf="gameWinFailSf",t.openItemSelect="openItemSelect",t.closeItemSelect="closeItemSelect"}(l||(l={})),function(t){t.tipIn="tipIn",t.tipOut="tipOut"}(d||(d={}));var j={2e4:"\u70b9\u51fb\u663e\u793a\u683c\u5b50\u5185\u5bb9",20001:"\u70b9\u51fb\u968f\u673a\u663e\u793a\n3\u4e2a\u683c\u5b50\u5185\u5bb9",20002:"\u70b9\u51fb\u663e\u793a\u4e00\u884c\n\u6216\u662f\u4e00\u5217\u683c\u5b50\u5185\u5bb9"},J=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.topSp=null,e.topGirlSk=null,e.topGooseSk=null,e.downSp=null,e.gridBgSp=null,e.topNode=null,e.downNode=null,e.downBeginY=0,e.font4=null,e.camera=null,e.panelAni=null,e.uHintSf=null,e.lHintSf=null,e.gridPrefab=null,e.map_node_=null,e.tilesParent=null,e.selectMask=null,e.selectMaskBg=null,e.rowHintsParent=null,e.colHintsParent=null,e.scoreLbl=null,e.score=0,e.useTimeLbl=null,e.consLbl=null,e.cons2Lbl=null,e.consBestLbl=null,e.rew1Lbl=null,e.rew2Lbl=null,e.threeNode=null,e.tenNode=null,e.oxTagAni=null,e.fadePrefab=null,e.patices=null,e.heartsPatic=null,e.hearts=[],e.heartInfinity=null,e.tipNode=null,e.tipLabel=null,e.tipAni=null,e.winAniNode=null,e.winCircleMask=null,e.winSpParent=null,e.winSps=null,e.winLight=null,e.singleSf=null,e.levelLbl=null,e.clockWarn=null,e.norClock=null,e.speClock=null,e.clockLbl=null,e.clockLbl2=null,e.tipActNode=null,e.tipUnActNode=null,e.shareBtn=null,e.shareIcon=null,e.shareLbl=null,e.noticeLbl=null,e.noticeAni=null,e.random_noticeLbl=null,e.random_noticeAni=null,e.full_row_colLbl=null,e.full_row_colAni=null,e.itemSelectEff=null,e.itemSelectIcon=null,e.itemSelectLbl=null,e.adGetBtn=null,e.getBtnsp=null,e.rewItems=null,e.rewItemPre=null,e.stopPraNode=null,e.heartBgNode=null,e.noticePrefab=null,e.random_noticePrefab=null,e.full_row_colPrefab=null,e.lineW=2,e.relifeTime=3,e.isAllRight=!1,e.rows_=15,e.cols_=15,e.grid_count=0,e.grids=[],e.baseData=null,e.workData=null,e.baseOTotal=-1,e.gridHeadRowVec=[],e.gridHeadColVec=[],e.rowHeadNums=[],e.rowHeadBegins=[],e.colHeadNums=[],e.colHeadBegins=[],e.fontSize=36,e.gridSize=40,e.gridsStartX=0,e.gridTouchStart=null,e.touchDir=a.None,e.fillMode=r.None,e.pen=o.O,e.lastTouchRow=-1,e.lastTouchCol=-1,e.click_touch_=!1,e.colAutoXCols=new Map,e.colAutoXRows=new Map,e.opStep=null,e._showResultTime=0,e.heartsNum=3,e.soundIdx=1,e.items=[{icon:"notice",tip:j[2e4],count:0,itemMax:-1,itemCur:0},{icon:"random_notice",tip:j[20001],count:0,itemMax:-1,itemCur:0},{icon:"full_row_col",tip:j[20002],count:0,itemMax:-1,itemCur:0}],e.eventFunc=null,e.raceRefreshPop=[],e.selectData={row:-1,col:-1},e}var i;return __extends(e,t),i=e,Object.defineProperty(e.prototype,"canTouch",{get:function(){return this._canTouch},set:function(t){this._canTouch=t},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this;if(this.byGuide=C.default.byGuide,delete C.default.byGuide,C.default.padScale){cc.view.setDesignResolutionSize(720,1280,cc.ResolutionPolicy.FIXED_HEIGHT);var e=this.topSp.node,i=(cc.view.getVisibleSize().width-720)/2;if(this.heartInfinity.x-=i,this.norClock.parent.x-=i,this.clockWarn.width+=2*i,this.hearts.forEach(function(t){t.node.x-=i}),this.heartBgNode.x-=i,e.removeComponent(cc.Widget),this.topNode.removeComponent(cc.Widget),this.scheduleOnce(function(){e.y=220,t.topNode.y=0}),!this.byGuide){var o=this.downNode.children;o[0].setPosition(-252,-570);for(var n=1;n<4;n++)o[n].x+=30;o[4].children[1].active=!0,o[5].active=!1}}f.platform.string()==v.PFCode.Alipay&&this.scheduleOnce(function(){t.heartInfinity.parent.y-=g.getSafeAreaRect().yMin,t.topSp.node.y-=g.getSafeAreaRect().yMin}),y.default.ins.playBGM(),this.opStep={grids:[],row_autox_cols:new Map,col_autox_rows:new Map,hint_rows:[],hint_cols:[],is_row_autox_changed:!1,is_col_autox_changed:!1,is_hint_rows_changed:!1,is_hint_cols_changed:!1},this.panelAni.on(cc.Animation.EventType.FINISHED,this.playAniDone,this),this.oxTagAni.on(cc.Animation.EventType.FINISHED,this.oxAniDone,this),this.tipAni.on(cc.Animation.EventType.FINISHED,this.tipAniDone,this),this.eventFunc=this.onOperTap.bind(this),h.default.opE.on(this.eventFunc)},e.prototype.checkLocalData=function(){var t;i.type,(t=new Array(this.grid_count)).fill(o.Empty),this.workData=t},e.prototype.checkGuide=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,o,n,a,r,s,l,d,u,p,h,f,g,v,y=this;return __generator(this,function(_){switch(_.label){case 0:return this.byGuide?(this.clockWarn.destroy(),this.stopPraNode.x=0,t=this.node,e=new cc.Node("guideOthers"),this.guideSteps=[{yIdx:3,glows:[[0,5]],finger:1,content:"\u8ba9\u6211\u4eec\u4ece\u6700\u7b80\u5355\u7684\u6b65\u9aa4\u5f00\u59cb\uff0c\u627e\u521a\u597d\u53ef\u4ee5\u586b\u6ee1\u7684\u4e00\u884c\u3002\u586b\u6ee1\u8fd95\u683c\u5427\uff01"},{none:1,content:"\u592a\u68d2\u5566\uff01"},{xIdx:0,finger:2,content:"\u8ba9\u6211\u4eec\u5148\u770b\u8fd9\u4e00\u5217\uff0c\u6570\u5b57\u4e0e\u8272\u5757\u6570\u76ee\u4e00\u6837\u3002\u6211\u4eec\u5148\u5207\u6362\u5230\u6253\u53c9\u6a21\u5f0f\uff01"},{xIdx:0,glows:[[2,1],[4,1]],content:"\u73b0\u5728\u53ef\u4ee5\u628a\u6211\u4eec\u80af\u5b9a\u662f\u7a7a\u683c\u7684\u683c\u5b50\u6253\u4e0aX\uff01"},{xIdx:4,glows:[[2,1],[4,1]],content:"\u592a\u68d2\u5566\uff01\u540c\u7406\uff0c\u53ef\u4ee5\u5728\u8fd9\u5217\u6807\u4e0a\u4e24\u4e2aX\u3002"},{yIdx:2,glows:[[1,3]],finger:3,content:"\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u786e\u5b9a\u8fd9\u884c\u76843\u4e2a\u8272\u5757\u5566\u3002\u5feb\u7ed9\u4ed6\u4eec\u4e0a\u8272\u5427\uff01"},{yIdx:2,glows:[[1,3]]},{yIdx:1,glows:[[0,1],[2,1],[4,1]],content:"\u8fd9\u884c\u67093\u4e2a1\uff0c\u90a3\u4e48\u5728\u5b83\u4eec\u7684\u4e2d\u95f4\u5fc5\u987b\u67092\u4e2a\u7a7a\u767d\u5757\u7684\u3002\n       1+1+1+2=5\u3002\u521a\u597d\u5360\u6ee1\u6574\u884c\u5566\u3002\u7ed9\u4ed6\u4eec\u4e0a\u8272\u5427\u3002"},{yIdx:0,glows:[[1,3]],content:"\u53c8\u627e\u52303\u4e2a\u8fde\u7eed\u7684\u6d82\u8272\u5757\uff01"},{yIdx:4,glows:[[1,1],[3,1]],content:"\u5feb\u8981\u5b8c\u6210\u4e86\uff0c\u628a\u6700\u540e\u7684\u683c\u5b50\u90fd\u4e0a\u8272\u5427\uff01"}],this.guideCurStep=-1,this.guideMaxStep=this.guideSteps.length-1,[4,m.default.ins.lPre("prefab/game/gridGlow")]):[3,4];case 1:for(i=_.sent(),o=this.guideGlows=[],n=0;n<3;n++)(a=cc.instantiate(i)).setAnchorPoint(0,.5),o.push(a),e.addChild(a);return s=this,d=(l=cc).instantiate,[4,m.default.ins.lPre("prefab/game/npc")];case 2:return(r=s.guideNpc=d.apply(l,[_.sent()])).setPosition(380,610),m.default.ins.getBundleByString("resSps").then(function(t){t.load("game/girl",cc.Prefab,function(t,e){if(!t&&y.node&&y.node.isValid){var i=cc.instantiate(e);r.addChild(i),i.setPosition(250,-251),i.setSiblingIndex(0);var o=y.topGirlSk=i.getComponent(sp.Skeleton);o.animation=c.idle,o.setEndListener(y.playGirlEnd.bind(y))}})}),u=r.getChildByName("dialog"),this.guideNpcAni=u.getComponent(cc.Animation),this.guideNpcLbl=u.getChildByName("content").getComponent(cc.Label),(p=this.guideFinger=new cc.Node("guideFinger")).setAnchorPoint(.1,.91),m.default.ins.lSF("common/shouzhi",p.addComponent(cc.Sprite)),e.addChild(p),e.addChild(r),e.setPosition(this.map_node_.position),e.setAnchorPoint(0,0),t.getChildByName("up").active=!1,(h=t.getChildByName("down")).children.forEach(function(t){t.active=!1}),this.guideFingerTogY=this.oxTagAni.node.y+h.y-this.map_node_.y,t.getChildByName("bg").getChildByName("winBg").active=!0,(f=this.guideMask=new cc.Node("guideMask")).addComponent(cc.Mask).inverted=!0,g=this.guideMaskBg=new cc.Node("mask"),v=g.addComponent(cc.Sprite),[4,m.default.ins.lSF("common/default_sprite_splash")];case 3:v.spriteFrame=_.sent(),g.addComponent(cc.BlockInputEvents),g.color=cc.Color.BLACK,g.opacity=100,this.scheduleOnce(function(){g.setContentSize(cc.view.getVisibleSize())}),f.addChild(g),t.addChild(f),t.addChild(e),f.setSiblingIndex(3),this.guideCheckGrid=[],this.updateGuideStep(),_.label=4;case 4:return[2]}})})},e.prototype.updateGuideStep=function(){var t=this;this.unschedule(this.updateGuideStep);var e=this.guideCurStep=this.guideCurStep+1,i=this.guideMask,o=this.guideSteps[e],n=this.guideFinger,a=this.guideGlows;if(!o){f.platform.reportEvent(f.ERepEvt.finshGuide),i.active=!1,a.forEach(function(t){t.active=!1});var r=this.guideNpc;return r.y=r.opacity=0,this.guideNpcLbl.string="       \u592a\u68d2\u4e86\uff01\u6211\u4eec\u6536\u96c6\u5230\u4e86\u4e00\u6735\u7f8e\u4e3d\u7684\u82b1\uff0c\u73b0\u5728\u524d\u5f80\u4e3b\u7ebf\u7ee7\u7eed\u6536\u96c6\u5176\u4ed6\u56fe\u753b\u5427\u3002",void this.playGirlAni(c.happy)}var s=o.content,l=o.xIdx,d=o.yIdx,u=o.glows,p=o.finger,h=o.none,g=this.guideMaskBg;if(this.oxTagAni.node.active=2==e||5==e,h)a[0].active=!1,n.active=!1,cc.Tween.stopAllByTarget(n),this.scheduleOnce(function(){return t.updateGuideStep()},1);else{var v,m=this.map_node_,y=this.gridSize,_=this.gridsStartX,b=this.guideCheckGrid,S=548,w=S,T=-68,I=-48,D=void 0!==l,k=void 0!==d;if(D?(T=_+l*y+y/2+m.x,S=y):k&&(I=d*y+y/2+m.y,w=y),i.setPosition(T,I),i.setContentSize(S,w),g.setPosition(-T,-I),u)for(var N=0,C=u.length;N<3;N++){var M=a[N];if(M.active=N<C){var R=u[N],L=R[0],P=R[1],A=void 0,E=void 0,B=void 0,F=void 0;D?(A=110,E=P*y+30,B=_+l*y-15,F=L*y+y/2):k&&(E=110,A=P*y+30,B=_+L*y-15,F=d*y+y/2),M.setContentSize(A,E),M.setPosition(B,F);for(var x=0;x<P;x++)k?b.push(d+"_"+(L+x)):D&&b.push(L+x+"_"+l)}}p?1==p?(F=268,v=Math.abs(311)/200,cc.tween(n).set({active:!0,opacity:0,x:212,y:F,scale:1}).to(17/30,{opacity:255}).to(v,{x:523}).to(17/30,{opacity:0}).union().repeatForever().start()):(F=this.guideFingerTogY,B=2==p?400:330,B+=this.oxTagAni.node.x,cc.tween(n).set({active:!0,x:B,y:F,scale:1,opacity:255}).to(.5,{scale:1.2}).to(.5,{scale:1},{easing:"cubicOut"}).union().repeatForever().start()):(cc.Tween.stopAllByTarget(n),n.active=!1),5==e&&(b.length=0)}s&&(this.guideNpcLbl.string="       "+s,this.guideNpcAni.play())},e.prototype.onDestroy=function(){f.platform.stopVideoRecord()},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case h.default.PURCHASED:this.onPurchased();break;case h.default.LOSEHEART:this.loseHeart(t.data);break;case h.default.UPDATESCORE:this.updateScore();break;case h.default.SHOWVIDEOSHARE:i.type==B.gameType.normal&&this.shareBtn&&(this.shareBtn.active=!0)}},e.prototype.start=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,this.OnTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.OnTouchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this.OnTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.OnTouchCancelled,this);var e,o=_.default.ins.getSetting();this.tipTog=o.tip,this.updateTip(),this.downBeginY=640-cc.view.getVisibleSize().height/2;var n=B.default.ins,a=n.getRecordData(),r=i.type;switch(r){case B.gameType.race:e=a.race;break;case B.gameType.challenge:e=a.daily;break;default:e=a.main}this.recData=e,this.consLbl.string="\u8fde\u80dc: "+n.getConsWinTimes(),this.consBestLbl.string=e.heWins+"",n.recordGameTimes(r),cc.assetManager.loadBundle("resSps",function(){t.initGame()})},e.prototype.onPurchased=function(){},e.prototype.initGame=function(){var t,e,o,n,a,r;return __awaiter(this,void 0,void 0,function(){var s,l,d,u,h,g,v,y,_,b,T,I,D,k,M,R,A,E,F,x,O,V,U,z,H,G,j,J,W,q,K,Y,X,Z,Q,$,tt,et,it,ot,nt,at,rt,st,ct,lt,dt,ut,pt,ht,ft,gt,vt,mt,yt,_t,bt,St,wt,Tt,It,Dt,kt=this;return __generator(this,function(Nt){switch(Nt.label){case 0:switch(d="normal",h=cc.assetManager.getBundle("resSps")||cc.assetManager.getBundle("chapter"),g=i.type){case B.gameType.normal:return[3,1];case B.gameType.race:return[3,2];case B.gameType.freedom:return[3,3];case B.gameType.practice:return[3,4];case B.gameType.festival:return[3,5];case B.gameType.challenge:return[3,6]}return[3,12];case 1:return I=P.default.ins,(M=I.getPuzzleInfo())&&(s=M.size,l=I.getPuzzleData()),v=B.default.ins.getPuzzleLvl(),y=(null===(o=null===(e=null===(t=w.default.serverCfg)||void 0===t?void 0:t.more_set)||void 0===e?void 0:e.protect_times)||void 0===o?void 0:o.val)||10,_=(null===(r=null===(a=null===(n=w.default.serverCfg)||void 0===n?void 0:n.more_set)||void 0===a?void 0:a.protect_charter)||void 0===r?void 0:r.val)||30,v<=y?this.infinityLife=!0:v<_&&(this.relifeTime=-1),this.getBtnsp.string="\u4e0b\u4e00\u5173",[3,12];case 2:u=1,d="normal",this.norClock.parent.active=!0,this.heartsNum=1,this.raceTime=31,this.raceMaxDenstiy=.85,this.raceMinDenstiy=.7,this.raceDensity=this.raceMaxDenstiy,this.raceRefeshTime=-1,this.raceFromX=180,this.raceAllX=this.raceFromX-70,s=10,l=(new N.default).getRandomData(s,this.raceMaxDenstiy),L.default.ins.updPro(L.fesTaskKey.raceTimes,1),b=this.items;try{T=w.default.serverCfg.qw_line_rules.rules,this.relifeTime=T.relive.limit||3,b[0].itemMax=T.limit.notice||1,b[1].itemMax=T.limit.random_notice||1,b[2].itemMax=T.limit.full_row_col||1}catch(Ct){this.relifeTime=3,b[0].itemMax=b[1].itemMax=b[2].itemMax=1}return this.clockWarn.height=cc.view.getVisibleSize().height,[3,12];case 3:return s=C.default.freedomSize,l=(new N.default).getRandomData(s,this.raceMaxDenstiy,5),[3,12];case 4:return f.platform.reportEvent(f.ERepEvt.beginPractice),this.infinityLife=!0,I=P.default.ins,D=this.byGuide?1:I.getPracticeId(),this.practiceId=D,(M=I.getPuzzleInfo(!0,D))&&(s=M.size,l=I.getPuzzleData(!0,D)),this.getBtnsp.node.parent.active=!1,this.stopPraNode.active=!0,[3,12];case 5:return k=L.default.ins,(M=k.getFesPuzzleInfo())&&(s=M.size,l=k.getFesPuzzleData()),this.getBtnsp.string="\u8fd4\u56de\u4e3b\u9875",k.isJigsawMax(),[3,12];case 6:try{R=w.default.serverCfg.daily_challenge,this.relifeTime=R.revive||3,A=R.limit,(E=this.items)[0].itemMax=A.notice||1,E[1].itemMax=A.random_notice||1,E[2].itemMax=A.full_row_col||1}catch(Mt){this.relifeTime=3,b[0].itemMax=b[1].itemMax=b[2].itemMax=1}switch(F=this.cons2Lbl.node.parent,x=F.parent.getChildByName("top"),O=x.getChildByName("cha"),F.getChildByName("midLblL").getComponent(cc.Label).string="\u901a\u5173\u65f6\u95f4",F.getChildByName("midLblR").getComponent(cc.Label).string="\u901a\u5173\u4eba\u6570",F.getChildByName("nor").active=x.getChildByName("nor").active=this.consLbl.node.parent.active=!1,F.getChildByName("cha").active=O.active=this.useTimeLbl.node.active=!0,m.default.ins.lSF("game/chaTitle",O.getComponent(cc.Sprite)),this.rewItems.node.parent.y=-325,this.chaTime=0,V=i.challageData,U=V.date,z=U.year,H=U.month,G=U.day,j=1e4*z+100*H+G,J=g in B.challengeType&&V.type?V.type:B.challengeType.tree,W=void 0,J!=B.challengeType.worm&&(s=10!=(s=V.size)||15!=s?15:s,q=V.denstiy<.2||!V.denstiy?null:V.denstiy,W=new N.default(j),l=W.getRandomData(s,q||.75,5)),K=W?W.getRandomIntBetween.bind(W):p.default.ins.rad,Y=void 0,J){case B.challengeType.worm:return[3,7];case B.challengeType.tree:return[3,9];case B.challengeType.ice:return[3,10]}return[3,11];case 7:return X=V.data,Z=X.size,Q=X.data,s=Z,(l=new Array(Math.pow(s,2))).fill(0),$=this.wormData={counts:[],sps:[]},tt=function(t,e){var i=t-e;return i<0?-1==i?1:0:1==i?3:2},et=0,[4,m.default.ins.lPre("prefab/game/wormSp")];case 8:return(it=Nt.sent())&&((ot=new cc.Node("wormSps")).width=500,ot.height=200,ot.x=100,(nt=ot.addComponent(cc.Layout)).type=cc.Layout.Type.HORIZONTAL,nt.resizeMode=cc.Layout.ResizeMode.CHILDREN,this.topSp.node.addChild(ot)),Q.forEach(function(t){var e,i,o,n,a,r,s,c,d,u,p=0,h=[0,0,0,0],f=t.length;if($.counts.push(f),it){var g=cc.instantiate(it);ot.addChild(g);var v=g.getComponent("wormSp");v.init(f),$.sps.push(v)}t.forEach(function(f){e=t[p-1],i=t[p+1],h[0]=h[1]=h[2]=h[3]=0,u=void 0!==i,(d=void 0!==e)&&(o=tt(e,f),h[o]=1),u&&(o=tt(i,f),h[o]=1),n=h[0],a=h[1],r=h[2],s=h[3],d&&u?n&&r||a&&s?(o=n&&r?90:0,c=2):(o=n&&a?0:n&&s?270:s&&r?180:90,c=3):(c=u?0:1,o=a?0:r?90:s?180:270),$[f]={i:et,tex:c,dir:o},l[f]=1,p++}),et++}),[3,11];case 9:return Y=V.count||10,at=this.treeData={},rt=Math.ceil(Y/2),st=Y-rt,at.minRow=K(0,s-rt-1),at.minCol=K(0,s-st-1),at.maxRow=at.minRow+rt+1,at.maxCol=at.minCol+st+1,h.preload("game/hedge/mask",cc.SpriteFrame),cc.assetManager.loadBundle("prefab",function(t,e){t||e.preload("prefab/game/hedge",cc.Prefab)}),[3,11];case 10:for(Y=V.count||3,ct=this.iceData={},lt=ct.rHints=[],dt=ct.cHints=[],ut=[];Y;)pt=K(1,s-2),ht=K(1,s-2),ft=(s-pt-1)*s+ht,-1==ut.indexOf(ft)&&(ut.push(ft,ft-1,ft+1,ft+s,ft-s),ct[ft]=1,lt[pt]=(lt[pt]||0)+1,dt[ht]=(dt[ht]||0)+1,Y--);return ut=null,h.preload("game/ice/mask",cc.SpriteFrame),h.preload("game/ice/pit",cc.SpriteFrame),cc.assetManager.loadBundle("prefab",function(t,e){t||e.preload("prefab/game/ice",cc.Prefab)}),[3,11];case 11:return[3,12];case 12:if(1==this.heartsNum||this.infinityLife){for(gt=0,vt=this.hearts;gt<3;gt++)mt=vt[gt].node,this.infinityLife?(2==gt&&(mt.active=!0,mt.setPosition(vt[0].node.position)),mt.active=2==gt):mt.active=0==gt;this.infinityLife&&(this.heartInfinity.active=!0),this.heartBgNode.width=70}if(d="game/"+d+"/",yt=B.default.ins.getUsingSkin().bg,_t=u?1:yt,h.loadDir(d,cc.SpriteFrame,function(t){if(!t&&kt.node&&kt.node.isValid){var e=kt.topSp;e.spriteFrame=h.get(d+"top"+_t,cc.SpriteFrame);var i=C.default.padScale;i&&(e.node.width*=i,e.node.height*=i)}kt._initGame(s,l)}),1!=yt){switch(bt=this.downSp.node,St=new cc.Color,wt=new cc.Color,Tt="game/skin/"+yt+"/",yt){case 2:St.r=222,St.g=146,St.b=52,wt.r=248,wt.g=221,wt.b=82}bt.color=St,bt.parent.getChildByName("bg").color=wt,It=bt.parent.getChildByName("winBg"),m.default.ins.lSF(Tt+"sky",It.getComponent(cc.Sprite)),m.default.ins.lSF(Tt+"cloud",It.children[0].getComponent(cc.Sprite)),m.default.ins.lSF(Tt+"cloud",It.children[1].getComponent(cc.Sprite))}return this.byGuide?[2]:(Dt=B.default.ins.getUsingSkin().role,cc.assetManager.loadBundle("prefab",function(t,e){t||e.load("skin/girl"+Dt,cc.Prefab,function(t,o){if(!t&&kt.node&&kt.node.isValid){var n=cc.instantiate(o),a=kt.topGirlSk=n.getComponent(sp.Skeleton);if(u)e.load("prefab/game/goose",cc.Prefab,function(t,e){if(!t&&kt.node&&kt.node.isValid){var i=kt.topSp;kt.downSp,i.addComponent(S.default).speed=.1;var o=cc.instantiate(e);kt.topGooseSk=o.getComponent(sp.Skeleton),a.animation=c.run,o.x=kt.raceFromX,n.x=-o.x,n.y=o.y=0,i.node.addChild(o),i.node.addChild(n)}});else{var r=kt.topSp.node.children.length?-225:0;if(n.setPosition(r,-20),kt.topSp.node.addChild(n),g===B.gameType.challenge){var s=i.challageData;(g in B.challengeType&&s.type?s.type:B.challengeType.tree)===B.challengeType.worm&&(n.scaleX=-n.scaleX)}a.animation=c.idle,a.setEndListener(kt.playGirlEnd.bind(kt))}}})}),[2])}})})},e.prototype._initGame=function(t,e){this.rows_=this.cols_=t,this.grid_count=this.rows_*this.cols_,this.baseData=e,this.checkLocalData(),this.initView()},e.prototype.initView=function(){return __awaiter(this,void 0,void 0,function(){var t,e,o,n,a,r,s,c,l,d,u,p,h,g,v,m,y,_,b,S,w,T,I,D,k=this;return __generator(this,function(N){switch(N.label){case 0:for(t=i.type,e=t==B.gameType.race,o=t==B.gameType.practice,n=67,this.fontSize=36,a=0;a<this.rows_;a++){for(r=this.GetBaseRowHeadNums(a),s=2,c=0,l=r;c<l.length;c++)d=l[c],s+=21.39*(d+"").length;s>n&&(n=s)}switch(e&&(n=90),u=this.rows_,p=-528+n,h=-403,g=0,v=5,m=1,(y=1-.07/45*(n-67.5))<.93?y=.93:y>1&&(y=1),_=1,S=172,u){case 5:b=384,y=.608,S=175,p=-360,h=-319,_=1.78,n=86,g=-72,v=-17,m=.78;break;case 10:b=640*(y-=.09),p+=45,h=-429,_=1.5,v=-21;break;case 15:b=640*(y-=.02)}return C.default.padScale&&!this.byGuide&&(h-=50,v-=50),this.map_node_.setPosition(p,h),this.gridBgSp.node.scale=y,this.selectMaskBg.scale=y,v-=this.downNode.y,(w=this.itemSelectEff.parent.children[0]).setPosition(g,v),w.setScale(m),w.children[0].y+=this.downNode.y,this.gridSize=b/this.rows_,this.gridsStartX=S,this.hintScale=_,this.hintWidth=n,[4,this.addHeads()];case 1:return N.sent(),[4,this.SetWorkGridTagWithInit()];case 2:for(N.sent(),T=0;T<3;T++)this.updateItemNum(T);return[4,this.checkGuide()];case 3:return N.sent(),!o&&f.platform.startVideoRecord(),I=B.default.ins,D=I.getIsFirstRaceTip(),e&&!D?(I.setFirstRaceTip(!0),this.canTouch=!1,A.default.ins.open("ui/ui_raceTip",{pageIdx:2,closeCb:function(){k.canTouch=!0}})):this.canTouch=!0,[2]}})})},e.prototype.addHeads=function(){return __awaiter(this,void 0,void 0,function(){var t,e,o,n,a,r,s;return __generator(this,function(c){switch(c.label){case 0:for(this.rowHeadNums.length=this.colHeadNums.length=0,this.rowHeadBegins.length=this.colHeadBegins.length=0,this.gridHeadColVec.length=this.gridHeadRowVec.length=0,this.rowHintsParent.removeAllChildren(),this.colHintsParent.removeAllChildren(),t=1,r=0;r<this.rows_;r++)(e=this.GetBaseColHeadNums(r).length)>t&&(t=e);if(i.type==B.gameType.race&&t<3&&(t=3),this.byGuide?this.hintHeight=85:this.hintHeight=5==this.rows_?105:70+30*(t-2),!(a=i.challageData))return[3,5];switch(a.type){case B.challengeType.tree:return[3,1];case B.challengeType.ice:return[3,3]}return[3,5];case 1:return[4,m.default.ins.lSF("game/hedge/mask")];case 2:return o=c.sent(),[3,5];case 3:return[4,m.default.ins.lSF("game/ice/mask")];case 4:return n=c.sent(),[3,5];case 5:for(r=0;r<this.rows_;r++)this.AddRowHead(r,o,n);for(s=0;s<this.cols_;s++)this.AddColHead(s,o,n);return this.beginAni(),[2]}})})},e.prototype.beginAni=function(t,e){void 0===t&&(t=this.hintWidth),void 0===e&&(e=this.hintHeight),cc.tween(this.tilesParent).to(.2,{opacity:255}).start(),cc.tween(this.colHintsParent).set({y:-e}).to(.2,{y:0}).start(),cc.tween(this.rowHintsParent).set({x:t}).to(.2,{x:0}).start();var o=i.type;o==B.gameType.race?this.raceCountDown():o==B.gameType.challenge?this.chaCD():this.commonCD()},e.prototype.commonCD=function(){this.schedule(this._commonCD,1,cc.macro.REPEAT_FOREVER)},e.prototype._commonCD=function(){if(this.canTouch){if(this.touchTime++,this.touchTime>5&&null==this.curItemAni){for(var t=0,e=this.items,i=e.length;t<i;t++){var o=e[t],n=o.count,a=o.icon;if(0!=n){(this.curItemAni=this[a+"Ani"]).play();break}}this.curItemAni||(this.touchTime=0)}}else this.resetCD()},e.prototype.resetCD=function(){this.touchTime=0;var t=this.curItemAni;if(t){t.stop();var e=t.node;cc.tween(e).to(.2,{y:5,angle:0}).start(),this.curItemAni=null}},e.prototype.raceCountDown=function(){this.hasCountDown?this.raceTime=31:(this.hasCountDown=!0,this.schedule(this._raceCoundDown,1,cc.macro.REPEAT_FOREVER)),this._raceCoundDown(void 0,!0)},e.prototype._raceCoundDown=function(t,e){if(this.canTouch){var i=this.raceTime=this.raceTime-1;this.updateRaceNpcs(i,e),i<10&&0!=i?(this.norClock.active=!1,this.speClock.active=this.clockWarn.active=!0,this.clockLbl2.string=i+"",this.clockLbl2.node.x=1!=i?0:-6,y.default.ins.play(y.default.TIME),b.default.p(b.VEnum3.DOUBLE)):(this.norClock.active=!0,this.speClock.active=this.clockWarn.active=!1,this.clockLbl.string=i+""),0==i&&this.loseHeart(this.grids[90].node.position)}},e.prototype.chaCD=function(){this.schedule(this._chaCD,1,cc.macro.REPEAT_FOREVER)},e.prototype._chaCD=function(){var t=this.chaTime=this.chaTime+1,e=z(t/86400),i=z((t-=86400*e)/3600),o=z((t-=3600*i)/60),n=(o<10?"0":"")+o+":"+((t-=60*o)<10?"0":"")+t,a="";i&&(a=(i<10?"0":"")+i+":"),this.useTimeLbl.string=a+n},e.prototype.updateRaceNpcs=function(t,e){var i=this.topGirlSk,o=this.topGooseSk;if(o){var n=this.raceFromX,a=(1-t/30)*this.raceAllX-n,r=-a,s=e?.5:1;i.timeScale=e?1.7:1,cc.tween(i.node).to(s,{x:a}).call(function(){i.timeScale=1}).start(),cc.tween(o.node).to(s,{x:r}).start()}},e.prototype.loseHeart=function(t){var e=this,i=this.heartsNum;if(!(i<1)){this.showOrHideSelectMask();var o=!this.infinityLife,n=this.hearts[i-1],a=this.patices;o&&this.heartsNum--,this.playGirlAni(c.sad);var r=n.node.convertToWorldSpaceAR(cc.Vec2.ZERO);a.convertToNodeSpaceAR(r,r);var s=cc.instantiate(this.heartsPatic);s.setPosition(t),s.setParent(a),s.scale=1/this.gridBgSp.node.scale,this.canTouch=!1,cc.tween(s).to(.8,{x:r.x,y:r.y}).call(function(){s.destroy(),o?(n.playLose(),0==e.heartsNum?(y.default.ins.play(y.default.LOSE),e.playAni(l.gameLose),e.eventDot(!1)):e.canTouch=!0):e.canTouch=!0}).start()}},e.prototype.updateItemNum=function(t,e){var o=this;void 0===t&&(t=this.curItemIdx);var n=this.items[t],a=n.icon,r=i.type==B.gameType.practice,s=this[a+"Lbl"];if(e){r||M.default.ins.useItem(a,1,i.type),this.OnBtnHideItem();var c=n.itemMax;if(c>0&&c==(n.itemCur=n.itemCur+1)){var l=s.node.parent.parent.getChildByName("canUse");l&&(l.active=!0)}}else m.default.ins.getBundleByString("prefab").then(function(t){t.load("prefab/game/"+a,cc.Prefab,function(t,e){o.node&&cc.isValid(o.node)&&!t&&(o[a+"Prefab"]=e)})});if(r){var d=s.node;d.active=!1,d.parent.getChildByName("wuxian").active=!0,n.count=1}else{var u=n.count=M.default.ins.getItemCount(a);s.string=0==u?"+":"x"+u}},e.prototype.useItem=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var o,n,a,r,s,c,l,d,u,h,f,g,v,_,b,S,w,T,I,D,N,C,M,R,L,P,A,E,B,F,x,O,V=this;return __generator(this,function(U){switch(U.label){case 0:return this.canTouch=!1,o=this.curItemIdx,n=this.items[o],a=n.icon,(r=this[a+"Prefab"])?[3,2]:[4,m.default.ins.lPre("prefab/game/"+a)];case 1:r=U.sent(),U.label=2;case 2:switch(s=this.patices,this.curItemIdx){case 0:if(c=function(){V.OnClickGrid(e,i,!0),V.canTouch=!0},!r)return c(),[2];(l=cc.instantiate(r)).setPosition(t.node.position),l.setParent(s),l.scale=1/this.gridBgSp.node.scale,y.default.ins.play(y.default.SHOVEL),(d=l.getComponent(cc.Animation)).play(),d.on(cc.Animation.EventType.FINISHED,function(){l.destroy(),c()},this);break;case 1:for(u=this.random_noticeLbl.node.parent.convertToWorldSpaceAR(cc.Vec2.ZERO),s.convertToNodeSpaceAR(u,u),h=p.default.ins.rad,f=this.grids,g=[],v=this.rows_,_=this.cols_,b=this.treeData,x=0,S=void 0;x<v;x++)for(w=0;w<_&&(T=f[S=x*_+w],b&&b[S]||!T.isEmpty||(g.push({t:v-x-1,e:w,data:T}),3!=g.length));w++);for(p.default.ins.randSort(g),I=Math.min(g.length,3),D=function(t){var e=g[t],i=e.t,o=e.e,n=e.data;if(!n)return"break";var a=function(){V.OnClickGrid(i,o,!0),t==I-1&&(V.canTouch=!0)};if(r){var c=cc.instantiate(r);c.setParent(s),c.setPosition(u),c.getComponent(k.default).init(),c.scale=1/N.gridBgSp.node.scale;var l=n.node.position,d=new cc.Vec2(l.x,l.y),p=new cc.Vec2;1==h(1,2)?(p.x=(u.x+u.y+d.x-d.y)/2,p.y=(u.y+d.x+d.y-u.x)/2):(p.x=(d.x+d.y+u.x-u.y)/2,p.y=(d.y+u.x+u.y-d.x)/2),cc.tween(c).delay(.2*t).call(function(){y.default.ins.play(y.default.ROCKETLAUNCH)}).bezierTo(1,u,p,d).call(function(){y.default.ins.play(y.default.ROCKETATTACK),c.destroy(),a()}).start()}else a()},N=this,x=0;x<I&&"break"!==D(x);x++);break;case 2:if(C=void 0,M=void 0,R=this.grids,L=this.cols_,P=this.rows_,null!=e)for(A=function(t){var i=R[(P-e-1)*L+t];0==t&&(C=i.node.position),t==L-1&&(M=i.node.position),E.scheduleOnce(function(){V.OnClickGrid(e,t,!0)},t/L*1)},E=this,x=0;x<L;x++)A(x);else if(null!=i)for(B=function(t){var e=R[(P-t-1)*L+i];0==t&&(M=e.node.position),t==P-1&&(C=e.node.position),F.scheduleOnce(function(){V.OnClickGrid(t,i,!0)},(P-t)/P*1)},F=this,x=0;x<P;x++)B(x);r?((O=cc.instantiate(r)).setParent(s),O.angle=null!=i?-90:0,O.scale=1/this.gridBgSp.node.scale,cc.tween(O).set({position:C}).to(1,{position:M}).call(function(){O.destroy(),V.canTouch=!0}).start()):this.scheduleOnce(function(){V.canTouch=!0},1)}return[2]}})})},e.prototype.playAni=function(t){if(!this.curAni)switch(this.curAni=t,this.panelAni.play(t),t){case l.gameLose:this.playDownAni(!0);break;case l.gameRelife:this.playDownAni(!1);break;case l.gameWinFailSf:this.tilesWinAni()}},e.prototype.playAniDone=function(){switch(this.curAni){case l.gameWin:this.playWinDone();break;case l.gameRelife:this.reLife();break;case l.openItemSelect:this.canTouch=!0;break;case l.closeItemSelect:this.curItemBtn.setSiblingIndex(this.curItemIdx+1),this.curItemBtn=this.curItemIdx=null}this.curAni=null},e.prototype.playWinDone=function(){var t,e,o=this;if(this.byGuide)cc.tween(this.guideNpc).to(.2,{opacity:255}).call(function(){var t=o.shareBtn.parent.getChildByName("getBtn"),e=o.guideFinger;e.setParent(t),o.guideNpcAni.play(),cc.tween(t).to(.2,{opacity:255}).start(),cc.tween(e).set({active:!0,x:80,y:0,scale:1,opacity:255}).to(.5,{scale:1.2}).to(.5,{scale:1},{easing:"cubicOut"}).union().repeatForever().start()}).start();else if(i.type!=B.gameType.practice&&f.platform.stopVideoRecord(),i.type===B.gameType.normal){var n=B.default.ins.getPuzzleLvl()-1,a=(null===(e=null===(t=w.default.serverCfg.add_desktop)||void 0===t?void 0:t.rules)||void 0===e?void 0:e.nums)||7,r=B.default.ins.getAddDesk();f.platform.string()!=v.PFCode.Bytedance||n!=a||r||A.default.ins.open("ui/ui_deskReward",null)}},e.prototype.playDownAni=function(t){var e=t?-360:this.downBeginY,i=t?0:1.1;cc.tween(this.downNode).delay(i).to(10/30,{y:e,opacity:t?0:255}).start()},e.prototype.reLife=function(){this.heartsNum=1,this.hearts[0].getHeart(),this.canTouch=!0,i.type==B.gameType.race&&this.raceCountDown()},e.prototype.GetBaseRowHeadNums=function(t){if(0==this.rowHeadNums.length)for(var e=this.baseData,i=this.rows_-1;i>=0;i--){for(var n=i*this.cols_,a=[],r=[],s=0,c=n;c<n+this.cols_;c++)e[c]==o.O?1==++s&&r.push(c):s>0&&(a.push(s),s=0);s>0&&a.push(s),0==a.length&&a.push(0),this.rowHeadNums.push(a),this.rowHeadBegins.push(r)}return this.rowHeadNums[t]},e.prototype.GetBaseColHeadNums=function(t){if(0==this.colHeadNums.length)for(var e=this.baseData,i=0;i<this.cols_;i++){for(var n=[],a=0,r=0,s=[];r<this.rows_;r++){var c=i+r*this.rows_;e[c]==o.O?1==++a&&s.push(c):a>0&&(n.push(a),a=0)}a>0&&n.push(a),0==n.length&&n.push(0),this.colHeadNums.push(n),this.colHeadBegins.push(s)}return this.colHeadNums[t]},e.prototype.GetBaseRowBeginNums=function(t){return 0==this.rowHeadBegins.length&&this.GetBaseRowHeadNums(t),this.rowHeadBegins[t]},e.prototype.GetBaseColBeginNums=function(t){return 0==this.colHeadBegins.length&&this.GetBaseColHeadNums(t),this.colHeadBegins[t]},e.prototype.GetWorkRowHeadNums=function(t){for(var e=(this.rows_-t-1)*this.cols_,i=[],n=0,a=e;a<e+this.cols_;a++)this.workData[a]==o.O?n++:n>0&&(i.push(n),n=0);return n>0&&i.push(n),0==i.length&&i.push(0),i},e.prototype.GetWorkColHeadNums=function(t){for(var e=[],i=0,n=0;n<this.rows_;n++){var a=t+n*this.rows_;this.workData[a]==o.O?i++:i>0&&(e.push(i),i=0)}return i>0&&e.push(i),0==e.length&&e.push(0),e},e.prototype.AddRowHead=function(t,e,i){var o={shineBg:null,labels:[],allRight:!1},n=this.hintScale,a=this.hintWidth,r=new cc.Node("rowHint"),s=new cc.Node("bg"),c=new cc.Node("shineBg"),l=s.addComponent(cc.Sprite),d=c.addComponent(cc.Sprite);l.spriteFrame=d.spriteFrame=this.lHintSf,l.sizeMode=d.sizeMode=cc.Sprite.SizeMode.CUSTOM,l.type=d.type=cc.Sprite.Type.SLICED,s.setAnchorPoint(1,.5),c.setAnchorPoint(1,.5),s.width=c.width=a,c.parent=s.parent=r,d.dstBlendFactor=cc.macro.BlendFactor.ONE,c.opacity=100,c.active=!1;for(var u=this.lineW,p=this.font4,h=this.fontSize,f=5==this.rows_,g=new cc.Node("lbls"),v=this.GetBaseRowHeadNums(t),m=f?5:2,y=v.length,_=1-.04*(y-2),b=y-1;b>=0;b--){var S=new cc.Node("lbl"),w=S.addComponent(cc.Label);w.font=p,w.fontSize=h;var T=v[b],I=w.string=T+"";w.spacingX=-6,S.color=H,S.setAnchorPoint(1,.5),S.position=cc.v3(-m,-6),S.parent=g,m=m+(h-13)*_+13*(I.length-1),o.labels[b]=S}if(g.parent=r,r.position=cc.v3(this.gridsStartX-2,t*this.gridSize+this.gridSize/2+Math.floor(t/5)*u-1),r.parent=this.rowHintsParent,o.shineBg=c,this.gridHeadRowVec.push(o),r.scale=n,e&&t>this.treeData.minRow&&t<this.treeData.maxRow||i&&this.iceData&&this.iceData.rHints[t]){var D=e?"treeMask":"iceMask",k=new cc.Node(D);k.setAnchorPoint(1,.5);var N=k.addComponent(cc.Sprite);N.spriteFrame=e||i,N.sizeMode=cc.Sprite.SizeMode.CUSTOM,N.type=e?cc.Sprite.Type.TILED:cc.Sprite.Type.SLICED,k.width=a,r.addChild(k),o[D]=k}},e.prototype.AddColHead=function(t,e,i){var o={shineBg:null,labels:[],allRight:!1},n=this.hintScale,a=this.hintHeight,r=new cc.Node("colHint"),s=new cc.Node("bg"),c=new cc.Node("shineBg"),l=s.addComponent(cc.Sprite),d=c.addComponent(cc.Sprite);l.spriteFrame=d.spriteFrame=this.uHintSf,l.sizeMode=d.sizeMode=cc.Sprite.SizeMode.CUSTOM,l.type=d.type=cc.Sprite.Type.SLICED,s.setAnchorPoint(.5,0),c.setAnchorPoint(.5,0),s.height=c.height=a,c.parent=s.parent=r,d.dstBlendFactor=cc.macro.BlendFactor.ONE,c.opacity=100,c.active=!1;for(var u=this.font4,p=this.fontSize,h=this.lineW,f=new cc.Node("lbls"),g=this.GetBaseColHeadNums(t),v=0,m=g.length-1;m>=0;m--){var y=new cc.Node("lbl"),_=y.addComponent(cc.Label);_.font=u,_.fontSize=p;var b=g[m],S=0;b>11&&(S=-2),_.string=b,_.spacingX=-6,y.color=H,y.setAnchorPoint(.5,0),y.position=cc.v3(S-1,v-10),y.parent=f,v=v+p-6,o.labels[m]=y}if(f.parent=r,r.position=cc.v3(this.gridsStartX+t*this.gridSize+this.gridSize/2+Math.floor(t/5)*h+1,this.rows_*this.gridSize+5),r.parent=this.colHintsParent,o.shineBg=c,this.gridHeadColVec.push(o),r.scale=n,e&&t>this.treeData.minCol&&t<this.treeData.maxCol||i&&this.iceData&&this.iceData.cHints[t]){var w=e?"treeMask":"iceMask",T=new cc.Node(w);T.setAnchorPoint(.5,0);var I=T.addComponent(cc.Sprite);I.spriteFrame=e||i,I.sizeMode=cc.Sprite.SizeMode.CUSTOM,I.type=e?cc.Sprite.Type.TILED:cc.Sprite.Type.SLICED,T.height=a,r.addChild(T),o[w]=T}},e.prototype.getWorldPointByTouch=function(t){var e=cc.Vec2.ZERO;return this.camera.getScreenToWorldPoint(t.getLocation(),e),e},e.prototype.TestTouch=function(t,e){void 0===e&&(e=!1);var i=this.getWorldPointByTouch(t.touch),o=this.map_node_.convertToNodeSpaceAR(i),r=o.x,s=o.y,c={area:n.None,row:-1,col:-1};if(this.touchDir!=a.None&&e){var l=Math.floor(s/this.gridSize),d=Math.floor((r-this.gridsStartX)/this.gridSize);return c.area=n.Grid,c.row=l,c.col=d,c}var u=this.map_node_.getContentSize();return r<0||s<0||s>u.height||r>u.width?c:(r<this.gridsStartX-15?(l=Math.floor(s/this.gridSize))>=0&&l<this.rows_&&(c.area=n.HeadRow,c.row=l):s>this.rows_*this.gridSize+15?(d=Math.floor((r-this.gridsStartX)/this.gridSize))>=0&&d<this.cols_&&(c.area=n.HeadCol,c.col=d):(l=Math.floor(s/this.gridSize),d=Math.floor((r-this.gridsStartX)/this.gridSize),l>=0&&l<this.rows_&&d>=0&&d<this.cols_&&(c.area=n.Grid,c.row=l,c.col=d)),c)},e.prototype.OnTouchBegan=function(t){if(this.resetCD(),this.canTouch)return!this.click_touch_&&(this.click_touch_=!0,this.gridTouchStart=null,void(this.isAllRight||(this.gridTouchStart=this.TestTouch(t),this.gridTouchStart.area==n.Grid&&this.OperationStepBegin(),this.gridTouchStart.area==n.Grid&&(this.touchDir=a.None,this.fillMode=r.None,this.OnClickGrid(this.gridTouchStart.row,this.gridTouchStart.col)))))},e.prototype.OnTouchMoved=function(t){if(this.canTouch&&!this.isAllRight&&this.gridTouchStart&&this.gridTouchStart.area!=n.None)do{if(this.gridTouchStart.area!=n.Grid)break;var e=this.TestTouch(t,!0);if(e.area!=n.Grid)break;if(this.touchDir==a.Horizontal?e.row=this.lastTouchRow:this.touchDir==a.Vertical&&(e.col=this.lastTouchCol),e.row==this.lastTouchRow&&e.col==this.lastTouchCol)break;this.touchDir==a.None&&(e.row==this.lastTouchRow?this.touchDir=a.Horizontal:e.col==this.lastTouchCol&&(this.touchDir=a.Vertical));var i=e.row,o=e.col;this.OnClickGrid(i,o)}while(0)},e.prototype.OnTouchEnded=function(t){do{if(!this.gridTouchStart)break;if(this.gridTouchStart.area!=n.HeadRow&&this.gridTouchStart.area!=n.HeadCol)break;var e=this.TestTouch(t);if(e.area==n.HeadRow&&this.gridTouchStart.area==n.HeadRow){this.OnClickRowHead(e.row);break}e.area==n.HeadCol&&this.gridTouchStart.area==n.HeadCol&&this.OnClickColHead(e.col)}while(0);this.CancelGridTouch()},e.prototype.OnTouchCancelled=function(){this.CancelGridTouch()},e.prototype.GetWorkGridTag=function(t,e){var i=(this.rows_-t-1)*this.cols_+e;return i<0||i>=this.workData.length?o.Empty:this.workData[i]},e.prototype.SetWorkGridTag=function(t,e,n,a){var r,s=this.rows_,c=this.cols_,l=(s-e-1)*c+n;if((r=this.grids[l])&&!r.isEmpty)return!0;var u=this.soundIdx;if(u=this.soundIdx>15?15:this.soundIdx,!(l<0||l>=this.workData.length)&&this.workData[l]!=t&&(this.OperationStepBySetWorkTag(this.workData[l],t,e*c+n),t==o.O||t==o.X)){var p=this.treeData,h=this.wormData,f=this.iceData;if(this.curItemBtn&&!a)return 2==this.curItemIdx||!(!p||!p[l])||!(!f||!f[l])||(this.updateItemNum(this.curItemIdx,!0),this.useItem(r,e,n),b.default.p(b.VEnum3.SHORT),!0);if(r.isEmpty){var g=this.guideCheckGrid;if(g){var v=e+"_"+n;if(-1==(w=g.indexOf(v)))return!0;g.splice(w,1),0==g.length&&this.scheduleOnce(this.updateGuideStep,.5)}if(a&&(t=r.isRight),p){if(p[l])return!0;this.treeCheck(e,n)}if(f){if((m=f[l])&&m.drop)return!0;this.iceCheck(e,n)}if(r.select(t),b.default.p(b.VEnum3.SHORT),r.isRight&&(this.workData[l]=o.O,t==o.O)){if(h){var m=h[l],_=h.counts,S=h.sps;if(m&&_){var w,T=_[w=m.i]=_[w]-1,I=S[w];if(I&&I.addCount(),0==T){var D=this.tilesParent.getChildByName("wormParent"),k=i.challageData.data.data;if(D&&D.children[w]&&k&&k[w]){D.children[w].active=!0;var N=this.grids,C=0;k[w].forEach(function(t){N[t].playWormAni(.06*C),C++})}}}}y.default.ins.play("tile_note_"+u),this.soundIdx++}this.tipTog&&!a&&(this.tipLabel.string=u+"",1==u?this.tipNode.setPosition(r.node.position):2==u?(this.tipNode.active=!0,this.tipAni.play(d.tipIn)):(this.tipLabel.node.x=u>9?-14:-13,cc.tween(this.tipNode).to(.1,{scale:1.1}).to(.1,{scale:1}).start()))}}},e.prototype.treeCheck=function(t,e){var i=this.treeData;if(void 0!==i&&void 0!==t&&void 0!==e){var o=this.rows_,n=this.cols_,a=this.gridHeadRowVec,r=this.gridHeadColVec,s=i.tmp||(i.tmp=[]),c=i.minRow,l=i.maxRow,d=i.minCol,u=i.maxCol;s.push(t>0&&{r:t-1,c:e},t<o-1&&{r:t+1,c:e},e>0&&{r:t,c:e-1},e<n-1&&{r:t,c:e+1}),s.forEach(function(t){if(t){var e=t.r,s=t.c,p=(o-e-1)*n+s,h=i[p];if(h){h.play(),delete i[p];var f=r[s].treeMask;if(f){for(var g=1,v=c+1;v<l&&1==g;v++)i[(o-v-1)*n+s]&&(g=0);g&&(delete r[s].treeMask,cc.tween(f).to(.5,{height:0}).call(function(){f.destroy()}).start())}var m=a[e].treeMask;if(m){g=1;for(var y=d+1;y<u&&1==g;y++)i[(o-e-1)*n+y]&&(g=0);g&&(delete a[e].treeMask,cc.tween(m).to(.5,{width:0}).call(function(){m.destroy()}).start())}}}}),s.length=0}},e.prototype.iceCheck=function(t,e){var i=this,o=this.iceData;if(void 0!==o&&void 0!==t&&void 0!==e){var n=this.rows_,a=this.cols_,r=this.gridHeadRowVec,s=this.gridHeadColVec,c=o.rHints,l=o.cHints,d=o.tmp||(o.tmp=[]);d.push(t>0&&{r:t-1,c:e},t<n-1&&{r:t+1,c:e},e>0&&{r:t,c:e-1},e<a-1&&{r:t,c:e+1}),d.forEach(function(t){if(t){var e=t.r,d=t.c,u=(n-e-1)*a+d,p=o[u];if(p&&p.drop){if(0==p.drop()){delete o[u];var h=c[e]=c[e]-1,f=l[d]=l[d]-1,g=s[d].iceMask;g&&0==f&&(delete s[d].iceMask,cc.tween(g).to(.5,{height:0}).call(function(){g.destroy()}).start());var v=r[e].iceMask;v&&0==h&&(delete r[e].iceMask,cc.tween(v).to(.5,{width:0}).call(function(){v.destroy()}).start())}var y=new cc.Node("icePit"),_=p.node;y.scale=_.scale,y.setPosition(_.x,_.y),_.parent.addChild(y),m.default.ins.lSF("game/ice/pit",y.addComponent(cc.Sprite));var b=i.gridSize,S=cc.v2(_.x,_.y),w=cc.v2(S.x+b,S.y+3*b),T=cc.v2(S.x+1.5*b,S.y-3*b);cc.tween(y).bezierTo(1,S,w,T).start(),cc.tween(y).delay(.2).by(20/30,{scale:-.3}).to(4/30,{opacity:0}).call(function(){y.destroy()}).start()}}}),d.length=0}},e.prototype.tipAniDone=function(t,e){e.name==d.tipOut&&(this.tipNode.active=!1)},e.prototype.SetWorkGridTagWithInit=function(){return __awaiter(this,void 0,void 0,function(){var t,e,o,n,a,r,s,c,l,d,u,p,h,f,g,v,y,_,b,S,w,I,D,k,N,C,M,R,L,P,A,E,F,x,O,V,U,z,H,G,j,J,W,q,K,Y,X,Z=this;return __generator(this,function(Q){switch(Q.label){case 0:if(e=(t=this).rows_,o=t.cols_,n=t.gridPrefab,a=t.gridsStartX,r=t.gridSize,s=t.grids,c=t.tilesParent,l=t.baseData,d=t.treeData,u=t.wormData,p=t.iceData,!(b=i.challageData))return[3,7];switch(b.type){case B.challengeType.tree:return[3,1];case B.challengeType.worm:return[3,3];case B.challengeType.ice:return[3,5]}return[3,7];case 1:return[4,m.default.ins.lPre("prefab/game/hedge")];case 2:return h=Q.sent(),f=new cc.Node("treeMasks"),c.addChild(f),[3,7];case 3:return[4,m.default.ins.lPre("prefab/game/worm")];case 4:for(g=Q.sent(),v=new cc.Node("wormParent"),L=b.data.data.length,P=0;P<L;P++)K=new cc.Node("worms"),v.addChild(K),K.active=!1;return c.addChild(v),[3,7];case 5:return[4,m.default.ins.lPre("prefab/game/ice")];case 6:return y=Q.sent(),_=new cc.Node("iceParent"),c.addChild(_),[3,7];case 7:return S=r/44,w=Math.floor,I=this.lineW,1==(N=B.default.ins.getUsingSkin().bg)?[3,10]:(C="game/skin/"+N+"/",[4,m.default.ins.lSF(C+"grid")]);case 8:return D=Q.sent(),[4,m.default.ins.lSF(C+"gridTip")];case 9:k=Q.sent(),Q.label=10;case 10:for(M=0,R=this.workData,L=R.length;M<L;M++)P=e-Math.floor(M/o)-1,E=w((A=M%o)/5),F=w(P/5),x=a+A*r+.5*r+E*I,O=P*r+.5*r+F*I,(V=cc.instantiate(n)).setPosition(x,O),V.setScale(S,S,1),U=s[M]=V.getComponent(T.default),z=l[M],U.init(z),U.initType(D,k),c.addChild(V),h&&P>d.minRow&&P<d.maxRow&&A>d.minCol&&A<d.maxCol&&((H=cc.instantiate(h)).setPosition(x,O),H.setScale(S,S,1),f.addChild(H),d[M]=H.getComponent(cc.Animation)),g&&z&&(G=u[M],j=G.i,J=G.tex,W=G.dir,(q=cc.instantiate(g)).angle=W,q.setPosition(x,O),q.setScale(S,S,1),q.getComponent("worm").init(J),(K=v.children[j]).addChild(q)),y&&p&&p[M]&&((Y=cc.instantiate(y)).setPosition(x,O),Y.setScale(S,S,1),(X=Y.getComponent("ice")).r=P,X.c=A,p[M]=X,_.addChild(Y));return f&&f.setSiblingIndex(c.childrenCount-1),v&&v.setSiblingIndex(0),_&&_.setSiblingIndex(c.childrenCount-1),this.schedule(function(){Z.playHightLight(1,1)},30),[2]}})})},e.prototype.GetBaseGridTag=function(t,e){var i=(this.rows_-t-1)*this.cols_+e;return i<0||i>=this.grid_count?o.Empty:this.baseData[i]},e.prototype.IsRowLogicRight=function(t){var e=this.GetBaseRowHeadNums(t),i=this.GetWorkRowHeadNums(t);if(e.length!=i.length)return!1;for(var o=0;o<e.length;o++)if(e[o]!=i[o])return!1;return!0},e.prototype.IsColLogicRight=function(t){var e=this.GetBaseColHeadNums(t),i=this.GetWorkColHeadNums(t);if(e.length!=i.length)return!1;for(var o=0;o<e.length;o++)if(e[o]!=i[o])return!1;return!0},e.prototype.IsRowFillRight=function(t){for(var e=0;e<this.cols_;e++){var i=this.GetBaseGridTag(t,e),n=this.GetWorkGridTag(t,e);if(i==o.O&&n!=o.O)return!1;if(i==o.X&&n==o.O)return!1}return!0},e.prototype.IsColFillRight=function(t){for(var e=0;e<this.rows_;e++){var i=this.GetBaseGridTag(e,t),n=this.GetWorkGridTag(e,t);if(i==o.O&&n!=o.O)return!1;if(i==o.X&&n==o.O)return!1}return!0},e.prototype.RefreshRowHeadState=function(t){var e=i.type!=B.gameType.race,n=this.gridHeadRowVec[t],a=n.labels;if(this.IsRowLogicRight(t)){for(var r=0;r<a.length;r++)e&&(a[r].color=G),this.playHightLight(t);this.raceRefresh(t),n.allRight=!0,this.selectData.row==t&&this.showOrHideSelectMask(),!this.byGuide&&this.playGirlAni(c.happy)}else if(e)for(var s=this.GetBaseRowHeadNums(t),l=this.GetBaseRowBeginNums(t),d=this.workData,u=0,p=s.length;u<p;u++)if(!G.equals(a[u].color)){for(var h=!0,f=l[u],g=l[u]+s[u];f<g;f++)if(d[f]!=o.O){h=!1;break}h&&(a[u].color=G)}},e.prototype.RefreshColHeadState=function(t){var e=i.type!=B.gameType.race,n=this.gridHeadColVec[t],a=n.labels;if(this.IsColLogicRight(t)){for(var r=0;r<a.length;r++)e&&(a[r].color=G),this.playHightLight(void 0,t);this.raceRefresh(void 0,t),n.allRight=!0,this.selectData.col==t&&this.showOrHideSelectMask()}else if(e)for(var s=this.GetBaseColHeadNums(t),c=this.GetBaseColBeginNums(t),l=this.workData,d=this.rows_,u=0,p=s.length;u<p;u++)if(!G.equals(a[u].color)){for(var h=!0,f=c[u],g=c[u]+s[u]*d;f<g;f+=d)if(l[f]!=o.O){h=!1;break}h&&(a[u].color=G)}},e.prototype.playHightLight=function(t,e){var i,n=this.grids,a=this.rows_,r=this.cols_;if(void 0===e){for(var s=void 0,c=void 0,l=0;l<r;l++)(i=n[l+(a-t-1)*a]).isEmpty&&(i.select(o.X,!0),this.treeCheck(t,l),this.iceCheck(t,l)),i.playHL(.02*l),0==l?s=i.node.position:l==r-1&&(c=i.node.position);if(s){var d=cc.instantiate(this.fadePrefab);d.setPosition(s.x-this.gridSize/2,s.y),d.angle=90,d.scale=1/this.gridBgSp.node.scale,this.patices.addChild(d),cc.tween(d).to(.02*(r-1),{position:c}).delay(.2).call(function(){d.destroy()}).start()}}else if(void 0===t){for(s=void 0,c=void 0,l=0;l<a;l++)(i=n[e+l*a]).isEmpty&&(i.select(o.X,!0),this.treeCheck(a-1-l,e),this.iceCheck(a-1-l,e)),i.playHL(.02*l),0==l?s=i.node.position:l==r-1&&(c=i.node.position);if(s){var u=cc.instantiate(this.fadePrefab);u.setPosition(s.x-this.gridSize/2,s.y),u.scale=1/this.gridBgSp.node.scale,this.patices.addChild(u),cc.tween(u).to(.02*(r-1),{position:c}).delay(.2).call(function(){u.destroy()}).start()}}else{var p=void 0;for(l=0;l<a;l++)for(var h=0;h<r;h++)p=.02*(a-l-1+h),(i=n[l+h*a]).playHL(p)}},e.prototype.raceRefresh=function(t,e){if(i.type==B.gameType.race){var o=this.raceRefreshPop;o.push({r:t,c:e}),1==o.length&&(this.canTouch=!1,this.scheduleOnce(this.checkRaceFresh))}},e.prototype._raceRefresh=function(t,e){if(this.isRefreshing)this.raceRefreshPop.push({r:t,c:e});else{this.isRefreshing=!0;var n=this.raceDensity;(this.raceRefeshTime=this.raceRefeshTime+1)%2==0&&((n=this.raceDensity-.05)<this.raceMinDenstiy&&(n=this.raceMinDenstiy),this.raceDensity=n);var a=this.baseData,r=this.workData,s=this.grids,c=this.gridPrefab,l=this.tilesParent,d=cc.instantiate,u=null!=e,p=null!=t;p&&(t=9-t),i.type;for(var h,f=u&&e<5,g=f?-1:1,v=p&&t<5,m=v?-10:10,y=0,_=1,b=0,S=1,w=0,T=void 0;w<10;w++){T=v?w:9-w;for(var I=0,D=void 0;I<10;I++){var k=s[F=(D=f?I:9-I)+10*T],N=a[F],C=r[F];if(u&&(0==N&&1==S&&b++,S=N),u&&D==e||p&&T==t)k.playFallDown();else if(u?(f&&D>e||!f&&D<e)&&(k.playWalk(s[F+g].node.position),s[F+g]=k,a[F+g]=N,r[F+g]=C):p&&(v&&T>t||!v&&T<t)&&(k.playWalk(s[F+m].node.position),s[F+m]=k,a[F+m]=N,r[F+m]=C),u&&9==I||p&&9==w){0==(h=Math.random()<n?1:0)&&1==_&&y++,(y>2||b>2)&&(h=1,y--),_=h,b=0,S=0;var M=k.node,R=d(c);R.setPosition(M.position),R.setParent(l),R.setScale(0);var L=R.getComponent("grid");L.init(h),L.initType(),L.playShow(M.scale),s[F]=L,a[F]=h,r[F]=o.Empty}}}if(p){t=v?9:0;var P=[],A=0,E=void 0;for(I=0;I<10;I++){var B=s[I+10*t].isRight;P[P.length-1]!=B&&(B&&A++,P.push(B))}if(A>4)for(_=1,I=0;I<10;I++){var F,x=s[F=I+10*t];if(1==_&&0==x.isRight)x.isRight=1,a[F]=1,E=!0;else if(E)break;_=x.isRight}}this.addHeads(),this.scheduleOnce(this.checkRaceFresh.bind(this),.5)}},e.prototype.checkRaceFresh=function(){var t=this.raceRefreshPop;if(this.isRefreshing=!1,t.length){var e=t.pop(),i=e.r,o=e.c;this._raceRefresh(i,o)}else this.canTouch=!0},e.prototype.OnClickGrid=function(t,e,i){if(!(t<0||e<0||t>=this.rows_||e>=this.cols_)){var n=this.GetWorkGridTag(t,e),a=-1;n==o.Empty?a=this.pen:n==o.O&&this.pen==o.O?a=o.Empty:n==o.X&&this.pen==o.X&&(a=o.Empty),this.fillMode==r.Set&&n!=o.Empty||this.fillMode==r.Clean&&n==o.Empty||(-1!=a&&(this.fillMode==r.None&&(this.fillMode=n==o.Empty?r.Set:r.Clean),!this.SetWorkGridTag(a,t,e,i)&&(this.RefreshRowHeadState(t),this.RefreshColHeadState(e),this.CheckAllRight())),this.lastTouchRow=t,this.lastTouchCol=e)}},e.prototype.OnClickRowHead=function(t){if(!this.byGuide&&!this.IsRowLogicRight(t)){var e=this.gridHeadRowVec[t];e.treeMask||e.iceMask||(this.curItemBtn&&2==this.curItemIdx?(this.updateItemNum(this.curItemIdx,!0),this.useItem(null,t,null)):this.showOrHideSelectMask(t),b.default.p(b.VEnum3.SHORT))}},e.prototype.OnClickColHead=function(t){if(!this.byGuide&&!this.IsColLogicRight(t)){var e=this.gridHeadColVec[t];e.treeMask||e.iceMask||(this.curItemBtn&&2==this.curItemIdx?(this.updateItemNum(this.curItemIdx,!0),this.useItem(null,null,t)):this.showOrHideSelectMask(void 0,t),b.default.p(b.VEnum3.SHORT))}},e.prototype.showOrHideSelectMask=function(t,e){var i=this.selectMask,o=this.selectData;if(void 0===t&&void 0===e)i.active=!1,-1!=o.row&&((m=this.gridHeadRowVec[o.row].shineBg).active=!1,cc.Tween.stopAllByTarget(m),o.row=-1),-1!=o.col&&((m=this.gridHeadColVec[o.col].shineBg).active=!1,cc.Tween.stopAllByTarget(m),o.col=-1);else{var n=i.active,a=this.selectMaskBg,r=this.gridBgSp.node,s=this.gridSize,c=this.cols_,l=this.lineW,d=c*s+this.gridsStartX+l*(c/5-1),u=d/2,p=u;if(n||(i.active=!0,i.width=i.height=d,i.setPosition(u,p),cc.tween(a).set({opacity:0}).to(.2,{opacity:128}).start()),void 0!==t){var h=this.gridHeadRowVec,f=o.row,g=o.col;if(-1!=f&&((m=h[f].shineBg).active=!1,cc.Tween.stopAllByTarget(m)),f==t){if(o.row=-1,-1==g)return void(i.active=!1);i.y=p,i.height=d}else i.height=s,o.row=t,i.y=t*s+s/2+Math.floor(t/5)*l-1,(m=h[t].shineBg).active=!0,cc.tween(m).to(.8,{opacity:0}).to(.8,{opacity:100}).union().repeatForever().start()}else{var v=this.gridHeadColVec;if(f=o.row,-1!=(g=o.col)&&((m=v[g].shineBg).active=!1,cc.Tween.stopAllByTarget(m)),g==e){if(o.col=-1,-1==f)return void(i.active=!1);i.x=u,i.width=d}else{var m;i.width=s,o.col=e,i.x=e*s+s/2+this.gridsStartX+Math.floor(e/5)*l-1,(m=v[e].shineBg).active=!0,cc.tween(m).to(.8,{opacity:0}).to(.8,{opacity:100}).union().repeatForever().start()}}a.setPosition(r.x-i.x,r.y-i.y+8)}},e.prototype.CancelGridTouch=function(){this.soundIdx=1,this.tipNode.active&&this.tipAni.play(d.tipOut),this.click_touch_=!1,this.gridTouchStart&&this.gridTouchStart.area!=n.None&&(this.gridTouchStart.area=n.None,this.OperationStepEnd())},e.prototype.IsAllRight=function(){if(this.baseOTotal<0){this.baseOTotal=0;for(var t=0;t<this.grid_count;t++)this.baseData[t]==o.O&&(this.baseOTotal+=1)}var e=this.baseOTotal,i=0;for(t=0;t<this.workData.length;t++)this.workData[t]==o.O&&(i+=1);if(e!=i)return!1;for(var n=0;n<this.rows_;n++)if(!this.IsRowLogicRight(n))return!1;for(var a=0;a<this.cols_;a++)if(!this.IsColLogicRight(a))return!1;return!0},e.prototype.CheckAllRight=function(){!this.isAllRight&&this.IsAllRight()&&(this.isAllRight=!0,this.showOrHideSelectMask(),this.gameWin())},e.prototype.winSpScaleAni=function(){var t=this.winSpParent,e=this.winAniNode.parent,i=new cc.Vec3;t.parent.convertToWorldSpaceAR(t.position,i),e.convertToNodeSpaceAR(i,i),t.setParent(e),t.setSiblingIndex(3),t.setScale(this.gridBgSp.node.scale),t.setPosition(i),cc.tween(t).to(.5,{scale:1.2}).delay(5/30).to(1,{scale:.5,x:0,y:C.default.padScale?75:175},{easing:"cubicIn"}).call(this.PlayFireworks.bind(this)).by(5/30,{scale:.05},{easing:"cubicOut"}).by(5/30,{scale:-.05},{easing:"cubicIn"}).start()},e.prototype.tilesWinAni=function(){var t=this.map_node_;cc.tween(t).delay(20/30).to(1,{scale:.606,x:-288,y:100},{easing:"cubicIn"}).call(this.PlayFireworks.bind(this)).start()},e.prototype.gameWin=function(){var t,e,o,n,a=this;this.canTouch=!1,y.default.ins.play(y.default.WIN);var r=B.default.ins,s=i.type,c=s==B.gameType.normal,d=s==B.gameType.practice,u=s==B.gameType.festival,p=s==B.gameType.freedom,h=s==B.gameType.challenge;E.default.taskCheck(s),(c||u||p)&&L.default.ins.updPro(L.fesTaskKey.throughMain,1),this.eventDot(!0),u?n=L.default.ins.getFesPuzzleSprFrame():p||h||(n=c?P.default.ins.getPuzzleSprFrame(B.default.ins.getPuzzleLvl()):P.default.ins.getPracitceSprfFrame(this.practiceId));var f=this.node.getChildByName("win"),g=f.getChildByName("top"),v=f.getChildByName("mid");if(d){g.active=!1,v.active=!1;var _=f.getChildByName("down");if(_.getChildByName("adGetBtn").active=!1,_.getChildByName("nextPraBtn").active=!this.byGuide,this.byGuide){var b=_.getChildByName("getBtn");b.x=0,b.opacity=0}}else{var S=void 0;h?(this.unschedule(this._chaCD),R.default.ins.winChallenge(i.challageData.date),C.default.loadToRace=3):p?(this.levelLbl.node.parent.active=!1,g.scaleX=0,S=15==this.rows_):(o=c?r.getPuzzleLvl():L.default.ins.getFesPuzzleLv(),this.levelLbl.string=""+o,S=o%3==0,c?r.finishPuzzleLvl():L.default.ins.finishFesPuzzleLv()),r.recordGameResult(s,!0,this.score,void 0,o);var T={};if(T[s!==B.gameType.festival||L.default.ins.isJigsawMax()?"puzzle_pieces":"newYear_pieces"]=1,h){this.cons2Lbl.string=this.useTimeLbl.string,this.mult=3,this.adGetBtn.node.adDotData="\u6bcf\u65e5\u6311\u6218\u4e09\u500d\u5956\u52b1";var I=i.challageData.date.num||1;this.consBestLbl.string=I+"",T=(null===(e=null===(t=w.default.serverCfg)||void 0===t?void 0:t.daily_challenge)||void 0===e?void 0:e.reward)||{times:50,coin:100,puzzle_pieces:10},i.challageData.date.isFin&&(T={})}else{var k=r.getConsWinTimes();this.cons2Lbl.string=k+"",this.consBestLbl.string=this.recData.heWins;var N=this.baseReward=2,M=this.reward=Math.min(N*k,20);this.mult=S?10:3,this.adGetBtn.node.adDotData=S?"\u4e3b\u7ebf\u5341\u500d\u5956\u52b1":"\u4e3b\u7ebf\u4e09\u500d\u5956\u52b1",this.tenNode.active=S,this.threeNode.active=!S,this.rew1Lbl.string=N+"",this.rew2Lbl.string=M+""}for(var A in T){var F=T[A],x=cc.instantiate(this.rewItemPre);x.scale=1.3,x.getComponent(D.default).initByData(A,F),this.rewItems.content.addChild(x)}if(!h||!i.challageData.date.isFin){var O=this.rewItems.content.children[0].width*this.rewItems.content.childrenCount;this.rewItems.node.x=O>this.rewItems.node.width?-180:(this.rewItems.node.width-O)/2-180,O=Math.min(O,360),this.rewItems.node.width=O,this.rewItems.scrollToLeft()}var V=w.default.serverCfg.share_rules.rules.main_line,U=r.getNormalShareTime();this.shareIcon.spriteFrame=cc.assetManager.getBundle("resSps").get("item/"+V.props,cc.SpriteFrame),this.shareLbl.string="+"+V.val,this.shareIcon.node.active=U<V.daily_limit_reward_times,m.default.ins.getBundleByString("prefab").then(function(t){t.preload("prefab/game/banner",cc.Prefab)})}n?n.then(function(t){var e=a.cols_,i=a.rows_,o=a.gridSize,n=a.map_node_,r=a.gridBgSp.node,s=r.scale,c=r.x+r.width*s/2+n.x,d=r.y+r.height*s/2+n.y;C.default.padScale&&(d-=150,g.isValid&&(g.removeComponent(cc.Widget),a.scheduleOnce(function(){g.y=-100})),f.getChildByName("mid").y=-100),a.winAniNode.setPosition(c,d),a.winAniNode.setScale(s);var u=a.lastTouchRow-i/2,p=(a.lastTouchCol-e/2)*o+o/2,h=u*o+o/2;a.winCircleMask.setPosition(p,h),a.winSpParent.setPosition(-p,-h),a.winLight.setPosition(p,h);var v=new cc.Node;v.addComponent(cc.Sprite).spriteFrame=t,v.parent=a.node;var m=v.width,y=v.height,_=new cc.RenderTexture;_.initWithSize(v.width,v.height);var b=new cc.Node;b.setParent(v);var S=b.addComponent(cc.Camera);S.clearFlags|=cc.Camera.ClearFlags.COLOR,S.backgroundColor=cc.color(0,0,0,0),S.zoomRatio=cc.winSize.height/y,S.targetTexture=_,S.render(v),b.destroy(),v.destroy(),a.scheduleOnce(function(){var t=_.readPixels();_.destroy();var n=a.winSps,r=z(m/e),c=z(y/i),d=a.singleSf;o/=s;for(var u=0;u<e;u++)for(var p=0;p<i;p++){var h=p*c*m+u*r,f=t[h*=4],g=t[h+1],v=t[h+2],b=(t[h+3],new cc.Node),S=b.addComponent(cc.Sprite);S.spriteFrame=d,S.sizeMode=cc.Sprite.SizeMode.CUSTOM,b.parent=n,b.color=new cc.Color(f,g,v),b.setContentSize(o,o),b.setPosition(u*o+o/2,p*o+o/2)}a.scheduleOnce(function(){a.playAni(l.gameWin)},.5)})}).catch(function(){a.scheduleOnce(function(){a.playAni(l.gameWinFailSf)},.5)}):this.scheduleOnce(function(){a.playAni(l.gameWinFailSf)},.5)},e.prototype.PlayFireworks=function(){if(!this.byGuide){var t=this.consBestLbl.node.parent.parent,e=this.levelLbl.node.parent.parent;m.default.ins.getBundleByString("prefab").then(function(i){t.isValid&&i.load("prefab/game/banner",cc.Prefab,function(i,o){if(!i&&t.isValid){var n=cc.instantiate(o),a=e.getChildByName("img_gk_ss"),r=e.convertToWorldSpaceAR(a.getPosition()),s=t.convertToNodeSpaceAR(r);n.setParent(t),n.y=s.y-100,n.getComponent(x.default).play()}})}).catch(function(){})}},e.prototype.OperationStepBegin=function(){var t=this.opStep;t.grids=[],t.row_autox_cols.clear(),t.col_autox_rows.clear(),Object.assign(t.row_autox_cols,this.colAutoXCols),Object.assign(t.col_autox_rows,this.colAutoXRows),t.hint_rows=[],t.hint_cols=[],t.is_row_autox_changed=!1,t.is_col_autox_changed=!1,t.is_hint_rows_changed=!1,t.is_hint_cols_changed=!1},e.prototype.OperationStepEnd=function(){this.isAllRight||(this.opStep.is_row_autox_changed||this.opStep.is_col_autox_changed||this.opStep.is_hint_rows_changed||this.opStep.is_hint_cols_changed||0!=this.opStep.grids.length)&&(this.opStep.is_row_autox_changed||this.opStep.row_autox_cols.clear(),this.opStep.is_col_autox_changed||this.opStep.col_autox_rows.clear())},e.prototype.OperationStepBySetWorkTag=function(t,e,i){this.opStep.grids.push({tag_undo:t,tag_redo:e,grid:i})},e.prototype.OnBtnOX=function(){if(!this.oxAning&&(this.resetCD(),this.canTouch)){var t=this.pen,e=(t=this.pen=t==o.X?o.O:o.X)==o.X;this.oxAning=!0,this.oxTagAni.play(e?"togToX":"togToO"),this.playShine(),b.default.p(b.VEnum3.SHORT)}},e.prototype.oxAniDone=function(){var t=this;this.byGuide?this.scheduleOnce(function(){t.updateGuideStep(),t.oxAning=!1},.2):this.oxAning=!1},e.prototype.playShine=function(){this.grids.forEach(function(t){t.shine()})},e.prototype.OnBtnSet=function(){if(!this.curAni){this.showOrHideSelectMask(),this.resetCD();var t=this.isShowBtn=!this.isShowBtn;this.playAni(t?l.showBtns:l.hideBtns),this.canTouch=!t,this.raceChgVis(),b.default.p(b.VEnum3.SHORT)}},e.prototype.OnBtnHelp=function(){this.resetCD(),A.default.ins.open("ui/ui_raceTip",{pageIdx:i.type==B.gameType.race?2:0}),b.default.p(b.VEnum3.SHORT)},e.prototype.OnBtnMusic=function(){this.resetCD(),A.default.ins.open("ui/ui_set",null),b.default.p(b.VEnum3.SHORT)},e.prototype.OnBtnTip=function(){this.resetCD(),this.tipTog=!this.tipTog,_.default.ins.setSetting({tip:this.tipTog}),this.updateTip(),b.default.p(b.VEnum3.SHORT)},e.prototype.updateTip=function(){this.tipActNode.active=this.tipTog,this.tipUnActNode.active=!this.tipTog},e.prototype.OnBtnHome=function(){this.resetCD(),A.default.ins.open("ui/ui_rePlay",{curScore:this.score,continueCb:this.continueCb.bind(this)},{MaskNoHide:!0}),b.default.p(b.VEnum3.SHORT)},e.prototype.OnBtnShare=function(){var t=this;this.resetCD(),f.platform.shareVideoRecord().then(function(e){var i=t.shareIcon;if(1==e&&i&&i.isValid&&i.node.active){var o=B.default.ins,n=w.default.serverCfg.share_rules.rules.main_line,a=n.props,r=n.val;i.spriteFrame=cc.assetManager.getBundle("resSps").get("item/"+a,cc.SpriteFrame);var s=o.getNormalShareTime();o.setNormalShareTime(s+1);var c=void 0;switch(a){case"coin":c=o.getCoin(),o.addCoin(r);break;case"times":o.addPower(r);break;default:M.default.ins.addItem(a,r)}var l=i.node.parent.convertToWorldSpaceAR(i.node.position);A.default.ins.open("ui/ui_flyAni",{itemDatas:[{itemId:a,worldPos:l,value:r}],showCoin:c}),t.shareBtn.active=!1}})},e.prototype.continueCb=function(){this.canTouch=!0,this.raceChgVis(),this.OnBtnSet()},e.prototype.raceChgVis=function(){if(i.type==B.gameType.race){var t=this.canTouch;this.tilesParent.active=t,this.gridHeadColVec.forEach(function(e){e.labels.forEach(function(e){e.active=t})}),this.gridHeadRowVec.forEach(function(e){e.labels.forEach(function(e){e.active=t})})}},e.prototype.OnBtnItem=function(t,e){var o=this;if(this.showOrHideSelectMask(),this.resetCD(),this.canTouch)if(this.curItemBtn)this.OnBtnHideItem();else{this.curItemIdx=Number(e);var n=this.items[e];if(n.itemMax!=n.itemCur){if(0==n.count)return this.canTouch=!1,this.raceChgVis(),void A.default.ins.open("ui/ui_getItem",{itemId:n.icon,cb:this.updateItemNum.bind(this),closeCb:function(){o.canTouch=!0,o.raceChgVis()},gType:i.type});var a=this.curItemBtn=t.currentTarget;a.setSiblingIndex(7),m.default.ins.lSF("item/"+n.icon,this.itemSelectIcon),this.itemSelectLbl.string=n.tip,this.itemSelectEff.setPosition(a.position),this.canTouch=!1,this.playAni(l.openItemSelect),this.chgGridItemShine(!0),b.default.p(b.VEnum3.SHORT)}else F.default.ins.showTip("\u6bcf\u5173\u53ea\u80fd\u4f7f\u7528"+n.itemMax+"\u6b21")}},e.prototype.OnBtnHideItem=function(){this.resetCD(),this.canTouch&&(this.playAni(l.closeItemSelect),this.chgGridItemShine(!1),b.default.p(b.VEnum3.SHORT))},e.prototype.tmpGet=function(t){var e,o,n;switch(this.resetCD(),i.type){case B.gameType.normal:case B.gameType.freedom:n=P.default.ins.updJigAndPop;break;case B.gameType.festival:n=P.default.ins.popFestival}if(i.type==B.gameType.challenge){f=t?this.mult:1;var a=(null===(o=null===(e=w.default.serverCfg)||void 0===e?void 0:e.daily_challenge)||void 0===o?void 0:o.reward)||{times:50,coin:100,puzzle_pieces:10};i.challageData.date.isFin&&(a={});var r=[],s=0;for(var c in a){var l=a[c]*f,d=this.rewItems.content.children[s],u=d.parent.convertToWorldSpaceAR(d.position),p={};p.itemId=c,p.worldPos=u,p.value=Number(l),r.push(p),M.default.ins.addItem(c,l),s++}r.length?A.default.ins.open("ui/ui_flyAni",{itemDatas:r,hideCb:function(){B.chgScene(B.sceneType.main,{cb:n})}}):B.chgScene(B.sceneType.main,{cb:n})}else if(this.reward){if(!t&&10==this.mult)return void A.default.ins.open("ui/ui_getReward",{gold:this.reward+this.baseReward},{MaskNoHide:!0});var h,f=t?this.mult:1,g=B.default.ins.getCoin();B.default.ins.addCoin((this.reward+this.baseReward)*f),h=i.type!==B.gameType.festival||L.default.ins.isJigsawMax()?"puzzle_pieces":"newYear_pieces",M.default.ins.addItem(h,f);var v=this.baseReward*f,m=this.reward*f,y=f,_=this.rew1Lbl.node,b=this.rew2Lbl.node,S=_.parent,T=this.rewItems.content.children[0],I=S.convertToWorldSpaceAR(_.position),D=S.convertToWorldSpaceAR(b.position),k=T.parent.convertToWorldSpaceAR(T.position);A.default.ins.open("ui/ui_flyAni",{itemDatas:[{itemId:"coin",worldPos:I,value:v},{itemId:"coin",worldPos:D,value:m},{itemId:h,worldPos:k,value:y}],hideCb:function(){B.chgScene(B.sceneType.main,{cb:n})},showCoin:g})}else B.chgScene(B.sceneType.main,{cb:n})},e.prototype.OnGet=function(){this.tmpGet(!1)},e.prototype.OnAdGet=function(){this.tmpGet(!0)},e.prototype.OnNextPracice=function(){B.chgScene(B.sceneType.game,{gameType:B.gameType.practice})},e.prototype.chgGridItemShine=function(t){if(2==this.curItemIdx){var e=i.type==B.gameType.race;this.gridHeadColVec.forEach(function(i){if(!i.allRight||e){var o=i.shineBg;o.active=t,t?cc.tween(o).to(.8,{opacity:0}).to(.8,{opacity:100}).union().repeatForever().start():cc.Tween.stopAllByTarget(o)}}),this.gridHeadRowVec.forEach(function(i){if(!i.allRight||e){var o=i.shineBg;o.active=t,t?cc.tween(o).to(.8,{opacity:0}).to(.8,{opacity:100}).union().repeatForever().start():cc.Tween.stopAllByTarget(o)}})}else this.grids.forEach(function(e){e.playItemTip(t)})},e.prototype.openLose=function(){0!=this.relifeTime?A.default.ins.open("ui/ui_getHeart",{time:this.relifeTime,cb:this.getHeartCb.bind(this),closeCb:this.getHeartCloseCb.bind(this),gType:i.type},{MaskNoHide:!0}):this.getHeartCloseCb()},e.prototype.getHeartCb=function(){this.relifeTime>0&&this.relifeTime--,this.playAni(l.gameRelife)},e.prototype.getHeartCloseCb=function(){var t=this;this.scheduleOnce(function(){var e=i.type===B.gameType.race?"ui/ui_rePlayRace":"ui/ui_rePlay";A.default.ins.open(e,{curScore:t.score},{MaskNoHide:!0})},.5)},e.prototype.onAppHide=function(){},e.prototype.updateScore=function(t){void 0===t&&(t=1);var e=this.score=this.score+t;this.scoreLbl.string=e+""},e.prototype.playGirlAni=function(t){t!=this.curGirlAni&&i.type!=B.gameType.race&&this.topGirlSk&&(this.curGirlAni=t,this.topGirlSk.animation=t,(this.topGirlSk.loop=t==c.idle)&&(this.curGirlAni=null))},e.prototype.playGirlEnd=function(){this.curGirlAni!=c.idle&&(this.curGirlAni=null,this.playGirlAni&&this.playGirlAni(c.idle))},e.prototype.eventDot=function(t){if(i.type==B.gameType.normal){var e=B.default.ins.getPuzzleLvl()+"";f.platform.reportEvent(f.ERepEvt.maindungeon,{iswin:t?"\u80dc\u5229":"\u5931\u8d25",level:e})}else if(i.type==B.gameType.race)f.platform.reportEvent(f.ERepEvt.raceEnd,{score:this.score});else if(i.type==B.gameType.festival){var o=Number(L.default.ins.getFesPuzzleLv());f.platform.reportEvent(f.ERepEvt.fesMainPuzzle,{iswin:t?"\u80dc\u5229":"\u5931\u8d25",id:o})}else if(i.type==B.gameType.challenge){var n=i.challageData.date,a=1e4*n.year+100*n.month+n.day;f.platform.reportEvent(f.ERepEvt.dailyChallenge,{iswin:t?"\u80dc\u5229":"\u5931\u8d25",time:a})}},e.prototype.onDestory=function(){var t=cc.assetManager.getBundle("resSps");t.release("game/normal/top",cc.SpriteFrame),t.release("game/race/top",cc.SpriteFrame),t.release("game/race/girl",cc.Prefab),t.release("game/race/goose",cc.Prefab)},__decorate([U(cc.Sprite)],e.prototype,"topSp",void 0),__decorate([U(cc.Sprite)],e.prototype,"downSp",void 0),__decorate([U(cc.Sprite)],e.prototype,"gridBgSp",void 0),__decorate([U(cc.Node)],e.prototype,"topNode",void 0),__decorate([U(cc.Node)],e.prototype,"downNode",void 0),__decorate([U(cc.BitmapFont)],e.prototype,"font4",void 0),__decorate([U(cc.Camera)],e.prototype,"camera",void 0),__decorate([U(cc.Animation)],e.prototype,"panelAni",void 0),__decorate([U(cc.SpriteFrame)],e.prototype,"uHintSf",void 0),__decorate([U(cc.SpriteFrame)],e.prototype,"lHintSf",void 0),__decorate([U(cc.Prefab)],e.prototype,"gridPrefab",void 0),__decorate([U(cc.Node)],e.prototype,"map_node_",void 0),__decorate([U(cc.Node)],e.prototype,"tilesParent",void 0),__decorate([U(cc.Node)],e.prototype,"selectMask",void 0),__decorate([U(cc.Node)],e.prototype,"selectMaskBg",void 0),__decorate([U(cc.Node)],e.prototype,"rowHintsParent",void 0),__decorate([U(cc.Node)],e.prototype,"colHintsParent",void 0),__decorate([U(cc.Label)],e.prototype,"scoreLbl",void 0),__decorate([U(cc.Label)],e.prototype,"useTimeLbl",void 0),__decorate([U(cc.Label)],e.prototype,"consLbl",void 0),__decorate([U(cc.Label)],e.prototype,"cons2Lbl",void 0),__decorate([U(cc.Label)],e.prototype,"consBestLbl",void 0),__decorate([U(cc.Label)],e.prototype,"rew1Lbl",void 0),__decorate([U(cc.Label)],e.prototype,"rew2Lbl",void 0),__decorate([U(cc.Node)],e.prototype,"threeNode",void 0),__decorate([U(cc.Node)],e.prototype,"tenNode",void 0),__decorate([U(cc.Animation)],e.prototype,"oxTagAni",void 0),__decorate([U(cc.Prefab)],e.prototype,"fadePrefab",void 0),__decorate([U(cc.Node)],e.prototype,"patices",void 0),__decorate([U(cc.Prefab)],e.prototype,"heartsPatic",void 0),__decorate([U([I.default])],e.prototype,"hearts",void 0),__decorate([U(cc.Node)],e.prototype,"heartInfinity",void 0),__decorate([U(cc.Node)],e.prototype,"tipNode",void 0),__decorate([U(cc.Label)],e.prototype,"tipLabel",void 0),__decorate([U(cc.Animation)],e.prototype,"tipAni",void 0),__decorate([U(cc.Node)],e.prototype,"winAniNode",void 0),__decorate([U(cc.Node)],e.prototype,"winCircleMask",void 0),__decorate([U(cc.Node)],e.prototype,"winSpParent",void 0),__decorate([U(cc.Node)],e.prototype,"winSps",void 0),__decorate([U(cc.Node)],e.prototype,"winLight",void 0),__decorate([U(cc.SpriteFrame)],e.prototype,"singleSf",void 0),__decorate([U(cc.Label)],e.prototype,"levelLbl",void 0),__decorate([U(cc.Node)],e.prototype,"clockWarn",void 0),__decorate([U(cc.Node)],e.prototype,"norClock",void 0),__decorate([U(cc.Node)],e.prototype,"speClock",void 0),__decorate([U(cc.Label)],e.prototype,"clockLbl",void 0),__decorate([U(cc.Label)],e.prototype,"clockLbl2",void 0),__decorate([U(cc.Node)],e.prototype,"tipActNode",void 0),__decorate([U(cc.Node)],e.prototype,"tipUnActNode",void 0),__decorate([U(cc.Node)],e.prototype,"shareBtn",void 0),__decorate([U(cc.Sprite)],e.prototype,"shareIcon",void 0),__decorate([U(cc.Label)],e.prototype,"shareLbl",void 0),__decorate([U(cc.Label)],e.prototype,"noticeLbl",void 0),__decorate([U(cc.Animation)],e.prototype,"noticeAni",void 0),__decorate([U(cc.Label)],e.prototype,"random_noticeLbl",void 0),__decorate([U(cc.Animation)],e.prototype,"random_noticeAni",void 0),__decorate([U(cc.Label)],e.prototype,"full_row_colLbl",void 0),__decorate([U(cc.Animation)],e.prototype,"full_row_colAni",void 0),__decorate([U(cc.Node)],e.prototype,"itemSelectEff",void 0),__decorate([U(cc.Sprite)],e.prototype,"itemSelectIcon",void 0),__decorate([U(cc.Label)],e.prototype,"itemSelectLbl",void 0),__decorate([U(cc.Button)],e.prototype,"adGetBtn",void 0),__decorate([U(cc.Label)],e.prototype,"getBtnsp",void 0),__decorate([U(cc.ScrollView)],e.prototype,"rewItems",void 0),__decorate([U(cc.Prefab)],e.prototype,"rewItemPre",void 0),__decorate([U(cc.Node)],e.prototype,"stopPraNode",void 0),__decorate([U(cc.Node)],e.prototype,"heartBgNode",void 0),i=__decorate([V],e)}(cc.Component);i.default=J,cc._RF.pop()},{Creator:"Creator",bagMgr:"bagMgr",banner:"banner",cfgMgr:"cfgMgr",challengeMgr:"challengeMgr",com:"com",evts:"evts",festivalMgr:"festivalMgr",global:"global",grid:"grid",heart:"heart",idx:"idx",item:"item",levelMgr:"levelMgr",mySafeArea:"mySafeArea",pConst:"pConst",pInfo:"pInfo",panelMgr:"panelMgr",random_notice:"random_notice",res:"res",sound:"sound",taskMgr:"taskMgr",tipMgr:"tipMgr",uData:"uData",uvAni:"uvAni",vb:"vb"}],global:[function(t,e,i){"use strict";cc._RF.push(e,"c75109C1jBJX7wBq6ETFM3I","global"),Object.defineProperty(i,"__esModule",{value:!0}),i.OssConfig=i.headImgExt=void 0;var o=t("sound");cc.Button.prototype.tE=cc.Button.prototype._onTouchEnded,cc.Button.prototype.cS=!0,cc.Button.prototype._onTouchEnded=function(t){this.interactable&&this.enabledInHierarchy&&this._pressed&&this.cS&&o.default.ins.play(o.default.CLICK),this.tE(t)},cc.macro.ENABLE_MULTI_TOUCH=!0,cc.macro.ENABLE_WEBGL_ANTIALIAS=!0,i.headImgExt=".head",cc.assetManager.downloader.register(i.headImgExt,function(t,e,i){i(null,t)}),cc.assetManager.parser.register(i.headImgExt,function(t,e,i){var o=new Image;function n(){o.removeEventListener("load",n),o.removeEventListener("error",a),i&&i(null,o)}function a(){o.removeEventListener("load",n),o.removeEventListener("error",a),i&&i(new Error(t))}return"file:"!==window.location.protocol&&(o.crossOrigin="anonymous"),o.addEventListener("load",n),o.addEventListener("error",a),o.src=t,o}),cc.assetManager.factory.register(i.headImgExt,function(t,e,i,o){var n=null,a=null;try{(n=new cc.Texture2D)._uuid=t,n._nativeUrl=t,n._nativeAsset=e}catch(r){a=r}o&&o(a,n)});var n=function(){function t(){}return t._baseUrl="https://tjkj300.oss-cn-shenzhen.aliyuncs.com/web/sudoku/",t.configUrl=t._baseUrl+"config.json",t.configDevUrl=t._baseUrl+"config-dev.json",t.levelUrl=t._baseUrl+"level/",t.chapterUrl=t._baseUrl+"chapter/",t.jigswawUrl=t._baseUrl+"jigsaw/",t.challengeUrl=t._baseUrl+"challenge/",t.challengeWormUrl=t._baseUrl+"challenge/worm/",t.skinUrl=t._baseUrl+"skin/",t.skinConfigUrl=t._baseUrl+"skin/cfg/config.json",t}();i.OssConfig=n;var a=function(){function t(){}return t.getCharXOffset=function(){return 0},t.chapterCount=18,t.jisawCount=40,t.loadToRace=0,t.challengeLv=0,t.isPopNewGift=!1,t.twoDaysLeft=!1,t.loadCb=!1,t}();i.default=a,cc._RF.pop()},{sound:"sound"}],grid:[function(t,e,i){"use strict";cc._RF.push(e,"0adafKMQFRHBqpLMtwJNSJZ","grid"),Object.defineProperty(i,"__esModule",{value:!0}),i.GridState=void 0;var o,n=t("evts"),a=t("sound"),r=cc._decorator,s=r.ccclass,c=r.property;(o=i.GridState||(i.GridState={}))[o.empty=0]="empty",o[o.rightTile=1]="rightTile",o[o.wrongTile=2]="wrongTile",o[o.rightCross=3]="rightCross",o[o.wrongCross=4]="wrongCross";var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.emptyNode=null,e.itemTipNode=null,e.itemTipAni=null,e.stateNodes=[],e.anis=[],e.crossShineNode=null,e.crossShineAni=null,e.norSf=null,e.tileSp=null,e.tileHLSp=null,e.isEmpty=!0,e}return __extends(e,t),e.prototype.onLoad=function(){for(var t=function(t){t.on(cc.Animation.EventType.FINISHED,function(){t.node.active=!1},e)},e=this,i=0,o=this.anis;i<o.length;i++)t(o[i])},e.prototype.shine=function(){if(this.isEmpty){var t=this.crossShineNode;(t.active=!t.active)&&this.crossShineAni.play()}},e.prototype.init=function(t){this.isRight=t>0?1:0},e.prototype.initType=function(t,e){var i=t||this.norSf;this.tileSp.spriteFrame=this.tileHLSp.spriteFrame=i,e&&(this.itemTipNode.getComponent(cc.Sprite).spriteFrame=e)},e.prototype.select=function(t,e){if(void 0===e&&(e=!1),this.isEmpty){this.isEmpty=!1,this.emptyNode.active=this.crossShineNode.active=!1,this.itemTipNode&&(this.itemTipNode.active=!1),this.unschedule(this.tipShine);var i=this.isRight,o=0;e||(o=(t<<1)+i);var r=this.stateNodes[o];r.active=!0,r.getComponent(cc.Animation).play(),e||3==o||a.default.ins.play(0==o?a.default.RIGHT:a.default.ERROR),this.aniIdx=o<2?0:1,n.default.opE.emit({action:n.default.UPDATESCORE}),e||1!=o&&2!=o||n.default.opE.emit({action:n.default.LOSEHEART,data:this.node.position})}},e.prototype.playWormAni=function(t){this.isEmpty||cc.tween(this.node).delay(t).to(7/30,{scale:1.5}).to(5/30,{opacity:0}).start()},e.prototype.playItemTip=function(t){if(this.isEmpty){var e=this.itemTipNode;this.unschedule(this.tipShine),e.active=t,t?this.scheduleOnce(this.tipShine,2*Math.random()):(this.itemTipAni.stop(),this.itemTipNode.opacity=0)}},e.prototype.tipShine=function(){this.isEmpty?(this.itemTipNode.active=!0,this.itemTipAni.play()):this.unschedule(this.tipShine)},e.prototype.playHL=function(t){this.isEmpty||(this.unschedule(this._playHL),this.scheduleOnce(this._playHL,t))},e.prototype._playHL=function(){var t=this.anis[this.aniIdx];t.node.active=!0,t.play()},e.prototype.playShow=function(t){cc.tween(this.node).delay(6*(Math.random()+1.5)/60).to(.1,{scale:t+.2}).to(.05,{scaleX:t-.1,scaleY:t-.3}).to(.05,{scaleX:t+.1,scaleY:t+.1}).to(.05,{scale:t}).start()},e.prototype.playFallDown=function(){var t=this;cc.tween(this.node).by(.1,{angle:60*Math.random()-30}).to(1,{y:-1e3},{easing:"quadOut"}).call(function(){t.node.destroy()}).start()},e.prototype.playWalk=function(t){var e=this.node,i=e.scale,o=cc.tween(e).to(.1,{position:t}),n=cc.tween(e).to(.05,{scale:i-.4},{easing:"cubicOut"}).to(.1,{scale:i},{easing:"cubicIn"});cc.tween(e).delay(6*(Math.random()+.5)/60).parallel(o,n).start()},__decorate([c(cc.Node)],e.prototype,"emptyNode",void 0),__decorate([c(cc.Node)],e.prototype,"itemTipNode",void 0),__decorate([c(cc.Animation)],e.prototype,"itemTipAni",void 0),__decorate([c([cc.Node])],e.prototype,"stateNodes",void 0),__decorate([c([cc.Animation])],e.prototype,"anis",void 0),__decorate([c(cc.Node)],e.prototype,"crossShineNode",void 0),__decorate([c(cc.Animation)],e.prototype,"crossShineAni",void 0),__decorate([c(cc.SpriteFrame)],e.prototype,"norSf",void 0),__decorate([c(cc.Sprite)],e.prototype,"tileSp",void 0),__decorate([c(cc.Sprite)],e.prototype,"tileHLSp",void 0),__decorate([s],e)}(cc.Component);i.default=l,cc._RF.pop()},{evts:"evts",sound:"sound"}],guide:[function(t,e,i){"use strict";cc._RF.push(e,"a0385aQUj5Mn4U3i4O115Wr","guide"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("res"),a=t("sound"),r=t("vb"),s=t("grid"),c=t("global"),l=t("pInfo"),d=t("game"),u=cc._decorator,p=u.ccclass,h=u.property,f=cc.color(252,254,94),g=cc.color(169,109,52,255),v={2e4:"\u6570\u5b57\u4f1a\u544a\u8bc9\u4f60\u4e00\u884c\u4e2d\u6709\u591a\u5c11\u65b9\u5757\u9700\u8981\u6d82\u4e0a\u989c\u8272\u3002\u8bd5\u8bd5\u5427\uff01",20001:"\u592a\u68d2\u4e86\uff01\u5982\u679c\u6709\u591a\u4e2a\u6570\u5b57\uff0c\u90a3\u4e48\u6bcf\u6bb5\u6d82\u8272\u7684\u65b9\u5757\u4e2d\u95f4\u81f3\u5c11\u4f1a\u6709\u4e00\u4e2a\u7a7a\u683c\u3002",20002:"\u987a\u5e8f\u4e5f\u5f88\u91cd\u8981\u3002\u6d82\u8272\u7684\u65b9\u5757\u7684\u4e2a\u6570\u7684\u987a\u5e8f\uff0c\u9700\u8981\u540c\u6570\u5b57\u7684\u987a\u5e8f\u4e00\u81f4\u3002",20003:"\u606d\u559c\uff01\u60a8\u5df2\u5b8c\u6210\u6559\u7a0b\uff01\u8ba9\u6211\u4eec\u53bb\u7ec3\u4e60\u4e00\u4e0b\u5427\uff01"},m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.top=null,e.fadeNode=null,e.fadeAni=null,e.dialogAni=null,e.mapAni=null,e.hintsLbl=[],e.grids=[],e.contentLbl=null,e.glows=[],e.arrows=[],e.arrowTops=[],e.finger=null,e.soundIdx=1,e.emptyArr=[],e.steps=[{data:[1,1,1,1,1],hint:[5],x:[231],width:[472],content:v[2e4]},{data:[1,1,0,1,1],hint:[2,2],x:[99,363],width:[208,208],content:v[20001]},{data:[1,0,1,1,1],hint:[1,3],x:[55,319],width:[120,296],content:v[20002]},{content:v[20003]}],e.curStep=0,e.maxStep=e.steps.length-1,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;c.default.padScale&&(cc.view.setDesignResolutionSize(720,1280,cc.ResolutionPolicy.FIXED_HEIGHT),this.top.node.scale=c.default.padScale),a.default.ins.playBGM(),this.updateView(1),this.fadeAni.on(cc.Animation.EventType.FINISHED,this.stepDone,this),this.mapAni.on(cc.Animation.EventType.FINISHED,this.reCanTouch,this);var e=cc.Node.EventType.TOUCH_START,i=cc.Node.EventType.TOUCH_MOVE,o=cc.Node.EventType.TOUCH_END,r=cc.Node.EventType.TOUCH_CANCEL;this.grids.forEach(function(n){n.on(e,t.touchStart,t),n.on(i,t.touchMove,t),n.on(o,t.touchEnd,t),n.on(r,t.touchEnd,t)}),n.default.ins.lSF("game/normal/top1",this.top),n.default.ins.getBundleByString("prefab").then(function(e){e.load("skin/girl1",cc.Prefab,function(e,i){if(t.node&&!e&&t.node.isValid){var o=cc.instantiate(i);t.dialogAni.node.parent.addChild(o),o.setPosition(250,-251),o.setSiblingIndex(0);var n=t.topGirlSk=o.getComponent(sp.Skeleton);n.animation=d.grilAni.idle,n.setEndListener(t.playGirlEnd.bind(t))}if(e)throw new Error(e.message)})}).catch(function(t){console.error("guide scene girl load fail",t)}),this.preLoad()},e.prototype.playGirlAni=function(t){t!=this.curGirlAni&&this.topGirlSk&&(this.curGirlAni=t,this.topGirlSk.animation=t,(this.topGirlSk.loop=t==d.grilAni.idle)&&(this.curGirlAni=null))},e.prototype.playGirlEnd=function(){this.curGirlAni!=d.grilAni.idle&&(this.curGirlAni=null,this.playGirlAni&&this.playGirlAni(d.grilAni.idle))},e.prototype.touchStart=function(t){var e=t.getLocation();this.chg(e)},e.prototype.touchMove=function(t){var e=t.getLocation();this.chg(e)},e.prototype.touchEnd=function(){this.soundIdx=1},e.prototype.chg=function(t){var e=this,i=this.grids;i.forEach(function(o){if(o.getBoundingBoxToWorld().contains(t)){var n=o.getComponent(s.default);if(n.isRight&&n.isEmpty){r.default.p(r.VEnum3.SHORT),a.default.ins.play("tile_note_"+e.soundIdx),e.soundIdx++,n.select(1);for(var c=e.hintsLbl,l=e.steps[e.curStep].hint,d=0,u=c.length;d<u;d++){var p=c[d].node;if(p.active&&p.color.equals(f)){for(var h=l[d],v=1==d?l[d-1]+1:0,m=0,y=v;y<h+v;y++){var _=i[y].getComponent(s.default);!_.isEmpty&&_.isRight&&m++}m==h&&(p.color=g)}}if(e.curRightCount++,e.curRightCount==e.allRightCount){e.emptyArr.forEach(function(t){i[t].getComponent(s.default).select(0,!0)});for(var b=0;b<5;b++)i[b].getComponent(s.default).playHL(.04*b);e.fadeNode.active=!0,e.fadeAni.play()}}}})},e.prototype.stepDone=function(){this.fadeNode.active=!1,this.finger.active=!1,this.curStep++,this.curStep==this.maxStep&&(this.playGirlAni(d.grilAni.happy),l.default.ins.setGuideDone(),this.getComponent(cc.Animation).play()),this.mapAni.play("mapHide"),o.platform.reportEvent(o.ERepEvt.guide,{step:this.curStep})},e.prototype.updateView=function(t){this.curStep=this.curStep>this.maxStep?this.maxStep:this.curStep;var e=this.curStep,i=this.steps[e],o=i.data,n=i.hint,a=i.content,r=i.x,c=i.width;this.contentLbl.string="        "+a;var l=this.arrows;if(l.forEach(function(t){return t.clear()}),e<this.maxStep){var d=this.grids,u=this.emptyArr;u.length=0;for(var p=0,h=void 0,g=0;g<5;g++){var v=d[g],m=o[g];p+=m,m||(u.push(g),h=v),v.setSiblingIndex(g+2);var y=v.getComponent(s.default);y.init(m),y.isEmpty=!0,y.emptyNode.active=!0,y.stateNodes.forEach(function(t){t.active=!1})}h&&h.setSiblingIndex(0),this.curRightCount=0,this.allRightCount=p;for(var _=this.glows,b=this.arrowTops,S=this.hintsLbl,w=void(g=0),T=n.length;g<2;g++){w=2==e||1==e?1-g:g;var I=_[g],D=l[w],k=b[w],N=S[g];if(I.active=D.node.active=k.active=N.node.active=g<T){N.string=n[g]+"",N.node.setSiblingIndex(0),N.node.color=f,I.x=k.x=r[g],I.width=c[g];var C=D.node.position,M=I.position;D.moveTo(0,0),D.quadraticCurveTo((C.x+M.x)/2,150,M.x,44),D.stroke()}}this.mapAni.play("mapShow")}t||this.dialogAni.play(),this.canTouch=!1},e.prototype.reCanTouch=function(t,e){"mapShow"==e.name?this.canTouch=!0:this.updateView()},e.prototype.onQuit=function(){c.default.byGuide=1,l.chgScene(l.sceneType.game,{gameType:l.gameType.practice})},e.prototype.preLoad=function(){cc.director.preloadScene(l.sceneType.game)},__decorate([h(cc.Sprite)],e.prototype,"top",void 0),__decorate([h(cc.Node)],e.prototype,"fadeNode",void 0),__decorate([h(cc.Animation)],e.prototype,"fadeAni",void 0),__decorate([h(cc.Animation)],e.prototype,"dialogAni",void 0),__decorate([h(cc.Animation)],e.prototype,"mapAni",void 0),__decorate([h([cc.Label])],e.prototype,"hintsLbl",void 0),__decorate([h([cc.Node])],e.prototype,"grids",void 0),__decorate([h(cc.Label)],e.prototype,"contentLbl",void 0),__decorate([h([cc.Node])],e.prototype,"glows",void 0),__decorate([h([cc.Graphics])],e.prototype,"arrows",void 0),__decorate([h([cc.Node])],e.prototype,"arrowTops",void 0),__decorate([h(cc.Node)],e.prototype,"finger",void 0),__decorate([p],e)}(cc.Component);i.default=m,cc._RF.pop()},{game:"game",global:"global",grid:"grid",idx:"idx",pInfo:"pInfo",res:"res",sound:"sound",vb:"vb"}],h5:[function(t,e,i){"use strict";cc._RF.push(e,"c83f1Tg+ndHibVP6V9Bsrr7","h5"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("pConst"),a=t("time"),r=t("uData"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.trackEvent=function(){},e.subscribe=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return new Promise(function(t){t(1)})},e}return __extends(e,t),Object.defineProperty(e.prototype,"appId",{get:function(){return"dev_nonogram"},enumerable:!1,configurable:!0}),e.prototype.string=function(){return n.PFCode.Web},e.prototype.init=function(){var t=new URLSearchParams(location.search),e={};t.forEach(function(t,i){e[i]=t}),r.default.ins.syncLaunchOption({query:e}),this.initListener()},e.prototype.initListener=function(){var t=this;cc.game.on(cc.game.EVENT_SHOW,function(){Math.abs(Date.now()/1e3-t.onHideT)>300?t.syncTime().then(function(t){t&&a.default.ins.sync(t),o.default.plE.emit({onShow:!0})}):o.default.plE.emit({onShow:!0})}),cc.game.on(cc.game.EVENT_HIDE,function(){t.onHideT=a.default.ins.serverTime,o.default.plE.emit({onHide:!0})})},e.prototype.isSwitchedInitd=function(){return!0},e.prototype.login=function(){return Promise.resolve({code:"dev_ceshi"})},e.prototype.getUserInfo=function(){},e.prototype.getStorage=function(t){var e=localStorage.getItem(t);return null==e||""==e?null:JSON.parse(e)},e.prototype.setStorage=function(t,e){localStorage.setItem(t,JSON.stringify(e))},e.prototype.clearStorage=function(){localStorage.clear()},e.prototype.removeStorage=function(t){localStorage.removeItem(t)},e.prototype.trackLogin=function(){},e.prototype.trackUserSet=function(){},e.prototype.trackUserSetOnce=function(){},e.prototype.getSeq=function(){return{type:Math.random()<.5?n.STDSeqType.VIDEO:n.STDSeqType.SHARE,modelId:"",shareGuid:"",forceResult:""}},e.prototype.consumeSeq=function(){return new Promise(function(t){t(1)})},e.prototype.doWatchAD=function(){return new Promise(function(t){t(1)})},e.prototype.doShare=function(){return new Promise(function(t){t(1)})},e.prototype.getSystemData=function(){return n.DefaultSystemInfo},e.prototype.getSwitches=function(){return n.DefaultSDKSwitch},e.prototype.vibrate=function(){},e.prototype.preloadVideo=function(){return!0},e.prototype.showModal=function(){},e.prototype.refreshGame=function(){location.reload()},e.prototype.showLoading=function(){},e.prototype.hideLoading=function(){},e.prototype.log=function(){},e.prototype.getMenuBounding=function(){return null==this.menuBounding&&(this.menuBounding=new cc.Rect(650,0,100,50)),this.menuBounding},e.prototype.createShareImage=function(){return new Promise(function(t){return t("")})},e.prototype.preloadInterstitialAD=function(){},e.prototype.showInterstitialAD=function(){return new Promise(function(t){return t(1)})},e.prototype.canShowBanner=function(){return!1},e.prototype.getBannerSize=function(){return new cc.Size(0,0)},e.prototype.showBanner=function(){},e.prototype.hideBanner=function(){},e.prototype.getSubscribeCnt=function(){return new Promise(function(t){return t(0)})},e.prototype.startVideoRecord=function(){},e.prototype.pauseVideoRecord=function(){},e.prototype.resumeVideoRecord=function(){},e.prototype.stopVideoRecord=function(){},e.prototype.hasVideoRecord=function(){return!1},e.prototype.shareVideoRecord=function(){return Promise.resolve(1)},e.prototype.uploadAdEvent=function(){},e.prototype.addShortcut=function(){},e.prototype.PostMessage=function(){},e.prototype.SetUserCloudStorage=function(){},e.prototype.GetOpenDataContext=function(){},e.prototype.reportEvent=function(){},e.prototype.share=function(){return new Promise(function(t){t(1)})},e.prototype.getUserProfile=function(){},e.prototype.subScriptionUpdate=function(){},e.prototype.getLaunchOptionsSync=function(){return n.DefaultLaunchOptions},e.prototype.payment=function(){return new Promise(function(t){return t(1)})},e}(t("pf").default);i.default=s,cc._RF.pop()},{evts:"evts",pConst:"pConst",pf:"pf",time:"time",uData:"uData"}],head:[function(t,e,i){"use strict";cc._RF.push(e,"bd3b6EvuhVISo+Thy3/ym09","head"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("res"),a=t("global"),r=t("skinMgr"),s=t("pInfo"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.headIcon=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.eventFunc=this.onOperTap.bind(this),o.default.opE.on(this.eventFunc)},e.prototype.onDestroy=function(){o.default.opE.off(this.eventFunc),this.eventFunc=null},e.prototype.onOperTap=function(t){var e;(null==t?void 0:t.action)===o.default.SKIN_CHG&&(null===(e=t.data)||void 0===e?void 0:e.skinId)===r.SkinIdEnum.headFrame&&t.data.isUse&&this.updateHeadFrame()},e.prototype.updateHeadFrame=function(t){var e=t||s.default.ins.getUsingSkin()[r.SkinIdEnum.headFrame];r.default.ins.updateHeadFrame(e,this.bg)},e.prototype.loadHeadImg=function(t,e){var i=this;t?cc.assetManager.loadRemote(t,{ext:a.headImgExt},function(t,e){i.node&&i.node.isValid&&(t?i.setDefaultHead():i.headIcon.spriteFrame=new cc.SpriteFrame(e))}):this.setDefaultHead(),this.updateHeadFrame(e)},e.prototype.setDefaultHead=function(){var t=this,e=this;n.default.ins.getBundleByString("resSps").then(function(i){i.load("common/head_1",cc.SpriteFrame,function(i,o){!i&&t.node&&t.node.isValid&&(e.headIcon.spriteFrame=o)})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})},__decorate([d(cc.Sprite)],e.prototype,"bg",void 0),__decorate([d(cc.Sprite)],e.prototype,"headIcon",void 0),__decorate([l],e)}(cc.Component);i.default=u,cc._RF.pop()},{evts:"evts",global:"global",pInfo:"pInfo",res:"res",skinMgr:"skinMgr"}],heart:[function(t,e,i){"use strict";cc._RF.push(e,"3b20bSJnh5P8p51eQRE+xVD","heart"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.playLose=function(){this.getComponent(cc.Animation).play()},e.prototype.getHeart=function(){var t=this.node;t.getChildByName("noHas").active=!1,t.getChildByName("has").active=!0},__decorate([n],e)}(cc.Component));i.default=a,cc._RF.pop()},{}],hedge:[function(t,e,i){"use strict";cc._RF.push(e,"07d98niZe5NzrFQ7E0lWKMH","hedge"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.getComponent(cc.Animation).on(cc.Animation.EventType.FINISHED,function(){t.node.destroy()},this)},__decorate([n],e)}(cc.Component));i.default=a,cc._RF.pop()},{}],ice:[function(t,e,i){"use strict";cc._RF.push(e,"bc1c1x9AEFHuo0WacUaPgZF","ice"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sps=[],e.sp=null,e.ani=null,e.count=4,e}return __extends(e,t),e.prototype.onLoad=function(){this.ani=this.getComponent(cc.Animation),this.ani.on(cc.Animation.EventType.FINISHED,this.playDone,this)},e.prototype.playDone=function(){0==this.count&&this.node.destroy()},e.prototype.drop=function(){var t=this.count;if(!(t<1))return this.ani.play(),t=this.count=t-1,this.sp.spriteFrame=t>0?this.sps[t-1]:null,t},__decorate([a([cc.SpriteFrame])],e.prototype,"sps",void 0),__decorate([a(cc.Sprite)],e.prototype,"sp",void 0),__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],idx:[function(t,e,i){"use strict";cc._RF.push(e,"b1538WEz6ZDt4+3IBZG199Y","idx"),Object.defineProperty(i,"__esModule",{value:!0}),i.ERepEvt=i.platform=void 0,t("ali"),t("androidP");var o,n=t("h5");t("iosP"),t("qq"),t("tb"),t("tt"),t("vivo"),t("wx"),i.platform||(i.platform=new n.default),(o=i.ERepEvt||(i.ERepEvt={})).firstEtrGame="dadian00001",o.finshGuide="dadian00002",o.maindungeon="dadian00003",o.dungeonReview="dadian00004",o.useItem="dadian00005",o.buyItem="dadian00006",o.buyTimes="dadian00007",o.buyCoins="dadian00008",o.dailyTask="dadian00009",o.raceEnd="dadian000010",o.raceReview="dadian000011",o.challengeCoupon="dadian000012",o.guide="dadian000013",o.gameLoaded="dadian000014",o.login="dadian000015",o.createNewRole="dadian000016",o.beginPractice="dadian000017",o.finishHoleJigsaw="dadian000018",o.partJigsaw="dadian000019",o.fesTaskFinish="dadian000020",o.fesMainPuzzle="dadian000021",o.fesJigNum="dadian000022",o.newGiftGet="dadian000023",o.adMax="dadian000024",o.dailyChallenge="dadian000025",o.applaunchShow="dadian000026",o.reSetData="dadian000027",o.susPayment="dadian000028",o.paymentResult="dadian000029",o.buySkin="dadian000030",o.useSkin="dadian000031",cc._RF.pop()},{ali:"ali",androidP:"androidP",h5:"h5",iosP:"iosP",qq:"qq",tb:"tb",tt:"tt",vivo:"vivo",wx:"wx"}],iosP:[function(t,e,i){"use strict";var o;cc._RF.push(e,"b63a8c4FAtD1LUSpIutFX8H","iosP"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("com"),a=t("pConst"),r=function(t){function e(){var e=t.call(this)||this;return o=jsb.reflection.callStaticMethod,e}return __extends(e,t),Object.defineProperty(e.prototype,"appId",{get:function(){return"6478914767"},enumerable:!1,configurable:!0}),e.prototype.string=function(){return a.PFCode.Ios},e.prototype.vibrate=function(){o("AppController","vibrate:",null)},e.prototype.showLogin=function(e){t.prototype.showLogin.call(this,e),o("AppController","showLogin:",null)},Object.defineProperty(e.prototype,"isLogin",{get:function(){return o("AppController","getOpenId:",null)},enumerable:!1,configurable:!0}),e.prototype.login=function(){return Promise.resolve({code:Date.now()+n.default.ins.rad(1,1e5),openid:o("AppController","getOpenId:",null)})},e.prototype.setCloudData=function(){},e.prototype.doWatchAD=function(){return Promise.resolve()},e.prototype.showLoading=function(){this.isShowLoading||(this.isShowLoading=!0,o("AppController","showLoading:",null))},e.prototype.hideLoading=function(){this.isShowLoading=!1,o("AppController","hideLoading:",null)},e.prototype.showTip=function(t){o("AppController","showTip:",t)},e}(t("nativeP").default);i.default=r,cc._RF.pop()},{com:"com",nativeP:"nativeP",pConst:"pConst"}],item1:[function(t,e,i){"use strict";cc._RF.push(e,"271daYGFwxILLSIwdBLS+j9","item1"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("NumberUtils"),n=t("res"),a=t("mailMgr"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.numLbl=null,e.awardedNode=null,e.key="",e.countStr="",e}return __extends(e,t),e.prototype.init=function(t,e,i){this.key=t,n.default.ins.lSF("item/"+t,this.icon);var r=o.default.FormatCurrency(e);this.countStr=r,this.numLbl.string="x"+e,this.awardedNode.active=i==a.mailState.award},__decorate([c(cc.Sprite)],e.prototype,"icon",void 0),__decorate([c(cc.Label)],e.prototype,"numLbl",void 0),__decorate([c(cc.Node)],e.prototype,"awardedNode",void 0),__decorate([s],e)}(cc.Component);i.default=l,cc._RF.pop()},{NumberUtils:"NumberUtils",mailMgr:"mailMgr",res:"res"}],item:[function(t,e,i){"use strict";cc._RF.push(e,"ab1208U3p1LdY9+tJ9S8YFo","item"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("NumberUtils"),n=t("res"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.numLbl=null,e.numBgNode=null,e.key="",e.count="",e}return __extends(e,t),e.prototype.init=function(t,e){this.key=e,n.default.ins.lSF("item/"+e,this.icon);var i=o.default.FormatCurrency(t.val[e]);this.count=i,this.numLbl.string="x"+i},e.prototype.initByData=function(t,e){var i=this;this.key=t,this.count=e,n.default.ins.lSF("item/"+t,this.icon);var o=this.numLbl.node.width;this.numLbl.string="x"+e,this.scheduleOnce(function(){var t=i.numLbl.node.width-o;i.reNumBg(t)})},e.prototype.reNumBg=function(t){this.numBgNode&&(this.numBgNode.width+=t)},__decorate([s(cc.Sprite)],e.prototype,"icon",void 0),__decorate([s(cc.Label)],e.prototype,"numLbl",void 0),__decorate([s(cc.Node)],e.prototype,"numBgNode",void 0),__decorate([r],e)}(cc.Component);i.default=c,cc._RF.pop()},{NumberUtils:"NumberUtils",res:"res"}],jigMenu:[function(t,e,i){"use strict";cc._RF.push(e,"e8351dgsMZDVIb8DD1BgeAK","jigMenu"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("res"),a=t("cfgMgr"),r=t("lang"),s=t("global"),c=t("jigsawMgr"),l=t("newJigMgr"),d=t("panelMgr"),u=t("tipMgr"),p=cc._decorator,h=p.ccclass,f=p.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icons=[],e.idxLbls=[],e.pieceLbs=[],e.unlockNode=null,e.lockNode=null,e.finishNode=null,e.unPlacedLb=null,e.theme_id=0,e.themeType=1,e}return __extends(e,t),e.prototype.onLoad=function(){o.default.opE.on(this.onOperTap.bind(this))},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.UPDJIGSAWGAME:this.updateView()}},e.prototype.init=function(t,e){var i=this;this.theme_id=t,this.themeType=e,this.idxLbls.forEach(function(e){e.string=t+1+""});var o,a=this.getFinAndAllNum(),r=a[0];a[1],this.pieceLbs.forEach(function(t){t.string=r+"/105"});var d=t+1,u="pintu_"+d+"_1",p="pintu_"+d;1===e?o=c.default.ins:2===e&&(o=l.default.ins,u="fes_"+d+"_1",p="fes_"+d),o.isItemUnlock(t)?this.initUnLock():this.initLocked(),this.IsJigsawCompleted(this.theme_id)&&(u=p),1===e?d<61?n.default.ins.getBundleByString("jigsaw").then(function(t){t.load(u,cc.SpriteFrame,function(t,e){!t&&i.node&&i.node.isValid&&i.icons.forEach(function(t){t.spriteFrame=e})})}).catch(function(t){console.error("RTool.ins.getBundleByString('jigsaw')",t)}):cc.assetManager.loadRemote(s.OssConfig.jigswawUrl+u+".jpg",{ext:s.headImgExt},function(t,e){if(!t&&i.node&&i.node.isValid){var o=new cc.SpriteFrame(e);i.icons.forEach(function(t){t.spriteFrame=o})}}):n.default.ins.getBundleByString("jigsaw").then(function(t){t.load(u,cc.SpriteFrame,function(t,e){!t&&i.node&&i.node.isValid&&i.icons.forEach(function(t){t.spriteFrame=e})})}).catch(function(t){console.error("RTool.ins.getBundleByString('jigsaw')",t)}),this.checkUnPlacedNum()},e.prototype.updateView=function(){this.init(this.theme_id,this.themeType)},e.prototype.initLocked=function(){this.lockNode.active=!0,this.unlockNode.active=!1,this.finishNode.active=!1},e.prototype.initUnLock=function(){this.lockNode.active=!1,this.IsJigsawCompleted(this.theme_id)?this.initComplete():this.initUnComplete()},e.prototype.initComplete=function(){this.unlockNode.active=!1,this.finishNode.active=!0},e.prototype.initUnComplete=function(){this.unlockNode.active=!0,this.finishNode.active=!1},e.prototype.IsJigsawCompleted=function(t){var e;1===this.themeType?e=c.default.ins:2===this.themeType&&(e=l.default.ins);var i=e.checkHasFin(t);if(i)return i;var o=e.getJigsawTilesByIdx(t);if(105==o.length){for(var n=0,a=o;n<a.length;n++){var r=a[n];if(r[0]!=r[1])return!1}return!0}return!1},e.prototype.getFinAndAllNum=function(){var t;1===this.themeType?t=c.default.ins:2===this.themeType&&(t=l.default.ins);for(var e=t.getJigsawTilesByIdx(this.theme_id),i=e.length,o=0,n=0;n<i;n++){var a=e[n];a[0]==a[1]&&o++}return t.checkHasFin(this.theme_id)&&(o=105),[o,i]},e.prototype.checkUnPlacedNum=function(){var t;1===this.themeType?t=c.default.ins:2===this.themeType&&(t=l.default.ins);for(var e=t.getJigsawTilesByIdx(this.theme_id),i=e.length,o=0,n=0;n<i;n++){var a=e[n];a[1]!=a[0]&&o++}t.checkHasFin(this.theme_id)&&(o=0);var r=this.unPlacedLb;o>0?(r.node.parent.active=!0,r.string=o+""):r.node.parent.active=!1},e.prototype.onBtnClick=function(){var t,e,i,o=this.themeType;if(1===o?i=c.default.ins:2===o&&(i=l.default.ins),i.isItemUnlock(this.theme_id))d.default.ins.open("ui/ui_jigsaw",{theme_id:this.theme_id,themeType:this.themeType});else{var n=a.default.serverCfg,s=(null===(e=null===(t=null==n?void 0:n.lock_rules)||void 0===t?void 0:t.main_line_lock)||void 0===e?void 0:e.puzzle_line_val)||0,p=i.isPieceEnough(this.theme_id)?r.lang[30001].format(s):"\u62fc\u56fe\u672a\u89e3\u9501";u.default.ins.showTip(p)}},__decorate([f([cc.Sprite])],e.prototype,"icons",void 0),__decorate([f([cc.Label])],e.prototype,"idxLbls",void 0),__decorate([f([cc.Label])],e.prototype,"pieceLbs",void 0),__decorate([f(cc.Node)],e.prototype,"unlockNode",void 0),__decorate([f(cc.Node)],e.prototype,"lockNode",void 0),__decorate([f(cc.Node)],e.prototype,"finishNode",void 0),__decorate([f(cc.Label)],e.prototype,"unPlacedLb",void 0),__decorate([h],e)}(cc.Component);i.default=g,cc._RF.pop()},{cfgMgr:"cfgMgr",evts:"evts",global:"global",jigsawMgr:"jigsawMgr",lang:"lang",newJigMgr:"newJigMgr",panelMgr:"panelMgr",res:"res",tipMgr:"tipMgr"}],jigsawMgr:[function(t,e,i){"use strict";cc._RF.push(e,"2f97e8To3BGBasqLgXvs1PD","jigsawMgr"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("global"),a=t("pInfo"),r=t("bagMgr"),s=function(){function t(){this.jigsawTileTotal=105,this.localData=null,this.seed=5,this.saveStr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()_+?><{}|[]. \u4ebf'\"\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u4e1c\u897f\u5357\u5317\u4e2d\u767e\u5343\u4e07"}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t)},enumerable:!1,configurable:!0}),t.prototype.getJigsawTilesByIdx=function(t){var e=this.getJigsawTiles()[t]||[],i=r.default.ins.getItemCount("puzzle_pieces"),o=t+1,n=this.getTicketPoolByIdx(t);if(e.length<this.jigsawTileTotal){var a=e.length,s=this.jigsawTileTotal-e.length,c=i-((o-1)*this.jigsawTileTotal+a);if(c>0)for(var l=Math.min(s,c),d=0;d<l;d++){var u=n[a+d];e.push([u,-1])}}return this.setJigsawTilesByIdx(t,e,!1),e},t.prototype.getTicketPoolByIdx=function(t){var e=t+1;this.seed=22+e;var i=[0,1,2,3,4,5,6,7,8,9,10,11,22,33,44,55,66,77,88,99,89,100,91,101,93,102,95,103,97,104,98,87,76,65,54,43,32,21];this.shuffleArray(i),i.length=10;for(var o=[],n=0;n<105;n++)-1==i.indexOf(n)&&o.push(n);return this.shuffleArray(o),i.concat(o)},t.prototype.setJigsawTilesByIdx=function(t,e,i){void 0===i&&(i=!0);for(var o=this.saveStr,n="",r=0,s=e.length;r<s;r++){var c=e[r][1],l="-";-1!=c&&(l=o[c]),n+=l}var d=this.getNewSaveTiles();if(d[t]=n,this.setNewSaveTiles(d),i){var u=[t,n];a.default.ins.setJigTiles(u)}},t.prototype.isItemUnlock=function(t){var e=t*this.jigsawTileTotal,i=r.default.ins.getItemCount("puzzle_pieces"),o=a.default.ins.isJigsawLocked();return(0==t||!o)&&i>e},t.prototype.isPieceEnough=function(t){var e=t*this.jigsawTileTotal;return r.default.ins.getItemCount("puzzle_pieces")>e},t.prototype.getNowJigsawLv=function(){for(var t=0,e=this.getJigsawTiles().length;t<e;t++)if(!this.IsJigsawCompletedByIdx(t))return t+1},t.prototype.IsJigsawCompletedByIdx=function(t){var e=this.getJigsawTiles()[t];if(105==e.length){for(var i=0,o=e;i<o.length;i++){var n=o[i];if(n[0]!=n[1])return!1}return!0}return!1},t.prototype.getAllTiles=function(){for(var t=0,e=n.default.jisawCount;t<e;t++)this.getJigsawTilesByIdx(t)},t.prototype.getUnPlacedNum=function(){this.getAllTiles();for(var t=this.getJigsawTiles(),e=0,i=0,o=t.length;i<o;i++){var n=t[i];if(!this.checkHasFin(i))for(var a=0,r=n.length;a<r;a++){var s=n[a];s[1]!=s[0]&&e++}}return e},t.prototype.seedRandom=function(){return this.seed=(9301*this.seed+49297)%233280,this.seed/233280},t.prototype.shuffleArray=function(t){for(var e,i=t.length-1;i>0;i--){var o=Math.floor(this.seedRandom()*(i+1));e=[t[o],t[i]],t[i]=e[0],t[o]=e[1]}},t.prototype.getJigsawTiles=function(){var t=this.saveStr,e=a.default.ins.getJigTiles(),i=this.getNewSaveTiles(),o=[],n=i.length;if(n){-1!=e[0]&&(i[e[0]]=e[1]);for(var r=0;r<n;r++){var s=i[r];if(s){for(var c=this.getTicketPoolByIdx(r),l=[],d=0,u=s.length;d<u;d++){var p=c[d],h=s[d],f=[p,t.indexOf(h)];l.push(f)}o.push(l)}}}else for(var g=[],v=(r=0,(o=this.getOldSaveTiles()).length);r<v;r++){for(var m=o[r],y="",_=(d=0,m.length);d<_;d++){var b=m[d][1],S="-";-1!=b&&(S=t[b]),y+=S}g.push(y),this.setNewSaveTiles(g),this.setOldSaveTiles([])}return o},t.prototype.getNewSaveTiles=function(){var t=this.getLocalJigData().jigTils;return null==t?[]:t},t.prototype.setNewSaveTiles=function(t){this.setLocalJigData({jigTils:t})},t.prototype.getOldSaveTiles=function(){var t=this.getLocalJigData().tiles;return null==t?[]:t},t.prototype.setOldSaveTiles=function(t){this.setLocalJigData({tiles:t})},t.prototype.setLocalJigData=function(t){var e=this.getLocalJigData();this.localData=Object.assign(Object.assign({},e),t),o.platform.setStorage("jigsawData",this.localData)},t.prototype.getLocalJigData=function(){return null==this.localData&&(this.localData=o.platform.getStorage("jigsawData")||{}),this.localData},t.prototype.checkClearData=function(){a.default.ins.getIsClearJigsawData()&&(a.default.ins.setIsClearJigsawData(!1),this.clearJigsawData())},t.prototype.clearJigsawData=function(){this.localData={},o.platform.setStorage("jigsawData",this.localData)},t.prototype.checkSetFin=function(t){this.checkHasFin(t)||this.setFinfishJigsaw(t)},t.prototype.checkHasFin=function(t){return a.default.ins.getHasFinJig()[t]||!1},t.prototype.setFinfishJigsaw=function(t){var e=a.default.ins.getHasFinJig();e[t]=!0,a.default.ins.setHasFinJig(e)},t.prototype.clearFinJig=function(t){var e=a.default.ins.getHasFinJig();e[t]=!1,a.default.ins.setHasFinJig(e)},t.prototype.resetJigByIdx=function(t){for(var e=this.getJigsawTilesByIdx(t),i=[],o=0,n=e.length;o<n;o++){var a=e[o];a[1]=-1,i.push(a)}this.setJigsawTilesByIdx(t,i,!1),this.clearFinJig(t)},t}();i.default=s,cc._RF.pop()},{bagMgr:"bagMgr",global:"global",idx:"idx",pInfo:"pInfo"}],jigsaw:[function(t,e,i){"use strict";cc._RF.push(e,"1e254roCXNBXbdO0aWr4kpu","jigsaw"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("res"),r=t("sound"),s=t("time"),c=t("vb"),l=t("cfgMgr"),d=t("lang"),u=t("global"),p=t("bagMgr"),h=t("festivalMgr"),f=t("jigsawMgr"),g=t("newJigMgr"),v=t("panelMgr"),m=t("pInfo"),y=t("loading"),_=t("main"),b=cc._decorator,S=b.ccclass,w=b.property,T=79-34.5*Math.tan(Math.PI/180*30)+.4,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ringNode=null,e.tilePre=null,e.shadow0=null,e.tilesNode=null,e.menuNode=null,e.scrollView=null,e.finImg=null,e.dragTag=null,e.lockNode=null,e.timeLb=null,e.bgBtn=null,e.getLb=null,e.timeAd=null,e.lockImg=null,e.tileLbNode=null,e.cellNode=null,e.cellSpr=null,e.hintNum=null,e.bgNum=null,e.bgNode=null,e.tipLb=null,e.bgBtnNode=null,e.getPieceSp=null,e.btnReset=null,e.jig_2d=null,e.tile_a=null,e.tile_p=[],e.tiles={},e.tiles_idle=[],e.isAllRight=!1,e.is_hinting=!1,e.idle_tile_select=null,e.tileSelect=null,e.tilePosId=-1,e.scroll_dir=0,e.drag_tile=null,e.dragPutPosId=-1,e.guideF=null,e.isUnlock=!1,e.theme_id=-1,e.is_init=!1,e.jigTiles=[],e.defaultShowTime=30,e.showBgEndTime=0,e.adMaxTime=5,e.adMaxTime2=5,e.themeType=1,e.eventFunc=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t,e,i=l.default.serverCfg,n=(null===(e=null===(t=null==i?void 0:i.lock_rules)||void 0===t?void 0:t.main_line_lock)||void 0===e?void 0:e.puzzle_line_val)||0;this.tipLb.string=d.lang[30001].format(n);for(var a=0,r=i.props.set;a<r.length;a++){var s=r[a];"puzzle_background"==s.key?s.limit_time&&(this.defaultShowTime=s.limit_time,this.timeLb.node.active=!1,this.timeAd.active=!0):"puzzle_pieces"==s.key?s.daily_limit_times&&(this.adMaxTime=Number(s.daily_limit_times)||5):"newYear_pieces"==s.key&&s.daily_limit_times&&(this.adMaxTime2=Number(s.daily_limit_times)||5)}this.eventFunc=this.onOperTap.bind(this),o.default.opE.on(this.eventFunc),this.scrollView._registerEvent=function(){},this.scrollView._unregisterEvent=function(){},this.tile_a=this.tilesNode,this.scrollView.node.on("scrolling",this.chgVisItems,this),this.tileLbNode.active=!1,this.btnReset.active=!1},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.UPDJIGSAWGAME:this.updateView();break;case o.default.UPD_PANEL:case o.default.UPD_MAIN_RED:this.upItemNum()}},e.prototype.start=function(){this.dragTag.zIndex=-1e3,this.dragTag.active=!1},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.upItemNum=function(){1===this.themeType?this.initGetTime():2===this.themeType&&this.initGetTime2(),this.hintNum.string=p.default.ins.getItemCount("puzzle_notice")+"",this.bgNum.string=p.default.ins.getItemCount("puzzle_background")+""},e.prototype.updateView=function(){var t;1===this.themeType?t=f.default.ins:2===this.themeType&&(t=g.default.ins),this.jigTiles=t.getJigsawTilesByIdx(this.theme_id),this.scrollView.content.removeAllChildren(),this.tiles_idle=[],this.RefreshIdleItems(!0),this.isUnlock=t.isItemUnlock(this.theme_id),this.isUnlock?this.initUnLock():this.initLocked(),this.upItemNum()},e.prototype.getIsUnlock=function(){return this.isUnlock},e.prototype.initItem=function(t,e){var i,o=this;this.themeType=e,this.theme_id=t;var n=t+1,r="puzzle_pieces",s="pintu_"+n+"_1";1===e?(i=f.default.ins,this.showBgEndTime=m.default.ins.getJigsawBgEndTimesByIdx(t),this.bgBtnNode.active=!0):2===e&&(i=g.default.ins,this.showBgEndTime=m.default.ins.getNewJigBgEndTimesByIdx(t),r="newYear_pieces",s="fes_"+n+"_1",this.bgBtnNode.active=!1),this.jigTiles=i.getJigsawTilesByIdx(t),this.isUnlock=i.isItemUnlock(t),this.isUnlock?this.initUnLock():this.initLocked(),!this.isUnlock&&i.isPieceEnough(t)?this.tipLb.node.active=!0:this.tipLb.node.active=!1,this.upItemNum(),1===e&&(n<61?a.default.ins.getBundleByString("jigsaw").then(function(t){t.load(s,cc.SpriteFrame,function(t,e){!t&&o.node&&o.node.isValid&&(o.lockImg.spriteFrame=e)})}).catch(function(t){console.error("RTool.ins.getBundleByString('jigsaw')",t)}):cc.assetManager.loadRemote(u.OssConfig.jigswawUrl+"pintu_"+n+"_1.jpg",{ext:u.headImgExt},function(t,e){!t&&o.node&&o.node.isValid&&(o.lockImg.spriteFrame=new cc.SpriteFrame(e))})),a.default.ins.getBundleByString("resSps").then(function(t){t.load("item/"+r,cc.SpriteFrame,function(t,e){!t&&o.node&&o.node.isValid&&(o.getPieceSp.spriteFrame=e)})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})},e.prototype.initGetTime=function(){var t=m.default.ins.getJigsawAdTimes(),e=this.adMaxTime-t;this.getLb.string=e+""},e.prototype.initGetTime2=function(){var t=m.default.ins.getNewJigAdTimes(),e=this.adMaxTime2-t;this.getLb.string=e+""},e.prototype.initLocked=function(){this.finImg.node.active=!0,this.menuNode.active=!1,this.lockNode.active=!0,this.lockImg.node.active=!0,this.bgNode.y=326,this.bgNode.height=790},e.prototype.initUnLock=function(){var t=this,e=this.theme_id+1,i="pintu_"+e;1===this.themeType?e<61?a.default.ins.getBundleByString("jigsaw").then(function(e){e.load(i,cc.Texture2D,function(e,i){!e&&t.node&&t.node.isValid&&t.initUnlockWithImg(i)})}).catch(function(t){console.error("RTool.ins.getBundleByString('jigsaw')",t)}):cc.assetManager.loadRemote(u.OssConfig.jigswawUrl+"pintu_"+e+".jpg",{ext:u.headImgExt},function(e,i){!e&&t.node&&t.node.isValid&&t.initUnlockWithImg(i)}):2===this.themeType&&(i="fes_"+e,a.default.ins.getBundleByString("jigsaw").then(function(e){e.load(i,cc.Texture2D,function(e,i){!e&&t.node&&t.node.isValid&&t.initUnlockWithImg(i)})}).catch(function(t){console.error("RTool.ins.getBundleByString('jigsaw')",t)}))},e.prototype.initUnlockWithImg=function(t){this.jig_2d=t,this.finImg.spriteFrame=new cc.SpriteFrame(t),this.lockNode.active=!1,this.menuNode.active=!0,this.lockImg.node.active=!1,this.isAllRight=this.IsJigsawCompleted(this.theme_id),this.isAllRight?this.initComplete():this.initUnComplete()},e.prototype.initComplete=function(){var t;this.lockImg.node.active=!1,this.finImg.node.active=!0,this.scrollView.node.parent.active=!1,this.menuNode.active=!1,this.lockNode.active=!1,this.btnReset.active=!0,this.bgNode.y=326,this.bgNode.height=790,1===this.themeType?t=f.default.ins:2===this.themeType&&(t=g.default.ins),t.checkSetFin(this.theme_id)},e.prototype.initUnComplete=function(){this.is_init||(this.lockImg.node.active=!1,this.scrollView.node.parent.active=!0,this.menuNode.active=!0,this.lockNode.active=!1,this.initTilePos(),this.initAroundTiles(),this.InitTiles(),this.RefreshIdleItems(!0),this.isShowBging(),this.is_init=!0,this.bgNode.y=396,this.bgNode.height=960);var t=this.showBgEndTime-s.default.ins.serverTime||Math.floor((new Date).getTime()/1e3);this.lockNode.active=!(t<0)},e.prototype.isShowBging=function(){(this.showBgEndTime-s.default.ins.serverTime||Math.floor((new Date).getTime()/1e3))<0?(this.finImg.node.active=!1,this.lockNode.active=!1,this.bgBtn.enabled=!0,this.timeLb.string=this.defaultShowTime+"s",this.timeLb.node.active=!1,this.timeAd.active=!0,this.unschedule(this.beginShow)):(this.bgBtn.enabled=!1,this.finImg.node.active=!0,this.lockNode.active=!0,this.timeAd.active=!1,this.timeLb.node.active=!0,this.schedule(this.beginShow,1),this.beginShow())},e.prototype.lockedToUnlock=function(){this.isUnlock||(this.isUnlock=!0,this.lockNode.active=!1,this.initUnLock())},e.prototype.InitTiles=function(){for(var t=0,e=this.jigTiles;t<e.length;t++){var i=e[t],o=i[0],n=i[1];-1!=n&&this.cTile(o,n,!1)}},e.prototype.addAroundTiles=function(t,e,i,o){var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=this.shadow0,n.position=cc.v3(t+-4,e+-9),n.zIndex=-1,n.parent=this.tile_a;var a=this.cTileSprite(i,o);a.position=cc.v3(t,e),a.scale=1.02,a.zIndex=1,a.parent=this.tile_a},e.prototype.initAroundTiles=function(){for(var t=0;t<11;t++){var e=this.getTilePos(t);this.addAroundTiles(e.x+49.5,-e.y-44.5+69,e.x,e.y-69)}for(var i=[99,89,100,91,101,93,102,95,103,97,104],o=0;o<11;o++)t=i[o],e=this.getTilePos(t),this.addAroundTiles(e.x+49.5,-e.y-44.5-69,e.x,e.y+69);var n=[0,11,22,33,44,55,66,77,88,99,99];for(o=0;o<11;o++)t=n[o],e=this.getTilePos(t),10==o?this.addAroundTiles(e.x+49.5-T,-e.y-44.5-34.5,e.x-T,e.y+34.5):this.addAroundTiles(e.x+49.5-T,-e.y-44.5+34.5,e.x-T,e.y-34.5);var a=[10,21,32,43,54,65,76,87,98,104,104];for(o=0;o<11;o++)t=a[o],e=this.getTilePos(t),10==o?this.addAroundTiles(e.x+49.5+T,-e.y-44.5-34.5,e.x+T,e.y+34.5):this.addAroundTiles(e.x+49.5+T,-e.y-44.5+34.5,e.x+T,e.y-34.5)},e.prototype.cIdleTile=function(t){var e=new cc.Node(t.toString());e.scale=1.01,e.setContentSize(cc.size(79,69)),this.addTileShadow(e);var i=this.getTilePos(t);return this.cTileSprite(i.x,i.y).parent=e,e},e.prototype.RefreshIdleItems=function(t,e){if(void 0===e&&(e=!1),!this.isAllRight&&this.jig_2d){for(var i=this.jigTiles,o={},n=0,a=this.tiles_idle;n<a.length;n++)o[(g=a[n]).name]=g;this.tiles_idle=[];for(var r=0,s=0,c=i;s<c.length;s++){var l=c[s],d=l[0];if(-1==l[1]){var u=o[f=d.toString()],p=null;u?(p=u,o[f]=void 0):(p=this.cIdleTile(d),t||(p.opacity=0,cc.tween(p).to(.5,{opacity:255}).start()),p.parent=this.scrollView.content),p.setPosition(50+100*r++,0),this.tiles_idle.push(p)}}var h=Math.max(100*this.tiles_idle.length,this.scrollView.node.getContentSize().width+1);for(var f in this.scrollView.content.setContentSize(cc.size(h,110)),o){var g;(g=o[f])&&g.destroy()}this.chgVisItems()}},e.prototype.chgVisItems=function(){var t=this.scrollView.content,e=t.children;if(0!=e.length)for(var i=t.parent.getContentSize(),o=-i.width/2-50,n=i.width/2+50,a=t.x,r=0,s=e;r<s.length;r++){var c=s[r],l=c.x+a,d=l>=o&&l<=n;c.active=d}},e.prototype.ttIdleTile=function(t){if(this.tiles_idle.length<=0)return null;var e=_.default.ins.getWorldPointByTouch(t),i=this.scrollView.content.convertToNodeSpaceAR(e);if(i.y<-45||i.y>45)return null;for(var o=0,n=this.tiles_idle;o<n.length;o++){var a=n[o],r=a.position;if(i.x>r.x-45&&i.x<r.x+45)return a}return null},e.prototype.tileFlyView=function(t,e){var i=this.cDragTile(e);i.position=t,i.parent=this.node;var o=this.scrollView.node.parent.position;cc.tween(i).to(.5,{position:o}).to(.15,{opacity:0}).start()},e.prototype.cDragTile=function(t){c.default.p(c.VEnum3.SHORT);var e=new cc.Node(t.toString());e.scale=1.01,e.setContentSize(cc.size(79,69)),this.addTileShadow(e);var i=this.getTilePos(t);return this.cTileSprite(i.x,i.y).parent=e,e},e.prototype.setTileVis=function(t,e){t.di.active=e,t.img.active=e},e.prototype.cTile=function(t,e,i){if(void 0===i&&(i=!0),!this.getTileByPos(e)){var o=this.tile_p[e],n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=this.shadow0,n.position=cc.v3(o.x,o.y-7),n.parent=this.tile_a;var a=this.getTilePos(t),r=this.cTileSprite(a.x,a.y);r.position=cc.v3(o.x,o.y),r.scale=1.02,r.zIndex=1,r.parent=this.tile_a,this.tiles[e]={di:n,img:r,tile_id:t},i&&e==t&&(this.playTrueAni(o),c.default.p(c.VEnum3.SHORT)),this.reGuide()}},e.prototype.delTile=function(t){var e=this.tiles[t];e&&(e.di.destroy(),e.img.destroy(),this.tiles[t]=null)},e.prototype.moveTile=function(t,e,i){var o=this.tiles[t];if(o&&o.tile_id==i){var n=this.tile_p[e];o.di.position=cc.v3(n.x,n.y-7),o.img.position=cc.v3(n.x,n.y),this.tiles[e]=o,this.tiles[t]=null,e==i&&(this.playTrueAni(n),c.default.p(c.VEnum3.SHORT))}},e.prototype.getTileByPos=function(t){return this.tiles[t]},e.prototype.cTileSprite=function(t,e){var i=this.jig_2d.width,o=this.jig_2d.height,n=t+10,a=e+10,r=cc.instantiate(this.tilePre);r.getComponent(cc.Sprite).getMaterial(0).setProperty("texture2",this.jig_2d);var s=n/i*255,c=a/o*255,l=cc.color();l.r=s>0?s:0,l.g=c>0?c:0;var d=0;return s>0&&c<=-21?d=51:s>0&&c<=-8?d=102:s<=-18&&c<=-8?d=153:s<=-18&&c>0&&(d=204),l.b=d+5,r.color=l,r},e.prototype.getTilePos=function(t){var e=Math.floor(t/11),i=t%11;t>99&&(i+=t-99);var o=T*i,n=69*e;return i%2==1&&(n+=34.5),cc.v2(o,n)},e.prototype.initTilePos=function(){if(!(this.tile_p.length>0))for(var t=0;t<105;t++){var e=this.getTilePos(t),i=e.x+49.5,o=-e.y-44.5,n=new cc.Node;n.color=cc.color(52,156,193);var a=n.addComponent(cc.Label);a.string=t+"",a.font=y.DEFAULTFONT,n.parent=this.tileLbNode,n.position=cc.v3(i,o+3);var r=new cc.Node;r.addComponent(cc.Sprite).spriteFrame=this.cellSpr,r.scale=.93,r.parent=this.cellNode,r.position=cc.v3(i,o,0),this.tile_p.push(cc.v2(i,o))}},e.prototype.tTilePosID=function(t){var e=_.default.ins.getWorldPointByTouch(t),i=this.tilesNode.convertToNodeSpaceAR(e);if(i.x<=0||i.x>=694||i.y>=0||i.y<=-711)return-1;for(var o=0;o<this.tile_p.length;o++)if(cc.Vec2.distance(i,this.tile_p[o])<=34.5)return o;return-1},e.prototype.onTBe=function(t){if(this.isAllRight||this.is_hinting)return!0;this.tileSelect=null,this.tilePosId=-1,this.idle_tile_select=null,this.drag_tile=null,this.scroll_dir=0;var e=this.tTilePosID(t.touch);if(-1!=e){var i=this.getTileByPos(e);if(i&&i.tile_id!=e)return this.tileSelect=i,this.tilePosId=e,!1}if(this.tiles_idle.length>0){var o=_.default.ins.getWorldPointByTouch(t.touch),n=this.scrollView.node.parent.convertToNodeSpaceAR(o);if(this.scrollView.node.getBoundingBox().contains(n))return this.scrollView._onTouchBegan(t),this.idle_tile_select=this.ttIdleTile(t.touch),this.idle_tile_select&&(this.idle_tile_select.scale=1.01*1.1),!1}return!0},e.prototype.onTM=function(t){if(this.isAllRight||this.is_hinting)return!0;if(0==this.scroll_dir){var e=t.touch,i=e.getStartLocationInView(),o=e.getLocationInView();if(cc.Vec2.distance(i,o)>5){var n=o.sub(i),a=57.2957*Math.atan2(n.y,n.x);a>30&&a<150?this.scroll_dir=2:a<-30&&a>-150?this.scroll_dir=2:a>=-30&&a<=30?this.scroll_dir=1:(a<=-150||a>=150)&&(this.scroll_dir=1),this.tileSelect?this.drag_tile||0==this.scroll_dir||(this.drag_tile=this.cDragTile(this.tileSelect.tile_id),this.drag_tile.scale=.88,this.drag_tile.parent=this.node,this.setTileVis(this.tileSelect,!1)):1==this.scroll_dir?this.idle_tile_select&&(this.idle_tile_select.scale=1.01):2==this.scroll_dir&&this.idle_tile_select&&!this.drag_tile&&(this.drag_tile=this.cDragTile(Number(this.idle_tile_select.name)),this.drag_tile.parent=this.node,this.idle_tile_select.active=!1)}}var r=_.default.ins.getWorldPointByTouch(t.touch),s=this.scrollView.node.parent.convertToNodeSpaceAR(r),c=this.scrollView.node.getBoundingBox().contains(s);if(this.tileSelect||1!=this.scroll_dir||!c||this.scrollView._onTouchMoved(t),this.drag_tile){var l=_.default.ins.getWorldPointByTouch(t.touch),d=this.node.convertToNodeSpaceAR(l);this.drag_tile.position=cc.v3(d.x,d.y+195);var u=this.node.convertToWorldSpaceAR(this.drag_tile.position),p=(i=this.tilesNode.convertToNodeSpaceAR(u),0),h=-1,f=cc.v3();if(i.x>0&&i.x<694&&i.y<0&&i.y>-711){for(var g=this.tile_p.length-1;g>=0;g--)if(f.x=this.tile_p[g].x,f.y=this.tile_p[g].y,-1==h)h=g,p=cc.Vec2.distance(i,f);else{var v=cc.Vec2.distance(i,f);v<p&&(p=v,h=g)}-1!=h&&p>50&&(h=-1)}this.dragPutPosId=h,-1==h?this.dragTag.active=!1:(this.dragTag.active=!0,this.dragTag.position=cc.v3(this.tile_p[h].x,this.tile_p[h].y))}},e.prototype.onTE=function(t){if(this.isAllRight||this.is_hinting)return!0;this.tileSelect||1!=this.scroll_dir||this.scrollView._onTouchEnded(t),this.putDragTile(),this.idle_tile_select&&(this.idle_tile_select.scale=1.01,this.idle_tile_select=null)},e.prototype.onTC=function(t){if(this.isAllRight||this.is_hinting)return!0;this.tileSelect||1!=this.scroll_dir||this.scrollView._onTouchCancelled(t),this.putDragTile(),this.idle_tile_select&&(this.idle_tile_select.scale=1.01,this.idle_tile_select=null)},e.prototype.putDragTile=function(){if(this.drag_tile){var t=Number(this.drag_tile.name);this.dragTag.active=!1;var e=this.drag_tile;if(cc.tween(this.drag_tile).to(.15,{opacity:0}).call(function(){e.destroy()}).start(),this.drag_tile=null,this.is_hinting=!1,this.idle_tile_select){if(this.idle_tile_select.scale=1.01,this.idle_tile_select.active=!0,this.idle_tile_select.opacity=0,cc.tween(this.idle_tile_select).to(.3,{opacity:255}).start(),this.idle_tile_select=null,-1==this.dragPutPosId)return;var i=this.getTileByPos(this.dragPutPosId);return i?void(i.tile_id==this.dragPutPosId||(this.modJigTile(this.theme_id,i.tile_id,-1,!1),this.delTile(this.dragPutPosId),this.modJigTile(this.theme_id,t,this.dragPutPosId),this.cTile(t,this.dragPutPosId),this.RefreshIdleItems(!1,!0))):(this.modJigTile(this.theme_id,t,this.dragPutPosId),this.cTile(t,this.dragPutPosId),this.RefreshIdleItems(!1),void(t==this.dragPutPosId&&this.checkAllR()))}if(this.tileSelect&&(this.setTileVis(this.tileSelect,!0),this.tileSelect=null,this.tilePosId!=this.dragPutPosId)){var o=this.getTileByPos(this.dragPutPosId);if(-1==this.dragPutPosId||o&&o.tile_id==this.dragPutPosId)return this.modJigTile(this.theme_id,t,-1),this.delTile(this.tilePosId),void this.RefreshIdleItems(!1);if(o&&o.tile_id!=this.dragPutPosId){var n=o.tile_id;return this.modJigTile(this.theme_id,o.tile_id,-1,!1),this.delTile(this.dragPutPosId),this.modJigTile(this.theme_id,t,this.dragPutPosId,!1),this.moveTile(this.tilePosId,this.dragPutPosId,t),this.modJigTile(this.theme_id,n,this.tilePosId),this.cTile(n,this.tilePosId),void this.checkAllR()}-1!=this.tilePosId&&this.tilePosId!=this.dragPutPosId&&(this.modJigTile(this.theme_id,t,this.dragPutPosId),this.moveTile(this.tilePosId,this.dragPutPosId,t),t==this.dragPutPosId&&this.checkAllR())}}},e.prototype.OnBtnHint=function(){if(!(this.is_hinting||this.isAllRight||this.tileSelect||this.idle_tile_select)){var t=this.tiles_idle.length>0;if(!t)for(var e in this.tiles){var i=this.tiles[e];if(i&&Number(e)!=i.tile_id){t=!0;break}}t?p.default.ins.getItemCount("puzzle_notice")>0?(p.default.ins.useItem("puzzle_notice"),this._doHint()):v.default.ins.open("ui/ui_getItem",{itemId:"puzzle_notice"}):this.onBtnGet()}},e.prototype._doHint=function(){var t=this;for(var e in this.is_hinting=!1,this.tiles)if(l=this.tiles[e]){var i=Number(e);if(i!=l.tile_id){this.tilePosId=i,this.tileSelect=l,this.dragPutPosId=l.tile_id;break}}if(this.tileSelect){this.drag_tile=this.cDragTile(this.tileSelect.tile_id),this.drag_tile.parent=this.node,this.setTileVis(this.tileSelect,!1);var o=this.tilesNode.convertToWorldSpaceAR(this.tile_p[this.tilePosId]),n=this.node.convertToNodeSpaceAR(o),a=this.tilesNode.convertToWorldSpaceAR(this.tile_p[this.dragPutPosId]),r=this.node.convertToNodeSpaceAR(a);return this.drag_tile.position=cc.v3(n.x,n.y),cc.tween(this.drag_tile).to(.5,{x:r.x,y:r.y}).call(function(){t.putDragTile()}).start(),void(this.is_hinting=!0)}for(var s=0,c=this.tiles_idle;s<c.length;s++){var l=c[s];this.idle_tile_select=l;var d=Number(l.name);this.dragPutPosId=d,this.drag_tile=this.cDragTile(d),this.drag_tile.parent=this.node,n=this.node.convertToNodeSpaceAR(l.convertToWorldSpaceAR(cc.Vec2.ZERO)),l.active||(n.x=this.scrollView.node.parent.x,n.y=this.scrollView.node.parent.y),r=this.node.convertToNodeSpaceAR(this.tilesNode.convertToWorldSpaceAR(this.tile_p[this.dragPutPosId])),this.drag_tile.setPosition(n.x,n.y),cc.tween(this.drag_tile).to(.5,{x:r.x,y:r.y}).call(function(){t.putDragTile()}).start(),this.is_hinting=!0,l.active=!1;break}},e.prototype.getCanHint=function(){for(var t in this.tiles){var e=this.tiles[t];if(e&&Number(t)!=e.tile_id)break}},e.prototype.addTileShadow=function(t){var e=new cc.Node;e.addComponent(cc.Sprite).spriteFrame=this.shadow0,e.position=cc.v3(0,-5),e.parent=t},e.prototype.playTrueAni=function(t){h.default.ins.updPro(h.fesTaskKey.finishPuzzle,1),r.default.ins.play(r.default.FINISH_PUZZLE),1===this.themeType?n.platform.reportEvent(n.ERepEvt.partJigsaw):2===this.themeType&&n.platform.reportEvent(n.ERepEvt.fesJigNum);var e=this.ringNode,i=this.tilesNode.convertToWorldSpaceAR(t),o=this.node.convertToNodeSpaceAR(i);e.active=!0,e.setPosition(o),e.parent=this.node,cc.tween(e).set({scale:.88,opacity:255}).to(.2,{scale:1.2,opacity:0}).call(function(){e.active=!1}).start()},e.prototype.checkAllR=function(){if(!this.isAllRight&&(this.isAllRight=this.IsJigsawCompleted(this.theme_id),this.isAllRight)){this.tilesNode.active=!1,this.finImg.node.active=!0,this.finImg.node.opacity=0,cc.tween(this.finImg.node).to(1,{opacity:255}).start(),this.scrollView.node.active=!1,this.menuNode.active=!1,this.lockNode.active=!1,this.btnReset.active=!0,this.bgNode.y=326,this.bgNode.height=790;var t=this.theme_id+"";n.platform.reportEvent(n.ERepEvt.finishHoleJigsaw,{idx:t});var e=void 0;1===this.themeType?e=f.default.ins:2===this.themeType&&(e=g.default.ins),e.setFinfishJigsaw(this.theme_id),v.default.ins.open("ui/ui_jigFinish",{themeId:this.theme_id,themeType:this.themeType})}},e.prototype.IsJigsawCompleted=function(t){var e;1===this.themeType?e=f.default.ins:2===this.themeType&&(e=g.default.ins);var i=e.checkHasFin(t);if(i)return i;var o=e.getJigsawTilesByIdx(t);if(105==o.length){for(var n=0,a=o;n<a.length;n++){var r=a[n];if(r[0]!=r[1])return!1}return!0}return!1},e.prototype.ShowGuide=function(){},e.prototype.reGuide=function(){this.guideF&&(this.guideF.destroy(),this.guideF=null)},e.prototype.onBtnBg=function(){if(p.default.ins.getItemCount("puzzle_background")>0){p.default.ins.useItem("puzzle_background");var t=s.default.ins.serverTime||Math.floor((new Date).getTime()/1e3);this.showBgEndTime=this.defaultShowTime+t,1===this.themeType?m.default.ins.setJigsawBgEndTimesByIdx(this.theme_id,this.showBgEndTime):2===this.themeType&&m.default.ins.setNewJigBgEndTimesByIdx(this.theme_id,this.showBgEndTime),this.bgBtn.enabled=!1,this.finImg.node.active=!0,this.lockNode.active=!0,this.timeAd.active=!1,this.timeLb.node.active=!0,this.schedule(this.beginShow,1)}else v.default.ins.open("ui/ui_getItem",{itemId:"puzzle_background"})},e.prototype.beginShow=function(){var t=s.default.ins.serverTime||Math.floor((new Date).getTime()/1e3),e=this.showBgEndTime-t;if(e<0)return this.finImg.node.active=!1,this.lockNode.active=!1,e=30,this.bgBtn.enabled=!0,this.timeLb.string=this.defaultShowTime+"s",this.timeLb.node.active=!1,this.timeAd.active=!0,void this.unschedule(this.beginShow);this.timeLb.string=e+"s"},e.prototype.onBtnGet=function(){1===this.themeType?v.default.ins.open("ui/ui_getItem",{itemId:"puzzle_pieces"}):2===this.themeType&&v.default.ins.open("ui/ui_getItem",{itemId:"newYear_pieces"})},e.prototype.onBtnLb=function(){this.tileLbNode.active=!this.tileLbNode.active},e.prototype.onBtnReset=function(){v.default.ins.open("ui/ui_jigTip",{okCb:this.resetItem.bind(this)})},e.prototype.resetItem=function(){var t;1===this.themeType?t=f.default.ins:2===this.themeType&&(t=g.default.ins),t.resetJigByIdx(this.theme_id),this.is_init||(this.initTilePos(),this.initAroundTiles(),this.is_init=!0),this.clearTiles(),this.isAllRight=!1,this.tilesNode.active=!0,this.jigTiles=t.getJigsawTilesByIdx(this.theme_id),this.scrollView.content.removeAllChildren(),this.tiles_idle.length=0,this.RefreshIdleItems(!0),this.lockImg.node.active=!1,this.scrollView.node.active=!0,this.scrollView.node.parent.active=!0,this.menuNode.active=!0,this.lockNode.active=!1,this.btnReset.active=!1,this.finImg.node.active=!1,this.bgNode.y=396,this.bgNode.height=960,this.upItemNum()},e.prototype.clearTiles=function(){for(var t in this.tiles)this.delTile(t)},e.prototype.modJigTile=function(t,e,i,n){if(void 0===n&&(n=!0),void 0===n&&(n=!0),!(e<0||e>=105||i<-1||i>=105)){for(var a=this.jigTiles,r=0,s=a;r<s.length;r++)if((d=s[r])[1]==i&&-1!=i){i=-1;break}for(var c=0,l=a;c<l.length;c++){var d;if((d=l[c])[0]==e){d[1]=i;break}}if(n){o.default.opE.emit({action:o.default.UPD_MAIN_RED});var u=void 0;1===this.themeType?u=f.default.ins:2===this.themeType&&(u=g.default.ins),u.setJigsawTilesByIdx(this.theme_id,this.jigTiles)}}},e.prototype.onDestroy=function(){o.default.opE.off(this.eventFunc),this.eventFunc=null},__decorate([w(cc.Node)],e.prototype,"ringNode",void 0),__decorate([w(cc.Prefab)],e.prototype,"tilePre",void 0),__decorate([w(cc.SpriteFrame)],e.prototype,"shadow0",void 0),__decorate([w(cc.Node)],e.prototype,"tilesNode",void 0),__decorate([w(cc.Node)],e.prototype,"menuNode",void 0),__decorate([w(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([w(cc.Sprite)],e.prototype,"finImg",void 0),__decorate([w(cc.Node)],e.prototype,"dragTag",void 0),__decorate([w(cc.Node)],e.prototype,"lockNode",void 0),__decorate([w(cc.Label)],e.prototype,"timeLb",void 0),__decorate([w(cc.Button)],e.prototype,"bgBtn",void 0),__decorate([w(cc.Label)],e.prototype,"getLb",void 0),__decorate([w(cc.Node)],e.prototype,"timeAd",void 0),__decorate([w(cc.Sprite)],e.prototype,"lockImg",void 0),__decorate([w(cc.Node)],e.prototype,"tileLbNode",void 0),__decorate([w(cc.Node)],e.prototype,"cellNode",void 0),__decorate([w(cc.SpriteFrame)],e.prototype,"cellSpr",void 0),__decorate([w(cc.Label)],e.prototype,"hintNum",void 0),__decorate([w(cc.Label)],e.prototype,"bgNum",void 0),__decorate([w(cc.Node)],e.prototype,"bgNode",void 0),__decorate([w(cc.Label)],e.prototype,"tipLb",void 0),__decorate([w(cc.Node)],e.prototype,"bgBtnNode",void 0),__decorate([w(cc.Sprite)],e.prototype,"getPieceSp",void 0),__decorate([w(cc.Node)],e.prototype,"btnReset",void 0),__decorate([S],e)}(cc.Component);i.default=I,cc._RF.pop()},{bagMgr:"bagMgr",cfgMgr:"cfgMgr",evts:"evts",festivalMgr:"festivalMgr",global:"global",idx:"idx",jigsawMgr:"jigsawMgr",lang:"lang",loading:"loading",main:"main",newJigMgr:"newJigMgr",pInfo:"pInfo",panelMgr:"panelMgr",res:"res",sound:"sound",time:"time",vb:"vb"}],lang:[function(t,e,i){"use strict";var o;cc._RF.push(e,"5ed20QixH9CRaDPmF/iPEsw","lang"),Object.defineProperty(i,"__esModule",{value:!0}),i.getCoinFor=i.gemeTypeKey=i.reportKey=i.lang=void 0,i.lang={1e4:"\u6682\u65e0\u89c6\u9891",10001:"\u5143\u5b9d\u4e0d\u8db3",10002:"\u4f53\u529b\u4e0d\u8db3",10003:"\u5165\u573a\u5238\u4e0d\u8db3",10004:"\u6682\u672a\u5f00\u653e",10005:"\u6ca1\u6709\u53ef\u5220\u9664\u7684\u90ae\u4ef6",10006:"\u6ca1\u6709\u53ef\u9886\u53d6\u7684\u5956\u52b1",10007:"\u611f\u8c22\u60a8\u7684\u53cd\u9988",10008:"\u8bf7\u8f93\u5165\u53cd\u9988\u5185\u5bb9",10009:"\u4eca\u65e5\u5df2\u8fbe\u4e0a\u9650,\u8bf7\u6ce8\u610f\u4f11\u606f",task_1:"\u9053\u5177\u793c\u5305",task_2:"\u5143\u5b9d\u793c\u5305",task_3:"\u5b8c\u62101\u5173\u79ef\u5206\u8d5b\u5173\u5361",task_4:"\u518d\u5b8c\u621010\u5173\u79ef\u5206\u8d5b\u5173\u5361",task_5:"\u901a\u5173\u6bcf\u65e5\u6311\u6218",task_6:"\u5b8c\u62105\u5c40\u8da3\u5473\u8d5b",task_7:"\u5206\u4eab2\u4f4d\u597d\u53cb,\u83b7\u53d6\u8da3\u5473\u8d5b\u5165\u573a\u5238",30001:"\u8da3\u5473\u8d5b\u79ef\u5206\u6700\u9ad8\u8fbe{0}\u89e3\u9501",40001:"\u901a\u5173\u901f\u5ea6\u8d85\u8fc7\u5168\u56fd{0}%\u7684\u4eba\uff01",40002:"\u60a8\u7684\u8fde\u80dc\u6b21\u6570\u5df2\u8fbe{0}\u6b21",40003:"\u672c\u7ec4\u6392\u540d"},i.reportKey={qw_line_ticket:"\u8da3\u5473\u8d5b\u6311\u6218\u5238",notice:"\u94f2\u5b50",random_notice:"\u70df\u82b1",full_row_col:"\u9489\u8019",puzzle_pieces:"\u62fc\u56fe\u788e\u7247",newYear_pieces:"\u65b0\u5e74\u62fc\u56fe\u788e\u7247",puzzle_notice:"\u62fc\u56fe\u63d0\u793a",puzzle_background:"\u62fc\u56fe\u80cc\u666f"},i.gemeTypeKey={0:"\u4e3b\u7ebf",1:"\u62d3\u5c55\u73a9\u6cd5-\u866b\u5b50",2:"\u8da3\u5473\u8d5b",3:"\u6bcf\u65e5\u6311\u6218",4:"\u7ec3\u4e60\u6a21\u5f0f",5:"\u62fc\u56fe",6:"\u6d3b\u52a8"},(o=i.getCoinFor||(i.getCoinFor={})).Main="\u9996\u9875",o.Item="\u9053\u5177",o.Rebirth="\u590d\u6d3b",cc._RF.pop()},{}],levelItem:[function(t,e,i){"use strict";cc._RF.push(e,"2980049qItDablK/zeCxVwI","levelItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=null,e.lvlLbl=null,e}return __extends(e,t),e.prototype.setLvlLbl=function(t){var e=0;if(1==t.length)-1!=t.indexOf("1")&&(e=-2);else for(var i=0,o=t;i<o.length;i++)"1"==o[i]&&e--;this.lvlLbl.string=t,this.lvlLbl.node.x=e},__decorate([a(cc.Sprite)],e.prototype,"sp",void 0),__decorate([a(cc.Label)],e.prototype,"lvlLbl",void 0),__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],levelMgr:[function(t,e,i){"use strict";cc._RF.push(e,"14951A6fINDx7WHHNNcam8b","levelMgr"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("res"),a=t("uData"),r=t("cfgMgr"),s=t("global"),c=t("pInfo"),l=cc._decorator,d=l.ccclass,u=(l.property,function(){function t(){this._bgId=0,this.oneChapLvlCount=54}var e;return e=t,Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new e)},enumerable:!1,configurable:!0}),t.prototype.getBgId=function(){return 0},t.prototype.init=function(){return Promise.all([this.updateData(),this.updatePracticeData()])},t.prototype.updateData=function(){var t=this,e=c.default.ins.getPuzzleLvl(),i=Math.ceil(e/this.oneChapLvlCount);if(i!=this.bundleId){this.bundleId=i,this.bundle&&(this.bundle.releaseAll(),a.default.ins._setLocalAndCloudData());var o=Math.floor((e-1)/54%4);(isNaN(o)||o<0||o>3)&&(o=0),this._bgId=o,cc.assetManager.loadBundle("resSps",function(t,e){var i=s.default.padScale?"ipad/":"";!t&&e.load("pages/page_level/"+i+"bg"+o,cc.SpriteFrame)});var n=this.bundleName=100+this.bundleId+"";return new Promise(function(e,o){var a=function(){cc.assetManager.loadBundle(n,function(i,n){i?o():(t.bundle=n,n.load("data",cc.BufferAsset,function(i,n){i&&o(),t.data=new Uint32Array(n._buffer),e(1)}))})};i>18?cc.assetManager.loadRemote(s.OssConfig.levelUrl+n+"/data.bin",cc.BufferAsset,function(o,r){o?t.data||(n=101+(i-1)%18+"",a()):(t.data=new Uint32Array(r._buffer),e(1))}):a()})}},t.prototype.updatePracticeData=function(){var t=this;return new Promise(function(e,i){cc.assetManager.loadBundle("practice",function(o,n){o?i():(n.load("data",cc.BufferAsset,function(e,o){e&&i(),t.practiceData=new Uint32Array(o._buffer)}),e(n))})})},t.prototype.updateTmpData=function(t){var e=this;this.tmpBundleId=t;var i=this.tmpBundleName=100+t+"";return new Promise(function(o,n){var a=function(){cc.assetManager.loadBundle(i,function(t,i){t?n():(e.tmpBundle=i,i.load("data",cc.BufferAsset,function(t,i){t&&n(),e.tmpData=new Uint32Array(i._buffer),o(1)}))})};t>18?cc.assetManager.loadRemote(s.OssConfig.levelUrl+i+"/data.bin",cc.BufferAsset,function(n,r){n?e.tmpData||(i=101+(t-1)%18+"",a()):(e.tmpData=new Uint32Array(r._buffer),o(1))}):a()})},t.prototype.getPracticeData=function(){var t=this;return this.practiceData||n.default.ins.getBundleByString("practice").then(function(e){var i=e.get("data",cc.BufferAsset);t.practiceData=new Uint32Array(i._buffer)}).catch(function(t){console.error("RTool.ins.getBundleByString('practice')",t)}),this.practiceData},t.prototype.getPracticeId=function(){return this.practiceId?(this.practiceId++,this.practiceId>this.getPuzzleLvlCount(!0)&&(this.practiceId=2)):this.practiceId=2,this.practiceId},t.prototype.clearPrcitceId=function(){this.practiceId=null},t.prototype.getPuzzleSprFrame=function(t){var e=this;return new Promise(function(i,o){var n=t,a=(n-1)%e.oneChapLvlCount+1+"";n>972?cc.assetManager.loadRemote(s.OssConfig.levelUrl+(100+e.bundleId+"/")+a+".png",cc.SpriteFrame,function(t,e){t?o():i(new cc.SpriteFrame(e))}):e.bundle.load(a,cc.SpriteFrame,function(t,e){t?o():i(e)})})},t.prototype.getPracitceSprfFrame=function(t){return new Promise(function(e,i){n.default.ins.getBundleByString("practice").then(function(o){o.load(t+"",cc.SpriteFrame,function(t,o){t?i():e(o)})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})})},t.prototype.getPuzzleDiff=function(){return this.getPuzzleInfo().diff},t.prototype.getPuzzleLvlCount=function(t){return t?this.getPracticeData()[1]:this.oneChapLvlCount},t.prototype.getPuzzleInfo=function(t,e){var i=t?this.getPracticeData():this.data,o=i[0],n=i[1],a=t&&e?e-1:(c.default.ins.getPuzzleLvl()-1)%this.oneChapLvlCount,r=i[2+n+(0==a?0:i[2+a-1]+a)];return{id:a,type:o,size:255&r,diff:r>>8&255}},t.prototype.getPuzzleData=function(t,e){for(var i=t?this.getPracticeData():this.data,o=i[1],n=t&&e?e-1:(c.default.ins.getPuzzleLvl()-1)%this.oneChapLvlCount,a=0==n?0:i[2+n-1]+n,r=i[2+n]+n,s=i[2+o+a],l=Math.pow(255&s,2),d=2+o+r+1,u=[],p=0,h=2+o+a+1;h<d;h++){for(var f=i[h],g=0;g<32;g++){var v=1<<g&4294967295;if(u[p++]=(f&v)==v?1:0,p==l)break}if(p==l)break}return u},Object.defineProperty(t.prototype,"levelBundle",{get:function(){return this.bundle},enumerable:!1,configurable:!0}),t.prototype.getJigsawIcon=function(t,e){var i=this;return void 0===e&&(e=this.bundleName),new Promise(function(o,n){e>"118"?cc.assetManager.loadRemote(s.OssConfig.chapterUrl+(e+"/")+t+".jpg",cc.SpriteFrame,function(t,e){t?n():(e.packable=!1,o(new cc.SpriteFrame(e)))}):i.getchapterBunder().then(function(i){i.load(e+"/"+t,cc.SpriteFrame,function(t,e){t?n():o(e)})}).catch(function(t){console.error("getchapterBunderErr",t)})})},t.prototype.releaseJigsawIcon=function(t,e){if(void 0===e&&(e=this.bundleName),!(e>"118")){var i=cc.assetManager.getBundle("chapter");if(i){var o=i.get(e+"/"+t,cc.SpriteFrame);o&&cc.assetManager.releaseAsset(o)}}},t.prototype.updateJigsaw=function(t){setTimeout(function(){o.default.opE.emit({action:o.default.UPDJIGSAW})},t)},t.prototype.updJigAndPop=function(t){setTimeout(function(){o.default.opE.emit({action:o.default.FINISH_PUZZLELV})},t)},t.prototype.popFestival=function(t){setTimeout(function(){o.default.opE.emit({action:o.default.POP_FESTIVAL})},t)},t.prototype.getchapterBunder=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return(t=cc.assetManager.getBundle("chapter"))?[3,2]:[4,new Promise(function(t,e){cc.assetManager.loadBundle("chapter",function(i,o){i?e():t(o)})})];case 1:return[2,e.sent()];case 2:return[2,t]}})})},t.prototype.getLevelCost=function(){var t=e.ins.getPuzzleDiff(),i=r.default.serverCfg.difficulty_rules.rules,o=10,n=1;for(var a in i){var s=i[a];if(o=Number(s.times_val),n===t)break;n++}return o},t.prototype.getLevelDiffStr=function(){var t=e.ins.getPuzzleDiff(),i=r.default.serverCfg.difficulty_rules.rules,o="\u5165\u95e8\u96be\u5ea6",n=1;for(var a in i){if(o=i[a].title,n===t)break;n++}return o.slice(0,-2)},e=__decorate([d],t)}());i.default=u,cc._RF.pop()},{cfgMgr:"cfgMgr",evts:"evts",global:"global",pInfo:"pInfo",res:"res",uData:"uData"}],loadingAni:[function(t,e,i){"use strict";var o;cc._RF.push(e,"3d72c1FxE5EP6uGCDaZ+H5L","loadingAni"),Object.defineProperty(i,"__esModule",{value:!0});var n,a=cc._decorator,r=a.ccclass,s=a.property;(n=o||(o={})).to="loadingTo",n.back="loadingBack";var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.ani=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.ani.on(cc.Animation.EventType.FINISHED,this.playEnd,this)},e.prototype.playEnd=function(t,e){var i=this;if(e.name==o.to)cc.director.loadScene(this.newRoot,function(){i.playBack(),i.cb&&i.cb()});else{var n=this.node;cc.game.removePersistRootNode(n),n.destroy()}},e.prototype.playTo=function(t,e,i,n){this.bg.setContentSize(t,e),this.newRoot=i,this.cb=n,this.ani.play(o.to)},e.prototype.playBack=function(){this.ani.play(o.back)},__decorate([s(cc.Node)],e.prototype,"bg",void 0),__decorate([s(cc.Animation)],e.prototype,"ani",void 0),__decorate([r],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],loading:[function(t,e,i){"use strict";cc._RF.push(e,"8c8e4zCZnxPrIZ17IRm3EJP","loading"),Object.defineProperty(i,"__esModule",{value:!0}),i.DEFAULTFONT=void 0;var o=t("errorCode"),n=t("idx"),a=t("pConst"),r=t("request"),s=t("res"),c=t("time"),l=t("uData"),d=t("cfgMgr"),u=t("global"),p=t("bagMgr"),h=t("challengeMgr"),f=t("levelMgr"),g=t("mailMgr"),v=t("skinMgr"),m=t("taskMgr"),y=t("pInfo"),_=cc._decorator,b=_.ccclass,S=_.property;cc.macro.ENABLE_MULTI_TOUCH=!1,cc.assetManager.downloader.maxConcurrency=1e3,cc.assetManager.downloader.maxRequestsPerFrame=1e3;var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.bg2=null,e.logo=null,e.pro=null,e.loginNode=null,e.rDown=null,e.tip=null,e.proLbl=null,e.info=null,e.isFail=!1,e.curPro=0,e.retryTime=1,e.stateStr="\u52a0\u8f7d\u4e2d",e}return __extends(e,t),e.prototype.onLoad=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,o,r,s,c,l;return __generator(this,function(p){switch(p.label){case 0:return u.default.isReStore?(n.platform.reportEvent(n.ERepEvt.reSetData),[2]):(n.platform.reportEvent(n.ERepEvt.applaunchShow),t=cc.view.getVisibleSize(),e=t.width,i=t.height,o=i/e,cc.sys.IPAD==cc.sys.platform&&n.platform.string()==a.PFCode.Bytedance||o<1.78&&(cc.view.setDesignResolutionSize(720,1280,cc.ResolutionPolicy.FIXED_HEIGHT),r=cc.view.getVisibleSize(),s=r.width,c=r.height,o=u.default.padScale=c/s,(l=new cc.Node("bg2")).color=new cc.Color(80,80,80),l.scale=o,this.node.addChild(l),l.setSiblingIndex(0),this.bg2=l.addComponent(cc.Sprite)),[4,d.default.init()]);case 1:return p.sent(),n.platform.init(),[2]}})})},e.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){var t,e=this;return __generator(this,function(o){switch(o.label){case 0:return[4,s.default.ins.lSF("bg/bg",this.bg)];case 1:return t=o.sent(),this.bg2&&t&&(this.bg2.spriteFrame=t),this.loadOther(),u.default.isReStore?[3,3]:[4,Promise.all([this.checkSession().then(function(){return e.preLogin()}).then(function(){e.updatePro(10)}),this.getPrivacy(),this.getOSSConfig(),this.loadFont().then(function(t){e.updatePro(40),i.DEFAULTFONT=t})]).catch(function(){})];case 2:return o.sent(),[3,5];case 3:return[4,Promise.all([this.loadFont().then(function(t){e.updatePro(25),i.DEFAULTFONT=t}),this.restore().then(function(){e.updatePro(25)})])];case 4:o.sent(),o.label=5;case 5:return[4,Promise.all([this.preloadScene(),f.default.ins.init()]).catch(function(){})];case 6:return o.sent(),this.isFail?(this.isFail=!1,this.scheduleOnce(this.start,1),[2]):(this.etr(),[2])}})})},e.prototype.loadOther=function(){var t=this,e=cc.resources;e.load("bg/logo_rc",cc.SpriteFrame,function(e,i){var o=t.logo.node;!e&&o.isValid&&(t.logo.spriteFrame=i)}),e.load("bg/rDown",cc.SpriteFrame,function(e,i){!e&&t.node&&t.node.isValid&&(t.rDown.spriteFrame=i)})},e.prototype.getOSSConfig=function(){return new Promise(function(t){u.default.chapterCount=18,u.default.jisawCount=40,t(1)})},e.prototype.getPrivacy=function(){var t=this;return new Promise(function(e){n.platform.string()==a.PFCode.Wechat||n.platform.isQQ||n.platform.string()==a.PFCode.Alipay?(t.info.active=!0,n.platform.requirePrivacyAuthorize?n.platform.requirePrivacyAuthorize({complete:function(){e(1)}}):e(1)):e(1)})},e.prototype.checkSession=function(){if(n.platform.isNative&&!n.platform.isLogin){var t;n.platform.clearStorage();var e=new Promise(function(e){t=e}),i=this.loginNode;i.active=!0;var o=i.addComponent(cc.Button);return o.transition=cc.Button.Transition.SCALE,o.zoomScale=.9,o.node.on("click",function(){n.platform.showLogin(t)},this),e}return Promise.resolve()},e.prototype.preLogin=function(t){var e=this;return this.loginNode.active=!1,this.pro.node.active=this.tip.node.active=this.proLbl.node.active=!0,new Promise(function(i){u.default.isReStore?(n.platform.initCloud&&n.platform.initCloud()||Promise.resolve()).then(function(t){c.default.ins.sync(t)}).then(function(){e.loginFinally(),i(1)}):null!=n.platform.getStorage("localData")||t?(console.log("\u5f02\u6b65login"),(n.platform.initCloud&&n.platform.initCloud()||Promise.resolve()).then(function(t){return c.default.ins.sync(t),n.platform.getCloudData&&n.platform.getCloudData()||Promise.resolve()}).then(function(t){l.default.ins.onLogin(t),e.loginFinally(),e.login().then(function(){return e.loginFinally}).catch(function(t){return console.error(t)}),i(1)})):(console.log("\u540c\u6b65login"),e.isSync=!0,e.login().then(function(){i(1)}).catch(function(t){return console.error(t)}))})},e.prototype.restore=function(){var t=this;return new Promise(function(e){(n.platform.initCloud&&n.platform.initCloud()||Promise.resolve()).then(function(t){c.default.ins.sync(t)}).then(function(){t.loginFinally(),e(1)})})},e.prototype.login=function(){var t,e=this,i=new Promise(function(e){t=e});return n.platform.login(this.retryTime).then(function(t){return t.code,t.anonymous_code,t.openid,t.unionid,Promise.resolve({status:1,msg:"\u767b\u5f55\u6210\u529f",data:{id:6082641,company_id:8,status:1,nickname:"\u6e38\u5ba20827",avatar:null,reg_time:1711775814e3,platform:"DEV",app_name:"DEV",from_game_uid:0,game_id:10001,login_times:2535,openid:"dev_ceshi",unionid:null,last_login_time:1712485967e3,anonymous_openid:null,area_code:null,mobile:null,appid:"dev_nonogram",qf_game_uid:null,qf_gamer_token:null,is_new_user:0,game_uid:6082641,token:"7d88dab3d09a3529353f2eeba4256732483fffc1",code:"dev_ceshi",session_key:"dev_sk_66127689dfb0e",launch_options:{scene:0,query:[]},system_info:null},code:1,server_time:Date.now()})}).then(function(i){return __awaiter(e,void 0,void 0,function(){var e,s,u,h,f,v,m,_,b,S,w,T,I,D,k,N,C,M=this;return __generator(this,function(R){switch(R.label){case 0:if(0==i.state)throw o.errorCode.LOGIN_STATE_ERR;if(n.platform.hideLoading(),console.log("login\u6210\u529f"),e=r.default.ins,s=l.default.ins,u=i.data,c.default.ins.sync(i.server_time),e.userToken=u&&u.token,e.openId=u&&u.openid,h=s.syncLoginData(u),f=h[0],v=h[1],m=function(){return __awaiter(M,void 0,void 0,function(){var e,i;return __generator(this,function(o){switch(o.label){case 0:return cc.resources.load("game_init_config",function(t,e){var i=e.json;d.default.syncServerCfg(i.data),p.default.ins.initBag(!f&&v),p.default.ins.initBag(!f&&v)}),e=y.default.ins.getAliAddHome(),n.platform.string()===a.PFCode.Alipay&&e?[4,null===(i=n.platform.checkDesktopExist)||void 0===i?void 0:i.call(n.platform)]:[3,2];case 1:o.sent(),o.label=2;case 2:return g.default.ins.getMail(null),this.loginFinally(),t(1),[2]}})})},!f||!v)return[3,7];_=void 0,b=void 0,R.label=1;case 1:return R.trys.push([1,3,,4]),[4,Promise.resolve()];case 2:return(w=R.sent())&&(_=JSON.parse(w.data[0].user_data)||{}),[3,4];case 3:return R.sent(),[3,4];case 4:return n.platform.getCloudData?[4,n.platform.getCloudData()]:[3,6];case 5:b=R.sent(),R.label=6;case 6:if(T=(null==_?void 0:_.puzzleLvl)||0,I=(null===(N=null==_?void 0:_.bag)||void 0===N?void 0:N.puzzle_pieces)||0,D=(null==b?void 0:b.puzzleLvl)||0,k=(null===(C=null==b?void 0:b.bag)||void 0===C?void 0:C.puzzle_pieces)||0,!(S=T>D||I>k||!b?_:b))throw o.errorCode.CANGET_DATE_ERR;return s.onLogin(S),m(),[3,8];case 7:s.onLogin(),m(),R.label=8;case 8:return[2]}})})}).catch(function(){}),i},e.prototype.loginFinally=function(){m.default.initTask(),h.default.ins.initNowMonthData(),v.default.ins.init(),this.sceneName=y.default.ins.getGuideDone()?y.sceneType.main:y.sceneType.guide},e.prototype.loadFont=function(){return new Promise(function(t,e){cc.resources.load("font/font",cc.BitmapFont,function(i,o){i?e(i):t(o)})})},e.prototype.preLoadGuide=function(){cc.director.preloadScene(y.sceneType.guide)},e.prototype.preloadScene=function(){var t=this;return this.stateStr="\u6b63\u5728\u8fdb\u5165\u6e38\u620f",new Promise(function(e,i){cc.Tween.stopAllByTag(886);var o=100-t.curPro;cc.director.preloadScene(t.sceneName,function(e,i){t.updatePro2(t.curPro+e/i*o)},function(t){t?i(t):e(1)})})},e.prototype.updatePro=function(t){this.curPro+=t,cc.Tween.stopAllByTag(886),cc.tween(this.pro).tag(886).to(.1,{progress:this.curPro/100}).start()},e.prototype.updatePro2=function(t){this.pro.progress=t/100},e.prototype.update=function(){this.proLbl.string=this.stateStr+" ("+Math.ceil(100*this.pro.progress)+"%)"},e.prototype.etr=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return u.default.isReStore=null,n.platform.hideLoading(),y.chgScene(this.sceneName,{noAni:!0,cb:function(){cc.assetManager.loadBundle("sound"),cc.assetManager.loadBundle("resSps"),cc.assetManager.loadBundle("prefab",function(t,e){t||y.default.ins.isOpenLock&&e.preload("prefab/page_race")}),cc.resources.release("bg/bg",cc.SpriteFrame),cc.resources.release("bg/logo",cc.SpriteFrame),cc.resources.release("bg/down",cc.SpriteFrame),cc.resources.release("bg/rDown",cc.SpriteFrame),n.platform.reportEvent(n.ERepEvt.gameLoaded)}}),[2]})})},__decorate([S(cc.Sprite)],e.prototype,"bg",void 0),__decorate([S(cc.Sprite)],e.prototype,"logo",void 0),__decorate([S(cc.ProgressBar)],e.prototype,"pro",void 0),__decorate([S(cc.Node)],e.prototype,"loginNode",void 0),__decorate([S(cc.Sprite)],e.prototype,"rDown",void 0),__decorate([S(cc.Label)],e.prototype,"tip",void 0),__decorate([S(cc.Label)],e.prototype,"proLbl",void 0),__decorate([S(cc.Node)],e.prototype,"info",void 0),__decorate([b],e)}(cc.Component);i.default=w,cc._RF.pop()},{bagMgr:"bagMgr",cfgMgr:"cfgMgr",challengeMgr:"challengeMgr",errorCode:"errorCode",global:"global",idx:"idx",levelMgr:"levelMgr",mailMgr:"mailMgr",pConst:"pConst",pInfo:"pInfo",request:"request",res:"res",skinMgr:"skinMgr",taskMgr:"taskMgr",time:"time",uData:"uData"}],mailItem:[function(t,e,i){"use strict";cc._RF.push(e,"df858t+SihDvZmIzPrVMWvv","mailItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("time"),n=t("mailMgr"),a=t("panelMgr"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title=null,e.content=null,e.leftT=null,e.goNode=null,e.mailSpf=[],e.newNode=null,e.qNode=null,e.rewardedNode=null,e.icon=null,e.timeBg=null,e}return __extends(e,t),e.prototype.init=function(t,e){this.id=t;var i=n.default.ins.serverMail[t];if(i){var o=i.title;o.length>8&&(o=o.substring(0,7)+"..."),this.title.string=o;var a=i.msg;a.length>9&&(a=a.substring(0,8)+"..."),this.content.string=a,this.temple=i,this.updateState(e),this.undateTime(),this.schedule(this.undateTime,1,cc.macro.REPEAT_FOREVER)}},e.prototype.updateState=function(t){this.state=t,t==n.mailState.award?this.icon.spriteFrame=this.mailSpf[1]:this.icon.spriteFrame=this.mailSpf[0],this.rewardedNode.active=t==n.mailState.award,this.newNode.active=t==n.mailState.noRead},e.prototype.onOperTap=function(t){null==t||t.action},e.prototype.undateTime=function(){if(this.temple.end_time){var t=this.temple.end_time/1e3-o.default.ins.serverTime;t<0?this.unschedule(this.undateTime):(this.leftT.string="\u5269\u4f59"+o.default.formatDate2Str(t),this.leftT._forceUpdateRenderData(!0),this.timeBg.node.width=this.leftT.node.width+20)}},e.prototype.onEnable=function(){this.goNode.on("click",this.showMailInfo,this)},e.prototype.onDisable=function(){this.goNode.off("click",this.showMailInfo,this),this.unschedule(this.undateTime)},e.prototype.showMailInfo=function(){n.default.ins.serverMail[this.id]&&a.default.ins.open("ui/ui_mailInfo",{id:this.id})},__decorate([c(cc.Label)],e.prototype,"title",void 0),__decorate([c(cc.Label)],e.prototype,"content",void 0),__decorate([c(cc.Label)],e.prototype,"leftT",void 0),__decorate([c(cc.Node)],e.prototype,"goNode",void 0),__decorate([c(cc.SpriteFrame)],e.prototype,"mailSpf",void 0),__decorate([c(cc.Node)],e.prototype,"newNode",void 0),__decorate([c(cc.Node)],e.prototype,"qNode",void 0),__decorate([c(cc.Node)],e.prototype,"rewardedNode",void 0),__decorate([c(cc.Sprite)],e.prototype,"icon",void 0),__decorate([c(cc.Sprite)],e.prototype,"timeBg",void 0),__decorate([s],e)}(cc.Component);i.default=l,cc._RF.pop()},{mailMgr:"mailMgr",panelMgr:"panelMgr",time:"time"}],mailMgr:[function(t,e,i){"use strict";var o;cc._RF.push(e,"77a46/RNnRPC5N1AjkZjR9U","mailMgr"),Object.defineProperty(i,"__esModule",{value:!0}),i.mailState=void 0;var n,a=t("NumberUtils"),r=t("evts"),s=(t("request"),t("time")),c=t("pInfo"),l=t("bagMgr"),d=function(){function t(){if(this._mailInfo={},this._serverMail={},this.isGetting=!1,this.getCb=[],t._ins)throw new Error("mailMgr can only be one\uff01");t._ins=this,this.initMail()}return Object.defineProperty(t,"ins",{get:function(){return t._ins||new t,t._ins},enumerable:!1,configurable:!0}),t.prototype.initMail=function(){this._mailInfo=c.default.ins.Mail,this._mailInfo.mail||(this._mailInfo.mail={}),this._mailInfo.outMail||(this._mailInfo.outMail=[])},t.prototype.saveMail=function(){c.default.ins.Mail=this._mailInfo},Object.defineProperty(t.prototype,"mailInfo",{get:function(){return this._mailInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverMail",{get:function(){return this._serverMail},enumerable:!1,configurable:!0}),t.prototype.getMail=function(t){if(t&&this.getCb.push(t),!this.isGetting){var e=this;if(e.isGetting=!0,(t={status:0,msg:"\u65e0\u90ae\u4ef6\u4fe1\u606f",code:0,server_time:Date.now()})&&t.code&&t.data){var i;if(e.mailInfo.mail instanceof Array)i=e.mailInfo.mail,e.mailInfo.mail={};else if(Object.keys(e._mailInfo.mail).length!==t.data.length){var n=new Set,a=JSON.parse(JSON.stringify(e._mailInfo.mail));for(var r in JSON.parse(JSON.stringify(t.data)).forEach(function(t){n.add(t.id)}),a)n.has(Number(r))||delete e._mailInfo.mail[r]}t.data.forEach(function(t){e._serverMail[t.id]=t,t.end_time<1e3*s.default.ins.serverTime?e._mailInfo.outMail.indexOf(t.id)<0&&e._mailInfo.outMail.push(t.id):e.mailInfo.mail[t.id]||(i&&i.indexOf(t.id)>-1?e.mailInfo.mail[t.id]=i[t.id]:e.mailInfo.mail[t.id]=o.noRead)})}else t&&0===t.code&&(e.mailInfo.mail={});e.saveMail(),function(t){e.getCb.length>0&&e.getCb.forEach(function(e){return e&&e(t)}),e.getCb=[],e.isGetting=!1}(e._serverMail)}},t.prototype.deleteMail=function(t){if(void 0===t&&(t=null),t=a.default.parseNum(t))return this._mailInfo.mail[t]&&delete this._mailInfo.mail[t],-1==this._mailInfo.outMail.indexOf(t)&&this._mailInfo.outMail.push(t),this.saveMail(),!0;for(var e in this._mailInfo.mail)if(this._mailInfo.mail[e]===o.award){var i=a.default.parseNum(e);-1==this._mailInfo.outMail.indexOf(i)&&this._mailInfo.outMail.push(i),this._mailInfo.mail[e]&&delete this._mailInfo.mail[e]}return this.saveMail(),r.default.opE.emit({action:r.default.UPDMAIL,data:{type:"keyDelete"}}),!0},t.prototype.getAward=function(t){if(void 0===t&&(t=null),t)return this._mailInfo.mail[t]!=o.award&&(this._mailInfo.mail[t]=o.award,this.addItem(t),this.saveMail(),!0);var e=!1;for(var i in this._mailInfo.mail)this._mailInfo.mail[i]!==o.award&&(e||(e=!0),this._mailInfo.mail[i]=o.award,this.addItem(i));return e&&this.saveMail(),r.default.opE.emit({action:r.default.UPDMAIL,data:{type:"keyAward"}}),e},t.prototype.readMail=function(t){return void 0===t&&(t=null),!(!t||!this._mailInfo.mail[t]||this._mailInfo.mail[t]!=o.award&&(this._mailInfo.mail[t]!=o.noRead||(this._mailInfo.mail[t]=o.read,this.saveMail(),0)))},t.prototype.addItem=function(t){var e=this.serverMail;if(t){if(!e[t])return;for(var i=JSON.parse(e[t].props),o=Object.keys(i),n=0;n<o.length;n++){var a=o[n];if(i.hasOwnProperty(a)){var r=n===o.length-1;l.default.ins.addItem(a,i[a],!0,r)}}}},t}();i.default=d,(n=o=i.mailState||(i.mailState={}))[n.none=0]="none",n[n.noRead=1]="noRead",n[n.read=2]="read",n[n.award=3]="award",cc._RF.pop()},{NumberUtils:"NumberUtils",bagMgr:"bagMgr",evts:"evts",pInfo:"pInfo",request:"request",time:"time"}],main:[function(t,e,i){"use strict";var o;cc._RF.push(e,"eeafcEk481Ax46HoxkVC6Oy","main"),Object.defineProperty(i,"__esModule",{value:!0});var n,a=t("evts"),r=t("idx"),s=t("pConst"),c=t("request"),l=t("res"),d=t("sound"),u=t("time"),p=t("uData"),h=t("cfgMgr"),f=t("page_jigsaw"),g=t("top"),v=t("global"),m=t("bagMgr"),y=t("challengeMgr"),_=t("jigsawMgr"),b=t("newJigMgr"),S=t("panelMgr"),w=t("shopMgr"),T=t("tipMgr"),I=t("pInfo"),D=cc._decorator,k=D.ccclass,N=D.property;(n=o||(o={})).bottomShowBtns="bottomShowBtns",n.bottomHideBtns="bottomHideBtns";var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blockComp=null,e.pages=null,e.downNode=null,e.downAnis=[],e.top=null,e.lPfb=null,e.powerSp=null,e.camera=null,e.rankBtn1=null,e.btnBgNode=null,e.curPageIdx=2,e.viewPage={},e.viewLPage={},e.viewPageInd=["page_shop","page_jigsaw","page_level","page_challenge","page_race"],e.canUseL=[],e.isAni=!1,e.redLbs=[],e.authorized=!1,e.isWx=!1,e}var i;return __extends(e,t),i=e,e.prototype.onLoad=function(){v.default.padScale&&(cc.view.setDesignResolutionSize(720,1280,cc.ResolutionPolicy.FIXED_HEIGHT),this.btnBgNode.scaleX=v.default.padScale),d.default.ins.playBGM(),this.viewPage.page_level=this.pages.getChildByName("page_level"),(I.default.ins.isMianLocked()||v.default.loadToRace)&&(I.default.ins.isMianLocked()&&(v.default.loadToRace=4),this.viewPage.page_level.active=!1,this.chgPage(v.default.loadToRace)),this.loadDown(),a.default.opE.on(this.onOperTap.bind(this)),i.ins=this,this.upMainRed(),this.isWx=r.platform.string()==s.PFCode.Wechat,this.checkPopNewGift(),this.checkPopPrivacy(),v.default.loadCb||(this.checkSerPack(),v.default.loadCb=!0)},e.prototype.onDestroy=function(){this.hideWxBtns(),i.ins=null,delete i.ins},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case a.default.MAINJUMP:this.jumpToPage(t.data,t.param);break;case a.default.UPD_MAIN_RED:this.upMainRed();break;case a.default.CHECK_WX_BTNS:this.checkGetUserInfo();break;case a.default.HIDE_WX_BTNS:this.hideWxBtns()}},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.jumpToPage=function(t,e){var i=this;if(!this.isAni){var n=this.curPageIdx;if(n!=t){if(3==t)return void T.default.ins.showTip("\u6682\u672a\u5f00\u653e");var a=this.downAnis;a[n].play(o.bottomHideBtns),a[t].play(o.bottomShowBtns),this.curPageIdx=t,cc.Tween.stopAllByTarget(this.pages);var r=t>n?-1:1,s=this.pages.x+cc.view.getVisibleSize().width*r;if(this.viewPage[this.viewPageInd[t]]||this.viewLPage[this.viewPageInd[t]])this.viewPage[this.viewPageInd[t]].x=-s,this.viewPage[this.viewPageInd[t]]&&(this.viewPage[this.viewPageInd[t]].active=!0);else{var c=this.canUseL.shift();c||(c=cc.instantiate(this.lPfb)),c.setPosition(-s,0),this.pages.addChild(c,100),this.loadPage(this.viewPageInd[t],function(e){var o=cc.instantiate(e);i.viewPage[i.viewPageInd[t]]=o,!o.active&&(o.active=!0),o.setPosition(-s,0),i.pages.addChild(o),c.removeFromParent(),i.canUseL.push(c)})}e&&"festival"===e&&this.viewPage[this.viewPageInd[t]]&&this.viewPage[this.viewPageInd[t]].getComponent(f.default).chgToFes(),this.isAni=!0,cc.tween(this.pages).to(.5,{x:s},{easing:this.customEaseInOut}).call(function(){i.viewPage[i.viewPageInd[n]]&&(i.viewPage[i.viewPageInd[n]].active=!1),i.isAni=!1}).start();var l=this.checkGetUserInfo();"page_level"==this.viewPageInd[t]?l&&this.setWxBtnShow1(!0):"page_level"==this.viewPageInd[n]&&(this.setWxBtnShow1(!1),this.isAni=!0)}}},e.prototype.chgPage=function(t){var e=this;if(!this.isAni){var i=this.curPageIdx;if(i!=t){if(3==t)return void T.default.ins.showTip("\u6682\u672a\u5f00\u653e");this.curPageIdx=t;var o=t>i?-1:1,n=this.pages.x+cc.view.getVisibleSize().width*o;if(this.viewPage[this.viewPageInd[t]]||this.viewLPage[this.viewPageInd[t]])this.viewPage[this.viewPageInd[t]].x=-n,this.viewPage[this.viewPageInd[t]]&&(this.viewPage[this.viewPageInd[t]].active=!0);else{var a=this.canUseL.shift();a||(a=cc.instantiate(this.lPfb)),a.setPosition(-n,0),this.pages.addChild(a,100),this.loadPage(this.viewPageInd[t],function(i){var o=cc.instantiate(i);e.viewPage[e.viewPageInd[t]]=o,!o.active&&(o.active=!0),o.setPosition(-n,0),e.pages.addChild(o),a.removeFromParent(),e.canUseL.push(a)})}this.pages.x=n,this.viewPage[this.viewPageInd[i]]&&(this.viewPage[this.viewPageInd[i]].active=!1)}}},e.prototype.lockBtnState=function(t){var e=this.downAnis;e[2].play(o.bottomHideBtns,.05),e[t].play(o.bottomShowBtns,.2)},e.prototype.customEaseInOut=function(t){return t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2},e.prototype.loadDown=function(){var t=this;l.default.ins.getBundleByString("prefab").then(function(e){var i="prefab/down/",o=["btn_quest","btn_jigsaw","btn_puzzle","btn_chanllage","btn_race"];e.loadDir(i,cc.Prefab,function(n){if(!n&&t.node&&t.node.isValid){var a=cc.view.getVisibleSize().width/5,r=2*-a,s=t.downNode;o.forEach(function(o,n){var c=cc.instantiate(e.get(i+o,cc.Prefab)),l=cc.find("img/tip/num",c);t.redLbs.push(l.getComponent(cc.Label)),c.setPosition(r,18),c.setParent(s),c.width=a,r+=a,t.downAnis.push(c.getComponent(cc.Animation)),c.on("click",function(){t.jumpToPage(n)},t),"btn_race"==o&&(t.rankBtn2=c)}),t.createBtns(),(I.default.ins.isMianLocked()||v.default.loadToRace)&&(I.default.ins.isMianLocked()&&(v.default.loadToRace=4),t.lockBtnState(v.default.loadToRace),v.default.loadToRace=0),t.upMainRed()}})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})},e.prototype.loadPage=function(t,e){this.viewLPage[t]||(this.viewLPage[t]=!0,l.default.ins.lPre("prefab/"+t).then(function(t){e&&e(t)}).catch(function(){console.error("getPrefabErr")}))},e.prototype.usePower=function(t,e,i){if(!(t>0)){I.default.ins.addPower(t);var o=this.powerSp,n=o.node,a=n.parent.convertToWorldSpaceAR(n.position);this.node.convertToNodeSpaceAR(a,a);var r=new cc.Node("flyPower");r.addComponent(cc.Sprite).spriteFrame=o.spriteFrame,r.setParent(this.node),this.node.convertToNodeSpaceAR(e,e),e.add(cc.v3(cc.winSize.width/2,cc.winSize.height/2)),cc.tween(r).set({position:a,scale:.8}).parallel(cc.tween(r).by(.2,{scale:.2}).delay(.1).by(.2,{scale:-.2}),cc.tween(r).to(.5,{position:e})).call(function(){r.destroy(),v.default.levelDone?I.chgScene(I.sceneType.game,{gameType:I.gameType.freedom,freedomSize:i}):I.chgScene(I.sceneType.game)}).start()}},e.prototype.getWorldPointByTouch=function(t){var e=cc.Vec2.ZERO;return this.camera.getScreenToWorldPoint(t.getLocation(),e),e},e.prototype.upMainRed=function(){var t,e,i=_.default.ins.getUnPlacedNum()+b.default.ins.getUnPlacedNum(),o=this.redLbs[1];if(o)if(i>0){var n=i>99?"99+":i+"";o.node.parent.active=!0,o.string=n+"",o.node.x=v.default.getCharXOffset(o.string)}else o.node.parent.active=!1;var a=m.default.ins.getItemCount("qw_line_ticket"),r=this.redLbs[4];r&&(a>0?(r.node.parent.active=!0,r.string=a+"",r.node.x=v.default.getCharXOffset(r.string)):r.node.parent.active=!1);var s=(null===(e=null===(t=h.default.serverCfg)||void 0===t?void 0:t.daily_challenge)||void 0===e?void 0:e.open)||50;I.default.ins.getPuzzleLvl()>s&&(y.default.ins.getTodayIsFin(),y.default.ins.getAllMonthRed());var c=w.default.ins.getAllRed(),l=this.redLbs[0];l&&(c>0?(l.node.parent.active=!0,l.string=c+""):l.node.parent.active=!1)},e.prototype.checkPopNewGift=function(){v.default.twoDaysLeft&&(v.default.twoDaysLeft=!1,S.default.ins.open("ui/ui_backReward",null).then(function(){v.default.isPopNewGift=!0}))},e.prototype.checkPopPrivacy=function(){r.platform.isQQ&&p.default.ins.getIsNewUser()&&S.default.ins.open("ui/ui_privacy",{},{MaskNoHide:!0})},e.prototype.checkSerPack=function(){},e.prototype.createBtns=function(){this.isWx&&(this.createUserInfoButton1(),this.createUserInfoButton2())},e.prototype.checkGetUserInfo=function(){if(this.isWx){var t=!1;return(u.default.ins.serverTime||Math.floor((new Date).getTime()/1e3))-I.default.ins.getRankLastTimeData()>=3600&&!this.authorized&&!S.default.ins.hasPop()?(this.showWxBtns(),t=!0):(this.hideWxBtns(),t=!1),t}},e.prototype.showWxBtns=function(){this.isWx&&(this.setWxBtnShow1(!0),this.setWxBtnShow2(!0))},e.prototype.hideWxBtns=function(){this.isWx&&(this.setWxBtnShow1(!1),this.setWxBtnShow2(!1))},e.prototype.setWxBtnShow1=function(t){this.isWx&&null!=this.wxBtn1&&(t?this.wxBtn1.show():this.wxBtn1.hide())},e.prototype.setWxBtnShow2=function(t){this.isWx&&null!=this.wxBtn2&&(t?this.wxBtn2.show():this.wxBtn2.hide())},e.prototype.createUserInfoButton1=function(){var t=this;wx.getSetting({success:function(e){e.authSetting["scope.userInfo"]?(t.authorized=!0,t.updateUserInfo()):(t.wxBtn1=t.authUersInfo(t.rankBtn1),t.wxBtn1.onTap(function(e){var i,o;console.log(JSON.stringify(e)),"getUserInfo:ok"==e.errMsg?(t.setUserInfo1(e.userInfo),null===(i=t.wxBtn2)||void 0===i||i.destroy(),t.wxBtn2=null,null===(o=t.wxBtn1)||void 0===o||o.destroy(),t.wxBtn1=null):(console.log("\u6388\u6743\u5931\u8d25"),t.getFail1())}),t.checkGetUserInfo())}})},e.prototype.createUserInfoButton2=function(){var t=this;wx.getSetting({success:function(e){e.authSetting["scope.userInfo"]?(t.authorized=!0,t.updateUserInfo()):(t.wxBtn2=t.authUersInfo(t.rankBtn2),t.wxBtn2.onTap(function(e){var i,o;console.log(JSON.stringify(e)),"getUserInfo:ok"==e.errMsg?(t.setUserInfo2(e.userInfo),null===(i=t.wxBtn2)||void 0===i||i.destroy(),t.wxBtn2=null,null===(o=t.wxBtn1)||void 0===o||o.destroy(),t.wxBtn1=null):(console.log("\u6388\u6743\u5931\u8d25"),t.getFail2())}),t.checkGetUserInfo())}})},e.prototype.authUersInfo=function(t){var e=wx.getSystemInfoSync(),i=e.screenWidth,o=e.screenHeight,n=0,a=0;if(t&&cc.isValid(t)){var r=e.screenWidth/cc.winSize.width,s=t.convertToWorldSpaceAR(cc.Vec2.ZERO),c=.5*(cc.view.getVisibleSize().height-cc.winSize.height);a=o-(s.y+.5*t.height+c)*r,n=(s.x-.5*t.width)*r,i=t.width*r,o=t.height*r}return wx.createUserInfoButton({type:"text",text:"",style:{left:n,top:a,width:i,height:o,lineHeight:40,backgroundColor:"#00000000",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4,borderColor:"#ffffff",borderWidth:0}})},e.prototype.updateUserInfo=function(){wx.getUserInfo({success:function(t){c.default.ins.updateUserInfo(t.userInfo)}})},e.prototype.setUserInfo1=function(){this.authorized=!0,this.checkGetUserInfo(),S.default.ins.open("ui/ui_rank",null)},e.prototype.setUserInfo2=function(){this.authorized=!0,this.jumpToPage(4)},e.prototype.getFail1=function(){var t=u.default.ins.serverTime||Math.floor((new Date).getTime()/1e3);I.default.ins.setRankLastTimeData(t),this.checkGetUserInfo(),S.default.ins.open("ui/ui_rank",null)},e.prototype.getFail2=function(){var t=u.default.ins.serverTime||Math.floor((new Date).getTime()/1e3);I.default.ins.setRankLastTimeData(t),this.jumpToPage(4)},__decorate([N(cc.BlockInputEvents)],e.prototype,"blockComp",void 0),__decorate([N(cc.Node)],e.prototype,"pages",void 0),__decorate([N(cc.Node)],e.prototype,"downNode",void 0),__decorate([N(g.default)],e.prototype,"top",void 0),__decorate([N(cc.Prefab)],e.prototype,"lPfb",void 0),__decorate([N(cc.Sprite)],e.prototype,"powerSp",void 0),__decorate([N(cc.Camera)],e.prototype,"camera",void 0),__decorate([N(cc.Node)],e.prototype,"rankBtn1",void 0),__decorate([N(cc.Node)],e.prototype,"btnBgNode",void 0),i=__decorate([k],e)}(cc.Component);i.default=C,cc._RF.pop()},{bagMgr:"bagMgr",cfgMgr:"cfgMgr",challengeMgr:"challengeMgr",evts:"evts",global:"global",idx:"idx",jigsawMgr:"jigsawMgr",newJigMgr:"newJigMgr",pConst:"pConst",pInfo:"pInfo",page_jigsaw:"page_jigsaw",panelMgr:"panelMgr",request:"request",res:"res",shopMgr:"shopMgr",sound:"sound",time:"time",tipMgr:"tipMgr",top:"top",uData:"uData"}],mySafeArea:[function(t,e,i){"use strict";cc._RF.push(e,"92030QpL0pPP4FHS+/UWwhC","mySafeArea"),Object.defineProperty(i,"__esModule",{value:!0}),i.getSafeAreaRect=void 0;var o=t("global"),n=cc._decorator,a=n.ccclass,r=(n.property,null);i.getSafeAreaRect=function(){if(!r){var t=cc.sys;if(o.default.padScale)r=new cc.Rect(0,0,720,1560);else if(t.platform==t.ALIPAY_GAME)r=new cc.Rect(0,62,720,1560);else{var e=cc.sys.getSafeAreaRect(),i=e.y;t.platform==t.WECHAT_GAME&&i<62&&(i=62),r=new cc.Rect(e.x,i,e.width,e.height)}}return r};var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateArea=function(){if(cc.sys.platform!=cc.sys.ALIPAY_GAME){var t=this.node.getComponent(cc.Widget);if(t){t.updateAlignment();var e=this.node.position,o=this.node.getAnchorPoint();t.isAlignTop=t.isAlignBottom=t.isAlignLeft=t.isAlignRight=!0;var n=cc.winSize.width,a=cc.winSize.height,r=i.getSafeAreaRect();t.top=a-r.y-r.height,t.bottom=r.y,t.left=r.x,t.right=n-r.x-r.width,t.updateAlignment();var s=this.node.position,c=o.x-(s.x-e.x)/this.node.width,l=o.y-(s.y-e.y)/this.node.height;this.node.setAnchorPoint(c,l),cc._widgetManager.add(t)}}},__decorate([a],e)}(cc.SafeArea);i.default=s,cc._RF.pop()},{global:"global"}],nameFrame:[function(t,e,i){"use strict";cc._RF.push(e,"9d594+dIy1LgYWXL4uGdb1G","nameFrame"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("skinMgr"),a=t("pInfo"),r=cc._decorator,s=r.ccclass,c=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.icon=this.node.getComponent(cc.Sprite),this.updateNameFrame(),this.eventFunc=this.onOperTap.bind(this),o.default.opE.on(this.eventFunc)},e.prototype.onDestroy=function(){o.default.opE.off(this.eventFunc),this.eventFunc=null},e.prototype.onOperTap=function(t){var e;(null==t?void 0:t.action)===o.default.SKIN_CHG&&(null===(e=t.data)||void 0===e?void 0:e.skinId)===n.SkinIdEnum.nameFrame&&this.updateNameFrame()},e.prototype.updateNameFrame=function(){var t=a.default.ins.getUsingSkin()[n.SkinIdEnum.nameFrame];n.default.ins.updateNameFrame(t,this.icon)},__decorate([s],e)}(cc.Component));i.default=c,cc._RF.pop()},{evts:"evts",pInfo:"pInfo",skinMgr:"skinMgr"}],nativeP:[function(t,e,i){"use strict";cc._RF.push(e,"3eb69/8EbJE/rYyIHzTmHB4","nativeP"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("pConst"),n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isNative=!0,e}return __extends(e,t),e.prototype.init=function(){this.initListener()},Object.defineProperty(e.prototype,"isLogin",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.showLogin=function(t){t&&(this.loginResolve=t)},e.prototype.loginSuceess=function(){this.loginResolve()},e.prototype.videoError=function(t){this.reject(t)},e.prototype.videoEnd=function(t){t==o.VideoFailCode.CANCELED?this.reject(t):this.resolve()},e}(t("h5").default);i.default=n,cc._RF.pop()},{h5:"h5",pConst:"pConst"}],newJigMgr:[function(t,e,i){"use strict";cc._RF.push(e,"76747ryvSJFDajgaJVMHyti","newJigMgr"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("pInfo"),a=t("bagMgr"),r=t("festivalMgr"),s=function(){function t(){this.jigsawTileTotal=105,this.jigsawThemeNum=r.default.ins.getJigsawNum(),this.localData=null,this.seed=5}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t)},enumerable:!1,configurable:!0}),t.prototype.getJigsawTilesByIdx=function(t){var e=this.getJigsawTiles()[t]||[],i=a.default.ins.getItemCount("newYear_pieces"),o=t+1;this.seed=21+o;var n=[0,1,2,3,4,5,6,7,8,9,10,11,22,33,44,55,66,77,88,99,89,100,91,101,93,102,95,103,97,104,98,87,76,65,54,43,32,21];this.shuffleArray(n),n.length=10;for(var r=[],s=0;s<105;s++)-1==n.indexOf(s)&&r.push(s);this.shuffleArray(r);var c=n.concat(r);if(e.length<this.jigsawTileTotal){var l=e.length,d=this.jigsawTileTotal-e.length,u=i-((o-1)*this.jigsawTileTotal+l);if(u>0){var p=Math.min(d,u);for(s=0;s<p;s++){var h=c[l+s];e.push([h,-1])}}}return this.setJigsawTilesByIdx(t,e),e},t.prototype.setJigsawTilesByIdx=function(t,e){var i=this.getJigsawTiles();i[t]=e,this.setJigsawTiles(i)},t.prototype.isItemUnlock=function(){return!0},t.prototype.isPieceEnough=function(t){var e=t*this.jigsawTileTotal;return a.default.ins.getItemCount("newYear_pieces")>e},t.prototype.getNowJigsawLv=function(){for(var t=0,e=this.getJigsawTiles().length;t<e;t++)if(!this.IsJigsawCompletedByIdx(t))return t+1},t.prototype.IsJigsawCompletedByIdx=function(t){var e=this.getJigsawTiles()[t];if(105==e.length){for(var i=0,o=e;i<o.length;i++){var n=o[i];if(n[0]!=n[1])return!1}return!0}return!1},t.prototype.getAllTiles=function(){for(var t=0,e=this.jigsawThemeNum;t<e;t++)this.getJigsawTilesByIdx(t)},t.prototype.getUnPlacedNum=function(){this.getAllTiles();for(var t=this.getJigsawTiles(),e=0,i=0,o=t.length;i<o;i++){var n=t[i];if(!this.checkHasFin(i))for(var a=0,r=n.length;a<r;a++){var s=n[a];s[1]!=s[0]&&e++}}return e},t.prototype.seedRandom=function(){return this.seed=(9301*this.seed+49297)%233280,this.seed/233280},t.prototype.shuffleArray=function(t){for(var e,i=t.length-1;i>0;i--){var o=Math.floor(this.seedRandom()*(i+1));e=[t[o],t[i]],t[i]=e[0],t[o]=e[1]}},t.prototype.getJigsawTiles=function(){var t=this.getLocalJigData().tiles;return null==t?[]:t},t.prototype.setJigsawTiles=function(t){this.setLocalJigData({tiles:t})},t.prototype.setLocalJigData=function(t){var e=this.getLocalJigData();this.localData=Object.assign(Object.assign({},e),t),o.platform.setStorage("newJigsaw",this.localData)},t.prototype.getLocalJigData=function(){return null==this.localData&&(this.localData=o.platform.getStorage("newJigsaw")||{}),this.localData},t.prototype.checkClearData=function(){n.default.ins.getIsClearJigsawData()&&(n.default.ins.setIsClearJigsawData(!1),this.clearJigsawData())},t.prototype.clearJigsawData=function(){this.localData={},o.platform.setStorage("newJigsaw",this.localData)},t.prototype.checkSetFin=function(t){this.checkHasFin(t)||this.setFinfishJigsaw(t)},t.prototype.checkHasFin=function(t){return n.default.ins.getHasFinFesJig()[t]||!1},t.prototype.setFinfishJigsaw=function(t){var e=n.default.ins.getHasFinFesJig();e[t]=!0,n.default.ins.setHasFinFesJig(e)},t.prototype.clearFinJig=function(t){var e=n.default.ins.getHasFinFesJig();e[t]=!1,n.default.ins.setHasFinFesJig(e)},t.prototype.resetJigByIdx=function(t){for(var e=this.getJigsawTilesByIdx(t),i=[],o=0,n=e.length;o<n;o++){var a=e[o];a[1]=-1,i.push(a)}this.setJigsawTilesByIdx(t,i),this.clearFinJig(t)},t}();i.default=s,cc._RF.pop()},{bagMgr:"bagMgr",festivalMgr:"festivalMgr",idx:"idx",pInfo:"pInfo"}],pConst:[function(t,e,i){"use strict";var o;cc._RF.push(e,"5027cy3DgNHsIzfr0s9Lkfg","pConst"),Object.defineProperty(i,"__esModule",{value:!0}),i.ShareResult=i.VEnum4=i.VIDEO_RECORD_LIMIT=i.SHARE_FAIL_MAX_CNT=i.DefaultSDKSwitch=i.DefaultLaunchOptions=i.DefaultSystemInfo=i.SDKConfig=i.VideoFailCode=i.STDSeqType=i.PFCode=void 0,i.PFCode={QQ:"qq",Wechat:"wechat",Bytedance:"DY",Web:"H5",Vivo:"vivo",Alipay:"Alipay",TaoBao:"TaoBao",Ios:"Ios",Android:"Android"},i.STDSeqType={VIDEO:"VIDEO",SHARE:"SHARE"},i.VideoFailCode={NO_AD:"NO_AD",IS_AUDIT:"IS_AUDIT",LOW_SDK_VERSION:"LOW_SDK_VERSION",CANCELED:"CANCELED"},i.SDKConfig={comQuery:"",_shareData:{title:"\u592a\u96be\u4e86",imageUrlId:"",imageUrl:"subpackages/resSps/native/72/7233d4b3-7dea-4bdd-9fa3-3874c53e29a0.954ee.jpg",query:""},shareData:function(){var t=i.SDKConfig._shareData;return t.query=i.SDKConfig.comQuery+Date.now(),t},ttZoneId:{race:"race",normal:"normal"},videoCoolTime:18e4},i.DefaultSDKSwitch={isAudit:!0,closeAD:!1},i.SHARE_FAIL_MAX_CNT=3,i.VIDEO_RECORD_LIMIT=3e5,(o=i.VEnum4||(i.VEnum4={}))[o.SHORT=0]="SHORT",o[o.LONG=1]="LONG",i.ShareResult={SUCCESS:0,FAILED:1,ERROR:2},cc._RF.pop()},{}],pInfo:[function(t,e,i){"use strict";var o;cc._RF.push(e,"ed1e6oh4MhAKYXj2NqhTJgo","pInfo"),Object.defineProperty(i,"__esModule",{value:!0}),i.chgScene=i.challengeType=i.gameType=i.sceneType=i.ROOT=void 0;var n,a=t("evts"),r=t("idx"),s=t("pConst"),c=t("time"),l=t("uData"),d=t("cfgMgr"),u=t("loadingAni"),p=t("global"),h=t("bagMgr"),f=t("jigsawMgr"),g=t("levelMgr"),v=t("rankMgr"),m=t("shopMgr"),y=(t("skinMgr"),t("game"));i.sceneType={loading:"loading",main:"main",game:"game",guide:"guide"},(n=o=i.gameType||(i.gameType={}))[n.normal=0]="normal",n[n.race=1]="race",n[n.challenge=2]="challenge",n[n.practice=3]="practice",n[n.festival=4]="festival",n[n.freedom=5]="freedom",function(t){t[t.worm=1]="worm",t[t.tree=2]="tree",t[t.ice=3]="ice"}(i.challengeType||(i.challengeType={})),i.chgScene=function(t,e){var n,r,s;e&&(n=e.cb,r=e.noAni,s=e.gameType),a.default.opE.clear();var c=cc.director;i.ROOT=t,t==i.sceneType.game?(s=y.default.type=s||o.normal)==o.challenge&&(y.default.challageData=e.challengeData||{}):(delete y.default.type,delete y.default.challageData,g.default.ins.clearPrcitceId()),s==o.freedom&&(p.default.freedomSize=e.freedomSize||10);var l=function(){null==n||n()};if(r)c.loadScene(t,l);else{var d=cc.assetManager.getBundle("prefab");d||c.loadScene(t,l),d.load("prefab/loadingAni",cc.Prefab,function(e,i){var o;if(!e){var a=cc.find("Canvas");if(a){var r=cc.view.getVisibleSize(),s=r.width,d=r.height,p=new cc.Node("mask");p.setContentSize(s,d),p.addComponent(cc.BlockInputEvents),a.addChild(p),(o=cc.instantiate(i)).setPosition(s/2,d/2),a.parent.addChild(o),o.getComponent(u.default).playTo(s,d,t,n),cc.game.addPersistRootNode(o)}}o?c.preloadScene(t):c.loadScene(t,l)})}};var _=function(){function t(){this.gameType={nomal:"nomal"}}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new b)},enumerable:!1,configurable:!0}),t.prototype.saveCoinData=function(){},t}();i.default=_;var b=function(){function t(){this.isOpenLock=!0,this.recordData={main:{gTimes:0,wTimes:0,heWins:0,tPoints:0,hePoints:0},daily:{gTimes:0,wTimes:0,heWins:0,tPoints:0,hePoints:0,feTime:0},race:{gTimes:0,tPoints:0,hePoints:0,feTime:0}},this.uploadData={ttMScore:0,ttDScore:0,ttMWin:0,ttDWin:0,tdMScore:0,tdDScore:0,tdMWin:0,tdDWin:0,tdRScore:0},this.usingSkin={bg:1,role:1,headFrame:1,nameFrame:1}}return t.prototype.getPerPowerNeedTime=function(){var t=d.default.serverCfg.times.forUser;return(l.default.ins.getIsNewUser()?t.new_user.rules.one_time.val:t.all.rules.one_time.val)||180},t.prototype.getInitPower=function(){var t=d.default.serverCfg.times.forUser;return(l.default.ins.getIsNewUser()?t.new_user.rules.int_times.val:t.all.rules.int_times.val)||100},t.prototype.getLevel=function(){var t=l.default.ins.getLocalData().lvl;return null==t?1:Number(t)},t.prototype.setLevel=function(t){l.default.ins.setLocalData({lvl:t})},t.prototype.finishLvl=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,{data:{lvl:this.getLevel()+1}}]})})},t.prototype.getGuideDone=function(){return l.default.ins.getLocalData().guideDone},t.prototype.setGuideDone=function(){l.default.ins.setLocalData({guideDone:1})},t.prototype.getPuzzleLvl=function(){var t=l.default.ins.getLocalData().puzzleLvl,e=p.default.chapterCount;return t>54*e&&(t=54*e,p.default.levelDone=!0),null==t?1:Number(t)},t.prototype.setPuzzleLvl=function(t){return l.default.ins.setLocalData({puzzleLvl:t}),g.default.ins.updateData()},t.prototype.finishPuzzleLvl=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this.getPuzzleLvl(),[4,this.setPuzzleLvl(t+1)];case 1:return e.sent(),[2]}})})},t.prototype.getJisawLvl=function(){var t=l.default.ins.getLocalData().jisawLvl;return null==t?1:Number(t)},t.prototype.setJisawLvl=function(t){l.default.ins.setLocalData({jisawLvl:t})},t.prototype.finishJisawLvl=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,{data:{lvl:this.getJisawLvl()+1}}]})})},t.prototype.getCoin=function(){var t=l.default.ins.getLocalData().coin;return null==t?0:Number(t)},t.prototype.addCoin=function(t,e){if(void 0===e&&(e=!0),!isNaN(t)){var i=this.getCoin()+t;i<0&&(i=0),this.setCoin(i),e&&a.default.opE.emit({action:a.default.COIN_CHG})}},t.prototype.setCoin=function(t){l.default.ins.setLocalData({coin:t})},t.prototype.getlevel=function(){var t=l.default.ins.getLocalData().level;return null==t?0:Number(t)},t.prototype.addLevel=function(t){if(void 0===t&&(t=1),!isNaN(t)){var e=this.getlevel()+t;e<0&&(e=0),l.default.ins.setLocalData({level:e}),a.default.opE.emit({action:a.default.LEV_CHG})}},t.prototype.addExp=function(t){if(!isNaN(t)){var e=this.getExp()+t;e<0&&(e=0);var i=this.getlevel();if(i*i*20<e){for(var o=0,n=8;i*i*20<e&&n>0;)o+=1,i+=1,n--;this.addLevel(o)}l.default.ins.setLocalData({exp:e}),a.default.opE.emit({action:a.default.EXP_CHG})}},t.prototype.getExp=function(){var t=l.default.ins.getLocalData().exp;return null==t?0:Number(t)},t.prototype.getPower=function(){var t=l.default.ins.getLocalData().power;return null==t?this.getInitPower():Number(t)},t.prototype.addPower=function(t,e){if(void 0===e&&(e=!0),!isNaN(t)){var i=this.getPower(),o=i+t;o<0&&(o=0),this.setPower(o);var n=this.getInitPower();if(o<=n){var r=i-o;i>=n&&(this.setPowerFullTime(0),r=n-o),this.updatePowerFullTime(r)}else i<n&&this.updatePowerFullTime(i-n);e&&a.default.opE.emit({action:a.default.POWER_CHG})}},t.prototype.setPower=function(t){t!=this.getPower()&&(t<0&&(t=0),l.default.ins.setLocalData({power:t}))},t.prototype.getPowerFullTime=function(){var t=l.default.ins.getLocalData().powerFullTime;return null==t?0:Number(t)},t.prototype.updatePowerFullTime=function(t){var e=this.getPowerFullTime()||c.default.ins.serverTime;e+=t*this.getPerPowerNeedTime(),this.setPowerFullTime(e)},t.prototype.setPowerFullTime=function(t){l.default.ins.setLocalData({powerFullTime:t})},t.prototype.getTask=function(t){var e=l.default.ins.getLocalData()[t];return null==e&&(e={}),e},t.prototype.setTask=function(t,e){var i;e&&l.default.ins.setLocalData(((i={})[t]=e,i))},t.prototype.getItem=function(){var t=l.default.ins.getLocalData().item;return null==t&&(t={}),t},t.prototype.recordGameResult=function(t,e,i,n,a){var c,l;if(t===o.normal){var d=this.getRecordMainData();e?(d.wTimes=Number(d.wTimes)+1,this.winMainLevel(),d.heWins=d.heWins>this.getConsWinTimes()?d.heWins:this.getConsWinTimes(),this.getLuckyState()||0==Number(d.wTimes)%2&&this.setLuckState(!0)):this.setConsWinTimes(0),d.tPoints=Number(d.tPoints)+i,d.hePoints=d.hePoints>i?d.hePoints:i,this.setTodayMainScore(this.getTodayMainScore()+i),null!=a&&(null===(c=r.platform.setFriendRankData)||void 0===c||c.call(r.platform,a,s.SDKConfig.ttZoneId.normal))}else if(t===o.challenge){var u=this.getRecordDailyData();e?(u.wTimes=Number(u.wTimes)+1,this.winDailyLevel(),u.heWins=u.heWins>this.getDailyWinTimes()?u.heWins:this.getDailyWinTimes()):this.setDailyWinTimes(0),u.tPoints=Number(u.tPoints)+i,u.hePoints=u.hePoints>i?u.hePoints:i,n&&(u.feTime=u.feTime<n?u.feTime:n),this.setTodayDailyScore(this.getTodayDailyScore()+i)}else if(t===o.race){var p=this.getRecordRaceData();p.tPoints=Number(p.tPoints)+i,p.hePoints=p.hePoints>i?p.hePoints:i,null===(l=r.platform.setFriendRankData)||void 0===l||l.call(r.platform,p.hePoints,s.SDKConfig.ttZoneId.race),n&&(p.feTime=p.feTime<n?p.feTime:n),this.setTodayRaceScore(i)}this.setRecordData(this.getRecordData())},t.prototype.recordGameTimes=function(t){var e;switch(t){case o.normal:e=this.getRecordMainData();break;case o.challenge:e=this.getRecordDailyData();break;case o.race:e=this.getRecordRaceData()}e&&(e.gTimes=Number(e.gTimes)+1,this.setRecordData(this.getRecordData()))},t.prototype.getRecordData=function(){var t=l.default.ins.getLocalData().recordData;return null==t?this.recordData:t},t.prototype.setRecordData=function(t){l.default.ins.setLocalData({recordData:t})},t.prototype.getRecordMainData=function(){return this.getRecordData().main},t.prototype.getRecordDailyData=function(){return this.getRecordData().daily},t.prototype.getRecordRaceData=function(){return this.getRecordData().race},t.prototype.getConsWinTimes=function(){var t=l.default.ins.getLocalData().mConsWTimes;return null==t?0:Number(t)},t.prototype.setConsWinTimes=function(t){l.default.ins.setLocalData({mConsWTimes:t})},t.prototype.winMainLevel=function(){var t=this.getConsWinTimes();this.setConsWinTimes(t+1);var e=this.getTodayMainWin();this.setTodayMainWin(e+1)},t.prototype.getDailyWinTimes=function(){var t=l.default.ins.getLocalData().dConsWTimes;return null==t?0:Number(t)},t.prototype.setDailyWinTimes=function(t){l.default.ins.setLocalData({dConsWTimes:t})},t.prototype.winDailyLevel=function(){var t=this.getDailyWinTimes();this.setDailyWinTimes(t+1);var e=this.getTodayDailyWin();this.setTodayDailyWin(e+1)},t.prototype.getTodayMainScore=function(){var t=l.default.ins.getLocalData().tdMScore;return null==t?0:Number(t)},t.prototype.setTodayMainScore=function(t){l.default.ins.setLocalData({tdMScore:t})},t.prototype.getTodayMainWin=function(){var t=l.default.ins.getLocalData().tdMWin;return null==t?0:Number(t)},t.prototype.setTodayMainWin=function(t){l.default.ins.setLocalData({tdMWin:t})},t.prototype.getTodayDailyScore=function(){var t=l.default.ins.getLocalData().tdDScore;return null==t?0:Number(t)},t.prototype.setTodayDailyScore=function(t){l.default.ins.setLocalData({tdDScore:t})},t.prototype.getTodayDailyWin=function(){var t=l.default.ins.getLocalData().tdDWin;return null==t?0:Number(t)},t.prototype.setTodayDailyWin=function(t){l.default.ins.setLocalData({tdDWin:t})},t.prototype.getTodayRaceScore=function(){var t=l.default.ins.getLocalData().tdRScore;return null==t?0:Number(t)},t.prototype.setTodayRaceScore=function(t){t>this.getTodayRaceScore()&&(l.default.ins.setLocalData({tdRScore:t}),v.default.ins.uploadRaceData())},t.prototype.chgTodayRaceScore=function(t){l.default.ins.setLocalData({tdRScore:t})},t.prototype.getYdayRaceScore=function(){var t=l.default.ins.getLocalData().ydRScore;return null==t?0:Number(t)},t.prototype.setYdayRaceScore=function(t){l.default.ins.setLocalData({ydRScore:t})},t.prototype.clearDailyData=function(){this.setYdayRaceScore(this.getTodayRaceScore()),this.clearDayUpLoad(),this.setTodayMainScore(0),this.setTodayMainWin(0),this.setTodayDailyScore(0),this.setTodayDailyWin(0),this.chgTodayRaceScore(0),this.setTicketAdTimes(0),this.setYdayRaceRankData([]),v.default.ins.setYdayRaceRankData([]),this.setShareNames([]),this.setIsGetSlider(!1),this.setFirstRaceTip(!1),this.setNormalShareTime(0),this.setRaceShareTime(0),this.setJigsawAdTimes(0),this.setNewJigAdTimes(0),this.setAdCount(0),this.setShareCount(0),this.setShopRecord({}),m.default.ins.setPackRed({}),m.default.ins.setTabsRed({})},t.prototype.getLuckTimes=function(){var t=l.default.ins.getLocalData().luckyTimes;return null==t?0:Number(t)},t.prototype.setLuckyTimes=function(t){l.default.ins.setLocalData({luckyTimes:t})},t.prototype.addLuckyTimes=function(){var t=this.getLuckTimes();t=(t+=1)>10?1:t,this.setLuckyTimes(t),this.setLuckState(!1)},t.prototype.getLuckyState=function(){var t=l.default.ins.getLocalData().luckyState;return null!=t&&t},t.prototype.setLuckState=function(t){l.default.ins.setLocalData({luckyState:t})},t.prototype.getPowerAdTimes=function(){var t=l.default.ins.getLocalData().powerAdTimes;return null==t?0:Number(t)},t.prototype.setPowerAdTimes=function(t){l.default.ins.setLocalData({powerAdTimes:t})},t.prototype.addPowerAdTimes=function(){var t=this.getPowerAdTimes();t=(t+=1)>1?0:t,this.setPowerAdTimes(t)},t.prototype.getCoinAdTimes=function(){var t=l.default.ins.getLocalData().coinAdTimes;return null==t?0:Number(t)},t.prototype.setCoinAdTimes=function(t){l.default.ins.setLocalData({coinAdTimes:t})},t.prototype.addCoinAdTimes=function(){var t=this.getCoinAdTimes();t=(t+=1)>2?0:t,this.setCoinAdTimes(t)},t.prototype.getTicketAdTimes=function(){var t=l.default.ins.getLocalData().ticketAdTimes;return null==t?0:Number(t)},t.prototype.setTicketAdTimes=function(t){l.default.ins.setLocalData({ticketAdTimes:t})},t.prototype.addTicketAdTimes=function(){var t=this.getTicketAdTimes();this.setTicketAdTimes(t+1)},t.prototype.getLastUploadRankData=function(){var t=l.default.ins.getLocalData().lastUploadRank;return null==t?this.uploadData:t},t.prototype.setLastUploadRankData=function(t){l.default.ins.setLocalData({lastUploadRank:t})},t.prototype.clearDayUpLoad=function(){var t=this.getLastUploadRankData();t.tdMScore=0,t.tdDScore=0,t.tdMWin=0,t.tdDWin=0,t.tdRScore=0,this.setLastUploadRankData(t)},t.prototype.setYdayRaceRankData=function(t){l.default.ins.setLocalData({ydayRRData:t})},t.prototype.getRankLastTimeData=function(){var t=l.default.ins.getLocalData().rLastTime;return null==t?0:t},t.prototype.setRankLastTimeData=function(t){l.default.ins.setLocalData({rLastTime:t})},t.prototype.getIsGetSlider=function(){var t=l.default.ins.getLocalData().isSlider;return null!=t&&t},t.prototype.setIsGetSlider=function(t){l.default.ins.setLocalData({isSlider:t})},t.prototype.getAliAddHome=function(){var t=l.default.ins.getLocalData().aliAddHome;return null==t?-1:t},t.prototype.setAliAddHome=function(t){l.default.ins.setLocalData({aliAddHome:t})},t.prototype.getIsFirstRaceTip=function(){var t=l.default.ins.getLocalData().isRaceTip;return null!=t&&t},t.prototype.setFirstRaceTip=function(t){l.default.ins.setLocalData({isRaceTip:t})},t.prototype.getNormalShareTime=function(){var t=l.default.ins.getLocalData().norShareT;return null==t?0:t},t.prototype.setNormalShareTime=function(t){l.default.ins.setLocalData({norShareT:t})},t.prototype.getRaceShareTime=function(){var t=l.default.ins.getLocalData().raceShareT;return null==t?0:t},t.prototype.setRaceShareTime=function(t){l.default.ins.setLocalData({raceShareT:t})},t.prototype.getJigsawAdTimes=function(){var t=l.default.ins.getLocalData().jigsawAdTimes;return null==t?0:Number(t)},t.prototype.setJigsawAdTimes=function(t){l.default.ins.setLocalData({jigsawAdTimes:t})},t.prototype.addJigsawAdTimes=function(){var t=this.getJigsawAdTimes();this.setJigsawAdTimes(t+1)},t.prototype.getNewJigAdTimes=function(){var t=l.default.ins.getLocalData().newJigAdTimes;return null==t?0:Number(t)},t.prototype.setNewJigAdTimes=function(t){l.default.ins.setLocalData({newJigAdTimes:t})},t.prototype.addNewJigAdTimes=function(){var t=this.getNewJigAdTimes();this.setNewJigAdTimes(t+1)},t.prototype.getAdCount=function(){var t=l.default.ins.getLocalData().adCount;return null==t?0:Number(t)},t.prototype.setAdCount=function(t){l.default.ins.setLocalData({adCount:t})},t.prototype.addAdCount=function(){var t=this.getAdCount();this.setAdCount(t+1),this.isMaxAdCount()&&(r.platform.reportEvent(r.ERepEvt.adMax),a.default.opE.emit({action:a.default.AD_MAX}))},t.prototype.isMaxAdCount=function(){return void 0!==d.default.serverCfg.daily_max_ad_times.val&&this.getAdCount()>=d.default.serverCfg.daily_max_ad_times.val},t.prototype.getShareCount=function(){var t=l.default.ins.getLocalData().shareCount;return null==t?0:Number(t)},t.prototype.setShareCount=function(t){l.default.ins.setLocalData({shareCount:t})},t.prototype.addShareCount=function(){var t=this.getShareCount();this.setShareCount(t+1)},t.prototype.isMaxShareCount=function(){var t,e=null!==(t=d.default.serverCfg.daily_max_ad_times.share_times_limit)&&void 0!==t?t:5;return this.getShareCount()>=e},t.prototype.getJigsawBgEndTimesByIdx=function(t){return this.getJigsawBgEndTimes()[t]||0},t.prototype.setJigsawBgEndTimesByIdx=function(t,e){var i=this.getJigsawBgEndTimes();i[t]=e,this.setJigsawBgEndTimes(i)},t.prototype.getJigsawBgEndTimes=function(){var t=l.default.ins.getLocalData().jigEndTimes;return null==t?[]:t},t.prototype.setJigsawBgEndTimes=function(t){l.default.ins.setLocalData({jigEndTimes:t})},t.prototype.getNewJigBgEndTimesByIdx=function(t){return this.getNewJigBgEndTimes()[t]||0},t.prototype.setNewJigBgEndTimesByIdx=function(t,e){var i=this.getNewJigBgEndTimes();i[t]=e,this.setNewJigBgEndTimes(i)},t.prototype.getNewJigBgEndTimes=function(){var t=l.default.ins.getLocalData().newJigEndTimes;return null==t?[]:t},t.prototype.setNewJigBgEndTimes=function(t){l.default.ins.setLocalData({newJigEndTimes:t})},t.prototype.getIsClearJigsawData=function(){var t=l.default.ins.getLocalData().isClearJig1;return null==t||t},t.prototype.setIsClearJigsawData=function(t){l.default.ins.setLocalData({isClearJig1:t})},t.prototype.getIsCheckdLock=function(){var t=l.default.ins.getLocalData().isCheckdLock;return null!=t&&t},t.prototype.setIsCheckdLock=function(t){l.default.ins.setLocalData({isCheckdLock:t})},t.prototype.getIsOpenLocked=function(){var t=l.default.ins.getLocalData().localIsOpen;return null==t||t},t.prototype.setIsOpenLocked=function(t){l.default.ins.setLocalData({localIsOpen:t})},t.prototype.checkIsOpenLock=function(){if(this.isOpenLock=this.getIsOpenLocked(),!this.getIsCheckdLock()){var t=this.getPuzzleLvl(),e=h.default.ins.getItemCount("puzzle_pieces"),i=f.default.ins.getUnPlacedNum();(t>1||e!=i)&&(this.isOpenLock=!1,this.setIsOpenLocked(!1)),this.setIsCheckdLock(!0)}},t.prototype.isMianLocked=function(){var t,e,i;if(this.checkIsOpenLock(),!this.isOpenLock)return!1;if(this.getPuzzleLvl()<55)return!1;var o=JSON.parse(JSON.stringify(_.ins.getRecordData())).race.hePoints,n=(null===(i=null===(e=null===(t=d.default.serverCfg)||void 0===t?void 0:t.lock_rules)||void 0===e?void 0:e.main_line_lock)||void 0===i?void 0:i.main_line_val)||0;return Number(o)<Number(n)},t.prototype.isJigsawLocked=function(){var t,e,i;if(this.checkIsOpenLock(),!this.isOpenLock)return!1;var o=JSON.parse(JSON.stringify(_.ins.getRecordData())).race.hePoints,n=(null===(i=null===(e=null===(t=d.default.serverCfg)||void 0===t?void 0:t.lock_rules)||void 0===e?void 0:e.main_line_lock)||void 0===i?void 0:i.puzzle_line_val)||0;return Number(o)<Number(n)},t.prototype.getIsGetNewGift=function(){var t=l.default.ins.getLocalData().isGetNewGift;return null!=t&&t},t.prototype.setIsGetNewGif=function(t){l.default.ins.setLocalData({isGetNewGift:t})},t.prototype.getHasFinJig=function(){var t=l.default.ins.getLocalData().hasFinJig;return null==t?{}:t},t.prototype.setHasFinJig=function(t){l.default.ins.setLocalData({hasFinJig:t}),l.default.ins._setLocalAndCloudData()},t.prototype.getHasFinFesJig=function(){var t=l.default.ins.getLocalData().hasFinFesJig;return null==t?{}:t},t.prototype.setHasFinFesJig=function(t){l.default.ins.setLocalData({hasFinFesJig:t}),l.default.ins._setLocalAndCloudData()},t.prototype.getFesName=function(){var t=l.default.ins.getLocalData().fesName;return null==t?"":t},t.prototype.setFesName=function(t){l.default.ins.setLocalData({fesName:t})},t.prototype.getFesPro=function(){var t=l.default.ins.getLocalData().fesPro;return null==t?0:Number(t)},t.prototype.setFesPro=function(t){l.default.ins.setLocalData({fesPro:t})},t.prototype.getFesTaskPro=function(){var t=l.default.ins.getLocalData().fesTaskPro;return null==t?0:Number(t)},t.prototype.setFesTaskPro=function(t){l.default.ins.setLocalData({fesTaskPro:t})},t.prototype.getFesPuzzleLv=function(){var t=l.default.ins.getLocalData().fesPuzzleLv;return null==t?1:Number(t)},t.prototype.setFesPuzzleLv=function(t){l.default.ins.setLocalData({fesPuzzleLv:t})},t.prototype.getShareNames=function(){var t=l.default.ins.getLocalData().sNames;return null==t?[]:t},t.prototype.setShareNames=function(t){l.default.ins.setLocalData({sNames:t})},t.prototype.getChallengeData=function(){var t=l.default.ins.getLocalData().chaData;return null==t?[]:t},t.prototype.setChallengeData=function(t){l.default.ins.setLocalData({chaData:t})},t.prototype.getChallengePackData=function(){var t=l.default.ins.getLocalData().chaPackData;return null==t?[]:t},t.prototype.setChallengePackData=function(t){l.default.ins.setLocalData({chaPackData:t})},t.prototype.getAddDesk=function(){var t=l.default.ins.getLocalData().addDesk;return null!=t&&t},t.prototype.setAddDesk=function(t){l.default.ins.setLocalData({addDesk:t})},t.prototype.getJigTiles=function(){var t=l.default.ins.getLocalData().jigTiles;return null==t?[-1,""]:t},t.prototype.setJigTiles=function(t){l.default.ins.setLocalData({jigTiles:t},15)},t.prototype.addSevenDays=function(){var t=this.getSevenDays(),e=Math.min(7,t+1);this.setSevenDays(e)},t.prototype.getSevenDays=function(){var t=l.default.ins.getLocalData().sevenLogin;return null==t?0:t},t.prototype.setSevenDays=function(t){l.default.ins.setLocalData({sevenLogin:t})},t.prototype.getSevenReward=function(){var t=l.default.ins.getLocalData().sevenReward;return null==t?0:t},t.prototype.setSevenReward=function(t){l.default.ins.setLocalData({sevenReward:t})},t.prototype.addShopRecord=function(t){var e=this.getShopRecord();e[t]?e[t]+=1:e[t]=1,this.setShopRecord(e)},t.prototype.getShopRecord=function(){var t=l.default.ins.getLocalData().shopRecord;return null==t?{}:t},t.prototype.setShopRecord=function(t){l.default.ins.setLocalData({shopRecord:t})},t.prototype.addShopUnreset=function(t){var e=this.getShopUnreset();e[t]?e[t]+=1:e[t]=1,this.setShopUnreset(e)},t.prototype.getShopUnreset=function(){var t=l.default.ins.getLocalData().shopReUn;return null==t?{}:t},t.prototype.setShopUnreset=function(t){l.default.ins.setLocalData({shopReUn:t})},Object.defineProperty(t.prototype,"Bag",{get:function(){var t=l.default.ins.getLocalData().bag;return null==t&&(t={}),t},set:function(t){t&&l.default.ins.setLocalData({bag:t})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Mail",{get:function(){var t=l.default.ins.getLocalData().mail;return null==t&&(t={}),t},set:function(t){t&&l.default.ins.setLocalData({mail:t})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mySkin",{get:function(){return this._mySkin||(this._mySkin={bg:[1],role:[1],headFrame:[1],nameFrame:[1]}),this._mySkin},enumerable:!1,configurable:!0}),t.prototype.getUsingSkin=function(){return this.usingSkin},t.prototype.setUsingSkin=function(){},t.prototype.getMySkin=function(){},t.prototype.addMySkin=function(){},t.prototype.getSkinAdPro=function(){},t.prototype.addSkinAdPro=function(){},t}();cc._RF.pop()},{bagMgr:"bagMgr",cfgMgr:"cfgMgr",evts:"evts",game:"game",global:"global",idx:"idx",jigsawMgr:"jigsawMgr",levelMgr:"levelMgr",loadingAni:"loadingAni",pConst:"pConst",rankMgr:"rankMgr",shopMgr:"shopMgr",skinMgr:"skinMgr",time:"time",uData:"uData"}],packItem1:[function(t,e,i){"use strict";cc._RF.push(e,"55c3ekMcB9Er61q37vHGQCP","packItem1"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("item"),a=t("bagMgr"),r=t("panelMgr"),s=t("shopMgr"),c=t("tipMgr"),l=t("pInfo"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.packName=null,e.scrollView=null,e.priceLb=null,e.rewardItem=null,e.finNode=null,e.btnNode=null,e.adNode=null,e.buyNumLb=null,e.redNode=null,e.discountLb=null,e.shopData=null,e.isFree=!1,e._rewardItems=[],e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.initItem=function(t){this.shopData=t,this.packName.string=(null==t?void 0:t.title)||"\u793c\u5305";var e=t.price||0;this.priceLb.string="\xa5"+t.price,this.isFree=0==e;var i=s.default.ins.getPackRed();i[t.key]?this.redNode.active=!1:(this.redNode.active=!0,i[t.key]=1,s.default.ins.setPackRed(i)),t.discount?(this.discountLb.string=t.discount+"\u6298",this.discountLb.node.parent.active=!0):this.discountLb.node.parent.active=!1,this.initReward(t.props),this.checkData()},e.prototype.initReward=function(t){var e=this;if(t){var i=0,o=this.scrollView.content;for(var a in o.children.forEach(function(t){e._rewardItems.push(t)}),o.removeAllChildren(),t){var r=t[a],s=this._rewardItems.shift();s||(s=cc.instantiate(this.rewardItem)),s.parent=o,s.active=!0;var c=s.getComponent(n.default);c&&c.initByData(a,r),i++}o.setContentSize(93*i,100)}},e.prototype.checkData=function(){if(this.shopData){var t=this.shopData.key,e=l.default.ins.getShopRecord(),i=this.shopData.daily_limit_nums||0,o=e[t]||0;this.btnNode.active=!this.isFree,this.adNode.active=this.isFree;var n=this.isFree?this.adNode:this.btnNode,a=o>=i;this.finNode.active=a,n.active=!a,this.buyNumLb.node.active=!a,this.buyNumLb.string="\u9650\u8d2d:"+o+"/"+i}},e.prototype.onBtnBuy=function(){var t=this;if(this.shopData){var e=JSON.stringify(this.shopData.props);o.platform.payment(this.shopData.key,this.shopData.price,0,e).then(function(){t.getReward()}).catch(function(t){c.default.ins.showTip(t,!0)})}},e.prototype.onBtnAd=function(){this.shopData&&this.getReward()},e.prototype.getReward=function(){var t=this.shopData.props;for(var e in t){var i=t[e];a.default.ins.addItem(e,i)}for(var o=this.scrollView.content.children,s=[],c=0,d=o.length;c<d;c++){var u=o[c],p=u.getComponent(n.default),h={};h.itemId=p.key,h.worldPos=u.parent.convertToWorldSpaceAR(u.position),h.value=Number(p.count),s.push(h)}r.default.ins.open("ui/ui_flyAni",{itemDatas:s}),l.default.ins.addShopRecord(this.shopData.key),this.checkData()},__decorate([p(cc.Label)],e.prototype,"packName",void 0),__decorate([p(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([p(cc.Label)],e.prototype,"priceLb",void 0),__decorate([p(cc.Node)],e.prototype,"rewardItem",void 0),__decorate([p(cc.Node)],e.prototype,"finNode",void 0),__decorate([p(cc.Node)],e.prototype,"btnNode",void 0),__decorate([p(cc.Node)],e.prototype,"adNode",void 0),__decorate([p(cc.Label)],e.prototype,"buyNumLb",void 0),__decorate([p(cc.Node)],e.prototype,"redNode",void 0),__decorate([p(cc.Label)],e.prototype,"discountLb",void 0),__decorate([u],e)}(cc.Component);i.default=h,cc._RF.pop()},{bagMgr:"bagMgr",idx:"idx",item:"item",pInfo:"pInfo",panelMgr:"panelMgr",shopMgr:"shopMgr",tipMgr:"tipMgr"}],packItem:[function(t,e,i){"use strict";cc._RF.push(e,"7abceAnT1dHcJZ6MEKrASAc","packItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spine=null,e.getSp=null,e.idx=0,e}return __extends(e,t),e.prototype.initItem=function(t,e){this.spine.skeletonData=e,this.idx=t+1,this.spine.animation="box_"+this.idx+"_"+this.idx,this.getSp.active=!1},e.prototype.setFinish=function(t){var e=this.idx;this.spine.animation=t?"box_"+e:"box_"+e+"_"+e},e.prototype.setIsGet=function(t){this.getSp.active=t,t&&this.setFinish(!1)},__decorate([a(sp.Skeleton)],e.prototype,"spine",void 0),__decorate([a(cc.Node)],e.prototype,"getSp",void 0),__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],page_challenge:[function(t,e,i){"use strict";cc._RF.push(e,"ffe87NgStNFVZHkaf3sEeX1","page_challenge"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("mySafeArea"),r=t("NumberUtils"),s=t("res"),c=t("time"),l=t("cfgMgr"),d=t("global"),u=t("bagMgr"),p=t("challengeMgr"),h=t("panelMgr"),f=t("skinMgr"),g=t("pInfo"),v=t("dateItem"),m=t("packItem"),y=cc._decorator,_=y.ccclass,b=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dateNodes=null,e.dateNode0=null,e.dateNode1=null,e.dateItem=null,e.yearLb=null,e.monthLb=null,e.costLb=null,e.topNode=null,e.leftNode=null,e.rightNode=null,e.lvPerLb=null,e.finNumLb=null,e.packPro=null,e.packItems=[],e.midBg=null,e.packageNode=null,e.maskNode=null,e.topSp=null,e.spineNode=null,e.beforeRedLb=null,e.afterRedLb=null,e.bgNode=null,e.hengNode=null,e.curYear=0,e.curMonth=0,e.curDay=0,e.lvData={type:1,diff:3},e.isAni=!1,e.isFin=!1,e.gameDate=null,e.loadPackEnd=!1,e.crossData={},e.isLoad=!0,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.node.height=cc.winSize.height,d.default.padScale&&(this.hengNode.scaleX=this.bgNode.scaleX=this.topSp.node.parent.scale=d.default.padScale),o.default.opE.on(this.onOperTap.bind(this)),s.default.ins.getBundleByString("resSps").then(function(e){e.load("game/normal/top1",cc.SpriteFrame,function(e,i){!e&&t.node&&t.node.isValid&&(t.topSp.spriteFrame=i)}),e.load("spine/package/action",sp.SkeletonData,function(e,i){if(!e&&t.node&&t.node.isValid){for(var o=0,n=t.packItems.length;o<n;o++)t.packItems[o].initItem(o,i);t.setPackPer(),t.loadPackEnd=!0}})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)}),this.loadGirl()},e.prototype.loadGirl=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return f.default.ins.updateRole(g.default.ins.getUsingSkin().role,this.spineNode),[2]})})},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.UPD_MAIN_RED:this.updateReds();break;case o.default.SKIN_CHG:this.loadGirl()}},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){t.adapter(),t.initPanel()})},e.prototype.onEnable=function(){var t=this;this.isLoad||p.default.ins.getRequestChallengeData(this.curYear,this.curMonth).then(function(e){e.status&&(t.crossData=e.data,t.setCrossNum())}).catch(function(t){console.error("getRequestChallengeDataErr",t)}),this.isLoad=!1},e.prototype.adapter=function(){var t=a.getSafeAreaRect().yMin,e=this.node.height-1280-t;this.spineNode.y+=e/6,this.topNode.y-=t,this.topNode.removeComponent(cc.Widget)},e.prototype.initPanel=function(){var t=this,e=1e3*c.default.ins.serverTime,i=new Date(e),o=i.getDate(),n=i.getFullYear(),a=i.getMonth()+1;if(d.default.challengeLv){var r=Math.trunc,l=r(d.default.challengeLv/1e4),u=r(d.default.challengeLv%1e4/100);p.default.ins.getTheMonthIsFin(n,a)||(n=l,a=u)}this.curYear=n,this.curMonth=a,this.curDay=o,this.yearLb.string=this.curYear+"\u5e74",this.monthLb.string=this.curMonth+"",this.initItems(),this.checkBtns(),this.getCrossData(),s.default.ins.getBundleByString("resSps").then(function(e){e.load("spine/package/action",sp.SkeletonData,function(e,i){if(!e&&t.node&&t.node.isValid){for(var o=0,n=t.packItems.length;o<n;o++)t.packItems[o].initItem(o,i);t.setPackPer(),t.loadPackEnd=!0}})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})},e.prototype.initItems=function(){for(var t=this.curYear,e=this.curMonth,i=0,o=0,n=0;n<42;n++){var a=cc.instantiate(this.dateItem);a.active=!0,a.parent=this.dateNode1,a.x=92*i,a.y=-86*o,++i>6&&(i=0,o++)}this.setItemsByDate(this.dateNode1,t,e);var r=1e3*c.default.ins.serverTime,s=new Date(r),l=s.getFullYear(),d=s.getMonth()+1,u=s.getDate(),h=p.default.ins,f=h.getLastUnFinIdx(t,e),g=h.getFinLvNum(t,e);l==t&&d==e&&u==g&&(f=u-1),this.setIsSelect(f),this.dateNode0.y+=516,i=0,o=0,this.loadDateItem(0,i,o)},e.prototype.loadDateItem=function(t,e,i){var o=this;if(!(t>=42)){var n=cc.instantiate(this.dateItem);n.active=!0,n.parent=this.dateNode0,n.x=92*e,n.y=-86*i,++e>6&&(e=0,i++),t++,this.scheduleOnce(function(){o.loadDateItem(t,e,i)},0)}},e.prototype.checkBtns=function(){var t=1e3*c.default.ins.serverTime,e=new Date(t),i=e.getFullYear(),o=e.getMonth()+1,n=p.default.ins,a=this.curYear,r=this.curMonth;this.rightNode.active=i!=a||o!=r,a==n.firstYear&&r==n.firstMonth?this.leftNode.active=!1:this.leftNode.active=!0,this.updateReds()},e.prototype.updateReds=function(){var t=p.default.ins,e=this.curYear,i=this.curMonth,o=t.getMonthRed(e,i),n=t.getBeforeMonthRed(e,i),a=n-o,r=t.getAllMonthRed()-n;a>0?(this.beforeRedLb.node.parent.active=!0,this.beforeRedLb.string=a+"",this.beforeRedLb.node.x=d.default.getCharXOffset(this.beforeRedLb.string)):this.beforeRedLb.node.parent.active=!1,r>0?(this.afterRedLb.node.parent.active=!0,this.afterRedLb.string=r+"",this.afterRedLb.node.x=d.default.getCharXOffset(this.afterRedLb.string)):this.afterRedLb.node.parent.active=!1},e.prototype.rePanel=function(t){var e=this,i=this.curYear,o=this.curMonth,n=516*t,a=this.dateNode0.active?this.dateNode0:this.dateNode1,r=this.dateNode0.active?this.dateNode1:this.dateNode0;r.y=a.y-n,this.setItemsByDate(r,i,o),this.dateNode0.active=!0,this.dateNode1.active=!0,this.isAni=!0,cc.tween(this.dateNodes).by(.2,{y:n}).call(function(){e.isAni=!1,a.active=!1,r.active=!0;var t=p.default.ins.getLastUnFinIdx(e.curYear,e.curMonth);e.setIsSelect(t)}).start(),this.yearLb.string=i+"\u5e74",this.monthLb.string=o+"",this.loadPackEnd&&this.setPackPer(),this.getCrossData()},e.prototype.setPackPer=function(){var t=p.default.ins,e=this.curYear,i=this.curMonth,o=t.getMonthData(e,i),n=(o[0],o[1]),a=t.getFinLvNum(e,i);this.lvPerLb.string=a+"/"+n,this.packPro.progress=a/28;for(var r=t.getChaPackData(e,i),s=0,c=this.packItems.length;s<c;s++){var l=7*(s+1),d=this.packItems[s];d.setIsGet(!1),d.setFinish(!1),a>=l&&d.setFinish(!0),r[s]&&d.setIsGet(!0)}},e.prototype.setItemsByDate=function(t,e,i){for(var o=this,n=p.default.ins,a=n.getfinData(e,i),r=n.getMonthData(e,i),s=r[0],c=r[1],l=function(r){var l=t.children[r],u=r-s+1,p=l.getComponent(v.default);u<0||u>=c?l.active=!1:(l.active=!0,p.setDate(u+1),l.off("click"),n.isLocked(e,i,u)?p.setLocked(!0):(l.on("click",function(){o.onBtnChgStartData(u)},d),p.setLocked(!1)),p.setFinish(a[u]))},d=this,u=0,h=t.childrenCount;u<h;u++)l(u)},e.prototype.setIsSelect=function(t){for(var e=this.dateNode0.active?this.dateNode0:this.dateNode1,i=0,o=e.childrenCount;i<o;i++){var n=e.children[i];n&&n.getComponent(v.default).setSelected(!1)}var a=p.default.ins,r=a.getMonthData(this.curYear,this.curMonth),s=r[0],c=(r[1],t+s-1),l=a.getfinData(this.curYear,this.curMonth);this.isFin=l[t];var d=e.children[c];d&&d.getComponent(v.default).setSelected(!0),this.lvData=a.getLvDataByDate(this.curYear,this.curMonth,t);var u={};u.year=this.curYear,u.month=this.curMonth,u.day=t+1,u.isFin=l[t],this.gameDate=u,this.setCrossNum();var h=this.getLevelCost();this.costLb.string="-"+h},e.prototype.getCrossData=function(){var t=this,e=p.default.ins.getRequestChallengeData(this.curYear,this.curMonth);this.crossData={},e.then(function(e){e.status&&(t.crossData=e.data,t.setCrossNum())}).catch(function(t){console.error("getRequestChallengeDataErr",t)})},e.prototype.setCrossNum=function(){var t=this.gameDate,e=p.default.ins,i=e.addZeroToNum(t.month),o=e.addZeroToNum(t.day),n=t.year+"-"+i+"-"+o,a=e.getfinData(t.year,t.month),r=a[t.day-1]?1:0,s=this.crossData[n]||r;this.finNumLb.string=s+"";var c=a[t.day-1]?s:s+1;this.gameDate.num=c},e.prototype.onBtnChgStartData=function(t){this.isAni||this.setIsSelect(t)},e.prototype.onBtnStart=function(){var t=this;if(!this.isAni){var e=this.getLevelCost();if(g.default.ins.getPower()<e)h.default.ins.open("ui/ui_getRes",{itemId:"times"});else{var i=this.lvData;if(i.date=this.gameDate,i.type===g.challengeType.worm){var o=i.count||r.default.RandomInt(1,460);(o<0||o>460)&&(o=Math.abs(o)%460),i.count=o,n.platform.showLoading(),cc.assetManager.loadRemote(d.OssConfig.challengeWormUrl+o+".json",cc.JsonAsset,function(o,a){n.platform.hideLoading(),!o&&a&&a.json?i.data=a.json:i.data={size:15,data:[[188,203,218,219,220,221,206,191,192,193,194,179,164,149,148,147,132,117,102,87,72,71,70,69,84,99,114,113,112,111,110,95,80,65,50,49,48,47,62,77,76,75,90,105,120],[186,185,170,155,154,153,138,123,108,107,122,137,152,151,166,167,182,197],[74,59,44,43,28,13,12,11,26,41,40,39,38,23,22,21,6,5,4,3,18,17,16,15],[160,159,158,157,142,143,144,145]]},h.default.ins.open("ui/ui_challengeInfo",{lvData:i,cost:e,crossNum:t.finNumLb.string})})}else h.default.ins.open("ui/ui_challengeInfo",{lvData:i,cost:e,crossNum:this.finNumLb.string})}}},e.prototype.onBtnChgMonth=function(t,e){if(!this.isAni){var i=Number(e),o=this.getNewDate(i),n=o[0],a=o[1];this.curYear=n,this.curMonth=a;var r=p.default.ins,s=1e3*c.default.ins.serverTime,l=new Date(s),d=l.getFullYear(),u=l.getMonth()+1;this.curYear==r.firstYear&&this.curMonth<r.firstMonth?this.curMonth=r.firstMonth:this.curYear==d&&this.curMonth>u?this.curMonth=u:(this.checkBtns(),this.rePanel(i))}},e.prototype.getNewDate=function(t){var e=t,i=this.curYear,o=this.curMonth;return(o+=e)<1?(i-=1,o=12):o>12&&(i+=1,o=1),[i,o]},e.prototype.getLevelCost=function(){var t,e,i=(null===(e=null===(t=l.default.serverCfg)||void 0===t?void 0:t.daily_challenge)||void 0===e?void 0:e.consume)||30;return this.isFin&&(i=0),i},e.prototype.onBtnPack=function(t,e){var i,n;if(!this.isAni){var a=Number(e),r=this.curYear,s=this.curMonth,c=p.default.ins,d=c.getFinLvNum(r,s),f=c.getChaPackData(r,s),g=7*(a+1),v=(null===(n=null===(i=l.default.serverCfg)||void 0===i?void 0:i.daily_challenge)||void 0===n?void 0:n.numreward)[a]||{times:150,coin:150,puzzle_pieces:20},m=this.packItems[a],y=[];for(var _ in v){var b=v[_],S=m.node,w=S.parent.convertToWorldSpaceAR(S.position),T={};T.itemId=_,T.worldPos=w,T.value=Number(b),y.push(T)}if(y.length)if(d>=g&&!f[a]){for(var _ in m.setIsGet(!0),c.setChaPackData(r,s,a),v)b=v[_],u.default.ins.addItem(_,Number(b));o.default.opE.emit({action:o.default.UPD_MAIN_RED}),h.default.ins.open("ui/ui_flyAni",{itemDatas:y})}else h.default.ins.open("ui/ui_preReward",{itemDatas:y})}},__decorate([b(cc.Node)],e.prototype,"dateNodes",void 0),__decorate([b(cc.Node)],e.prototype,"dateNode0",void 0),__decorate([b(cc.Node)],e.prototype,"dateNode1",void 0),__decorate([b(cc.Prefab)],e.prototype,"dateItem",void 0),__decorate([b(cc.Label)],e.prototype,"yearLb",void 0),__decorate([b(cc.Label)],e.prototype,"monthLb",void 0),__decorate([b(cc.Label)],e.prototype,"costLb",void 0),__decorate([b(cc.Node)],e.prototype,"topNode",void 0),__decorate([b(cc.Node)],e.prototype,"leftNode",void 0),__decorate([b(cc.Node)],e.prototype,"rightNode",void 0),__decorate([b(cc.Label)],e.prototype,"lvPerLb",void 0),__decorate([b(cc.Label)],e.prototype,"finNumLb",void 0),__decorate([b(cc.ProgressBar)],e.prototype,"packPro",void 0),__decorate([b([m.default])],e.prototype,"packItems",void 0),__decorate([b(cc.Node)],e.prototype,"midBg",void 0),__decorate([b(cc.Node)],e.prototype,"packageNode",void 0),__decorate([b(cc.Node)],e.prototype,"maskNode",void 0),__decorate([b(cc.Sprite)],e.prototype,"topSp",void 0),__decorate([b(cc.Node)],e.prototype,"spineNode",void 0),__decorate([b(cc.Label)],e.prototype,"beforeRedLb",void 0),__decorate([b(cc.Label)],e.prototype,"afterRedLb",void 0),__decorate([b(cc.Node)],e.prototype,"bgNode",void 0),__decorate([b(cc.Node)],e.prototype,"hengNode",void 0),__decorate([_],e)}(cc.Component);i.default=S,cc._RF.pop()},{NumberUtils:"NumberUtils",bagMgr:"bagMgr",cfgMgr:"cfgMgr",challengeMgr:"challengeMgr",dateItem:"dateItem",evts:"evts",global:"global",idx:"idx",mySafeArea:"mySafeArea",pInfo:"pInfo",packItem:"packItem",panelMgr:"panelMgr",res:"res",skinMgr:"skinMgr",time:"time"}],page_jigsaw:[function(t,e,i){"use strict";cc._RF.push(e,"502baxKlExFebmxN98W6bhx","page_jigsaw"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("mySafeArea"),a=t("global"),r=t("jigsawMgr"),s=t("newJigMgr"),c=t("tipMgr"),l=t("jigMenu"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.jigsawItem=null,e.menuView=null,e.newView=null,e.btnsNode=null,e.pageNodes=null,e.jigsawNum=null,e.jigsawNum1=null,e.jigTypes=[],e.bgNode=null,e.menuItem=null,e.THEME_H=276,e.themeSpace=10,e.top_offest=30,e.bottom_offest=200,e.last_view_inner_y=-1,e.themes={},e.newThemes={},e.touching_theme_id=0,e.jigBID=1,e.jigEID=27,e.jigCount=27,e.newJigBID=1,e.newJigEID=18,e.newJigCount=18,e.designContH=1100,e.btnsComp=[],e.curPageIdx=0,e.isAni=!1,e.isFirstLoad=!0,e}return __extends(e,t),e.prototype.onLoad=function(){this.jigEID=this.jigCount=a.default.jisawCount,this.newJigEID=this.newJigCount=s.default.ins.jigsawThemeNum,this.node.height=cc.winSize.height,a.default.padScale&&(this.bgNode.scale=a.default.padScale),o.default.opE.on(this.onOperTap.bind(this)),this.upNewJigRed()},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.FINISH_PUZZLE:break;case o.default.UPD_MAIN_RED:this.upNewJigRed()}},e.prototype.upNewJigRed=function(){this.jigsawNum1.node.parent.active=!1;var t=s.default.ins.getUnPlacedNum();if(t>0){var e=t>99?"99+":t+"";this.jigsawNum.node.parent.active=!0,this.jigsawNum.string=e+"",this.jigsawNum.node.x=a.default.getCharXOffset(this.jigsawNum.string)}else this.jigsawNum.node.parent.active=!1,this.jigsawNum1.node.parent.active=!1},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){t.adapter();var e=n.getSafeAreaRect().yMin,i=t.node.height-1280-e;t.newView.node.height=t.menuView.node.height=t.designContH+i,t.newView.node.getChildByName("view").height=t.menuView.node.getChildByName("view").height=t.designContH+i,t.menuView.node.y-=e/2,t.newView.node.y-=e/2,t.initMenuView()})},e.prototype.adapter=function(){var t=n.getSafeAreaRect().yMin;this.btnsNode.y-=t},e.prototype.onEnable=function(){var t=this;this.isFirstLoad||this.scheduleOnce(function(){t.adapter()}),this.isFirstLoad=!1},e.prototype.initMenuView=function(){var t=(Math.ceil(this.jigCount/3)+1)*(this.themeSpace+this.THEME_H);this.menuView.content.setContentSize(cc.size(cc.winSize.width,t)),this.initItemView1(),this.loadMenuItem(0)},e.prototype.loadMenuItem=function(t){if(t<this.jigCount){var e=this.jigBID+t,i=cc.instantiate(this.menuItem),o=i.getComponent(l.default);o.node.active=!0,i.opacity=0,cc.tween(i).to(.5,{opacity:255}).start();var n=t%3,a=Math.ceil(e/3),r=128+232*n,s=-this.top_offest-this.THEME_H/2+(a-1)*-(this.THEME_H+this.themeSpace);o.node.parent=this.menuView.content,o.node.position=cc.v3(r,s),this.themes[e]=o,o.init(t,1),t++,this.scheduleOnce(this.loadMenuItem.bind(this,t),0)}else this.reItemVis1(),this.loadNewItem(0)},e.prototype.loadNewItem=function(t){if(t<this.newJigCount){var e=this.newJigBID+t,i=cc.instantiate(this.menuItem).getComponent(l.default);i.node.active=!0;var o=t%3,n=Math.ceil(e/3),a=128+232*o,r=-this.top_offest-this.THEME_H/2+(n-1)*-(this.THEME_H+this.themeSpace);i.node.parent=this.newView.content,i.node.position=cc.v3(a,r),this.newThemes[e]=i,i.init(t,2),t++,this.scheduleOnce(this.loadNewItem.bind(this,t),0)}else this.initItemView2()},e.prototype.initItemView1=function(){var t=this;this.menuView.node.on("scrolling",function(){t.reItemVis1()},this);var e=r.default.ins.getNowJigsawLv();e>=this.jigBID&&e<=this.jigEID?this.ScrollToItem1(e):this.ScrollToItem1(this.jigBID)},e.prototype.initItemView2=function(){var t=this;this.newView.node.on("scrolling",function(){t.reItemVis2()},this);var e=s.default.ins.getNowJigsawLv();e>=this.newJigBID&&e<=this.newJigEID?this.ScrollToItem2(e):this.ScrollToItem2(this.newJigBID)},e.prototype.ScrollToItem1=function(t){if(this.last_view_inner_y=-1,!(t<this.jigBID||t>this.jigEID)){var e=Math.ceil(t/3),i=Math.abs(-279*(e-1)),o=Math.max(i,0),n=this.menuView.getScrollOffset();Math.abs(o-n.y)<Number.EPSILON||this.menuView.scrollToOffset(cc.v2(0,o),.5)}},e.prototype.ScrollToItem2=function(t){if(this.last_view_inner_y=-1,!(t<this.newJigBID||t>this.newJigEID)){var e=Math.ceil(t/3),i=Math.abs((e-1)*-this.THEME_H),o=Math.max(i,0),n=this.newView.getScrollOffset();Math.abs(o-n.y)<Number.EPSILON||this.newView.scrollToOffset(cc.v2(0,o))}this.reItemVis2()},e.prototype.reItemVis1=function(){var t=this.menuView.getContentPosition();if(!(Math.abs(this.last_view_inner_y-t.y)<.01)){this.last_view_inner_y=t.y;for(var e=this.menuView.node,i=e.height/2,o=e.parent.convertToWorldSpaceAR(e.position),n=o.y+i,a=o.y-i,r=this.menuView.content.children,s=0,c=r.length;s<c;s++){var l=r[s],d=l.parent.convertToWorldSpaceAR(l.position),u=d.y-125>n||d.y+125<a;l.active=!u}}},e.prototype.reItemVis2=function(){},e.prototype.chgToFes=function(){},e.prototype.onBtnChgJigType=function(){var t=this;if(0!==this.curPageIdx){var e=this.curPageIdx,i=0===e?1:0;if(!this.isAni){this.isAni=!0,this.jigTypes[e].active=!1,this.jigTypes[i].active=!0,this.curPageIdx=0===e?1:0;var o=this.pageNodes.children[i],n=this.pageNodes.children[e];cc.Tween.stopAllByTarget(this.pageNodes);var a=i>e?-1:1,r=this.pageNodes.x+cc.view.getVisibleSize().width*a;o.x=-r,o&&(o.active=!0),cc.tween(this.pageNodes).to(.5,{x:r},{easing:this.customEaseInOut}).call(function(){n&&(n.active=!1),t.isAni=!1}).start()}}else c.default.ins.showTip("\u6682\u672a\u5f00\u542f")},e.prototype.customEaseInOut=function(t){return t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2},__decorate([p(cc.Prefab)],e.prototype,"jigsawItem",void 0),__decorate([p(cc.ScrollView)],e.prototype,"menuView",void 0),__decorate([p(cc.ScrollView)],e.prototype,"newView",void 0),__decorate([p(cc.Node)],e.prototype,"btnsNode",void 0),__decorate([p(cc.Node)],e.prototype,"pageNodes",void 0),__decorate([p(cc.Label)],e.prototype,"jigsawNum",void 0),__decorate([p(cc.Label)],e.prototype,"jigsawNum1",void 0),__decorate([p([cc.Node])],e.prototype,"jigTypes",void 0),__decorate([p(cc.Node)],e.prototype,"bgNode",void 0),__decorate([p(cc.Node)],e.prototype,"menuItem",void 0),__decorate([u],e)}(cc.Component);i.default=h,cc._RF.pop()},{evts:"evts",global:"global",jigMenu:"jigMenu",jigsawMgr:"jigsawMgr",mySafeArea:"mySafeArea",newJigMgr:"newJigMgr",tipMgr:"tipMgr"}],page_level:[function(t,e,i){"use strict";cc._RF.push(e,"14ce18JY+pOW5bs9htHgdMC","page_level"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("res"),a=t("cfgMgr"),r=t("lang"),s=t("global"),c=t("festivalMgr"),l=t("levelMgr"),d=t("panelMgr"),u=t("tipMgr"),p=t("pInfo"),h=t("levelItem"),f=cc._decorator,g=f.ccclass,v=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.content=null,e.levelItemPrefab=null,e.lockedSp=null,e.unlockSp=null,e.startBtnLbl=null,e.jigsawPfb=null,e.bgSpr=null,e.startNode=null,e.startNodeGray=null,e.chaLb=null,e.secLb=null,e.secPro=null,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;n.default.ins.getBundleByString("resSps").then(function(e){var i=s.default.padScale?"ipad/":"";e.load("pages/page_level/"+i+"bg"+l.default.ins.getBgId(),cc.SpriteFrame,function(e,i){t.node&&t.node.isValid&&!e&&(t.bg.spriteFrame=i)})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)}),s.default.padScale&&(this.bg.node.width=1080),this.halfHeight=cc.view.getVisibleSize().height/2,this.upChapter(),this.checkStartBtn(),this.initScrollView(),this.initLvl(),o.default.opE.on(this.onOperTap.bind(this)),this.onE()},e.prototype.start=function(){var t=this;s.default.padScale&&this.scheduleOnce(function(){var e=(cc.view.getVisibleSize().width-720)/2;t.chaLb.node.parent.x-=e})},e.prototype.upChapter=function(){var t=p.default.ins.getPuzzleLvl(),e=Math.ceil(t/54);this.chaLb.string="\u7b2c"+e+"\u7ae0";var i=t-54*(e-1)-1;s.default.levelDone&&(i=54),this.secLb.string=i+"/54";var o=i/54;this.secPro.fillRange=o},e.prototype.checkStartBtn=function(){var t=p.default.ins.isMianLocked();this.startNodeGray.active=t,this.startNode.active=!t,s.default.levelDone?this.startBtnLbl.node.parent.active=!1:this.startBtnLbl.node.parent.active=!0},e.prototype.initScrollView=function(){for(var t=Math.floor,e=cc.instantiate,i=[45,-57,-160,-147,-113,18,37,-36,-102,14,55,88,12,-52],o=[35,110,186,288,391,423,545,648,746,806,911,1014,1093,1188],n=l.default.ins.getPuzzleLvlCount(),a=this.levelItemPrefab,r=this.lockedSp,c=this.unlockSp,d=this.content,u=(p.default.ins.getPuzzleLvl()-1)%n,f=s.default.levelDone,g=0,v=5;g<n;g++,v++){14==v&&(v=0);var m=t((g+5)/14),y=i[v],_=o[v]+1280*m,b=e(a);b.name="level_"+(g+1),b.setParent(d),b.setPosition(y,_),b.active=!1;var S=b.getComponent(h.default);S.setLvlLbl(g+1+""),S.sp.spriteFrame=g<u||f?c:r,u!==g||f||cc.tween(b).sequence(cc.tween().to(1,{scale:1.1}),cc.tween().to(1,{scale:.9})).repeatForever().start(),(g+1)%9==0&&this.addJigsaw(y,_,g,u)}},e.prototype.initLvl=function(){var t=l.default.ins.getPuzzleLvlCount(),e=(p.default.ins.getPuzzleLvl()-1)%t;this.startBtnLbl.string="-"+l.default.ins.getLevelCost();var i=this.content,o=0;if(0!=e){var n=i.children,a=n[1].position.y;o=n[e].position.y-a}o=(o=-this.halfHeight-o)<-4980?-4980:o,i.setPosition(0,o),this.onScrollForItemVis()},e.prototype.onScrollForItemVis=function(){for(var t=this.content,e=t.position.y,i=this.halfHeight,o=t.children,n=1,a=o.length;n<a;n++){var r=o[n],s=r.position.y+e;r.active=-i<s&&s<i}for(var c=this.content.children[0].children,l=(n=0,c.length);n<l;n++){var d=c[n];s=d.position.y+e,d.active=-i<s&&s<i}},e.prototype.onStart=function(){if(p.default.ins.isMianLocked()){var t=a.default.serverCfg.lock_rules.main_line_lock.main_line_val;u.default.ins.showTip(r.lang[30001].format(t))}else{var e=l.default.ins.getLevelCost();p.default.ins.getPower()<e?d.default.ins.open("ui/ui_getRes",{itemId:"times"}):s.default.levelDone?d.default.ins.open("ui/ui_selectMode",null):d.default.ins.open("ui/ui_lvInfo",null)}},e.prototype.addJigsaw=function(t,e,i,o){var n,a=cc.instantiate(this.jigsawPfb),r=this.content.children[0].childrenCount,c=[218,-206,132,-172,194,115][r],d=[1188,1838,2835,3532,4548,5364][r];a.off("click",this.onBtnChapter,this),a.on("click",this.onBtnChapter,this),a.setPosition(c,d),a.active=!1,a.setParent(this.content.children[0]),a.name="jigsaw_"+this.content.children[0].childrenCount;var u=a.children[1].getComponent(cc.Sprite),p=Math.ceil((i+1)/9);l.default.ins.getJigsawIcon(p).then(function(t){t&&(u.spriteFrame=t)}).catch(function(){console.error("getJigsawIconErr")}),0==o||"number"==typeof s.default.puzzlv&&(s.default.puzzlv=s.default.puzzlv%l.default.ins.getPuzzleLvlCount(),o=s.default.puzzlv),n=s.default.levelDone?9:o>=9*p?9:o>9*p-9?o%9:0,u.getMaterial(0).setProperty("height",n)},e.prototype.onBtnChapter=function(){d.default.ins.open("ui/ui_chapter",null)},e.prototype.onE=function(){var t=p.default.ins.getPuzzleLvl();this.checkShowFinger(t<=3)},e.prototype.onD=function(){this.checkShowFinger(!1)},e.prototype.checkShowFinger=function(t){var e=this;t?this._fingerNode?this._fingerNode.active=!0:n.default.ins.lPre("prefab/finger").then(function(t){e._fingerNode=cc.instantiate(t),e.node.getChildByName("startBtn").addChild(e._fingerNode);var i=cc.v3(80,0);e._fingerNode.setPosition(i),e._fingerNode.active=!0}).catch(function(){console.error("getPrefabErr")}):this._fingerNode&&this._fingerNode.active&&(this._fingerNode.active=!1)},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.UPDJIGSAW:this.checkJigsaw();break;case o.default.FINISH_PUZZLELV:this.checkAndPop();break;case o.default.POP_FESTIVAL:this.popFestival();break;case o.default.UPDATA_LEVEL_TMP:this.updateLvlTmp()}},e.prototype.updateLvlTmp=function(){s.default.levelTmp},e.prototype.checkAndPop=function(){this.checkJigsaw(),this.scheduleOnce(function(){s.default.levelDone?d.default.ins.open("ui/ui_selectMode",null):1==p.default.ins.getPuzzleLvl()%54?d.default.ins.open("ui/ui_chapterDone",{}):d.default.ins.open("ui/ui_lvInfo",{isShow:!0})},0)},e.prototype.popFestival=function(){!c.default.ins.isFesEnd()&&c.default.ins.fesTaskDatas&&d.default.ins.open("ui/ui_festival",null)},e.prototype.checkJigsaw=function(){if("number"==typeof s.default.puzzlv){var t=(p.default.ins.getPuzzleLvl()-1)%l.default.ins.getPuzzleLvlCount();if(t){if(s.default.puzzlv!=t||1==t){var e=this.content.getChildByName("level_"+t),i=Math.ceil(t/9),o=this.content.children[0].getChildByName("jigsaw_"+i),n=cc.instantiate(e);n.setParent(e.parent),n.setPosition(e.position);var a=cc.v2(n.x,n.y),r=cc.v2(o.x,o.y),c=t%9||9,d=Math.floor((c-1)/3),u=(c-1)%3;r.x+=(u-1)*o.width*o.scale/3,r.y+=(1-d)*o.width*o.scale/3;var h=r.add(a).multiplyScalar(.7);cc.tween(n).bezierTo(1,a,h,r).call(function(){n.active=!1,setTimeout(function(){n.destroy()},100),o.children[1].getComponent(cc.Sprite).getMaterial(0).setProperty("height",c)}).start()}s.default.puzzlv=null}}},e.prototype.onDestroy=function(){o.default.opE.off(this.onOperTap.bind(this)),this.onD();for(var t=l.default.ins.getPuzzleLvlCount(),e=0,i=5;e<t;e++,i++)(e+1)%9==0&&this.releaseJigsaw(e);cc.assetManager.releaseAsset(this.bgSpr.spriteFrame)},e.prototype.releaseJigsaw=function(t){var e=Math.ceil((t+1)/9);l.default.ins.releaseJigsawIcon(e)},e.prototype.onBtnFes=function(){d.default.ins.open("ui/ui_festival",null)},__decorate([v(cc.Sprite)],e.prototype,"bg",void 0),__decorate([v(cc.Node)],e.prototype,"content",void 0),__decorate([v(cc.Prefab)],e.prototype,"levelItemPrefab",void 0),__decorate([v(cc.SpriteFrame)],e.prototype,"lockedSp",void 0),__decorate([v(cc.SpriteFrame)],e.prototype,"unlockSp",void 0),__decorate([v(cc.Label)],e.prototype,"startBtnLbl",void 0),__decorate([v(cc.Prefab)],e.prototype,"jigsawPfb",void 0),__decorate([v(cc.Sprite)],e.prototype,"bgSpr",void 0),__decorate([v(cc.Node)],e.prototype,"startNode",void 0),__decorate([v(cc.Node)],e.prototype,"startNodeGray",void 0),__decorate([v(cc.Label)],e.prototype,"chaLb",void 0),__decorate([v(cc.Label)],e.prototype,"secLb",void 0),__decorate([v(cc.Sprite)],e.prototype,"secPro",void 0),__decorate([g],e)}(cc.Component);i.default=m,cc._RF.pop()},{cfgMgr:"cfgMgr",evts:"evts",festivalMgr:"festivalMgr",global:"global",lang:"lang",levelItem:"levelItem",levelMgr:"levelMgr",pInfo:"pInfo",panelMgr:"panelMgr",res:"res",tipMgr:"tipMgr"}],page_race:[function(t,e,i){"use strict";var o;cc._RF.push(e,"57a50JN9w9EQJ5/pwcl4QsY","page_race"),Object.defineProperty(i,"__esModule",{value:!0});var n,a=t("evts"),r=t("idx"),s=t("mySafeArea"),c=t("pConst"),l=t("request"),d=t("time"),u=t("uData"),p=t("rankItem"),h=t("global"),f=t("bagMgr"),g=t("panelMgr"),v=t("rankMgr"),m=t("taskMgr"),y=t("pInfo"),_=cc._decorator,b=_.ccclass,S=_.property;(n=o||(o={}))[n.today=0]="today",n[n.yday=1]="yday";var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollView=null,e.dayTypeBtnsSps=[],e.friendRankBtn=null,e.viewItem=null,e.rankTop=[],e.myRank=null,e.ticketCount=null,e.topNode=null,e.loadingNode=null,e.bgSpr=null,e.last_view_inner_y=-1,e.THEME_H=122,e.top_offest=61,e.designContH=410,e.itemCount=0,e.items=[],e.bottom_offest=0,e.rankData=[],e.nowDataTag=o.today,e.isFirstLoad=!0,e.playAni=!0,e}return __extends(e,t),e.prototype.onLoad=function(){this.node.height=cc.winSize.height,h.default.padScale&&(this.bgSpr.node.scale=h.default.padScale),this.scrollView.vertical=!1,a.default.opE.on(this.onOperTap.bind(this))},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case a.default.UPD_PANEL:case a.default.UPD_MAIN_RED:this.initData();break;case a.default.SKIN_CHG:this.setMySelf()}},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){t.adapter(),t.scrollView.node.on("scrolling",function(){t.RefreshThemesVisible()},t),t.initData(),t.refreshData(),t.updateFriendRankBtn()})},e.prototype.adapter=function(){var t=s.getSafeAreaRect().yMin,e=this.node.height-1280-t;this.scrollView.node.height=this.designContH+e,this.scrollView.node.getChildByName("view").height=this.designContH+e,this.topNode.y-=t,this.scrollView.node.y-=t/2,this.loadingNode.position=this.scrollView.node.position},e.prototype.onEnable=function(){var t=this;this.isFirstLoad||(this.scrollView.vertical=!1,this.scheduleOnce(function(){t.adapter(),t.scrollView.scrollToTop(),t.playAni=!0,t.last_view_inner_y=-1,t.RefreshThemesVisible()},.2)),this.isFirstLoad=!1;var e=d.default.ins.serverTime||Math.floor((new Date).getTime()/1e3);if(e-y.default.ins.getRankLastTimeData()>=3600&&!y.default.ins.isOpenLock){y.default.ins.setRankLastTimeData(e);var i=r.platform.getUserInfo(),o=this.myRank.getComponent(p.default);i?i.then(function(t){l.default.ins.updateUserInfo(t),o.setHeadSp(u.default.ins.getHeadImg())},function(){o.setDefaultHead()}):o.setDefaultHead()}},e.prototype.onDisable=function(){this.initAni()},e.prototype.initData=function(){var t=f.default.ins.getItemCount("qw_line_ticket")||0;this.ticketCount.string=t+"/1"},e.prototype.refreshData=function(){this.getRankData()},e.prototype.getRankData=function(){var t,e=this;this.nowDataTag===o.today?t=v.default.ins.getTodayRaceData():this.nowDataTag===o.yday&&(t=v.default.ins.getYdayRaceData()),t.then(function(t){e.dealData(t.data),e.nowDataTag===o.yday&&v.default.ins.setYdayRaceRankData(t.data)}).catch(function(t){console.error("getRankDataErr"+t)})},e.prototype.dealData=function(t){this.node&&(this.loadingNode.active=!1);var e=!1,i=[],n=0;if(this.nowDataTag===o.today?n=v.default.ins.getMyRaceTodayData():this.nowDataTag===o.yday&&(n=v.default.ins.getMyRaceYdayData()),t)for(var a in i=i.concat(t))if((r=i[a]).game_uid==u.default.ins.getUid()){r.nickname=u.default.ins.getName(),r.sort_value=n,r.game_uid=u.default.ins.getUid(),r.avatar=u.default.ins.getHeadImg(),e=!0;break}if(!e){var r={nickname:u.default.ins.getName(),sort_value:n,game_uid:u.default.ins.getUid(),avatar:u.default.ins.getHeadImg()};i.push(r)}i.sort(function(t,e){return e.sort_value-t.sort_value}),this.rankData=i,this.refreshPanel()},e.prototype.refreshPanel=function(){this.setMySelf(),this.last_view_inner_y=-1,this.itemCount=97;var t=this.THEME_H*this.itemCount+this.top_offest/2;this.scrollView.content.setContentSize(cc.size(cc.winSize.width,t)),this.scrollView.scrollToTop();for(var e=0;e<3;e++){var i=this.rankData[e],o=this.rankTop[e];this.setRankTop(o,i)}this.RefreshThemesVisible()},e.prototype.RefreshThemesVisible=function(t){var e=this;void 0===t&&(t=0);var i=this.scrollView.getContentPosition();if(!(Math.abs(this.last_view_inner_y-i.y)<.01)){this.last_view_inner_y=i.y;for(var o,n,a,r,s,c,l=function(){o=-p*d.THEME_H-d.top_offest,n=d.scrollView.content.convertToWorldSpaceAR(cc.v2(0,o)),a=d.node.convertToNodeSpaceAR(n),r=a.y<-u||a.y+d.THEME_H>u,s=p;var t=p+3,i=d.rankData[t];if(r)d.items[s]&&(d.items[s].active=!1);else if(d.items[s]){d.setItemInfo(d.items[s],t,i);var l=d.playAni;if(d.items[s].x=0,l)return d.items[s].opacity=0,d.scheduleOnce(function(){e.items[s].active=!0,e.last_view_inner_y=-1,e.RefreshThemesVisible(p+1),l&&e.showChgAni(e.items[s])},.06),"break";d.items[s].opacity=255,d.items[s].active=!0}else{(c=cc.instantiate(d.viewItem)).active=!0,c.position=cc.v3(0,-p*d.THEME_H-d.top_offest),c.parent=d.scrollView.content,d.items[s]=c,d.setItemInfo(c,t,i);var h=d.playAni;if(h)return c.x=(cc.winSize.width+d.items[s].width)/2,c.opacity=255,d.scheduleOnce(function(){e.last_view_inner_y=-1,e.RefreshThemesVisible(p+1),h&&e.showLoadAni(c)},.02),"break";c.opacity=255,c.x=0}d.playAni=!1,p===d.itemCount-1&&d.scheduleOnce(function(){e.scrollView.vertical=!0},.5)},d=this,u=this.scrollView.node.height/5*4,p=t;p<this.itemCount&&"break"!==l();p++);}},e.prototype.setRankTop=function(t,e){var i=t.getComponent(p.default);e?(i.setRankData(e),i.setGameUid(e.game_uid),i.setScore(e.sort_value),e.game_uid==u.default.ins.getUid()?(i.setSkin(y.default.ins.getUsingSkin(),!1,!0),i.setNickName(u.default.ins.getName()),i.setHeadSp(u.default.ins.getHeadImg())):(i.setSkin(null==e?void 0:e.uSkin,!1,!0),i.setNickName(e.nickname),e.avatar?i.setHeadSp(e.avatar):i.setDefaultHead())):(i.clearFrame(),i.setNickName("\u6682\u65e0"),i.setScore("0"),i.setDefaultHead())},e.prototype.setItemInfo=function(t,e,i,o){void 0===o&&(o=!1);var n=t.getComponent(p.default);n.setIdx(Number(e)+1+""),i?(n.setRankData(i),n.setGameUid(i.game_uid),n.setScore(i.sort_value),i.game_uid==u.default.ins.getUid()?(n.setSkin(y.default.ins.getUsingSkin(),o),n.setNickName(u.default.ins.getName()),n.setHeadSp(u.default.ins.getHeadImg())):(n.setSkin(null==i?void 0:i.uSkin),n.setNickName(i.nickname),i.avatar?n.setHeadSp(i.avatar):n.setDefaultHead())):(n.clearFrame(),n.setNickName("\u6682\u65e0"),n.setScore("0"),n.setDefaultHead())},e.prototype.setMySelf=function(){var t=this.rankData;for(var e in t){var i=t[e];if(i.game_uid==u.default.ins.getUid()&&Number(e)<100)return void this.setItemInfo(this.myRank,e,i,!0)}var n=0;this.nowDataTag===o.today?n=v.default.ins.getMyRaceTodayData():this.nowDataTag===o.yday&&(n=v.default.ins.getMyRaceYdayData());var a=this.myRank.getComponent(p.default);a.setSkin(y.default.ins.getUsingSkin(),!0),a.setGameUid(u.default.ins.getUid().toString()),a.setIdx("99+"),a.setNickName(u.default.ins.getName()),a.setScore(n+""),u.default.ins.getHeadImg()?a.setHeadSp(u.default.ins.getHeadImg()):a.setDefaultHead()},e.prototype.showLoadAni=function(t){cc.tween(t).to(.5,{x:0},{easing:"backInOut"}).start()},e.prototype.showChgAni=function(t){cc.tween(t).to(.5,{opacity:255}).start()},e.prototype.onBtnStart=function(){f.default.ins.getItemCount("qw_line_ticket")<=0?g.default.ins.open("ui/ui_getItem",{itemId:"qw_line_ticket",cb:this.initData.bind(this),gType:y.gameType.race}):(y.chgScene(y.sceneType.game,{gameType:y.gameType.race}),f.default.ins.useItem("qw_line_ticket",1,y.gameType.race),m.default.taskCheck(y.gameType.race))},e.prototype.onBtnTip=function(){g.default.ins.open("ui/ui_raceTip",{pageIdx:2})},e.prototype.onBtnChange=function(){this.initAni(),this.nowDataTag===o.yday?(this.nowDataTag=o.today,this.dayTypeBtnsSps[0].active=!1,this.dayTypeBtnsSps[1].active=!0,this.refreshData()):this.nowDataTag===o.today&&(this.nowDataTag=o.yday,this.dayTypeBtnsSps[0].active=!0,this.dayTypeBtnsSps[1].active=!1,this.refreshData())},e.prototype.initAni=function(){this.unscheduleAllCallbacks();for(var t=0,e=this.items.length;t<e;t++){var i=this.items[t];cc.Tween.stopAllByTarget(i),i&&(i.opacity=0)}this.scrollView.stopAutoScroll(),this.scrollView.scrollToTop(),this.scrollView.vertical=!1,this.playAni=!0},e.prototype.updateFriendRankBtn=function(){this.friendRankBtn.active=r.platform.string()===c.PFCode.Bytedance},e.prototype.onBtnFriendRank=function(){r.platform.showFriendRank(c.SDKConfig.ttZoneId.race)},e.prototype.onDestroy=function(){cc.assetManager.releaseAsset(this.bgSpr.spriteFrame)},__decorate([S(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([S([cc.Node])],e.prototype,"dayTypeBtnsSps",void 0),__decorate([S(cc.Node)],e.prototype,"friendRankBtn",void 0),__decorate([S(cc.Node)],e.prototype,"viewItem",void 0),__decorate([S([cc.Node])],e.prototype,"rankTop",void 0),__decorate([S(cc.Node)],e.prototype,"myRank",void 0),__decorate([S(cc.Label)],e.prototype,"ticketCount",void 0),__decorate([S(cc.Node)],e.prototype,"topNode",void 0),__decorate([S(cc.Node)],e.prototype,"loadingNode",void 0),__decorate([S(cc.Sprite)],e.prototype,"bgSpr",void 0),__decorate([b],e)}(cc.Component);i.default=w,cc._RF.pop()},{bagMgr:"bagMgr",evts:"evts",global:"global",idx:"idx",mySafeArea:"mySafeArea",pConst:"pConst",pInfo:"pInfo",panelMgr:"panelMgr",rankItem:"rankItem",rankMgr:"rankMgr",request:"request",taskMgr:"taskMgr",time:"time",uData:"uData"}],page_shop:[function(t,e,i){"use strict";cc._RF.push(e,"6cfcdLL6MJNqIEFWRnYXtGU","page_shop"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("mySafeArea"),a=t("res"),r=t("cfgMgr"),s=t("global"),c=t("panelMgr"),l=t("skinMgr"),d=t("pInfo"),u=t("item"),p=t("shopItem1"),h=cc._decorator,f=h.ccclass,g=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgNode=null,e.topSpNode=null,e.spineNode=null,e.scrollView=null,e.topBgSp=null,e.topBgSp1=null,e.powerItem=null,e.goldItem=null,e.itemSc=null,e.itemPre=null,e.lightNode=null,e.eventFunc=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.node.height=cc.winSize.height,s.default.padScale&&(this.bgNode.scaleX=this.topSpNode.parent.scale=s.default.padScale),this.loadGirl(),this.onResize(),this.eventFunc=this.onOperTap.bind(this),o.default.opE.on(this.eventFunc)},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.REFRESH_CFGDATA:this.initPanel()}},e.prototype.onResize=function(){var t=n.getSafeAreaRect().yMin,e=cc.winSize.height-1280-t;this.scrollView.node.height+=e,this.scrollView.content.parent.height+=e,this.topBgSp.height+=e,this.topBgSp1.height+=e},e.prototype.start=function(){this.initPanel()},e.prototype.loadGirl=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(){return l.default.ins.updateRole(d.default.ins.getUsingSkin().role,this.spineNode),a.default.ins.getBundleByString("resSps").then(function(e){e.load("spine/light/action",sp.SkeletonData,function(e,i){if(!e&&t.node&&t.node.isValid){var o=new cc.Node,n=o.addComponent(sp.Skeleton);n.skeletonData=i,n.animation="animation",o.parent=t.lightNode}})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)}),[2]})})},e.prototype.initPanel=function(){this.powerItem.initPower(),this.goldItem.initGold(),this.initPack()},e.prototype.initPack=function(){var t,e;this.itemSc.content.removeAllChildren();var i=null===(e=null===(t=r.default.serverCfg)||void 0===t?void 0:t.shop_config)||void 0===e?void 0:e.gift;if(i){var o={},n=d.default.ins.getShopRecord();for(var a in i){var s=(null==(o=i[a])?void 0:o.daily_limit_nums)||0,c=n[o.key]||0;if((null==o?void 0:o.is_shop)&&c<s)break}if(this.itemSc.node.width=330,o&&o.props){for(var a in o.props){var l=o.props[a],p=cc.instantiate(this.itemPre);p.active=!0,this.itemSc.content.addChild(p),p.getComponent(u.default).initByData(a,l)}var h=this.itemSc.content.children[0].width*this.itemSc.content.childrenCount;this.itemSc.node.x=h>this.itemSc.node.width?-4:(this.itemSc.node.width-h)/2-4,h=Math.min(h,330),this.itemSc.node.width=h,this.itemSc.scrollToLeft()}}},e.prototype.onBtnGift=function(){c.default.ins.open("ui/ui_shopPack",null).then(function(){o.default.opE.emit({action:o.default.UPD_MAIN_RED})})},e.prototype.onDestroy=function(){o.default.opE.off(this.eventFunc),this.eventFunc=null},__decorate([g(cc.Node)],e.prototype,"bgNode",void 0),__decorate([g(cc.Node)],e.prototype,"topSpNode",void 0),__decorate([g(cc.Node)],e.prototype,"spineNode",void 0),__decorate([g(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([g(cc.Node)],e.prototype,"topBgSp",void 0),__decorate([g(cc.Node)],e.prototype,"topBgSp1",void 0),__decorate([g(p.default)],e.prototype,"powerItem",void 0),__decorate([g(p.default)],e.prototype,"goldItem",void 0),__decorate([g(cc.ScrollView)],e.prototype,"itemSc",void 0),__decorate([g(cc.Node)],e.prototype,"itemPre",void 0),__decorate([g(cc.Node)],e.prototype,"lightNode",void 0),__decorate([f],e)}(cc.Component);i.default=v,cc._RF.pop()},{cfgMgr:"cfgMgr",evts:"evts",global:"global",item:"item",mySafeArea:"mySafeArea",pInfo:"pInfo",panelMgr:"panelMgr",res:"res",shopItem1:"shopItem1",skinMgr:"skinMgr"}],panelMgr:[function(t,e,i){"use strict";var o;cc._RF.push(e,"18935KmlCBN86TB4yHqLYf5","panelMgr"),Object.defineProperty(i,"__esModule",{value:!0}),i.PanelShowResult=void 0;var n,a=t("evts"),r=t("res"),s=t("baseUI"),c=cc._decorator,l=c.ccclass,d=c.property;(n=o=i.PanelShowResult||(i.PanelShowResult={}))[n.DONE=0]="DONE",n[n.FAILED=1]="FAILED",n[n.WAITING=2]="WAITING";var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=null,e.mask=null,e}var i;return __extends(e,t),i=e,e.prototype.onLoad=function(){i.ins=this,this.panelQueue=[],this.panelList=[],this.mask.active=!1,this.mask.opacity=0},e.prototype.open=function(t,e,i){return void 0===i&&(i={}),__awaiter(this,void 0,void 0,function(){var n,c,l,d,u;return __generator(this,function(p){switch(p.label){case 0:return i.inQueue&&this.panelList.length>0?(this.panelQueue.push({prefab:t,data:e,opt:i}),[2,{panelResult:o.WAITING}]):[3,1];case 1:return[4,new Promise(function(e,i){r.default.ins.getBundleByString("prefab").then(function(o){o.load(t,cc.Prefab,function(t,o){t?i(t):e(o)})})})];case 2:return n=p.sent(),u=this,cc.isValid(n)?(c=cc.instantiate(n),(l=c.getComponent(s.default))?((d=c.getComponent(cc.Widget)||c.addComponent(cc.Widget)).verticalCenter=0,d.horizontalCenter=0,d.isAlignVerticalCenter=!0,d.isAlignHorizontalCenter=!0,this.currentPanel=c,this.panelList.push({prefab:t,data:e,opt:i,node:c}),c.setParent(this.container),l.show(e),this.ensureMask(),a.default.laE.emit({comp:l}),[2,new Promise(function(t){l.setCb(function(e,i){u.currentPanel=null,e.destroy();for(var n=0;n<u.panelList.length;n++)if(e==u.panelList[n].node){u.panelList.splice(n,1);break}t({panelResult:o.DONE,values:i}),u.onNext(),u.scheduleOnce(function(){u.ensureMask(),a.default.laE.emit({comp:null})},0)})})]):(console.warn("failed to load component of prefab",t),[2,{panelResult:o.FAILED}])):(console.warn("invalid prefab",t),[2,{panelResult:o.FAILED}]);case 3:return[2]}})})},e.prototype.getPanelByPath=function(t){for(var e=this.panelList,i=e.length-1;i>=0;--i)if(e[i].prefab===t&&null!=e[i].node){var o=e[i].node.getComponent(s.default);if(null!=o)return o}return null},e.prototype.close=function(t){for(var e=this.panelList,i=e.length-1;i>=0;--i)if(e[i].prefab===t){var o=e[i].node;if(null!=o){var n=o.getComponent(s.default);null!=n&&n.hide()}break}},e.prototype.closeAllPanel=function(){this.panelQueue=[];for(var t=this.panelList,e=t.length-1;e>=0;--e)if(null!=t[e].node){var i=t[e].node.getComponent(s.default);null!=i&&i.hide()}},e.prototype.onNext=function(){if(!(this.panelList.length>0)&&null==this.currentPanel&&0!=this.panelQueue.length){var t=this.panelQueue.shift();this.open(t.prefab,t.data,t.opt)}},e.prototype.ensureMask=function(){var t=this.panelList,e=t.length,i=t[e-1],o=this.container.childrenCount,n=this.mask;if(e<=0)n.opacity=0,n.isValid&&(n.active=!1),a.default.opE.emit({action:a.default.CHECK_WX_BTNS});else{var r=i.node;n.active=!0,cc.tween(n).to(.2,{opacity:200}).start(),r.active=!0,n.setSiblingIndex(o),r.setSiblingIndex(o),a.default.opE.emit({action:a.default.HIDE_WX_BTNS})}},e.prototype.onMaskClick=function(){var t=this.panelList,e=t.length;if(!(e<=0)){var i=t[e-1],o=i.opt,n=i.node;!o.MaskNoHide&&n.getComponent(s.default).hide()}},e.prototype.hasPop=function(){return this.panelList.length>0},__decorate([d(cc.Node)],e.prototype,"container",void 0),__decorate([d(cc.Node)],e.prototype,"mask",void 0),i=__decorate([l],e)}(cc.Component);i.default=u,cc._RF.pop()},{baseUI:"baseUI",evts:"evts",res:"res"}],pf:[function(t,e,i){"use strict";cc._RF.push(e,"5d08eGcGmRG/bMCOUzEMeOL","pf"),Object.defineProperty(i,"__esModule",{value:!0}),t("request");var o=function(){function t(){}return t.prototype.syncTime=function(){return new Promise(function(t){t(Date.now())})},t}();i.default=o,cc._RF.pop()},{request:"request"}],qq:[function(t,e,i){"use strict";cc._RF.push(e,"7bad26df+hPn6RIm3jVIcMH","qq"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("c"),n=t("evts"),a=t("pConst"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isQQ=!0,e}return __extends(e,t),Object.defineProperty(e.prototype,"appId",{get:function(){return"1110513462"},enumerable:!1,configurable:!0}),e.prototype.canUse=function(){return!0},e.prototype.doWatchAD=function(){var t=this;return this.noAd?(n.default.adE.emit(o.ADE.VIDEO_END),Promise.reject(a.VideoFailCode.NO_AD)):this.noVideo?void Promise.reject(a.VideoFailCode.NO_AD):(n.default.adE.emit(o.ADE.VIDEO),this.showLoading(),new Promise(function(e,i){var r=wx.createRewardedVideoAd({adUnitId:"bb8f5f005098f1ca2e16e73448b4bc8c"});r.onError(function(){}),r.onLoad(function(){}),r.onClose(function t(s){null!=r&&r.offClose(t),null!=s&&s.isEnded?(n.default.adE.emit(o.ADE.VIDEO_END),e(1)):(n.default.adE.emit(o.ADE.VIDEO_END),i(a.VideoFailCode.CANCELED))}),r.load().then(function(){r.show().then(function(){}).catch(function(){n.default.adE.emit(o.ADE.VIDEO_END),i(a.VideoFailCode.NO_AD)}).then(function(){t.hideLoading()})}).catch(function(){t.hideLoading()})}))},e.prototype.preloadVideo=function(){return!1},e.prototype.reportEvent=function(){},e.prototype.share=function(){return new Promise(function(t){var e=a.SDKConfig.shareData();qq.shareAppMessage({title:e.title,imageUrl:e.imageUrl,query:e.query,success:function(e){t(e.data)},fail:function(){t(0)}})})},e}(t("wx").default);i.default=r,cc._RF.pop()},{c:"c",evts:"evts",pConst:"pConst",wx:"wx"}],questItem:[function(t,e,i){"use strict";cc._RF.push(e,"5625bI4JLpBOohvs4j5MumY","questItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("veBtn"),r=t("lang"),s=t("panelMgr"),c=t("taskMgr"),l=t("loading"),d=t("item"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLbl=null,e.itemsNode=null,e.itemPrefab=null,e.pro=null,e.proLbl=null,e.getBtnNode=null,e.goBtnNode=null,e.adNode=null,e.goImgNode=null,e.scrollView=null,e.getedNode=null,e.questPool=new cc.NodePool(d.default),e.eventFunc=null,e}return __extends(e,t),e.prototype.init=function(t){for(var e in this._taskData=t,this.nameLbl.string=r.lang[t.temp.key],this.nameLbl.font=l.DEFAULTFONT,this.pro.progress=0,this.scrollView.node.width=360,cc.tween(this.pro).to(.5,{progress:t.data.count/t.temp.nums}).start(),this.proLbl.string=t.data.count+"/"+t.temp.nums,t.temp.val)if(t.temp.val.hasOwnProperty(e)){var i=this.questPool.get();i||(i=cc.instantiate(this.itemPrefab)),this.scrollView.content.addChild(i),i.getComponent(d.default).init(t.temp,e)}var o=this.scrollView.content.children[0].width*this.scrollView.content.childrenCount;if(this.scrollView.node.x=o>this.scrollView.node.width?-283:(this.scrollView.node.width-o)/2-283,o=Math.min(o,360),this.scrollView.node.width=o,this.scrollView.scrollToLeft(),this.adNode.active=!1,this.goImgNode.x=0,this.goBtnNode.getComponent(a.default)&&this.goBtnNode.removeComponent(a.default),t.temp.get_by==c.TaskType.ad_reward){var n=this.goBtnNode.addComponent(a.default),s=new cc.Component.EventHandler;s.target=this.node,s.component="questItem",s.handler="onWatchEnd","task_1"==t.temp.key&&(s.customEventData="\u6bcf\u65e5\u4efb\u52a1-\u9053\u5177\u793c\u5305"),n.onWatchEndEvent=s,this.adNode.active=!0,this.goImgNode.x=25}this.goBtnNode.active=this._taskData.data.state===c.taskState.Receive,this.getBtnNode.active=this._taskData.data.state===c.taskState.Finish,this.getedNode.active=this._taskData.data.state===c.taskState.Rewared},e.prototype.updateTask=function(t){t&&t.temp.key==this._taskData.temp.key&&(this._taskData=t,cc.tween(this.pro).to(.5,{progress:t.data.count/t.temp.nums}).start(),this.proLbl.string=t.data.count+"/"+t.temp.nums,this.goBtnNode.active=this._taskData.data.state===c.taskState.Receive,this.getBtnNode.active=this._taskData.data.state===c.taskState.Finish,this.getedNode.active=this._taskData.data.state===c.taskState.Rewared)},e.prototype.unuse=function(){var t=this;this.scrollView.content.children.forEach(function(e){t.questPool.put(e)}),this.scrollView.content.removeAllChildren()},e.prototype.reuse=function(){},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.UPDTASK:this.updateTask(t.data)}},e.prototype.onEnable=function(){this.goBtnNode.on("click",this.jumpPage,this),this.getBtnNode.on("click",this.onAward,this),this.eventFunc=this.onOperTap.bind(this),o.default.opE.on(this.eventFunc)},e.prototype.onDisable=function(){this.goBtnNode.off("click",this.jumpPage,this),this.getBtnNode.off("click",this.onAward,this),o.default.opE.off(this.eventFunc),this.eventFunc=null},e.prototype.jumpPage=function(t){var e;return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:if(this._taskData.data.state!=c.taskState.Receive)return[2];switch(this._taskData.temp.get_by){case"ad_reward":return[3,1];case"cg_line":return[3,2];case"qw_line":return[3,3];case"daily_challenge":return[3,4];case"share":return[3,5]}return[3,7];case 1:return null===(e=this.goBtnNode.getComponent(a.default))||void 0===e||e.onClick(t),[3,8];case 2:return s.default.ins.closeAllPanel(),o.default.opE.emit({action:o.default.MAINJUMP,data:2}),[3,8];case 3:return s.default.ins.closeAllPanel(),o.default.opE.emit({action:o.default.MAINJUMP,data:4}),[3,8];case 4:return s.default.ins.closeAllPanel(),o.default.opE.emit({action:o.default.MAINJUMP,data:3}),[3,8];case 5:return[4,n.platform.share()];case 6:return i.sent()&&c.default.doTask(this._taskData.temp.key),[3,8];case 7:return[3,8];case 8:return[2]}})})},Object.defineProperty(e.prototype,"taskData",{get:function(){return this._taskData},enumerable:!1,configurable:!0}),e.prototype.onAward=function(){c.default.updateTask(this._taskData);for(var t=[],e=this.scrollView.content.childrenCount-1;e>=0;e--){var i=this.scrollView.content.children[e],o=i.parent.convertToWorldSpaceAR(i.position),n={};n.itemId=i.getComponent(d.default).key,n.worldPos=o,n.value=i.getComponent(d.default).count,t.push(n)}s.default.ins.open("ui/ui_flyAni",{itemDatas:t})},e.prototype.onWatchEnd=function(){cc.log("\u5e7f\u544a\u7684\u56de\u8c03"),c.default.doTask(this._taskData.temp.key)},__decorate([h(cc.Label)],e.prototype,"nameLbl",void 0),__decorate([h(cc.Node)],e.prototype,"itemsNode",void 0),__decorate([h(cc.Prefab)],e.prototype,"itemPrefab",void 0),__decorate([h(cc.ProgressBar)],e.prototype,"pro",void 0),__decorate([h(cc.Label)],e.prototype,"proLbl",void 0),__decorate([h(cc.Node)],e.prototype,"getBtnNode",void 0),__decorate([h(cc.Node)],e.prototype,"goBtnNode",void 0),__decorate([h(cc.Node)],e.prototype,"adNode",void 0),__decorate([h(cc.Node)],e.prototype,"goImgNode",void 0),__decorate([h(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([h(cc.Node)],e.prototype,"getedNode",void 0),__decorate([p],e)}(cc.Component);i.default=f,cc._RF.pop()},{evts:"evts",idx:"idx",item:"item",lang:"lang",loading:"loading",panelMgr:"panelMgr",taskMgr:"taskMgr",veBtn:"veBtn"}],raceRankItem:[function(t,e,i){"use strict";cc._RF.push(e,"7e2e8kHoUZNVrkBvdUrlq5X","raceRankItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("rankItem"),n=cc._decorator,a=n.ccclass,r=n.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.idxIcon=null,e.idxBg=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.scoreLb.string="",this.idxLb.string="",this.nickNameLb.string="",this.idxIcon&&(this.idxIcon.spriteFrame=null)},e.prototype.initItem=function(t,e){this.setNickName(t.nick),this.setScore(t.score),e?this.setIdxSp(e):this.setIdx(t.idx),t.headUrl?this.setHeadSp(t.headUrl):this.setDefaultHead()},e.prototype.setIdx=function(e){t.prototype.setIdx.call(this,e),this.idxBg.active=!0},e.prototype.setIdxSp=function(t){this.idxIcon.spriteFrame=t,this.idxBg.active=!1},__decorate([r(cc.Sprite)],e.prototype,"idxIcon",void 0),__decorate([r(cc.Node)],e.prototype,"idxBg",void 0),__decorate([a],e)}(o.default);i.default=s,cc._RF.pop()},{rankItem:"rankItem"}],random_notice:[function(t,e,i){"use strict";cc._RF.push(e,"d1568XYcd5KxbBwNiWbgXvK","random_notice"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=(o.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tmpV3=new cc.Vec3,e}return __extends(e,t),e.prototype.init=function(){this.preV3=this.node.position,this.isMoveing=!0},e.prototype.update=function(){var t=this.preV3,e=this.node.position,i=this.tmpV3;cc.Vec3.subtract(i,e,t),t.set(e);var o=cc.Vec3.angle(i,cc.Vec3.RIGHT),n=cc.misc.radiansToDegrees(o);this.node.angle=n-90},__decorate([n],e)}(cc.Component));i.default=a,cc._RF.pop()},{}],rankItem:[function(t,e,i){"use strict";cc._RF.push(e,"64824nHmPRCBqzNVohG2VVh","rankItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("res"),n=t("global"),a=t("panelMgr"),r=t("skinMgr"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nickNameLb=null,e.scoreLb=null,e.idxLb=null,e.headSp=null,e.headFSp=null,e.nameFSp=null,e.game_uid="",e.rankInfo={},e}return __extends(e,t),e.prototype.onLoad=function(){this.setHeadBtn(),this.game_uid=""},e.prototype.setNickName=function(t){t.length>6&&(t=t.substring(0,5)+"..."),this.nickNameLb.string=t},e.prototype.setScore=function(t){this.scoreLb.string=t},e.prototype.setIdx=function(t){this.idxLb.string=t},e.prototype.setHeadSp=function(t){var e=this;t?cc.assetManager.loadRemote(t,{ext:n.headImgExt},function(t,i){e.node&&e.node.isValid&&(t?e.setDefaultHead():e.headSp.spriteFrame=new cc.SpriteFrame(i))}):this.setDefaultHead()},e.prototype.setDefaultHead=function(){o.default.ins.lSF("common/head_1",this.headSp)},e.prototype.setHeadBtn=function(){},e.prototype.setGameUid=function(t){this.game_uid=t},e.prototype.setRankData=function(t){this.rankInfo=t},e.prototype.setSkin=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),t?(t.headFrame&&1!=t.headFrame?r.default.ins.updateHeadFrame(t.headFrame,this.headFSp,!0):r.default.ins.updateHeadFrame(1,this.headFSp,!0),t.nameFrame&&1!=t.nameFrame?r.default.ins.updateNameFrame(t.nameFrame,this.nameFSp):this.nameFSp.spriteFrame=null):(r.default.ins.updateHeadFrame(1,this.headFSp,!0),this.nameFSp.spriteFrame=null)},e.prototype.clearFrame=function(){r.default.ins.updateHeadFrame(1,this.headFSp,!0),this.nameFSp.spriteFrame=null},e.prototype.clickHead=function(){this.game_uid&&a.default.ins.open("ui/ui_userInfo",{gameUid:this.game_uid,baseData:this.rankInfo})},e.nameColor1=new cc.Color(166,86,31),e.nameColor2=new cc.Color(64,109,30),e.nameColor3=new cc.Color(152,54,38),__decorate([l(cc.Label)],e.prototype,"nickNameLb",void 0),__decorate([l(cc.Label)],e.prototype,"scoreLb",void 0),__decorate([l(cc.Label)],e.prototype,"idxLb",void 0),__decorate([l(cc.Sprite)],e.prototype,"headSp",void 0),__decorate([l(cc.Sprite)],e.prototype,"headFSp",void 0),__decorate([l(cc.Sprite)],e.prototype,"nameFSp",void 0),__decorate([c],e)}(cc.Component);i.default=d,cc._RF.pop()},{global:"global",panelMgr:"panelMgr",res:"res",skinMgr:"skinMgr"}],rankMgr:[function(t,e,i){"use strict";var o,n,a;cc._RF.push(e,"e7bedtBQEVEDLcEkhi9q9lw","rankMgr"),Object.defineProperty(i,"__esModule",{value:!0}),i.rankSortType=i.rankType=i.rankTag=void 0;var r,s=t("idx"),c=t("request"),l=t("time"),d=t("pInfo");(r=o=i.rankTag||(i.rankTag={})).mainScore="main_score",r.dailyScore="daily_score",r.mainWin="main_win",r.dailyWin="daily_win",r.raceScore="race_score",function(t){t.Total="total",t.Today="daily"}(n=i.rankType||(i.rankType={})),function(t){t.Desc="desc",t.Asc="asc"}(a=i.rankSortType||(i.rankSortType={}));var u=function(){function t(){this.lastRequestTime=0,this.lastReqRaceTime=0,this.ttMScore=null,this.ttDScore=null,this.ttMWin=null,this.ttDWin=null,this.tdMScore=null,this.tdDScore=null,this.tdMWin=null,this.tdDWin=null,this.tdRScore=null,this.localData=null}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t)},enumerable:!1,configurable:!0}),t.prototype.uploadRankData=function(){var t=n.Total,e=o.mainScore;this.uploadRankDataByTag(e,t),e=o.mainWin,this.uploadRankDataByTag(e,t),e=o.dailyScore,this.uploadRankDataByTag(e,t),e=o.dailyWin,this.uploadRankDataByTag(e,t),t=n.Today,e=o.mainScore,this.uploadRankDataByTag(e,t),e=o.dailyScore,this.uploadRankDataByTag(e,t),e=o.mainWin,this.uploadRankDataByTag(e,t),e=o.dailyWin,this.uploadRankDataByTag(e,t)},t.prototype.uploadRankDataByTag=function(t,e){var i=d.default.ins,o=JSON.parse(JSON.stringify(i.getLastUploadRankData())),n=this.getValueAndKeyByTag(t,e),r=n[0],s=n[1],l=o[s],u=Number(r);if(u>Number(l)){var p=this.getRankDataByType(t,e);o[s]=r,p.then(function(o){var n=o.data,r=0;if(n){n.sort(function(t,e){return e.sort_value-t.sort_value});var s=n[99];s&&(r=s.sort_value)}if(u>Number(r)){var l={};l.uSkin=i.getUsingSkin();var d={rank_tag:t,sort_value:u,sort_type:a.Desc,extra_data:l};c.default.ins.uploadRank(d,e)}}).catch(function(){console.error("getRankDataErr")}),i.setLastUploadRankData(o)}},t.prototype.getValueAndKeyByTag=function(t,e){var i=d.default.ins,a=Object.assign({},d.default.ins.getRecordData());if(e===n.Total)switch(t){case o.mainScore:return[a.main.tPoints,"ttMScore"];case o.dailyScore:return[a.daily.tPoints,"ttDScore"];case o.mainWin:return[a.main.heWins,"ttMWin"];case o.dailyWin:return[a.daily.heWins,"ttDWin"]}else if(e===n.Today)switch(t){case o.mainScore:return[i.getTodayMainScore(),"tdMScore"];case o.dailyScore:return[i.getTodayDailyScore(),"tdDScore"];case o.mainWin:return[i.getTodayMainWin(),"tdMWin"];case o.dailyWin:return[i.getTodayDailyWin(),"tdDWin"]}},t.prototype.uploadRaceData=function(){this.getTodayRaceData().then(function(t){var e=d.default.ins,i=t.data;i&&i.sort(function(t,e){return e.sort_value-t.sort_value});var r=e.getLastUploadRankData(),s=o.raceScore,l=e.getTodayRaceScore(),u=r.tdRScore,p=0,h=i[99];if(h&&(p=h.sort_value),Number(l)>Number(u)&&Number(l)>Number(p)){r.tdRScore=l;var f={};f.uSkin=e.getUsingSkin();var g={rank_tag:s,sort_value:l,sort_type:a.Desc,extra_data:f};c.default.ins.uploadRank(g,n.Today)}e.setLastUploadRankData(r)}).catch(function(){console.error("uploadRaceData")})},t.prototype.getRankDataByType=function(t,e,i){void 0===i&&(i=a.Desc);var o=l.default.ins.serverTime||Math.floor((new Date).getTime()/1e3),r=o-this.lastRequestTime>=3600;r&&this.clearData();var s=this.getCachedDataByType(t,e);if(!r&&s)return this.getCachedDataByType(t,e);if(this.lastRequestTime=o,e===n.Total){var d=c.default.ins.getRank(t,e,i);return this.setCachedDataByType(t,e,d),d}if(e===n.Today){var u=l.default.ins.serverTime||(new Date).getTime();u-=(u+28800)%86400,u*=1e3;var p=c.default.ins.getRank(t,e,i,u);return this.setCachedDataByType(t,e,p),p}},t.prototype.getMyRankDataByTag=function(t,e){var i=d.default.ins.getRecordData();if(e===n.Today)switch(t){case o.mainScore:return d.default.ins.getTodayMainScore();case o.dailyScore:return d.default.ins.getTodayDailyScore();case o.mainWin:return d.default.ins.getTodayMainWin();case o.dailyWin:return d.default.ins.getTodayDailyWin()}else if(e===n.Total)switch(t){case o.mainScore:return i.main.tPoints;case o.dailyScore:return i.daily.tPoints;case o.mainWin:return i.main.heWins;case o.dailyWin:return i.daily.heWins}},t.prototype.getTodayRaceData=function(){var t=l.default.ins.serverTime||Math.floor((new Date).getTime()/1e3),e=t-this.lastReqRaceTime>=3600;e&&(this.tdDWin=null);var i=this.getCachedDataByType(o.raceScore,n.Today);if(e||!i){this.lastReqRaceTime=t;var r=l.default.ins.serverTime||Math.floor((new Date).getTime()/1e3);r-=(r+28800)%86400,r*=1e3;var s=c.default.ins.getRank(o.raceScore,n.Today,a.Desc,r);return this.setCachedDataByType(o.raceScore,n.Today,s),s}return this.getCachedDataByType(o.raceScore,n.Today)},t.prototype.getYdayRaceData=function(){var t=l.default.ins.serverTime||Math.floor((new Date).getTime()/1e3);t-=86400,t-=(t+28800)%86400,t*=1e3;var e=this.getYdayRaceRankData();if(0!=e.length){var i={data:e};return Promise.resolve(i)}return c.default.ins.getRank(o.raceScore,n.Today,a.Desc,t)},t.prototype.getMyRaceTodayData=function(){return d.default.ins.getTodayRaceScore()},t.prototype.getMyRaceYdayData=function(){return d.default.ins.getYdayRaceScore()},t.prototype.setCachedDataByType=function(t,e,i){if(e===n.Total)switch(t){case o.mainScore:this.ttMScore=i;break;case o.dailyScore:this.ttDScore=i;break;case o.mainWin:this.ttMWin=i;break;case o.dailyWin:this.ttDWin=i}else if(e===n.Today)switch(t){case o.mainScore:this.tdMScore=i;break;case o.dailyScore:this.tdDScore=i;break;case o.mainWin:this.tdMWin=i;break;case o.dailyWin:this.tdDWin=i;break;case o.raceScore:this.tdDWin=i}},t.prototype.getCachedDataByType=function(t,e){if(e===n.Total)switch(t){case o.mainScore:return this.ttMScore;case o.dailyScore:return this.ttDScore;case o.mainWin:return this.ttMWin;case o.dailyWin:return this.ttDWin}else if(e===n.Today)switch(t){case o.mainScore:return this.tdMScore;case o.dailyScore:return this.tdDScore;case o.mainWin:return this.tdMWin;case o.dailyWin:case o.raceScore:return this.tdDWin}},t.prototype.clearData=function(){this.ttMScore=null,this.ttDScore=null,this.ttMWin=null,this.ttDWin=null,this.tdMScore=null,this.tdDScore=null,this.tdMWin=null,this.tdDWin=null},t.prototype.getYdayRaceRankData=function(){var t=this.getLocalRaceRankData().ydayRRData;return null==t?[]:t},t.prototype.setYdayRaceRankData=function(t){this.setLocalRaceRankData({ydayRRData:t})},t.prototype.setLocalRaceRankData=function(t){var e=this.getLocalRaceRankData();this.localData=Object.assign(Object.assign({},e),t),s.platform.setStorage("ydayRankData",this.localData)},t.prototype.getLocalRaceRankData=function(){return null==this.localData&&(this.localData=s.platform.getStorage("ydayRankData")||{}),this.localData},t}();i.default=u,cc._RF.pop()},{idx:"idx",pInfo:"pInfo",request:"request",time:"time"}],request:[function(t,e,i){"use strict";cc._RF.push(e,"c853fD3v1xDPam4tdNFLok2","request"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("cfgMgr"),n=t("idx"),a=t("uData"),r=t("pConst"),s=t("time"),c=t("evts"),l=t("flyio"),d=(t("errorCode"),window.fly||l.default,function(){function t(){this._urlCache={},this.APPID=n.platform.appId}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),t.prototype.getUserToken=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this._userToken?[3,2]:[4,this.desynclogin()];case 1:t.sent(),t.label=2;case 2:return[2,this._userToken]}})})},Object.defineProperty(t.prototype,"userToken",{set:function(t){this._userToken=t},enumerable:!1,configurable:!0}),t.prototype._post=function(){},t.prototype.desynclogin=function(){return __awaiter(this,void 0,void 0,function(){var e,i,o,a,r,c;return __generator(this,function(l){switch(l.label){case 0:return[4,n.platform.login()];case 1:return e=l.sent(),i=e.code,o=e.anonymous_code,i?[4,t.ins.login(i,o)]:[2];case 2:if(0==(a=l.sent()).state)throw new Error("\u767b\u5f55\u72b6\u6001\u5417\u9519\u8bef\uff1a"+a.state);return r=t.ins,c=a.data,s.default.ins.sync(a.server_time),r.userToken=c.token,r.openId=c.openid,[2]}})})},t.prototype.getJson=function(){var t={};return t.appid=this.APPID,this._post("/v1/GameConfigApi/get_game_init_config","N644UF9VMU9OFTTYHOV3DEGY7L2DMMVP",t,!1)},t.prototype.login=function(t,e,i,o){var s={};return s.appid=this.APPID,s.system_info=n.platform.getSystemData(),s.code=t,s.openid=i,s.unionid=o,r.PFCode.Alipay===n.platform.string()&&(s.grant_type="authorization_code"),s.anonymous_code=e,s.launch_options=a.default.ins.getLaunchOption(),this._post("/v1/GameConfigApi/game_user_login","N644UF9VMU9OFTTYHOV3DEGY7L2DMMVP",s,void 0,2e3)},t.prototype.getTime=function(){return this._post("/v1/GameConfigApi/game_user_login","123456",{},void 0,2e3)},t.prototype.updateUserInfo=function(t){var e=this;this.getUserToken().then(function(i){if(i&&t){var o=a.default.ins;o.setHeadImg(t.avatar||t.avatarUrl),o.setName(t.nickName||t.nickname),e._post("/v1/GameApi/update_game_user",i,{user_info:t}),c.default.opE.emit({action:c.default.UPD_TOP_HEADINFO})}}).catch(function(t){console.error("updateUserInfoErr",t)})},t.prototype.addHomepageConsult=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(o){switch(o.label){case 0:return t="/v1/GameApi/get_addHome",(e={}).alipay_user_id=this.openId,[4,this.getUserToken()];case 1:return i=o.sent(),[2,this._post(t,i,e,!1)]}})})},t.prototype.uploadRank=function(t,e){var i=this;this.getUserToken().then(function(o){if(o){var n={};n.client_data=[t],n.type=e,i._post("/v1/GameApi/upload_gamer_score",o,n,!0)}}).catch(function(t){console.error("uploadRankErr",t)})},t.prototype.getRank=function(){return Promise.resolve(function(t){cc.resources.load("rank",function(e,i){t(i.json)})})},t.prototype.adDot=function(t,e,i,n){var a=this;void 0===i&&(i=1),void 0===n&&(n=1),this.getUserToken().then(function(r){if(r){var s=o.default.serverCfg.upload_ad_result;if(s&&1==s.val){var c={};c.type=i,c.path=t,c.ad_nums=n,c.status=e,a._post("/v1/GameApi/upload_gamer_ad_recode",r,c,!0)}}}).catch(function(t){console.error("adDotErr",t)})},t.prototype.userFeedBack=function(t){var e=this;return this.getUserToken().then(function(i){if(i){var o={};return o.content=t,e._post("/v1/GameApi/add_reply",i,o)}}).catch(function(t){console.error("userFeedBackErr",t)})},t.prototype.updateServerData=function(t,e,i,o){var n=this;return this.getUserToken().then(function(a){if(a){var r={};r.user_data=t,r.save_tag=e,r.title=i,r.extra_data=o;var s="backData"!=e;return n._post("/v1/GameApi/backup_user_data",a,r,s,5500)}}).catch(function(t){console.error("updateServerDataErr",t)})},t.prototype.getServerData=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,o;return __generator(this,function(n){switch(n.label){case 0:return e="/v1/GameApi/get_user_backup",[4,this.getUserToken()];case 1:return(i=n.sent())?((o={}).save_tag=t,[2,this._post(e,i,o)]):[2]}})})},t.prototype.getMailData=function(t,e){var i=this;return this.getUserToken().then(function(o){if(o){var n={};return n.type=t,n.exp_ids=e,i._post("/v1/GameApi/get_mail",o,n)}}).catch(function(t){console.error("getMailDataErr",t)})},t.prototype.updateChallengeData=function(t){var e=this;this.getUserToken().then(function(i){if(i&&t){var o={};o.level=t,e._post("/v1/GameApi/passLevel",i,o)}}).catch(function(t){console.error("updateUserInfoErr",t)})},t.prototype.getChallengeData=function(t){var e=this;return this.getUserToken().then(function(i){if(i&&t){var o={};return o.level=t,e._post("/v1/GameApi/getCompletionInfo",i,o)}}).catch(function(t){console.error("updateUserInfoErr",t)})},t.prototype.getUserDataByUid=function(t){var e=this;return this.getUserToken().then(function(i){if(i&&t){var o={};return o.game_uid=t,e._post("/v1/GameApi/getUserData",i,o)}}).catch(function(t){console.error("getUserDataByUid",t)})},t.prototype.sendSevenCard=function(t,e){var i=this;this.getUserToken().then(function(o){if(o&&e){var n={};return n.aid=t,n.open_id=i.openId,n.reward_index=e,i._post("/v1/GameApi/saveUserAlienCard",o,n)}}).catch(function(t){console.error("sendSevenCard",t)})},t.prototype.paymentResult=function(t){var e=this;return this.getUserToken().then(function(i){if(i){var o=t;return e._post("/v1/GameApi/get_delivery_status",i,o)}}).catch(function(t){console.error("get_delivery_status",t)})},t.prototype.getPayGamecoins=function(){var t=this;return this.getUserToken().then(function(e){if(e){var i={};return i.open_id=t.openId,console.log("\u83b7\u53d6\u6e38\u620f\u5e01\u53c2\u6570",i),t._post("/v1/GameApi/get_balance",e,i)}})},t.prototype.getUnshippedOrders=function(){var t=this;return this.getUserToken().then(function(e){if(e){var i={};return i.open_id=t.openId,t._post("/v1/GameApi/get_unshipped_orders",e,i)}}).catch(function(t){console.error("get_unshipped_orders",t)})},t}());i.default=d,cc._RF.pop()},{cfgMgr:"cfgMgr",errorCode:"errorCode",evts:"evts",flyio:"flyio",idx:"idx",pConst:"pConst",time:"time",uData:"uData"}],res:[function(t,e,i){"use strict";function o(t,e,i){var o=cc.assetManager.bundles;return function t(n){if(!o.has(n))return null;var a=o.get(n).getInfoWithPath(e,i);return a?a.redirect?t(a.redirect):a.uuid:null}(t)}cc._RF.push(e,"c0cdaipDaZNtoFsplufKRJV","res"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),t.prototype.lPre=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.l(t,cc.Prefab,"prefab")];case 1:return[2,e.sent()]}})})},t.prototype.lSF=function(t,e){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(o){switch(o.label){case 0:return[4,this.l(t,cc.SpriteFrame,"resSps")];case 1:return i=o.sent(),e&&i&&(e.spriteFrame=i),[2,i]}})})},t.prototype.l=function(t,e,i){return void 0===i&&(i="resources"),__awaiter(this,void 0,void 0,function(){var o,n;return __generator(this,function(a){switch(a.label){case 0:return t?(o=cc.resources).getInfoWithPath(t)?[3,4]:[3,1]:[3,6];case 1:return(o=cc.assetManager.getBundle(i))?[3,4]:[3,2];case 2:return[4,new Promise(function(t,e){cc.assetManager.loadBundle(i,function(i,o){i?e(i):t(o)})})];case 3:o=a.sent(),a.label=4;case 4:return[4,this.d(i,t,e)];case 5:return(n=a.sent())?[2,n]:[2,new Promise(function(i,n){o.load(t,e,function(t,e){t?n(t):i(e)})})];case 6:return[2,null]}})})},t.prototype.d=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(){return e&&o(t,e,i)&&(n=cc.assetManager.assets.get(e))?[2,n]:[2,null]})})},t.prototype.getBundleByString=function(t){var e,i,o=new Promise(function(t,o){e=t,i=o}),n=cc.assetManager.getBundle(t);return n?e(n):cc.assetManager.loadBundle(t,function(t,o){t?i():e(o)}),o},t}();i.default=n,cc._RF.pop()},{}],scrollView:[function(t,e,i){"use strict";cc._RF.push(e,"c59d3G5OhpCHoMi9impffT1","scrollView"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxScale=1.5,e.minScale=.5,e.brake=.75,e.content=null,e._touchMovePreviousTimestamp=0,e._autoScrolling=!1,e._touchMoveDisplacements=[],e._touchMoveTimeDeltas=[],e._autoScrollAccumulatedTime=0,e._autoScrollTotalTime=0,e._autoScrollStartPosition=cc.v2(0,0),e._autoScrollTargetDelta=cc.Vec2.ZERO,e._isHandleMultiTouch=!1,e._isOnDestScrolling=!1,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this.content,e=cc.Node.EventType;t.on(e.TOUCH_START,this.onTouchStart,this),t.on(e.TOUCH_MOVE,this.onTouchMove,this),t.on(e.TOUCH_END,this.onTouchEnd,this),t.on(e.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onDestroy=function(){var t=this.content,e=cc.Node.EventType;t.off(e.TOUCH_START,this.onTouchStart,this),t.off(e.TOUCH_MOVE,this.onTouchMove,this),t.off(e.TOUCH_END,this.onTouchEnd,this),t.off(e.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onTouchStart=function(){this.resetTouchInfos()},e.prototype.onTouchMove=function(t){if(!this._isOnDestScrolling){var e=t.getTouches();if(1==e.length){var i=t.getDelta();this.moveContent(i),this.gatherTouchMove(i)}else{this._isHandleMultiTouch=!0;var o=e[0],n=e[1];if(!this._initLen){this._initLen=o.getPreviousLocation().sub(n.getPreviousLocation()).mag();var a=o.getStartLocation().add(n.getStartLocation()).divide(2),r=this.node.convertToNodeSpaceAR(a),s=this.node.convertToWorldSpaceAR(r);this._initPos=this.content.convertToNodeSpaceAR(s),this._initScale=this.content.scale}var c=o.getLocation().sub(n.getLocation()).mag(),l=this._initScale*(c/this._initLen);if(l>this.maxScale||l<this.minScale)return;this._tarScale=l,this._scrollZoom=!0}}},e.prototype.onTouchEnd=function(t){this._isOnDestScrolling||(this._isHandleMultiTouch?this._scrollZoom=null:(this.gatherTouchMove(t.getDelta()),this.startInertiaScroll()),this._isHandleMultiTouch=!1)},e.prototype.update=function(t){if(this._scrollZoom){var e=this.content.scale,i=this._tarScale,o=e+.5*(i-e),n=o-e,a=this._initPos.mul(-n);this.content.scale=o,this.moveContent(a),this._scrollZoom=Math.abs(o-i)>.01}else this._autoScrolling&&this.processAutoScrolling(t)},e.prototype.calculateTouchMoveVelocity=function(){var t=0;if((t=this._touchMoveTimeDeltas.reduce(function(t,e){return t+e},t))<=0||t>=.5)return cc.v2(0,0);var e=cc.v2(0,0);return e=this._touchMoveDisplacements.reduce(function(t,e){return t.add(e)},e),cc.v2(e.x*(1-this.brake)/t,e.y*(1-this.brake)/t)},e.prototype.processAutoScrolling=function(t){var e;this._autoScrollAccumulatedTime+=t;var i=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);e=i,i=(e-=1)*e*e*e*e+1;var o=this._autoScrollStartPosition.add(this._autoScrollTargetDelta.mul(i));Math.abs(i-1)<=1e-4&&(this._autoScrolling=!1);var n=o.sub(this.content.getPosition());this.moveContent(this._clampDelta(n))},e.prototype.startAttenuatingAutoScroll=function(t,e){var i=Math.sqrt(Math.sqrt(e.mag()/5)),o=t.normalize(),n=this.content.getContentSize(),a=this.node.getContentSize(),r=n.width-a.width,s=n.height-a.height,c=this.calculateAttenuatedFactor(r),l=this.calculateAttenuatedFactor(s);o=cc.v2(o.x*r*(1-this.brake)*c,o.y*s*l*(1-this.brake));var d=t.mag(),u=o.mag()/d;o=o.add(t),this.brake>0&&u>7&&(u=Math.sqrt(u),o=t.mul(u).add(t)),this.brake>0&&u>3&&(i*=u=3),0===this.brake&&u>1&&(i*=u),this.startAutoScroll(o,i)},e.prototype.calculateAttenuatedFactor=function(t){return this.brake<=0?1-this.brake:(1-this.brake)*(1/(1+14e-6*t+t*t*8e-9))},e.prototype.startInertiaScroll=function(){var t=this.calculateTouchMoveVelocity();if(!t.fuzzyEquals(cc.v2(0,0),1e-4)&&this.brake<1){var e=t.mul(.7);this.startAttenuatingAutoScroll(e,t)}},e.prototype.startAutoScroll=function(t,e){this._autoScrolling=!0,this._autoScrollTargetDelta=t,this._autoScrollStartPosition=this.content.getPosition(),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0},e.prototype._clampDelta=function(t){var e=this.content.getContentSize(),i=this.node.getContentSize();return e.width<i.width&&(t.x=0),e.height<i.height&&(t.y=0),t},e.prototype.moveContent=function(t,e){var i=this;return void 0===e&&(e=0),new Promise(function(o){var n=t,a=i.content.getPosition().add(n);a.x>i.boundX?(a.x=i.boundX,i._autoScrolling=!1):a.x<-i.boundX&&(a.x=-i.boundX,i._autoScrolling=!1),a.y>i.boundY?(a.y=i.boundY,i._autoScrolling=!1):a.y<-i.boundY&&(a.y=-i.boundY,i._autoScrolling=!1),e>0?cc.tween(i.content).to(e,{position:cc.v3(a.x,a.y)}).call(function(){o()}).start():(i.content.setPosition(a),o())})},e.prototype.getTimeInMilliseconds=function(){return(new Date).getMilliseconds()},e.prototype.gatherTouchMove=function(t){for(t=this._clampDelta(t);this._touchMoveDisplacements.length>=5;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(t);var e=this.getTimeInMilliseconds();this._touchMoveTimeDeltas.push((e-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=e},Object.defineProperty(e.prototype,"boundY",{get:function(){return this.content.height*this.content.scaleY/2-this.node.height/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boundX",{get:function(){return this.content.width*this.content.scaleX/2-this.node.width/2},enumerable:!1,configurable:!0}),e.prototype.scrollTo=function(t,e){var i=this;return void 0===e&&(e=0),this._isOnDestScrolling=!0,this.resetTouchInfos(),new Promise(function(o){i.moveContent(t.mul(-1),e).then(function(){i._isOnDestScrolling=!1,o()})})},e.prototype.resetTouchInfos=function(){this._autoScrolling=!1,this._touchMovePreviousTimestamp=this.getTimeInMilliseconds(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._isHandleMultiTouch=!1,this._initLen=null},e.prototype.stopAutoScroll=function(){this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},__decorate([a({tooltip:"\u6700\u5927\u53ef\u653e\u5927\u500d\u6570",type:cc.Float})],e.prototype,"maxScale",void 0),__decorate([a({tooltip:"\u6700\u5c0f\u53ef\u7f29\u5c0f\u500d\u6570",type:cc.Float})],e.prototype,"minScale",void 0),__decorate([a({tooltip:"\u6eda\u52a8\u4e4b\u540e\u7684\u51cf\u901f\u7cfb\u6570",type:cc.Float})],e.prototype,"brake",void 0),__decorate([a(cc.Node)],e.prototype,"content",void 0),__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],shopItem1:[function(t,e,i){"use strict";cc._RF.push(e,"f95238W2llPIrEkQREhyIIb","shopItem1"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("cfgMgr"),n=t("shopItem"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shopItems=[],e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.initPower=function(){var t,e,i=null===(e=null===(t=o.default.serverCfg)||void 0===t?void 0:t.buy_stamina)||void 0===e?void 0:e.stamina;if(i){var n=0;for(var a in i){var r=i[a];if(r){var s=this.shopItems[n];s&&s.initItem(r,!0)}n++}}},e.prototype.initGold=function(){var t,e,i=null===(e=null===(t=o.default.serverCfg)||void 0===t?void 0:t.buy_gold_coins)||void 0===e?void 0:e.gold_coins;if(i){var n=0;for(var a in i){var r=i[a];if(r){var s=this.shopItems[n];s&&s.initItem(r,!1)}n++}}},__decorate([s([n.default])],e.prototype,"shopItems",void 0),__decorate([r],e)}(cc.Component);i.default=c,cc._RF.pop()},{cfgMgr:"cfgMgr",shopItem:"shopItem"}],shopItem:[function(t,e,i){"use strict";cc._RF.push(e,"13e5clDaOZHmrEnbKIG3sTB","shopItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("res"),a=t("bagMgr"),r=t("panelMgr"),s=t("tipMgr"),c=t("pInfo"),l=t("item"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buyBtnNode=null,e.finNode=null,e.btnPrice=null,e.doubleNode=null,e.itemComp=null,e.shopData=null,e.aniDatas=[],e.isDouble=!1,e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.initItem=function(t,e){var i=this;if(t){this.shopData=t;var o=t.props;for(var a in o){var r=Number(o[a]);this.itemComp.initByData(a,r)}var s=e?"blueLight":"light";n.default.ins.getBundleByString("resSps").then(function(t){t.load("spine/"+s+"/action",sp.SkeletonData,function(t,e){if(!t&&i.node&&i.node.isValid){var o=new cc.Node,n=o.addComponent(sp.Skeleton);n.skeletonData=e,n.animation="animation",o.parent=i.itemComp.node}})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)}),this.btnPrice.string="\xa5"+t.price,this.finNode.active=!1,this.doubleNode.active=!1,this.checkData()}},e.prototype.checkData=function(){if(this.shopData){var t=this.shopData.key,e=c.default.ins.getShopUnreset(),i=this.shopData.double||0,o=e[t]||0;this.isDouble=this.doubleNode.active=o<i}},e.prototype.onBtnBuy=function(){var t=this;if(this.shopData){var e=this.isDouble?1:0,i=this.shopData.props,n=JSON.stringify(this.shopData.props);o.platform.reportEvent(o.ERepEvt.susPayment,{key:this.shopData.key}),o.platform.payment(this.shopData.key,this.shopData.price,e,n).then(function(){var e=[];for(var n in i){var s=i[n];t.isDouble&&(s*=2),a.default.ins.addItem(n,s);var l={};l.itemId=n,l.worldPos=t.node.parent.convertToWorldSpaceAR(t.node.position),l.value=s,e.push(l)}r.default.ins.open("ui/ui_flyAni",{itemDatas:e}),c.default.ins.addShopUnreset(t.shopData.key),t.checkData(),o.platform.reportEvent(o.ERepEvt.paymentResult,{key:t.shopData.key,success:1})}).catch(function(e){s.default.ins.showTip(e,!0),o.platform.reportEvent(o.ERepEvt.paymentResult,{key:t.shopData.key,success:0})})}},__decorate([p(cc.Node)],e.prototype,"buyBtnNode",void 0),__decorate([p(cc.Node)],e.prototype,"finNode",void 0),__decorate([p(cc.Label)],e.prototype,"btnPrice",void 0),__decorate([p(cc.Node)],e.prototype,"doubleNode",void 0),__decorate([p(l.default)],e.prototype,"itemComp",void 0),__decorate([u],e)}(cc.Component);i.default=h,cc._RF.pop()},{bagMgr:"bagMgr",idx:"idx",item:"item",pInfo:"pInfo",panelMgr:"panelMgr",res:"res",tipMgr:"tipMgr"}],shopMgr:[function(t,e,i){"use strict";cc._RF.push(e,"8a5decHXkJJK6qhk3PNOD+U","shopMgr"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("cfgMgr"),a=function(){function t(){this.localData=null}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t)},enumerable:!1,configurable:!0}),t.prototype.getAllRed=function(){var t,e,i=null===(e=null===(t=n.default.serverCfg)||void 0===t?void 0:t.shop_config)||void 0===e?void 0:e.gift,o=0;if(i){var a={};for(var r in i){var s=i[r],c=s.tag||0;s.is_shop&&(a[c]?a[c].push(s):(a[c]=[],a[c].push(s)))}var l=this.getTabsRed();for(var d in a){var u=a[d];if(u){var p=1;if(l[d])p=0;else for(var h=u.length,f=0;f<h;f++)0==(u[f].price||0)&&p++;o+=p}}}return o},t.prototype.getTabsRed=function(){var t=this.getLocalShopRedData().tabsRed;return null==t?{}:t},t.prototype.setTabsRed=function(t){this.setLocalShopRedData({tabsRed:t})},t.prototype.getPackRed=function(){var t=this.getLocalShopRedData().packRed;return null==t?{}:t},t.prototype.setPackRed=function(t){this.setLocalShopRedData({packRed:t})},t.prototype.setLocalShopRedData=function(t){var e=this.getLocalShopRedData();this.localData=Object.assign(Object.assign({},e),t),o.platform.setStorage("shopRed",this.localData)},t.prototype.getLocalShopRedData=function(){return null==this.localData&&(this.localData=o.platform.getStorage("shopRed")||{}),this.localData},t}();i.default=a,cc._RF.pop()},{cfgMgr:"cfgMgr",idx:"idx"}],skinBg:[function(t,e,i){"use strict";cc._RF.push(e,"7a56ebbKS9OsZ5A4r1830oM","skinBg"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("skinMgr"),n=t("skinItemBase"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemSp=null,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.loadItem=function(){o.default.ins.updateBg(this.ref,this.itemSp)},e.prototype.clickItem=function(){var t;this.state!==o.SkinState.using&&(t=this.itemSp.node,this.openSkinInfo(t))},__decorate([s(cc.Sprite)],e.prototype,"itemSp",void 0),__decorate([r],e)}(n.default);i.default=c,cc._RF.pop()},{skinItemBase:"skinItemBase",skinMgr:"skinMgr"}],skinContent:[function(t,e,i){"use strict";cc._RF.push(e,"25d4cZd7RtM460Zomkgx+9w","skinContent"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("skinItemBase"),n=cc._decorator,a=n.ccclass,r=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInit=!1,e}return __extends(e,t),e.prototype.initContent=function(t){if(!this.isInit){for(var e=this.node.children[0],i=t.itemData,n=t.skinId,a=0;a<i.length;a++){var r=null;this.node.childrenCount>a?r=this.node.children[a]:(r=cc.instantiate(e),this.node.addChild(r)),r.getComponent(o.default).initItem(i[a],n)}this.isInit=!0}},__decorate([a],e)}(cc.Component));i.default=r,cc._RF.pop()},{skinItemBase:"skinItemBase"}],skinHeadFrame:[function(t,e,i){"use strict";cc._RF.push(e,"495e1u4RCpPV7Xh5v/0L5/6","skinHeadFrame"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("skinMgr"),n=t("skinItemBase"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemSp=null,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.loadItem=function(){o.default.ins.updateHeadFrame(this.ref,this.itemSp)},e.prototype.clickItem=function(){var t;this.state!==o.SkinState.using&&(t=this.itemSp.node,this.openSkinInfo(t))},__decorate([s(cc.Sprite)],e.prototype,"itemSp",void 0),__decorate([r],e)}(n.default);i.default=c,cc._RF.pop()},{skinItemBase:"skinItemBase",skinMgr:"skinMgr"}],skinItemBase:[function(t,e,i){"use strict";cc._RF.push(e,"31bb8q44stCjow3FOL8MsYB","skinItemBase"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("panelMgr"),a=t("skinMgr"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.usingNode=null,e.lockNode=null,e.state=a.SkinState.none,e.ref=-1,e.id="",e}return __extends(e,t),e.prototype.onLoad=function(){var t=this.node.getContentSize();this.lockNode.setContentSize(t),this.usingNode.setPosition(0,0)},e.prototype.start=function(){},e.prototype.onEnable=function(){this.node.on("click",this.clickItem,this),this.eventFunc=this.onOperTap.bind(this),o.default.opE.on(this.eventFunc)},e.prototype.onDisable=function(){this.node.off("click",this.clickItem,this),o.default.opE.off(this.eventFunc),this.eventFunc=null},e.prototype.onOperTap=function(t){t.action===o.default.SKIN_CHG&&this.updateState()},e.prototype.initItem=function(t,e){this.ref=t.ref,this.id=e,this.updateState(),this.loadItem()},e.prototype.updateState=function(){var t=a.default.ins.isHasSkin(this.id,this.ref)?a.SkinState.unlock:a.SkinState.lock;t===a.SkinState.unlock&&a.default.ins.isUsingSkin(this.id,this.ref)&&(t=a.SkinState.using),this.setState(t)},e.prototype.setState=function(t){this.state=t,this.usingNode.active=t==a.SkinState.using,this.lockNode.active=t==a.SkinState.lock},e.prototype.loadItem=function(){},e.prototype.clickItem=function(){},e.prototype.openSkinInfo=function(t){var e=this.ref,i=this.id;n.default.ins.open("ui/ui_skinInfo",{ref:e,skinId:i,showNode:t,unlockState:this.state})},__decorate([c(cc.Node)],e.prototype,"usingNode",void 0),__decorate([c(cc.Node)],e.prototype,"lockNode",void 0),__decorate([s],e)}(cc.Component);i.default=l,cc._RF.pop()},{evts:"evts",panelMgr:"panelMgr",skinMgr:"skinMgr"}],skinMgr:[function(t,e,i){"use strict";var o;cc._RF.push(e,"9335eNcn6hC4YaMUkwXQ5k8","skinMgr"),Object.defineProperty(i,"__esModule",{value:!0}),i.SkinUnlockType=i.SkinIdEnum=i.SkinState=void 0;var n,a=t("evts"),r=t("idx"),s=t("res"),c=t("uData"),l=t("global"),d=t("pInfo");(n=i.SkinState||(i.SkinState={}))[n.none=0]="none",n[n.unlock=1]="unlock",n[n.lock=2]="lock",n[n.using=3]="using",function(t){t.bg="bg",t.role="role",t.nameFrame="nameFrame",t.headFrame="headFrame"}(o=i.SkinIdEnum||(i.SkinIdEnum={})),function(t){t[t.none=0]="none",t[t.video=1]="video",t[t.coin=2]="coin"}(i.SkinUnlockType||(i.SkinUnlockType={}));var u=function(){function t(){this.defaultConfig={bg:{skinId:"bg",itemData:[{ref:1,name:"\u9ed8\u8ba4\u80cc\u666f",unlockType:0,unlockValue:0,desc:""},{ref:2,name:"\u591c\u8272\u964d\u4e34",unlockType:1,unlockValue:20,desc:""}]},role:{skinId:"role",itemData:[{ref:1,name:"\u9ed8\u8ba4\u89d2\u8272",unlockType:0,unlockValue:0,desc:""},{ref:2,name:"\u6d41\u8fde\u5fd8\u8fd4",unlockType:1,unlockValue:20,desc:""}]},nameFrame:{skinId:"nameFrame",itemData:[{ref:1,name:"\u9ed8\u8ba4\u540d\u5b57\u6846",unlockType:0,unlockValue:0,desc:""},{ref:2,name:"\u5fc3\u65f7\u795e\u6021",unlockType:2,unlockValue:1e4,desc:""},{ref:3,name:"\u6d77\u8a93\u5c71\u76df",unlockType:2,unlockValue:1e4,desc:""},{ref:4,name:"\u65d6\u65ce\u98ce\u5149",unlockType:2,unlockValue:2e4,desc:""},{ref:5,name:"\u67f3\u6697\u82b1\u906e",unlockType:2,unlockValue:2e4,desc:""},{ref:6,name:"\u59f9\u7d2b\u5ae3\u7ea2",unlockType:2,unlockValue:2e4,desc:""}]},headFrame:{skinId:"headFrame",itemData:[{ref:1,name:"\u9ed8\u8ba4\u5934\u50cf\u6846",unlockType:0,unlockValue:0,desc:""},{ref:2,name:"\u79c0\u8272\u53ef\u9910",unlockType:2,unlockValue:2e4,desc:""},{ref:3,name:"\u706b\u6811\u94f6\u82b1",unlockType:2,unlockValue:2e4,desc:""},{ref:4,name:"\u6e56\u5149\u5c71\u8272",unlockType:2,unlockValue:2e3,desc:""},{ref:5,name:"\u9e1f\u8bed\u82b1\u9999",unlockType:1,unlockValue:10,desc:""},{ref:6,name:"\u6c5f\u5c71\u5982\u753b",unlockType:1,unlockValue:10,desc:""}]}},this.skinConfig=this.defaultConfig}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t)},enumerable:!1,configurable:!0}),t.prototype.init=function(){var t=this;cc.resources.load("config",cc.JsonAsset,function(e,i){!e&&i&&i.json?t.skinConfig=i.json:t.skinConfig=t.defaultConfig})},t.prototype.isUsingSkin=function(t,e){return d.default.ins.getUsingSkin()[t]===e},t.prototype.isHasSkin=function(t,e){var i=d.default.ins.getMySkin();return i[t]&&i[t].includes(e)},t.prototype.getSkinConfig=function(t){return this.skinConfig[t]},t.prototype.getSkinData=function(t,e){for(var i=this.getSkinConfig(t).itemData,o=0;o<i.length;o++)if(i[o].ref===e)return i[o];return null},t.prototype.addSkin=function(t,e){d.default.ins.addMySkin(t,e),r.platform.reportEvent(r.ERepEvt.buySkin,{skinId:t,ref:e}),a.default.opE.emit({action:a.default.SKIN_CHG,data:{skinId:t,ref:e,isUse:!1}}),c.default.ins._setLocalAndCloudData()},t.prototype.usingSkin=function(t,e){var i;d.default.ins.setUsingSkin(((i={})[t]=e,i)),r.platform.reportEvent(r.ERepEvt.useSkin,{skinId:t,ref:e}),a.default.opE.emit({action:a.default.SKIN_CHG,data:{skinId:t,ref:e,isUse:!0}})},t.prototype.updateHeadFrame=function(t,e,i){var n,a;if(void 0===i&&(i=!1),e){var r;t||(t=1);var c=(null===(a=null===(n=this.getSkinConfig(o.headFrame))||void 0===n?void 0:n.itemData)||void 0===a?void 0:a.length)||1;(t=Math.min(t,c))>6?(r=l.OssConfig.skinUrl+"headFrame/head"+t+".png",cc.assetManager.loadRemote(r,cc.Texture2D,function(t,o){if(!t&&o&&e.isValid){var n=new cc.SpriteFrame(o);e.spriteFrame=n}else i?(r="game/skin/headFrame/head1",s.default.ins.lSF(r,e)):e.spriteFrame=null})):(r="game/skin/headFrame/head"+t,s.default.ins.lSF(r,e))}},t.prototype.updateBg=function(t,e,i){var n,a;if(void 0===i&&(i=!1),e){var r;t||(t=1);var c=(null===(a=null===(n=this.getSkinConfig(o.bg))||void 0===n?void 0:n.itemData)||void 0===a?void 0:a.length)||1;(t=Math.min(t,c))>2?(r=l.OssConfig.skinUrl+"bg/top"+t+".jpg",cc.assetManager.loadRemote(r,cc.Texture2D,function(t,o){if(!t&&o&&e.isValid){var n=new cc.SpriteFrame(o);e.spriteFrame=n}else i?(r="game/normal/top1",s.default.ins.lSF(r,e)):e.spriteFrame=null})):(r="game/normal/top"+t,s.default.ins.lSF(r,e))}},t.prototype.updateNameFrame=function(t,e,i){var n,a;if(void 0===i&&(i=!1),e){var r;t||(t=1);var c=(null===(a=null===(n=this.getSkinConfig(o.nameFrame))||void 0===n?void 0:n.itemData)||void 0===a?void 0:a.length)||1;(t=Math.min(t,c))>6?(r=l.OssConfig.skinUrl+"nameFrame/name"+t+".png",cc.assetManager.loadRemote(r,cc.Texture2D,function(t,o){if(!t&&o&&e.isValid){var n=new cc.SpriteFrame(o);e.spriteFrame=n}else i?(r="game/skin/nameFrame/name1",s.default.ins.lSF(r,e)):e.spriteFrame=null})):(r="game/skin/nameFrame/name"+t,s.default.ins.lSF(r,e))}},t.prototype.updateRole=function(t,e,i){var n,a,r=this;if(void 0===i&&(i=!1),e){t||(t=1);var c=(null===(a=null===(n=this.getSkinConfig(o.role))||void 0===n?void 0:n.itemData)||void 0===a?void 0:a.length)||1;if((t=Math.min(t,c))>2)this.curRoleNode=e,this.curRoleRef=t,Promise.all([this._remoteAtlas(),this._remoteImg(),this._remoteJson()]).then(function(t){var i=t[0],o=t[1],n=t[2];return __awaiter(r,void 0,void 0,function(){var t,a,r,c;return __generator(this,function(l){switch(l.label){case 0:return(t=new sp.SkeletonData).skeletonJson=n.json,t.atlasText=i.text,t.textures=[o],t.textureNames=["1.png"],[4,s.default.ins.lPre("skin/girl1")];case 1:return a=l.sent(),r=cc.instantiate(a),(c=r.getComponent(sp.Skeleton))?(c.skeletonData=t,r.position=cc.Vec3.ZERO,c.animation="idle",e.addChild(r),[2]):[2]}})})}).catch(function(t){if(console.error(t),e.removeAllChildren(),i){if(!e)return;s.default.ins.lPre("skin/girl1").then(function(t){var i=cc.instantiate(t);i.position=cc.Vec3.ZERO,e.addChild(i)})}});else{var l="skin/girl"+t;e.removeAllChildren(),s.default.ins.lPre(l).then(function(t){var i=cc.instantiate(t);i.position=cc.Vec3.ZERO,e.addChild(i)})}}},t.prototype._remoteAtlas=function(){var t=this,e=l.OssConfig.skinUrl+"role/"+this.curRoleRef+"/1.atlas";return new Promise(function(i,o){cc.assetManager.loadRemote(e,function(e,n){e&&o(e),t.curRoleNode.isValid||o("this.curRoleNode.isValid === false"),n||o("atlasText is null"),i(n)})})},t.prototype._remoteImg=function(){var t=this,e=l.OssConfig.skinUrl+"role/"+this.curRoleRef+"/1.png";return new Promise(function(i,o){cc.assetManager.loadRemote(e,function(e,n){e&&o(e),t.curRoleNode.isValid||o("this.curRoleNode.isValid === false"),n||o("texture is null"),i(n)})})},t.prototype._remoteJson=function(){var t=this,e=l.OssConfig.skinUrl+"role/"+this.curRoleRef+"/1.json";return new Promise(function(i,o){cc.assetManager.loadRemote(e,function(e,n){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(){return e&&o(e),this.curRoleNode.isValid||o("this.curRoleNode.isValid === false"),n||o("skeletonJson is null"),i(n),[2]})})})})},t}();i.default=u,cc._RF.pop()},{evts:"evts",global:"global",idx:"idx",pInfo:"pInfo",res:"res",uData:"uData"}],skinNameFrame:[function(t,e,i){"use strict";cc._RF.push(e,"367f7W3ubxNcbB33cXikbqd","skinNameFrame"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("skinMgr"),n=t("skinItemBase"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemSp=null,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.loadItem=function(){this.itemSp.node.y=this.ref>1?0:-4,this.itemSp.type=this.ref>1?cc.Sprite.Type.SIMPLE:cc.Sprite.Type.SLICED,this.itemSp.sizeMode=this.ref>1?cc.Sprite.SizeMode.TRIMMED:(this.itemSp.node.setContentSize(155,55),cc.Sprite.SizeMode.CUSTOM),o.default.ins.updateNameFrame(this.ref,this.itemSp)},e.prototype.clickItem=function(){var t;this.state!==o.SkinState.using&&(t=this.itemSp.node,this.openSkinInfo(t))},__decorate([s(cc.Sprite)],e.prototype,"itemSp",void 0),__decorate([r],e)}(n.default);i.default=c,cc._RF.pop()},{skinItemBase:"skinItemBase",skinMgr:"skinMgr"}],skinRole:[function(t,e,i){"use strict";cc._RF.push(e,"c3f91k0OeBK2Z1h7DbieN6o","skinRole"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("skinMgr"),n=t("skinItemBase"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleNode=null,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.loadItem=function(){o.default.ins.updateRole(this.ref,this.roleNode)},e.prototype.clickItem=function(){var t;this.state!==o.SkinState.using&&(t=this.roleNode.children[0],this.openSkinInfo(t))},__decorate([s(cc.Node)],e.prototype,"roleNode",void 0),__decorate([r],e)}(n.default);i.default=c,cc._RF.pop()},{skinItemBase:"skinItemBase",skinMgr:"skinMgr"}],slider:[function(t,e,i){"use strict";cc._RF.push(e,"dfa43OykftLfa6ThTFErZTe","slider"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handle=null,e.slideEvents=[],e.pro=null,e._progress=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},set:function(t){this._progress=cc.misc.clamp01(t),this.pro.width=this._progress*this.node.width},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.handle&&this.handle.isValid&&this.handle.node.on(cc.Node.EventType.TOUCH_MOVE,this.tM,this)},e.prototype.init=function(t){this.progress=t,this.handle.node.x=this.progress*this.node.width},e.prototype.tM=function(t){var e=t.getLocation(),i=this.node.convertToNodeSpaceAR(e);this.handle.node.x=cc.misc.clampf(i.x,0,this.node.width),this.progress=this.handle.node.x/this.node.width,this.slideEvents.length>0&&cc.Component.EventHandler.emitEvents(this.slideEvents,this)},__decorate([a(cc.Button)],e.prototype,"handle",void 0),__decorate([a([cc.Component.EventHandler])],e.prototype,"slideEvents",void 0),__decorate([a(cc.Node)],e.prototype,"pro",void 0),__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],sound:[function(t,e,i){"use strict";cc._RF.push(e,"9e58fSpOr5KX6wp5ukpL3BX","sound"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("pInfo"),n=t("c"),a=t("evts"),r=t("uData"),s=function(){function t(){this.isSharing=!1,this.isHiding=!1,this.delayID=0,this.clips={},a.default.plE.on(function(e){e.onShow?(t.ins.isHiding=!1,t.ins.onSoundChange()):e.onHide&&(t.ins.isHiding=!0,t.ins.onSoundChange())}),a.default.adE.on(function(e){t.ins.isSharing=e==n.ADE.SHARE||e==n.ADE.VIDEO,t.ins.onSoundChange()})}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bgmVolume",{get:function(){return void 0===this._bgmVolume&&(this._bgmVolume=r.default.ins.getSetting().bgmVolume),this._bgmVolume},set:function(t){cc.audioEngine.setMusicVolume(t),this._bgmVolume=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectVolume",{get:function(){return void 0===this._effectVolume&&(this._effectVolume=r.default.ins.getSetting().effectVolume),this._effectVolume},set:function(t){this._effectVolume=t},enumerable:!1,configurable:!0}),t.prototype.onSoundChange=function(){clearTimeout(this.delayID),this.delayID=setTimeout(function(){clearTimeout(t.ins.delayID),t.ins.delayID=0,t.ins.isSharing||t.ins.isHiding?t.ins.stopAll():t.ins.resumeAll()},100)},t.prototype.stopAllEffects=function(){cc.audioEngine.stopAllEffects()},t.prototype.resumeAll=function(){cc.audioEngine.resumeMusic(),cc.audioEngine.resumeAllEffects()},t.prototype.stopAll=function(){cc.audioEngine.stopMusic(),cc.audioEngine.stopAllEffects()},t.prototype.play=function(t,e){return void 0===e&&(e=0),__awaiter(this,void 0,void 0,function(){var i,o,n;return __generator(this,function(a){switch(a.label){case 0:return!1!==r.default.ins.getSetting().effectSound&&null!=t?[3,1]:[2];case 1:return e=Math.max(1,Math.min(0,e)),t instanceof cc.AudioClip?(i=t,[3,5]):[3,2];case 2:return null!=this.clips[t]?[3,4]:(o=this.clips,n=t,[4,new Promise(function(e){cc.assetManager.loadBundle("sound",function(i,o){i?e(i):o.load(t,cc.AudioClip,function(t,i){e(t?null:i)})})})]);case 3:return i=o[n]=a.sent(),[3,5];case 4:i=this.clips[t],a.label=5;case 5:return i?(cc.audioEngine.playEffect(i,!1),cc.audioEngine.setEffectsVolume(e*this.effectVolume),[2,i.duration]):[2];case 6:return[2]}})})},t.prototype.playBGM=function(){return __awaiter(this,void 0,void 0,function(){var e,i,n=this;return __generator(this,function(){return 0==(e=r.default.ins.getSetting().bgmSound)?[2]:(i=o.ROOT==o.sceneType.game||o.ROOT==o.sceneType.guide?"Game":"Main",cc.assetManager.loadBundle("sound",function(o,a){o||a.load(t.BGM+i,cc.AudioClip,function(t,o){if(!t){var a=cc.audioEngine;n.curBg==i&&a.isMusicPlaying()||!e||(n.curBg=i,a.playMusic(o,!0),a.setMusicVolume(n.bgmVolume))}})}),[2])})})},t.prototype.stopBGM=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return r.default.ins.getSetting().bgmSound&&!t?[2]:(cc.audioEngine.stopMusic(),[2])})})},t.CLICK="click",t.BGM="BGM",t.WIN="win",t.LOSE="lose",t.RIGHT="right",t.ERROR="error",t.SHOVEL="shovel",t.ROCKETLAUNCH="rocketLaunch",t.ROCKETATTACK="rocketAttack",t.TIME="time",t.FINISH_PUZZLE="finish_puzzle",t}();i.default=s,cc._RF.pop()},{c:"c",evts:"evts",pInfo:"pInfo",uData:"uData"}],swBtn:[function(t,e,i){"use strict";cc._RF.push(e,"7c4e0aUwodIo6AqBp46T8p1","swBtn"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprNode=null,e.flag=!0,e}return __extends(e,t),e.prototype.start=function(){this.u()},e.prototype.setState=function(t){this.flag=t,this.u()},e.prototype.u=function(){null!=this.sprNode&&(this.sprNode.active=this.flag)},__decorate([a(cc.Node)],e.prototype,"sprNode",void 0),__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],tE:[function(t,e,i){"use strict";cc._RF.push(e,"d306dQjHl5AJbe+g7xzVEUS","tE"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this._1=[],this._2=[]}return t.prototype.on=function(t){var e=this;return e._1.push(t),function(){return e.off(t)}},t.prototype.once=function(t){var e=this;return e._2.push(t),function(){return e.off(t)}},t.prototype.off=function(t){var e=this,i=e._1.indexOf(t);i>-1&&e._1.splice(i,1),(i=e._2.indexOf(t))>-1&&e._2.splice(i,1)},t.prototype.emit=function(t){var e=this;e._1.forEach(function(e){return e(t)}),e._2.forEach(function(e){return e(t)}),e._2=[]},t.prototype.pipe=function(t){return this.on(function(e){return t.emit(e)})},t.prototype.clear=function(){this._1=[],this._2=[]},t}();i.default=o,cc._RF.pop()},{}],taskMgr:[function(t,e,i){"use strict";cc._RF.push(e,"43d38GhCKVBYrlCS5iT8Rpi","taskMgr"),Object.defineProperty(i,"__esModule",{value:!0}),i.taskState=i.taskChannel=i.TaskType=i.taskPro=i.taskBase=void 0;var o=t("evts"),n=t("idx"),a=t("cfgMgr"),r=t("pInfo"),s=t("bagMgr"),c=t("lang"),l=function(){function t(){}return t.initTask=function(){t.getTaskByType(u.daily,!0),t.getTaskByType(u.achieve,!0)},t.getTaskByType=function(e){var i,o=this,n=a.default.serverCfg[e],s=t.baseTask[e],c=t.saveData[e]||r.default.ins.getTask(e);t.baseTask[e]=s={};var l=0===Object.keys(c).length;return null===(i=null==n?void 0:n.rules)||void 0===i||i.forEach(function(t){var i=o.baseTask[e][t.key];i||((i=new h).temp=t,i.data=c[t.key]||new g,s[t.key]=i,c[t.key]=i.data)}),l&&r.default.ins.setTask(e,c),t.saveData[e]||(t.saveData[e]=c),s},t.taskReset=function(){t.taskResetByTyp(u.daily)},t.taskResetByTyp=function(e){var i,o=a.default.serverCfg[e],n=t.saveData[e]||{};null===(i=null==o?void 0:o.rules)||void 0===i||i.forEach(function(t){n[t.key]?(n[t.key].count=0,n[t.key].state=p.Receive):n[t.key]=new g}),t.saveData[e]=n,r.default.ins.setTask(e,n)},t.updateTask=function(e,i){void 0===i&&(i=u.daily);var a=t.baseTask[i],l=t.saveData[i];if(a&&e.data.state==p.Finish)for(var h in e.temp.get_by==d.ad_reward?e.data.state=e.data.count>=e.temp.nums?p.Rewared:p.Receive:e.data.state=p.Rewared,a[e.temp.key]=e,l[e.temp.key]=e.data,r.default.ins.setTask(i,l),n.platform.reportEvent(n.ERepEvt.dailyTask,{taskId:c.lang[e.temp.key]}),o.default.opE.emit({action:o.default.UPDTASK,data:e}),e.temp.val)e.temp.val.hasOwnProperty(h)&&s.default.ins.addItem(h,e.temp.val[h])},t.doTask=function(e,i){void 0===i&&(i=u.daily);var n=t.baseTask[i],a=t.saveData[i];if(n){var s;for(var c in n)if(n.hasOwnProperty(c)){var l=n[c];if(l.data.state!=p.Receive)continue;var h="string"==typeof e&&Object.values(d).includes(e)?"get_by":"key";l.temp[h]==e&&(l.data.count+=1,(l.data.count>=l.temp.nums||l.temp.get_by==d.ad_reward)&&(l.data.state=p.Finish,a[c]=l.data),s=!0,o.default.opE.emit({action:o.default.UPDTASK,data:l})),o.default.opE.emit({action:o.default.UPD_MAIN_RED})}s&&r.default.ins.setTask(i,a)}},t.taskCheck=function(e){switch(e){case r.gameType.normal:case r.gameType.freedom:t.doTask(d.cg_line);break;case r.gameType.race:t.doTask(d.qw_line);break;case r.gameType.challenge:t.doTask(d.daily_challenge)}},t.getFinishNum=function(){for(var e=a.default.serverCfg[u.daily],i=t.getTaskByType(u.daily),o=null==e?void 0:e.rules,n=0,r=0,s=o.length;r<s;r++)i[o[r].key].data.state==p.Finish&&n++;return n},t.getUnFinishNum=function(){for(var e=a.default.serverCfg[u.daily],i=t.getTaskByType(u.daily),o=null==e?void 0:e.rules,n=0,r=0,s=o.length;r<s;r++)i[o[r].key].data.state==p.Receive&&n++;return n},t.baseTask={},t.saveData={},t}();i.default=l;var d,u,p,h=function(){};i.taskBase=h;var f,g=function(){this.count=0,this.state=p.Receive};i.taskPro=g,(f=d=i.TaskType||(i.TaskType={})).ad_reward="ad_reward",f.cg_line="cg_line",f.daily_challenge="daily_challenge",f.qw_line="qw_line",function(t){t.daily="daily_tasks",t.achieve="achieve_tasks"}(u=i.taskChannel||(i.taskChannel={})),function(t){t[t.None=0]="None",t[t.Receive=1]="Receive",t[t.Finish=2]="Finish",t[t.Rewared=3]="Rewared"}(p=i.taskState||(i.taskState={})),cc._RF.pop()},{bagMgr:"bagMgr",cfgMgr:"cfgMgr",evts:"evts",idx:"idx",lang:"lang",pInfo:"pInfo"}],tb:[function(t,e,i){"use strict";cc._RF.push(e,"b3b25KMz3pN65/TF12QdPWO","tb"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("ali"),n=t("uData"),a=t("evts"),r=t("pConst"),s=t("sound"),c=t("idx"),l=t("time"),d=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"appId",{get:function(){return"3000000107678912"},enumerable:!1,configurable:!0}),e.prototype.string=function(){return r.PFCode.TaoBao},e.prototype.login=function(){return Promise.resolve()},e.prototype.initAliListener=function(){var t=this;o.my.onShow(function(e){a.default.plE.emit({onShow:!0,isSharing:t.isSharing}),n.default.ins.syncLaunchOption(e),t.isSharing||t.reenter(),t.bySlider="gamecenter"==e.query.sourceChannel,a.default.opE.emit({action:a.default.Slider_Chg})}),o.my.onHide(function(){t.onHideT=l.default.ins.serverTime,a.default.plE.emit({onHide:!0})});var e=r.SDKConfig.shareData();this.canUse("8.8.0")&&(o.my.onShareAppMessage=function(){return{title:e.title,desc:"",imageUrl:"https://tjkj300.oss-cn-shenzhen.aliyuncs.com/web/tjkj300web/other/share.jpg"}}),o.my.onMemoryWarning&&o.my.onMemoryWarning(function(){o.my.triggerGC&&o.my.triggerGC()})},e.prototype.initCommonSetting=function(){o.my.getNetworkType({success:function(){},fail:function(){}}),a.default.chE.on(function(){})},e.prototype.syncTime=function(){return new Promise(function(t){var e=c.platform.cloud;e?e.callContainer({path:"/api/gTime",init:{method:"GET",header:{"content-type":"application/json"},timeout:2e3},success:function(e){var i,o=e.data;if(o)if("string"==typeof o)try{i=JSON.parse(o).t}catch(e){}else i=o.t;t(i||null)},fail:function(){return t(null)}}):t(null)})},e.prototype.doWatchAD=function(){},e.prototype.share=function(){return new Promise(function(t){o.my.showSharePanel({from:"code",success:function(){s.default.ins.playBGM(),t(1)},fail:function(e){console.error("alisharedata fail:",e),s.default.ins.playBGM(),t(0)}})})},e}((o=t("ali")).default);i.default=d,cc._RF.pop()},{ali:"ali",evts:"evts",idx:"idx",pConst:"pConst",sound:"sound",time:"time",uData:"uData"}],temp:[function(t,e){"use strict";cc._RF.push(e,"c3183USi7VC9LK6sjitvsGm","temp"),cc._RF.pop()},{}],time:[function(t,e,i){"use strict";cc._RF.push(e,"59024eX+axMOIBY16DZlWQV","time"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("uData"),n=function(){function t(){}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),t.prototype.sync=function(t){this.serverStartT=t||Date.now(),this.clientStartT=Date.now()},Object.defineProperty(t.prototype,"serverTime",{get:function(){return Math.floor((this.serverStartT+Date.now()-this.clientStartT)/1e3)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loginTime",{get:function(){return this.loginT||(this.loginT=o.default.ins.getLocalDataByKey("login_date")),this.loginT},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSameDay",{get:function(){if(!t.ins.serverTime||!t.ins.loginTime)return!0;var e=new Date(1e3*t.ins.serverTime),i=new Date(1e3*t.ins.loginTime);return e.getFullYear()==i.getFullYear()&&e.getMonth()==i.getMonth()&&e.getDate()==i.getDate()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextZeroTime",{get:function(){var t=1e3*this.serverTime,e=new Date(t);return e.setDate(e.getDate()+1),e.setHours(0,0,0,0),e.getTime()-t},enumerable:!1,configurable:!0}),t.getFormatHMS=function(t,e,i){void 0===e&&(e="HH:MM:SS"),void 0===i&&(i=!0);var o=Math.floor(t/86400),n=o.toString();i&&(n=(n="00"+o).substring(n.length-2));var a=Math.floor(t%86400/3600),r=a.toString();i&&(r=(r="00"+a).substring(r.length-2));var s=Math.floor(t%3600/60),c=s.toString();i&&(c=(c="00"+s).substring(c.length-2));var l=Math.floor(t%3600%60),d=l.toString();i&&(d=(d="00"+l).substring(d.length-2));var u={"D+":n,"H+":r,"M+":c,"S+":d};for(var p in u){var h=new RegExp("("+p+")").exec(e);h&&(e=e.replace(h[1],u[p]))}return e},t.formatDate2Str=function(t,e){var i,o,n;void 0===e&&(e=!1);var a=Math.floor(t/86400);if(a>0){var r=a.toString();return e&&(r=(r="00"+a).substring(r.length-2)),r+"\u5929"}if((i=Math.floor(t%86400/3600))>0){var s=i.toString();return e&&(s=(s="00"+i).substring(s.length-2)),s+"\u5c0f\u65f6"}if((o=Math.floor(t%3600/60))>0){var c=o.toString();return e&&(c=(c="00"+o).substring(c.length-2)),c+"\u5206\u949f"}if((n=Math.floor(t%3600%60))>0){var l=n.toString();return e&&(l=(l="00"+n).substring(l.length-2)),l+"\u79d2"}return"0\u79d2"},t.prototype.formatDate=function(t){var e=new Date(t),i=e.getFullYear(),o=e.getMonth()+1,n=e.getDate(),a=e.getHours(),r=e.getMinutes(),s=e.getSeconds();return i+"-"+(o<10?"0":"")+o+"-"+(n<10?"0":"")+n+" "+(a<10?"0":"")+a+":"+(r<10?"0":"")+r+":"+(s<10?"0":"")+s},t}();i.default=n,cc._RF.pop()},{uData:"uData"}],tipMgr:[function(t,e,i){"use strict";cc._RF.push(e,"a83eevdkoxFOaQQ5jw2Zqgx","tipMgr"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("res"),n=t("ui_tip"),a=function(){function t(){if(this.iL=!1,this.tipN=null,t._ins)throw new Error("tipMgr can only be one\uff01");t._ins=this}return Object.defineProperty(t,"ins",{get:function(){return t._ins||new t,t._ins},enumerable:!1,configurable:!0}),t.prototype.showTip=function(t,e){var i=this;this.showStr=t,this.isSystemFont=e,this.iL||(cc.isValid(this.tipN)?this.onShow():(this.iL=!0,o.default.ins.lPre("prefab/tip").then(function(t){i.tipN=cc.instantiate(t),i.onShow(),i.iL=!1}).catch(function(){console.error("getPrefabErr")})))},t.prototype.onShow=function(){if(this.showStr){var t=cc.director.getScene().getChildByName("Canvas");if(t){var e=t.getChildByName("tipManager");e||(e=new cc.Node("tipManager"),t.addChild(e)),this.tipN.parent||e.addChild(this.tipN),e.setPosition(cc.v2()),this.tipN.getComponent(n.default).init(this.showStr,this.isSystemFont)}}},t}();i.default=a,cc._RF.pop()},{res:"res",ui_tip:"ui_tip"}],toast:[function(t,e,i){"use strict";cc._RF.push(e,"fc94b5eJWNH+pO/QTHSv3Xi","toast"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.showToast=function(){return new Promise(function(t){t(1)})},t}();i.default=o,cc._RF.pop()},{}],top:[function(t,e,i){"use strict";cc._RF.push(e,"e7643aDbU1EEpPuHwYX4LLj","top"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("mySafeArea"),r=t("pConst"),s=t("res"),c=t("time"),l=t("uData"),d=t("cfgMgr"),u=t("lang"),p=t("global"),h=t("mailMgr"),f=t("panelMgr"),g=t("taskMgr"),v=t("pInfo"),m=t("head"),y=cc._decorator,_=y.ccclass,b=y.property,S=Math.floor,w=Math.ceil,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.countDownNode=null,e.coinLbl=null,e.powerLbl=null,e.powerCdLbl=null,e.powerSp=null,e.sidebarNode=null,e.desktopNode=null,e.newGiftBtn=null,e.newGiftBtnLight=null,e.friendRankBtn=null,e.clearBtn=null,e.sidebarRedPointNode=null,e.mailRedPointLbl=null,e.txt_name=null,e.deskLb=null,e.saveBtn=null,e.signRedLb=null,e.headComp=null,e.serviceNode=null,e.taskRedLb=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.updateDesktop(),this.updateSidebar(),this.updateMail(),this.updateCoin(),this.updatePower(),this.upChapter(),this.loadNewGift(),this.updateNewGift(),this.updateHead(),this.updateFriendRank(),this.updateSignRed(),this.upserviceNode(),this.upDTaskRed(),o.default.opE.on(this.onOperTap.bind(this)),o.default.plE.on(this.onOperTap2.bind(this)),this.clearBtn.destroy()},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){if(t.node.y-=a.getSafeAreaRect().yMin,t.node.removeComponent(cc.Widget),p.default.padScale){var e=(cc.view.getVisibleSize().width-720)/2;t.node.children[0].x-=e,t.node.children[1].x+=e}})},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.COIN_CHG:this.updateCoin();break;case o.default.POWER_CHG:this.updatePower();break;case o.default.Slider_Chg:this.updateSidebar();break;case o.default.UPDMAIL:this.updateMail();break;case o.default.UPD_NEW_GIFT:this.updateNewGift();break;case o.default.UPD_TOP_HEADINFO:this.updateHead();break;case o.default.ADD_DESKTOP:this.addDesktopCb(t.data);break;case o.default.ALIPAY_MAIN:this.getDesktopReward();case o.default.Desktop_Chg:this.updateDesktop();break;case o.default.SIGN_RED:this.updateSignRed();break;case o.default.UPD_MAIN_RED:this.upDTaskRed()}},e.prototype.onOperTap2=function(t){t&&(t.onHide&&this.pause(),t.onShow&&this.updatePower())},e.prototype.updateSignRed=function(){this.signRedLb.node.parent.parent.active=!1},e.prototype.upDTaskRed=function(){var t=g.default.getUnFinishNum(),e=this.taskRedLb;e&&(t>0?(e.node.parent.active=!0,e.string=t+"",e.node.x=p.default.getCharXOffset(e.string)):e.node.parent.active=!1)},e.prototype.upserviceNode=function(){if(this.serviceNode.active=!1,n.platform.string()==r.PFCode.Bytedance){var t=n.platform.getSystemData();t&&("Douyin"!=t.appName&&"douyin_lite"!=t.appName||(this.serviceNode.active=!0))}},e.prototype.updateDesktop=function(){var t,e;switch(n.platform.string()){case r.PFCode.Bytedance:if(this.desktopNode.active=!0,v.default.ins.getAddDesk())this.deskLb.node.parent.active=!1;else{var i=(null===(e=null===(t=d.default.serverCfg.add_desktop)||void 0===t?void 0:t.rules)||void 0===e?void 0:e.times)||50;this.deskLb.string="+"+i,this.deskLb.node.parent.active=!0}break;case r.PFCode.Alipay:0===l.default.ins.getLocalData().aliAddHome||n.platform.cDeskCatch?this.desktopNode.active=!1:this.desktopNode.active=!0;break;default:this.desktopNode.active=!1}},e.prototype.updateSidebar=function(){this.sidebarNode.active=n.platform.sidebarExist;var t=n.platform.bySlider&&!v.default.ins.getIsGetSlider();this.sidebarRedPointNode.active=t,t&&this.scheduleOnce(function(){f.default.ins.open("ui/ui_sidebar",null)})},e.prototype.updateMail=function(){var t=this;h.default.ins.getMail(function(e){var i=0,o=t.mailRedPointLbl;if(o&&o.isValid){if(e&&e.errMsg&&"error"===e.errMsg)return void(t.mailRedPointLbl.node.parent.active=!1);for(var n in h.default.ins.mailInfo.mail)h.default.ins.mailInfo.mail[n]==h.mailState.noRead&&i++;t.mailRedPointLbl.string=i+"",t.mailRedPointLbl.node.parent.active=i>0}})},e.prototype.updateFriendRank=function(){this.friendRankBtn.active=n.platform.string()==r.PFCode.Bytedance},e.prototype.updateCoin=function(){this.coinLbl.string=v.default.ins.getCoin()+""},e.prototype.updatePower=function(){this.schedule(this._updatePower,1,cc.macro.REPEAT_FOREVER),this._updatePower()},e.prototype.pause=function(){this.unschedule(this._updatePower)},e.prototype.loadNewGift=function(){var t=this;s.default.ins.getBundleByString("resSps").then(function(e){e.load("spine/light/action",sp.SkeletonData,function(e,i){if(!e&&t.node&&t.node.isValid){var o=new cc.Node,n=o.addComponent(sp.Skeleton);n.skeletonData=i,n.animation="animation",o.parent=t.newGiftBtn}})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)}),cc.tween(this.newGiftBtnLight).by(3,{angle:-360}).repeatForever().start(),cc.tween(this.newGiftBtn).sequence(cc.tween().to(1,{scale:.9}),cc.tween().to(1,{scale:1})).repeatForever().start()},e.prototype.updateNewGift=function(){this.newGiftBtn.active=this.newGiftBtnLight.active=!1},e.prototype.updateHead=function(){var t=l.default.ins.getName()||"\u6e38\u5ba2s3df";t.length>7&&(t=t.substring(0,6)+"..."),this.txt_name.string=t;var e=l.default.ins.getHeadImg();this.headComp.loadHeadImg(e)},e.prototype.upChapter=function(){},e.prototype._updatePower=function(){if(this.isValid){var t=v.default.ins,e=t.getPowerFullTime()-c.default.ins.serverTime,i=t.getPower(),o=i,n=e>0,a=d.default.serverCfg.times.forUser,r=(l.default.ins.getIsNewUser()?a.new_user.rules.basic_times.val:a.all.rules.basic_times.val)||100;if(n){var s=t.getPerPowerNeedTime();o=r-w(e/s);var u=e%s,p=S(u/60),h=S(u%60),f=p<10?"0":"",g=h<10?"0":"";this.powerCdLbl.string=f+p+":"+g+h}else o<r&&(o=r),this.unschedule(this._updatePower),v.default.ins.setPowerFullTime(0);this.countDownNode.active=n,o!=i&&t.setPower(o),this.powerLbl.string=o+"/"+r}},e.prototype.onBtnGetPower=function(){f.default.ins.open("ui/ui_getRes",{itemId:"times"})},e.prototype.onBtnSet=function(){f.default.ins.open("ui/ui_set",null)},e.prototype.onBtnRecord=function(){f.default.ins.open("ui/ui_record",null)},e.prototype.onBtnRank=function(){f.default.ins.open("ui/ui_rank",null)},e.prototype.onBtnGetCoin=function(){f.default.ins.open("ui/ui_getRes",{itemId:"coin",gType:v.gameType.normal,useTo:u.getCoinFor.Main})},e.prototype.onBtnChapter=function(){f.default.ins.open("ui/ui_chapter",null)},e.prototype.onBtnSidebar=function(){f.default.ins.open("ui/ui_sidebar",null)},e.prototype.onBtnEmail=function(){f.default.ins.open("ui/ui_mail",null)},e.prototype.onBtnTip=function(){f.default.ins.open("ui/ui_raceTip",{pageIdx:0})},e.prototype.onBtnNewGift=function(){f.default.ins.open("ui/ui_newGift",{hideCb:null})},e.prototype.onBtnDesktop=function(){var t;switch(n.platform.string()){case r.PFCode.Bytedance:n.platform.addShortcut();break;case r.PFCode.Alipay:null===(t=n.platform.addGamesetlattice)||void 0===t||t.call(n.platform)}},e.prototype.onBtnFriendRank=function(){n.platform.showFriendRank(r.SDKConfig.ttZoneId.normal)},e.prototype.onBtnSkin=function(){f.default.ins.open("ui/ui_skin",null)},e.prototype.onBtnSave=function(){f.default.ins.open("ui/ui_save",null)},e.prototype.onBtnSign=function(){f.default.ins.open("ui/ui_sevenDay",null)},e.prototype.onBtnQuest=function(){f.default.ins.open("ui/ui_quest",null)},e.prototype.onBtnService=function(){if(n.platform.string()==r.PFCode.Bytedance){var t=n.platform.getSystemData();if(t){var e=0;switch(t.appName){case"Douyin":e=2;break;case"douyin_lite":e=1}e&&n.platform.openService(e)}}},e.prototype.onTest=function(){v.default.ins.clearDailyData()},e.prototype.addDesktopCb=function(t){var e=v.default.ins.getAddDesk();t&&!e&&(v.default.ins.setAddDesk(!0),this.getDesktopReward(),this.updateDesktop())},e.prototype.getDesktopReward=function(){var t,e,i=(null===(e=null===(t=d.default.serverCfg.add_desktop)||void 0===t?void 0:t.rules)||void 0===e?void 0:e.times)||50;v.default.ins.addPower(i);var o=this.desktopNode.isValid?this.desktopNode.position:this.deskTopNodePos,n=this.node.convertToWorldSpaceAR(o);f.default.ins.open("ui/ui_flyAni",{itemDatas:[{itemId:"times",worldPos:n,value:i}]})},__decorate([b(cc.Node)],e.prototype,"countDownNode",void 0),__decorate([b(cc.Label)],e.prototype,"coinLbl",void 0),__decorate([b(cc.Label)],e.prototype,"powerLbl",void 0),__decorate([b(cc.Label)],e.prototype,"powerCdLbl",void 0),__decorate([b(cc.Sprite)],e.prototype,"powerSp",void 0),__decorate([b(cc.Node)],e.prototype,"sidebarNode",void 0),__decorate([b(cc.Node)],e.prototype,"desktopNode",void 0),__decorate([b(cc.Node)],e.prototype,"newGiftBtn",void 0),__decorate([b(cc.Node)],e.prototype,"newGiftBtnLight",void 0),__decorate([b(cc.Node)],e.prototype,"friendRankBtn",void 0),__decorate([b(cc.Node)],e.prototype,"clearBtn",void 0),__decorate([b(cc.Node)],e.prototype,"sidebarRedPointNode",void 0),__decorate([b(cc.Label)],e.prototype,"mailRedPointLbl",void 0),__decorate([b(cc.Label)],e.prototype,"txt_name",void 0),__decorate([b(cc.Label)],e.prototype,"deskLb",void 0),__decorate([b(cc.Node)],e.prototype,"saveBtn",void 0),__decorate([b(cc.Label)],e.prototype,"signRedLb",void 0),__decorate([b(m.default)],e.prototype,"headComp",void 0),__decorate([b(cc.Node)],e.prototype,"serviceNode",void 0),__decorate([b(cc.Label)],e.prototype,"taskRedLb",void 0),__decorate([_],e)}(cc.Component);i.default=T,cc._RF.pop()},{cfgMgr:"cfgMgr",evts:"evts",global:"global",head:"head",idx:"idx",lang:"lang",mailMgr:"mailMgr",mySafeArea:"mySafeArea",pConst:"pConst",pInfo:"pInfo",panelMgr:"panelMgr",res:"res",taskMgr:"taskMgr",time:"time",uData:"uData"}],tt:[function(t,e,i){"use strict";cc._RF.push(e,"0b084hHrupN56MsxKfnNQhM","tt"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("c"),n=t("com"),a=t("env"),r=t("errorCode"),s=t("evts"),c=t("idx"),l=t("pConst"),d=t("request"),u=t("time"),p=t("uData"),h=t("tipMgr"),f="env-nBT5qFlz3P",g="1jtw3wjabr0ui",v="4m29365j0d2k3agn5c",m=function(){function t(){this.isSharing=!1,this.sdkSwitch=l.DefaultSDKSwitch,this.videoCheckedMap={},this.videoCheckedLastT={},this.uniqueVideoUnitId=v,this.isLoading=!1,this.isLoggedIn=!1,this.onHideT=0,this.noAd=!1,this.noVideo=!1,this.lastInterAdShowT=0,this.switchesInitd=!1,this.gameRecorder=null,this.ta=null,this.m_nStartRecordT=0,this.m_nRecordT=0,this.m_bIsRecording=!1,this.m_nAutoStopVideoId=0,this.m_strVideoPath="",this.onKeyboardComplete=tt.onKeyboardComplete}return Object.defineProperty(t.prototype,"appId",{get:function(){return"tt6d2c1b91f21d474902"},enumerable:!1,configurable:!0}),t.prototype.string=function(){return l.PFCode.Bytedance},t.prototype.init=function(){this.initVersion(),this.initByteDanceListener(),this.initCommonSetting(),this.initTga(),this.initVideoRecorder(),this.uploadAdEvent("active",{});var t=tt.getLaunchOptionsSync(),e=(null==t?void 0:t.scene)||"0";this.bySlider="021036"==e},t.prototype.initVersion=function(){var t,e;this.version=tt.getEnvInfoSync&&(null===(e=null===(t=tt.getEnvInfoSync())||void 0===t?void 0:t.microapp)||void 0===e?void 0:e.mpVersion)},t.prototype.initTga=function(){},t.prototype.isSwitchedInitd=function(){return this.switchesInitd},t.prototype.initByteDanceListener=function(){var t=this,e=this;tt.onShow(function(t){p.default.ins.syncLaunchOption(t),e.isSharing||e.reenter(),e.startStopRecordTimeout(Math.max(1e3,l.VIDEO_RECORD_LIMIT-e.m_nRecordT)),e.bySlider="homepage"==t.launch_from&&"sidebar_card"==t.location,s.default.opE.emit({action:s.default.Slider_Chg}),Math.abs(Date.now()/1e3-e.onHideT)>300?e.syncTime().then(function(t){t&&u.default.ins.sync(t),s.default.plE.emit({onShow:!0,isSharing:e.isSharing})}):s.default.plE.emit({onShow:!0,isSharing:e.isSharing})}),tt.checkScene&&tt.checkScene({scene:"sidebar",success:function(e){t.sidebarExist=e.isExist},fail:function(){}}),tt.onHide(function(){e.onHideT=u.default.ins.serverTime,s.default.plE.emit({onHide:!0}),e.clearStopRecordTimeout()}),tt.onError(function(t){a.env.mode!==a.EM.PROD&&tt.showModal({title:t.message||"\u5f02\u5e38\u62a5\u9519",content:t.stack||t+"",showCancel:!1,confirmText:"\u597d\u7684"})}),tt.canIUse("onMemoryWarning")&&tt.onMemoryWarning(function(){tt.triggerGC()}),tt.onShareAppMessage(function(){return l.SDKConfig.shareData()}),tt.showShareMenu({success:function(){},fail:function(){}});var i=tt.getUpdateManager();i.onCheckForUpdate(function(){}),i.onUpdateFailed(function(){}),i.onUpdateReady(function(){tt.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u662f\u5426\u91cd\u542f\u5c0f\u6e38\u620f\uff1f",success:function(t){t.confirm&&i.applyUpdate()}})})},t.prototype.initCommonSetting=function(){p.default.ins.syncLaunchOption(tt.getLaunchOptionsSync()),tt.getNetworkType({success:function(){},fail:function(){}}),s.default.chE.on(function(){})},t.prototype.initCloud=function(){return new Promise(function(t){tt.login({success:function(){tt.createCloud&&tt.canIUse("createCloud")&&(c.platform.cloud=tt.createCloud({envID:f,serviceID:g})),t(c.platform.syncTime())},fail:function(){t(null)}})})},t.prototype.setAccountID=function(){a.env.mode,a.EM.TEST},t.prototype.login=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,new Promise(function(e,i){tt.login({success:function(o){if(o&&o.code){var n=c.platform.cloud||(c.platform.cloud=tt.createCloud&&tt.canIUse("createCloud")&&tt.createCloud({envID:f,serviceID:g}));if(t>2||!n)return void e(o);n.callContainer({path:"/index",init:{method:"GET",header:{"content-type":"application/json"},timeout:2e3},success:function(t){var i=t.data;if(i)if("string"==typeof i)try{var n=JSON.parse(i);o.openid=n.i,o.unionid=n.j}catch(t){}else o.openid=i.i,o.unionid=i.j;e(o)},fail:function(){return i(r.errorCode.PF_CLOUD_ERR)}})}else console.warn("\u5934\u6761\u767b\u9646\u5931\u8d25\uff1aempty code"),i(r.errorCode.LOGIN_ERR)},fail:function(t){var e="";null!=t&&null!=t.errMsg&&(e=t.errMsg),console.warn("\u5934\u6761\u767b\u9646\u5931\u8d25\uff1a",e),i(r.errorCode.LOGIN_ERR)}})})]})})},t.prototype.syncTime=function(){return new Promise(function(t){var e=c.platform.cloud||(c.platform.cloud=tt.createCloud&&tt.canIUse("createCloud")&&tt.createCloud({envID:f,serviceID:g}));e?e.callContainer({path:"/gTime",init:{method:"GET",header:{"content-type":"application/json"},timeout:2e3},success:function(e){var i,o=e.data;if(o)if("string"==typeof o)try{i=JSON.parse(o).t}catch(e){}else i=o.t;t(i||null)},fail:function(){return t(null)}}):t(null)})},t.prototype.reenter=function(){},t.prototype.getCloudData=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,o;return __generator(this,function(n){switch(n.label){case 0:return(t=c.platform.cloud||(c.platform.cloud=tt.createCloud&&tt.canIUse("createCloud")&&tt.createCloud({envID:f,serviceID:g})))?[4,t.database()]:[3,3];case 1:return(i=n.sent())?(o=i.collection("userData"),[4,c.platform._check(o)]):[3,3];case 2:e=n.sent(),n.label=3;case 3:return[2,e]}})})},t.prototype._check=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,new Promise(function(e){t.get("id").then(function(t){if(t){c.platform.isCheck=!0;var i=t.data;if(i&&i.length){var o=i[0];c.platform.dbId=o._id;try{var n=JSON.parse(o.uData);e(n)}catch(a){e(null)}}else e(null)}else e(null)}).catch(function(){return e(null)})})]})})},t.prototype.setCloudData=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,o,n,a;return __generator(this,function(r){switch(r.label){case 0:return(e=this).isSaving?[2]:(i=e.cloud||(e.cloud=tt.createCloud&&tt.canIUse("createCloud")&&tt.createCloud({envID:f,serviceID:g})))?[4,i.database()]:[3,2];case 1:if(!(o=r.sent()))return[2];e.isSaving=!0,n=o.collection("userData"),a=Promise.resolve(),e.isCheck||(a=this._check(n)),a.then(function(){e.dbId?n.doc(e.dbId).update({uData:t}).then(function(){c.platform.isSaving=!1}):n.add({uData:t}).then(function(t){c.platform.dbId=t.id,c.platform.isSaving=!1})}).catch(function(t){return console.error("\u5199\u5165\u5931\u8d25",t)}),r.label=2;case 2:return[2]}})})},t.prototype.getStorage=function(t){try{var e=tt.getStorageSync(t);return null==e||""==e?null:JSON.parse(e)}catch(i){}},t.prototype.setStorage=function(t,e){try{tt.setStorageSync(t,JSON.stringify(e))}catch(i){}},t.prototype.clearStorage=function(){try{tt.clearStorageSync()}catch(t){}},t.prototype.removeStorage=function(t){try{tt.removeStorageSync(t)}catch(e){}},t.prototype.trackLogin=function(){},t.prototype.trackUserSet=function(){},t.prototype.trackUserSetOnce=function(){},t.prototype.trackEvent=function(){},t.prototype.getSeq=function(){},t.prototype.consumeSeq=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return t.sequenceInfo.type!=l.STDSeqType.VIDEO?[3,2]:[4,this.doWatchAD(t)];case 1:e.sent(),this.doShare(),e.label=2;case 2:return[2]}})})},t.prototype.doWatchAD=function(t){return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(){return this.noAd?[2]:this.noVideo?(console.error("[error] no video"),[2,Promise.reject(l.VideoFailCode.NO_AD)]):(s.default.adE.emit(o.ADE.VIDEO),e=this.uniqueVideoUnitId,null==this.videoAd&&(this.videoAd=tt.createRewardedVideoAd({adUnitId:e})),this.showLoading(),i=this,[2,new Promise(function(n,a){i.videoAd.onClose(function r(c){null!=i.videoAd&&i.videoAd.offClose(r),null!=c&&c.isEnded?(s.default.adE.emit(o.ADE.VIDEO_END),i.trackEvent("video",{step:"complete",unit:e,type:t.videoSource,item:t.item}),n(1)):(s.default.adE.emit(o.ADE.VIDEO_END),a(l.VideoFailCode.CANCELED))}),i.videoAd.show().then(function(){}).catch(function(){s.default.adE.emit(o.ADE.VIDEO_END),i.videoAd.destroy(),i.videoAd=null,a(l.VideoFailCode.NO_AD)}).then(function(){i.hideLoading()})})])})})},t.prototype.doShare=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2]})})},t.prototype._askReShare=function(){},t.prototype.canUse=function(t){return n.default.ins.compareVersion(c.platform.getSystemData().SDKVersion,t)>=0},t.prototype.getSystemData=function(){if(null==this.systemInfoCache)try{this.systemInfoCache=tt.getSystemInfoSync()}catch(t){return l.DefaultSystemInfo}return this.systemInfoCache},t.prototype.getSwitches=function(){},t.prototype.vibrate=function(t){t==l.VEnum4.SHORT?tt.vibrateShort(null):t==l.VEnum4.LONG&&tt.vibrateLong({success:function(){},fail:function(){}})},t.prototype.preloadVideo=function(){return!1},t.prototype.showModal=function(t){return new Promise(function(e){tt.showModal(Object.assign(Object.assign({},t),{success:function(t){t.confirm?e(!0):t.cancel&&e(!1)},fail:function(){e(!1)}}))})},t.prototype.refreshGame=function(){try{tt.restartMiniProgramSync()}catch(t){tt.exitMiniProgram()}},t.prototype.showLoading=function(t){void 0===t&&(t="\u52a0\u8f7d\u4e2d"),this.canUse("1.0.0")&&(this.isLoading=!0,tt.showLoading({title:t,mask:!0}))},t.prototype.hideLoading=function(){this.canUse("1.0.0")&&this.isLoading&&(tt.hideLoading(),this.isLoading=!1)},t.prototype.log=function(){},t.prototype.getMenuBounding=function(){},t.prototype.createShareImage=function(){},t.prototype.preloadInterstitialAD=function(){},t.prototype.showInterstitialAD=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,null]})})},t.prototype.canShowBanner=function(){return!1},t.prototype.getBannerSize=function(){return new cc.Size(0,0)},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.getSubscribeCnt=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,0]})})},t.prototype.subscribe=function(){},t.prototype.initVideoRecorder=function(){this.canUse("1.6.1")&&(this.gameRecorder=tt.getGameRecorderManager(),this.gameRecorder.onStart(this.onVideoRecordStart.bind(this)),this.gameRecorder.onStop(this.onVideoRecordEnd.bind(this)),this.gameRecorder.onError(this.onVideoRecordError.bind(this)))},t.prototype.startVideoRecord=function(){try{null!=this.gameRecorder&&(this.m_bIsRecording=!0,this.gameRecorder.start({duration:.001*l.VIDEO_RECORD_LIMIT,isMarkOpen:!1}),this.startStopRecordTimeout(l.VIDEO_RECORD_LIMIT))}catch(t){this.gameRecorder=null}},t.prototype.pauseVideoRecord=function(){null!=this.gameRecorder&&this.m_bIsRecording&&(this.gameRecorder.pause(),this.clearStopRecordTimeout())},t.prototype.resumeVideoRecord=function(){null!=this.gameRecorder&&this.m_bIsRecording&&(this.gameRecorder.resume(),this.startStopRecordTimeout(Math.max(1e3,l.VIDEO_RECORD_LIMIT-this.m_nRecordT)))},t.prototype.stopVideoRecord=function(){null!=this.gameRecorder&&(this.clearStopRecordTimeout(),this.gameRecorder.stop(),this.m_bIsRecording=!1)},t.prototype.startStopRecordTimeout=function(t){this.m_bIsRecording&&(this.m_nAutoStopVideoId=setTimeout(this.autoStopVideoRecord.bind(this),t-1e3),this.m_nStartRecordT=(new Date).getTime())},t.prototype.clearStopRecordTimeout=function(){this.m_bIsRecording&&(0!==this.m_nAutoStopVideoId&&clearTimeout(this.m_nAutoStopVideoId),this.m_nAutoStopVideoId=0,this.m_nRecordT+=(new Date).getTime()-this.m_nStartRecordT,this.m_nStartRecordT=0)},t.prototype.autoStopVideoRecord=function(){this.m_nAutoStopVideoId=0,this.stopVideoRecord(),setTimeout(this.startVideoRecord.bind(this),100)},t.prototype.onVideoRecordStart=function(){this.m_strVideoPath="",this.m_nRecordT=0},t.prototype.onVideoRecordEnd=function(t){var e;null!=t&&null!=t.videoPath&&(e=this.m_strVideoPath=t.videoPath),e&&s.default.opE.emit({action:s.default.SHOWVIDEOSHARE})},t.prototype.onVideoRecordError=function(){},t.prototype.hasVideoRecord=function(){return null!=this.m_strVideoPath&&""!==this.m_strVideoPath},t.prototype.shareVideoRecord=function(){var t,e=new Promise(function(e){t=e});if(this.hasVideoRecord()&&tt.shareAppMessage){var i=[a.env.name,"\u5973\u751f\u6e38\u620f\u63a8\u8350","\u8111\u6d1e\u6e38\u620f","\u70e7\u8111\u76ca\u667a"],o=l.SDKConfig.shareData();tt.shareAppMessage({title:"\u6211\u6b32\u4fee\u4ed9",channel:"video",desc:"\u6765\u6311\u6218\u4e00\u4e0b",query:o.query,extra:{withVideoId:!0,videoPath:this.m_strVideoPath,video_title:o.title,videoTopics:i},success:function(){h.default.ins.showTip("\u5206\u4eab\u6210\u529f"),t(1)},fail:function(){h.default.ins.showTip("\u5206\u4eab\u5931\u8d25"),t(0)}})}else t(0);return e},t.prototype.uploadAdEvent=function(){},t.prototype.PostMessage=function(t,e,i){tt.getOpenDataContext().postMessage({Even:t,Value1:e,Value2:i})},t.prototype.SetUserCloudStorage=function(t,e,i){var o=new Date;tt.setUserCloudStorage({KVDataList:[{key:"level",value:t.toString()+"#"+o.getTime().toString()+"#"+e.toString()+"#"+i.toString()}],success:function(){},fail:function(){}})},t.prototype.GetOpenDataContext=function(){return tt.getOpenDataContext()},t.prototype.addShortcut=function(){tt.addShortcut({success:function(){s.default.opE.emit({action:s.default.ADD_DESKTOP,data:!0})},fail:function(){s.default.opE.emit({action:s.default.ADD_DESKTOP,data:!1}),h.default.ins.showTip("\u6dfb\u52a0\u5931\u8d25")}})},t.prototype.share=function(){return new Promise(function(t){var e=l.SDKConfig.shareData();tt.shareAppMessage({title:e.title,imageUrl:e.imageUrl,query:e.query,channel:"invite",success:function(e){t(e.data)},fail:function(){t(0)}})})},t.prototype.getUserInfo=function(){var t=this;return new Promise(function(e,i){if(tt.canIUse("getUserInfo")){var o=t;tt.getSetting({success:function(t){t.authSetting["scope.userInfo"]?o._getUserInfo(e,i):!1===t.authSetting["scope.userInfo"]?o.showRefuseTip(e,i):o._getUserInfo(e,i)},fail:function(){i()}})}else i()})},t.prototype.showRefuseTip=function(t,e){if(this.showModal({title:"\u53cb\u60c5\u63d0\u793a",content:"\u7533\u8bf7\u4f7f\u7528\u60a8\u7684\u7528\u6237\u4fe1\u606f\uff0c\u5c55\u793a\u6392\u884c\u699c\u3002",confirmText:"\u5141\u8bb8",cancelText:"\u62d2\u7edd"})){var i=this;tt.openSetting({success:function(){i._getUserInfo(t,e)},fail:function(){e()}})}else e()},t.prototype._getUserInfo=function(t,e){tt.getUserInfo({success:function(e){t(e.userInfo)},fail:function(){e()}})},t.prototype.navigateToScene=function(t){void 0===t&&(t="sidebar"),tt.navigateToScene({scene:t,success:function(){},fail:function(){}})},t.prototype.reportEvent=function(t,e){void 0===e&&(e={}),tt.reportAnalytics(t,e)},t.prototype.setFriendRankData=function(t,e){var i;tt&&(null===(i=tt.setImRankData)||void 0===i||i.call(tt,{dataType:0,value:t.toString(),zoneId:e,success:function(){},fail:function(){}}))},t.prototype.showFriendRank=function(t){if(tt)if(tt.getImRankList){var e=t===l.SDKConfig.ttZoneId.normal?"\u5173":"\u5206",i=t===l.SDKConfig.ttZoneId.normal?"\u4e3b\u7ebf\u6392\u884c":"\u597d\u53cb\u8da3\u5473\u8d5b\u6392\u884c",o=(l.SDKConfig.ttZoneId.normal,"all"),n=t===l.SDKConfig.ttZoneId.normal?"all":"friend";tt.getImRankList({relationType:n,dataType:0,rankType:o,suffix:e,rankTitle:i,zoneId:t,success:function(){},fail:function(){}})}else tt.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5ba2\u6237\u7aef\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5ba2\u6237\u7aef\u6216\u5173\u95ed\u540e\u91cd\u542f\u66f4\u65b0\u3002"})},t.prototype.payment=function(t,e,i,o){var n=this;void 0===t&&(t="1"),void 0===e&&(e=1),void 0===i&&(i=0);var a=c.platform.getSystemData(),r="android";return a&&-1!=a.system.indexOf("iOS")&&(r="iOS"),new Promise(function(a,s){n.checkSession().then(function(){var n=d.default.ins.openId,c=u.default.ins.serverTime,l=t+n+c,p={};p.cp_orderno=l,p.creation_time=c,p.openid=n,p.money=e,p.gift_id=t,p.gift_num=1,p.status=0,p.is_double=i,p.package=o,p.phone=r;var h={};h.openid=n,h.gift_id=t,h.gift_num=1,h.money=e,h.is_double=i,h.package=o,h.phone=r,d.default.ins.getUserToken().then(function(t){if(t){h.token=t;var i=JSON.stringify(h);tt.requestGamePayment({mode:"game",env:0,currencyType:"CNY",platform:r,buyQuantity:e,zoneId:"1",customId:l,extraInfo:i,success:function(){p.status=1,d.default.ins.paymentResult(p),a(1)},fail:function(t){p.status=2;var e=p.errCode=t&&t.errCode||0;d.default.ins.paymentResult(p),s("\u652f\u4ed8\u5931\u8d25: "+e)},complete:function(){}})}}).catch(function(){})}).catch(function(t){s("\u652f\u4ed8\u5f02\u5e38: "+t)})})},t.prototype.checkSession=function(){var t=this;return new Promise(function(e,i){tt.checkSession({success:function(){e(1)},fail:function(){t.login(0).then(function(){e(1)}).catch(function(t){i(t)})}})})},t.prototype.openService=function(t){tt.openCustomerServiceConversation&&tt.openCustomerServiceConversation({type:t,success:function(){},fail:function(){}})},t}();i.default=m,cc._RF.pop()},{c:"c",com:"com",env:"env",errorCode:"errorCode",evts:"evts",idx:"idx",pConst:"pConst",request:"request",time:"time",tipMgr:"tipMgr",uData:"uData"}],uData:[function(t,e,i){"use strict";cc._RF.push(e,"86181ZnrptJ9In2AI14myYD","uData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("cfgMgr"),n=t("global"),a=t("bagMgr"),r=t("taskMgr"),s=t("pInfo"),c=t("adC"),l=t("evts"),d=t("idx"),u=t("NumberUtils"),p=t("pConst"),h=(t("request"),t("time")),f=function(){function t(){this.basic={name:"",uid:0,userId:"123",openId:"test2",sessionKey:"",headImg:"",isAuth:null,isNew:null,anonymous_openid:null},this.setting={effectSound:!0,bgmSound:!0,vibrate:!0,effectVolume:.5,bgmVolume:.5,tip:!0},this.localData=null,this.network={networkType:"none"},this.launchOption={scene:0,query:{}},this.flushTimeoutKeys={},this.enterAt=Date.now(),this.loginAt=null}return Object.defineProperty(t,"ins",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),t.prototype.onLogin=function(t){var e,i,o=this;if(!this.loginAt){var n;this.loadSetting();var a=this.getLocalData();if(t){var r=t.puzzleLvl||0,s=(null===(e=null==t?void 0:t.bag)||void 0===e?void 0:e.puzzle_pieces)||0,u=(null==a?void 0:a.puzzleLvl)||0,p=(null===(i=null==a?void 0:a.bag)||void 0===i?void 0:i.puzzle_pieces)||0;(r>u||s>p||!a.guideDone)&&this.setLocalData(t)}this.loginAt=h.default.ins.serverTime;var f=this.basic;if(f.recordFlag=null!==(n=f.recordFlag)&&void 0!==n?n:{},null==this.getLocalDataByKey("register_date")){var g=new Date;this.setLocalData({register_date:g.getTime()}),d.platform.reportEvent(d.ERepEvt.createNewRole)}else d.platform.reportEvent(d.ERepEvt.login);this.getLocalDataByKey("login_date")||this.setLocalData({login_date:this.loginAt-864e5}),this.checkNewDay(),d.platform.preloadVideo(c.VEnum[60]);var v=(h.default.ins.serverTime||Math.floor((new Date).getTime()/1e3))%60;0!=v&&(v=60-v),setTimeout(function(){o.checkNewDay(),setInterval(function(){o.checkNewDay()},6e4)},1e3*v),l.default.plE.on(this.onOperTap.bind(this))}},t.prototype.onOperTap=function(t){(null==t?void 0:t.onHide)&&this.timeId&&this._setLocalAndCloudData()},t.prototype.checkNewDay=function(t){if(void 0===t&&(t=!0),!t||!h.default.ins.isSameDay){r.default.taskReset(),s.default.ins.clearDailyData();var e=o.default.serverCfg.qw_line_rules.rules.times.set.basic_times.val;a.default.ins.chgItemCount("qw_line_ticket",Number(e)),l.default.opE.emit({action:l.default.UPD_MAIN_RED}),this.loginAt=h.default.ins.serverTime,h.default.ins.loginT=h.default.ins.serverTime;var i=this.getLocalDataByKey("login_date");if(h.default.ins.serverTime-i>=1728e5&&(n.default.twoDaysLeft=!0),this.setLocalData({login_date:this.loginAt}),t&&!this.basic.isNew){var c=1e3*u.default.RandomInt(1,30);this.timeId=setTimeout(this._setLocalAndCloudData.bind(this),c)}l.default.opE.emit({action:l.default.UPD_PANEL})}},t.prototype.loadSetting=function(){var t=this,e=Object.keys(this.setting),i=this.setting;this.setting=d.platform.getStorage("setting")||this.setting,e.forEach(function(e){var o;null==t.setting[e]&&t.setSetting(((o={})[e]=i[e],o))})},t.prototype.setSetting=function(t,e){void 0===e&&(e=!0),this.setting=Object.assign(Object.assign({},this.setting),t),l.default.usE.emit({userData:this,kind:"setting"}),e&&d.platform.setStorage("setting",this.setting)},t.prototype.getSetting=function(){return this.setting},t.prototype.setLocalData=function(t,e){void 0===e&&(e=10);var i=this.getLocalData(),o=this.localData=Object.assign(Object.assign({},i),t);d.platform.setStorage("localData",this.localData),o&&!this.timeId&&(this.timeId=setTimeout(this._setLocalAndCloudData.bind(this),1e3*e))},t.prototype._setLocalAndCloudData=function(){},t.prototype.restoreData=function(t){t&&(this.localData=t,a.default.ins.clearItem(),d.platform.setStorage("localData",this.localData),this.checkNewDay(),this._setLocalAndCloudData(),n.default.isReStore=1,cc.game.restart())},t.prototype.getLocalData=function(){return null==this.localData&&(this.localData=d.platform.getStorage("localData")||{}),this.localData},t.prototype.getLocalDataByKey=function(t){return null==this.localData?null:this.localData[t]},Object.defineProperty(t.prototype,"fakeUID",{get:function(){return 10005+2*this.basic.uid},enumerable:!1,configurable:!0}),t.prototype.setUserId=function(t){this.basic.userId=t},t.prototype.getUserId=function(){return this.basic.userId},t.prototype.getUid=function(){return this.basic.uid},t.prototype.setName=function(t){this.basic.name=t},t.prototype.getName=function(){return this.basic.name},t.prototype.setHeadImg=function(t){this.basic.headImg=t},t.prototype.getHeadImg=function(){return this.basic.headImg},t.prototype.setIsAuth=function(t){this.basic.isAuth=t},t.prototype.getIsAuth=function(){return this.basic.isAuth},t.prototype.getIsNewUser=function(){return this.basic.isNew},t.prototype.syncLaunchOption=function(t){if(this.launchOption.query={},this.launchOption=Object.assign(Object.assign({},this.launchOption),t),null==this.getLocalDataByKey("register_date")){var e=this.getLaunchParam("ad_type","");if(""!==e){this.setLocalData({ad_type:e});var i=this.getLaunchParam("addict_type","");""!==i&&this.setLocalData({addict_type:i});var o=this.getLaunchParam("clickid","");""!==o&&this.setLocalData({clickid:o})}}},t.prototype.getLaunchParam=function(t,e){if(null==this.launchOption)return e;var i=this.launchOption[t];return null==i&&null!=this.launchOption.query&&null!=this.launchOption.query[t]?i=this.launchOption.query[t]:e},t.prototype.getLaunchOption=function(){return this.launchOption},t.prototype.delayFlush=function(t,e,i){void 0===i&&(i=0);var o=this,n=this.flushTimeoutKeys[e];n?0===i&&(clearTimeout(n),this.flushTimeoutKeys[e]=null,d.platform.setStorage(e,t)):this.flushTimeoutKeys[e]=setTimeout(function(){o.flushTimeoutKeys[e]=null,d.platform.setStorage(e,t)},1e3*i)},t.prototype.syncLoginData=function(t){void 0===t&&(t={});var e=this.basic;e.name=t.nickname,e.headImg=t.avatar,e.uid=t.game_uid,e.openId=t.openid,e.sessionKey=t.session_key,e.anonymous_openid=t.anonymous_openid,e.isNew=t.is_new_user,l.default.opE.emit({action:l.default.UPD_TOP_HEADINFO}),t.is_register;var i=null==d.platform.getStorage("localData");return p.SDKConfig.comQuery="from_game_uid="+t.game_uid+"&share_time=",[!1,i]},t}();i.default=f,cc._RF.pop()},{NumberUtils:"NumberUtils",adC:"adC",bagMgr:"bagMgr",cfgMgr:"cfgMgr",evts:"evts",global:"global",idx:"idx",pConst:"pConst",pInfo:"pInfo",request:"request",taskMgr:"taskMgr",time:"time"}],ui_backReward:[function(t,e,i){"use strict";cc._RF.push(e,"dbd454L8pFK/aIzDSWtQgjM","ui_backReward"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("cfgMgr"),n=t("item"),a=t("bagMgr"),r=t("panelMgr"),s=t("skinMgr"),c=t("pInfo"),l=t("baseUI"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardItem=null,e.rewards=null,e.spineNode=null,e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(){var t,e,i=(null===(e=null===(t=o.default.serverCfg)||void 0===t?void 0:t.seven_day_reward)||void 0===e?void 0:e.backtrack)||{times:50},r=0;for(var s in i){var c=Number(i[s]),l=this.rewards.children[r];l||(l=cc.instantiate(this.rewardItem)),l.parent=this.rewards;var d=l.getComponent(n.default);d&&d.initByData(s,c);var u={};u.itemId=s,u.itemNode=l,u.value=c,a.default.ins.addItem(s,c),r++}this.loadGirl()},e.prototype.loadGirl=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return s.default.ins.updateRole(c.default.ins.getUsingSkin().role,this.spineNode),[2]})})},e.prototype.hideThis=function(){this.hide()},e.prototype.onBtnGet=function(){for(var t=this,e=[],i=0,o=this.rewards.childrenCount;i<o;i++){var a=this.rewards.children[i],s=a.getComponent(n.default),c={};c.itemId=s.key,c.worldPos=a.parent.convertToWorldSpaceAR(a.position),c.value=s.count,e.push(c)}r.default.ins.open("ui/ui_flyAni",{itemDatas:e,hideCb:function(){t.hideThis()}})},__decorate([p(cc.Node)],e.prototype,"rewardItem",void 0),__decorate([p(cc.Node)],e.prototype,"rewards",void 0),__decorate([p(cc.Node)],e.prototype,"spineNode",void 0),__decorate([u],e)}(l.default);i.default=h,cc._RF.pop()},{bagMgr:"bagMgr",baseUI:"baseUI",cfgMgr:"cfgMgr",item:"item",pInfo:"pInfo",panelMgr:"panelMgr",skinMgr:"skinMgr"}],ui_challengeInfo:[function(t,e,i){"use strict";cc._RF.push(e,"c28b4mJ0e5ASrI7YQ9qWxVY","ui_challengeInfo"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("cfgMgr"),n=t("global"),a=t("pInfo"),r=t("baseUI"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lvLB=null,e.infoLB=null,e.sizeLb=null,e.diffLb=null,e.crossLb=null,e.costLB=null,e.typeSp=null,e.lightNode=null,e.tySps=[],e}return __extends(e,t),e.prototype.onLoad=function(){cc.tween(this.lightNode).by(3,{angle:-360}).repeatForever().start()},e.prototype.init=function(t){var e=t.lvData,i=t.cost,o=t.crossNum;this.lvData=e,this.cost=i;var n="",r="",s=5;switch(e.type){case a.challengeType.worm:n="\u9664\u866b\u6a21\u5f0f",r="\u866b\u5b50\u90fd\u662f\u8fde\u7eed\u683c\u5b50\u7ec4\u6210\uff0c\n\u6839\u636e\u63d0\u793a\u7684\u6570\u5b57\u627e\u51fa\u866b\u5b50\u3002",this.typeSp.spriteFrame=this.tySps[0],s=e.data.size;break;case a.challengeType.tree:n="\u9664\u8349\u6a21\u5f0f",r="\u70b9\u4eae\u8349\u4e1b\u56db\u5468\u7684\u4efb\u610f\u683c\u5b50\uff0c\n\u53ef\u4ee5\u53bb\u9664\u8349\u4e1b\u3002",this.typeSp.spriteFrame=this.tySps[1],s=e.size;break;case a.challengeType.ice:n="\u9664\u51b0\u6a21\u5f0f",r="\u70b9\u4eae\u51b0\u5757\u5468\u56f44\u4e2a\u683c\u5b50\uff0c\n\u53ef\u4ee5\u53bb\u9664\u51b0\u5757\u3002",this.typeSp.spriteFrame=this.tySps[2],s=e.size}this.lvLB.string=n,this.infoLB.string=r,this.crossLb.string=o,this.sizeLb.string=s+"x"+s,this.diffLb.string=this.getLevelDiffStrByDiff(e.diff),this.costLB.string=i+"/"+a.default.ins.getPower()},e.prototype.onBtnStart=function(){var t=this.cost,e=Object.assign({},this.lvData);a.default.ins.addPower(-t);var i=e.date,o=1e4*i.year+100*i.month+i.day;n.default.challengeLv=o,a.chgScene(a.sceneType.game,{gameType:a.gameType.challenge,challengeData:e})},e.prototype.hideThis=function(){this.hide()},e.prototype.getLevelDiffStrByDiff=function(t){var e=o.default.serverCfg.difficulty_rules.rules,i="\u5165\u95e8\u96be\u5ea6",n=1;for(var a in e){if(i=e[a].title,n===t)break;n++}return i.slice(0,-2)},__decorate([l(cc.Label)],e.prototype,"lvLB",void 0),__decorate([l(cc.Label)],e.prototype,"infoLB",void 0),__decorate([l(cc.Label)],e.prototype,"sizeLb",void 0),__decorate([l(cc.Label)],e.prototype,"diffLb",void 0),__decorate([l(cc.Label)],e.prototype,"crossLb",void 0),__decorate([l(cc.Label)],e.prototype,"costLB",void 0),__decorate([l(cc.Sprite)],e.prototype,"typeSp",void 0),__decorate([l(cc.Node)],e.prototype,"lightNode",void 0),__decorate([l([cc.SpriteFrame])],e.prototype,"tySps",void 0),__decorate([c],e)}(r.default);i.default=d,cc._RF.pop()},{baseUI:"baseUI",cfgMgr:"cfgMgr",global:"global",pInfo:"pInfo"}],ui_chapterDone:[function(t,e,i){"use strict";cc._RF.push(e,"bcc61uunFpAPIf+ZqAgsiJ/","ui_chapterDone"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("levelMgr"),n=t("pInfo"),a=t("baseUI"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.light=null,e.pics=[],e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),cc.tween(this.light).by(3,{angle:-360}).repeatForever().start()},e.prototype.init=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];o.default.ins.getchapterBunder().then(function(){for(var e=n.default.ins.getPuzzleLvl(),i=""+(Math.ceil(e/54)-1+100),a=function(e){o.default.ins.getJigsawIcon(e,i).then(function(i){i&&(t.pics[e-1].spriteFrame=i)}).catch(function(){console.error("getJigsawIconErr")})},r=1;r<=6;r++)a(r)}).catch(function(){console.error("getChapterBundleErr")})},e.prototype.hideThis=function(){this.hide()},__decorate([c(cc.Node)],e.prototype,"light",void 0),__decorate([c([cc.Sprite])],e.prototype,"pics",void 0),__decorate([s],e)}(a.default);i.default=l,cc._RF.pop()},{baseUI:"baseUI",levelMgr:"levelMgr",pInfo:"pInfo"}],ui_chapter:[function(t,e,i){"use strict";cc._RF.push(e,"361f3jG3WREaI8xtSHb2M8k","ui_chapter"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("mySafeArea"),n=t("chapterItem"),a=t("global"),r=t("pInfo"),s=t("baseUI"),c=t("chaptBtn"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollView=null,e.chaptPfb=null,e.btnView=null,e.btnPre=null,e.bgNode=null,e.bookNode=null,e.lineNode=null,e.lineNode1=null,e.topNode=null,e.closeNode=null,e.chapterJigsawPos={},e.itemHeight=460,e.swBtns=[],e.endChapterCount=0,e.startIdx=1,e.chapterItem=[],e.lastScrollPosition=0,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;if(this.node.height=cc.winSize.height,a.default.padScale){this.bgNode.scale=a.default.padScale;var e=(cc.view.getVisibleSize().width-720)/2;this.closeNode.x-=e}this.onResize(),this.btnView.content.removeAllChildren(),this.loadBtns(),this.initChpaterPos().then(function(){return t.initData()}).catch(function(t){console.error("initChpaterPosErr",t)})},e.prototype.onResize=function(){this.node.height=cc.winSize.height;var t=o.getSafeAreaRect().yMin,e=cc.winSize.height-1280-t;this.bookNode.height+=e,this.lineNode.height+=e,this.lineNode1.height+=e,this.btnView.content.height+=e,this.scrollView.content.height+=e,this.btnView.node.height+=e,this.scrollView.node.height+=e,this.btnView.content.parent.height+=e,this.scrollView.content.parent.height+=e},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){t.topNode.y-=o.getSafeAreaRect().yMin/2,t.topNode.removeComponent(cc.Widget)})},e.prototype.init=function(){},e.prototype.hideThis=function(){this.hide()},e.prototype.loadBtns=function(){for(var t=this,e=a.default.chapterCount,i=Math.ceil(e/10),o=e%10,n=function(e){var n=cc.instantiate(s.btnPre);n.parent=s.btnView.content,n.active=!0;var a=n.getComponent(c.default),r=1+10*e,l=10*(e+1);o&&(l=r+o-1);var d=r+"-"+(e===i-1?l:10*(e+1));a.setLb(d),a.setState(!1),s.swBtns.push(a),n.on("click",function(){t.btnClick(e)},s)},s=this,l=0;l<i;l++)n(l);var d=r.default.ins.getPuzzleLvl(),u=Math.ceil(d/54),p=Math.ceil(u/10);this.startIdx=1+10*(p-1),this.swBtns[p-1].setState(!0);var h=10,f=u%10;f&&(h=f);var g=(h-1)*this.itemHeight;this.scrollView.scrollToOffset(cc.v2(0,g));var v=10*p;this.endChapterCount=Math.min(v,e);var m=this.endChapterCount-this.startIdx+1;this.scrollView.content.setContentSize(cc.size(560,this.itemHeight*m))},e.prototype.btnClick=function(t){if(!this.swBtns[t].getState()){for(var e=0,i=this.swBtns.length;e<i;e++)this.swBtns[e].setState(!1);this.swBtns[t].setState(!0),this.startIdx=1+10*t;var o=10*(t+1);this.endChapterCount=Math.min(o,a.default.chapterCount);var n=this.endChapterCount-this.startIdx+1;this.scrollView.content.setContentSize(cc.size(560,this.itemHeight*n)),this.scrollView.stopAutoScroll(),this.scrollView.scrollToTop(),this.initData()}},e.prototype.initData=function(){var t=this;this.scrollView.content.children.forEach(function(e){t.chapterItem.push(e)}),this.scrollView.content.removeAllChildren(),this.loadItem(this.startIdx,0)},e.prototype.loadItem=function(t,e){if(t<=this.endChapterCount){var i=this.chapterItem.shift();i||(i=cc.instantiate(this.chaptPfb)),this.scrollView.content.addChild(i),i.name="chapter_"+t,i.opacity=0,i.position=cc.v3(0,-this.itemHeight*e),i.getComponent(n.default).init(t,this.chapterJigsawPos),t++,e++,this.scheduleOnce(this.loadItem.bind(this,t,e),0)}else{for(var o=this.scrollView.content,a=0;a<o.children.length;a++){var r=o.children[a];r.active=!0,r.opacity=255,this.showChgAni}this.lastScrollPosition=0,this.pageScroll(!1),this.showChgAni||(this.showChgAni=!0)}},e.prototype.pageScroll=function(t){void 0===t&&(t=!0);var e=this.scrollView.content.children,i=this.scrollView.getScrollOffset().y;if(!(t&&Math.abs(i-this.lastScrollPosition)<1)){for(var o=this.itemHeight,n=this.scrollView.content.parent.height,a=0;a<e.length;a++){var r=e[a],s=r.convertToWorldSpaceAR(cc.Vec2.ZERO);(s=this.scrollView.content.parent.convertToNodeSpaceAR(s)).y+o<-n||s.y-o>0?r.children[0].active=!1:r.children[0].active=!0}this.lastScrollPosition=i}},e.prototype.initChpaterPos=function(){var t,e=this,i=new Promise(function(e){t=e});return cc.assetManager.loadRemote(a.OssConfig.chapterUrl+"pos.json",cc.JsonAsset,function(i,o){var n=[[[-40,127],[129,127],[-88,-28],[195,-60],[-224,-128],[49,-128]],[[-195,134],[192,119],[144,-71],[53,34],[-40,-81],[-209,-44]],[[-133,59],[40,62],[210,95],[-191,-104],[-28,-98],[181,-95]],[[-167,122],[-24,39],[136,122],[-198,-42],[35,-80],[191,-112]],[[20,98],[-89,-44],[22,-40],[149,-75],[-193,-128],[15,-138]],[[-80,30],[101,132],[-216,-72],[-95,-123],[32,-91],[184,-66]],[[-90,29],[76,126],[79,-22],[-199,-112],[-51,-122],[197,-95]],[[-117,125],[162,110],[-217,-119],[-79,-101],[57,-118],[162,-126]],[[-129,71],[162,62],[-2,-37],[150.5,-101.6],[-9,-136.4],[-177,-136]],[[-183,-56],[22,-70],[-81,-121],[188,-130],[-74,114],[73,-149]],[[-135,96],[14,51],[188,58],[-169,-134],[-3,-97],[187,-124]],[[209,-84],[-205,97],[-173,-136],[172,56],[68,-21],[-118,-15]],[[-198,-108],[32,-139],[183,-107],[-159,133],[15,-14],[180,97]],[[-7,-51],[-35,121],[-196,24],[-159,-117],[154,-136],[149,99]],[[172,-116],[13,42],[-152,98],[-145,-127],[164,124],[31,-122]],[[121,-115],[-5,80],[-165,-122],[202,28],[-183,116],[-173,-8.4]],[[156,-25],[-206,-126],[-21.5,103.4],[5,-114],[-92,-34],[-198,3]],[[-112,84],[142,93],[-189,-97],[185,-57],[53,-99],[-58,-90]]];!i&&o&&o.json&&Array.isArray(o.json)&&e.node&&n.push.apply(n,o.json);var a=e.chapterJigsawPos,r=1;n.forEach(function(t){t.forEach(function(t){a[9*r]=cc.v2(t[0],t[1]),r++})}),t(1)}),i},e.prototype.showLoadAni=function(t){cc.tween(t).to(.5,{x:0},{easing:"backInOut"}).start()},e.prototype.showChangegAni=function(t){cc.tween(t).to(.2,{opacity:255}).start()},__decorate([u(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([u(cc.Prefab)],e.prototype,"chaptPfb",void 0),__decorate([u(cc.ScrollView)],e.prototype,"btnView",void 0),__decorate([u(cc.Node)],e.prototype,"btnPre",void 0),__decorate([u(cc.Node)],e.prototype,"bgNode",void 0),__decorate([u(cc.Node)],e.prototype,"bookNode",void 0),__decorate([u(cc.Node)],e.prototype,"lineNode",void 0),__decorate([u(cc.Node)],e.prototype,"lineNode1",void 0),__decorate([u(cc.Node)],e.prototype,"topNode",void 0),__decorate([u(cc.Node)],e.prototype,"closeNode",void 0),__decorate([d],e)}(s.default);i.default=p,cc._RF.pop()},{baseUI:"baseUI",chaptBtn:"chaptBtn",chapterItem:"chapterItem",global:"global",mySafeArea:"mySafeArea",pInfo:"pInfo"}],ui_contentUs:[function(t,e,i){"use strict";cc._RF.push(e,"738e8CNRgJIdYoGyBMV/m6N","ui_contentUs"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("request"),a=t("lang"),r=t("tipMgr"),s=t("baseUI"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ediBox=null,e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.hideThis=function(){this.hide()},e.prototype.editEnd=function(){var t=this;o.platform.onKeyboardComplete&&(this.inCorrect=!0,o.platform.onKeyboardComplete(function(e){t.ediBox&&(t.ediBox.string=e.value),t.inCorrect=!1}))},e.prototype.editChange=function(t,e){e.string=t},e.prototype.feedMsg=function(){var t=this;this.inCorrect||(this.ediBox.string?n.default.ins.userFeedBack(this.ediBox.string).then(function(e){var i=e&&e.msg||a.lang[10007];r.default.ins.showTip(i,!0),t.ediBox.string=""}).catch(function(t){console.error(t)}):r.default.ins.showTip(a.lang[10008]))},__decorate([d(cc.EditBox)],e.prototype,"ediBox",void 0),__decorate([l],e)}(s.default);i.default=u,cc._RF.pop()},{baseUI:"baseUI",idx:"idx",lang:"lang",request:"request",tipMgr:"tipMgr"}],ui_deskReward:[function(t,e,i){"use strict";cc._RF.push(e,"8ad3bzV0+JPOLqI0/63veUG","ui_deskReward"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("pConst"),r=t("res"),s=t("cfgMgr"),c=t("panelMgr"),l=t("pInfo"),d=t("baseUI"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSpr=null,e.deskSpr=null,e.numLb=null,e.infoLb=null,e}return __extends(e,t),e.prototype.onLoad=function(){o.default.opE.on(this.onOperTap.bind(this))},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.ADD_DESKTOP:this.addDesktopCb(t.data)}},e.prototype.init=function(){var t,e,i=this;r.default.ins.l("pages/page_level/zhuxian_07_3",cc.SpriteFrame,"resSps").then(function(t){i.node&&i.node.isValid&&(i.deskSpr.spriteFrame=t)}).catch(function(){console.error("getResSpErr")});var o=(null===(e=null===(t=s.default.serverCfg.add_desktop)||void 0===t?void 0:t.rules)||void 0===e?void 0:e.times)||50;this.numLb.string="+"+o},e.prototype.hideThis=function(){this.hide()},e.prototype.onBtnAdd=function(){switch(n.platform.string()){case a.PFCode.Bytedance:n.platform.addShortcut()}},e.prototype.addDesktopCb=function(t){var e,i,o=l.default.ins.getAddDesk();if(t&&!o){l.default.ins.setAddDesk(!0);var n=(null===(i=null===(e=s.default.serverCfg.add_desktop)||void 0===e?void 0:e.rules)||void 0===i?void 0:i.times)||50;l.default.ins.addPower(n);var a=this.numLb.node,r=a.parent.convertToWorldSpaceAR(a.position);c.default.ins.open("ui/ui_flyAni",{itemDatas:[{itemId:"times",worldPos:r,value:n}]}),this.hideThis()}},e.prototype.onDestroy=function(){cc.assetManager.releaseAsset(this.iconSpr.spriteFrame)},__decorate([h(cc.Sprite)],e.prototype,"iconSpr",void 0),__decorate([h(cc.Sprite)],e.prototype,"deskSpr",void 0),__decorate([h(cc.Label)],e.prototype,"numLb",void 0),__decorate([h(cc.Label)],e.prototype,"infoLb",void 0),__decorate([p],e)}(d.default);i.default=f,cc._RF.pop()},{baseUI:"baseUI",cfgMgr:"cfgMgr",evts:"evts",idx:"idx",pConst:"pConst",pInfo:"pInfo",panelMgr:"panelMgr",res:"res"}],ui_festival:[function(t,e,i){"use strict";cc._RF.push(e,"fd8b2rRJL5Bb4++/HXP0pgn","ui_festival"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("mySafeArea"),r=t("res"),s=t("time"),c=t("global"),l=t("bagMgr"),d=t("festivalMgr"),u=t("newJigMgr"),p=t("panelMgr"),h=t("tipMgr"),f=t("pInfo"),g=t("baseUI"),v=cc._decorator,m=v.ccclass,y=v.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.proLb=null,e.taskLb=null,e.timeLb=null,e.imgNode=null,e.tianNode=null,e.dayTimeLb=null,e.costLb=null,e.startBtn=null,e.topNode=null,e.upEggNode=null,e.eggNode=null,e.spineNode=null,e.jigsawNum=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.node.height=cc.winSize.height,this.checkEndTime()},e.prototype.start=function(){var t=this;this.initPanel(),this.upNewJigRed(),this.scheduleOnce(function(){t.adapter()})},e.prototype.adapter=function(){var t=a.getSafeAreaRect().yMin;this.topNode.y-=t},e.prototype.upNewJigRed=function(){var t=u.default.ins.getUnPlacedNum();if(t>0){var e=t>99?"99+":t+"";this.jigsawNum.node.parent.active=!0,this.jigsawNum.string=e+"",this.jigsawNum.node.x=c.default.getCharXOffset(this.jigsawNum.string)}else this.jigsawNum.node.parent.active=!1},e.prototype.initPanel=function(){this.initTask(),this.initImg(),this.initBtn(),this.initReward()},e.prototype.initTask=function(){var t=d.default.ins,e=t.getNowTaskData(),i=e.nums,o=t.getNowTaskPro();this.taskLb.string=e.title.format(i),this.schedule(this.showTime,1),this.showTime(),t.isTaskLocked()?(this.proLb.string="",this.upEggNode.active=!1):(this.proLb.string=o+"/"+i,this.upEggNode.active=!0)},e.prototype.initImg=function(){for(var t=d.default.ins.getFesPuzzleLv()-1,e=this.imgNode.children,i=0,o=e.length;i<o;i++)e[i].active=i>=t;if(d.default.ins.isPuzzleMax())this.spineNode.active=!1;else{this.spineNode.active=!0;var n=this.imgNode.children[t];this.spineNode.position=cc.v3(n.x+this.imgNode.x+54,n.y+this.imgNode.y-55)}},e.prototype.initBtn=function(){var t=d.default.ins.getFesLevelCost();this.costLb.string="-"+t,this.startBtn.active=!d.default.ins.isPuzzleMax()},e.prototype.initReward=function(){var t=this.upEggNode;if(d.default.ins.isTaskLocked())return this.checkShowFinger(!1),this.eggNode.angle=0,cc.Tween.stopAllByTarget(this.eggNode),void(t.active=!1);t.active=!0;var e=d.default.ins,i=e.getNowTaskData().nums;e.getNowTaskPro()>=i?(this.checkShowFinger(!0),cc.Tween.stopAllByTarget(this.eggNode),cc.tween(this.eggNode).sequence(cc.tween().to(.5,{angle:10}),cc.tween().to(1,{angle:0},{easing:"elasticOut"}).delay(.5)).repeatForever().start()):(this.checkShowFinger(!1),this.eggNode.angle=0,cc.Tween.stopAllByTarget(this.eggNode))},e.prototype.checkShowFinger=function(t){var e=this;t?this._fingerNode?this._fingerNode.active=!0:r.default.ins.lPre("prefab/finger").then(function(t){e._fingerNode=cc.instantiate(t),e.eggNode.parent.addChild(e._fingerNode);var i=cc.v3(0,105);e._fingerNode.setPosition(i),e._fingerNode.active=!0}).catch(function(){}):this._fingerNode&&this._fingerNode.active&&(this._fingerNode.active=!1)},e.prototype.showTime=function(){var t=s.default.ins.nextZeroTime/1e3;if(t<=0)return this.initTask(),void this.unschedule(this.showTime);this.dayTimeLb.string=s.default.getFormatHMS(t)},e.prototype.checkEndTime=function(){var t=d.default.ins.fesEndTime-s.default.ins.serverTime;if(t>0){var e=Math.floor(t/86400);if(e<=0)this.tianNode.active=!1,this.schedule(this.showEndTime,1),this.showEndTime();else{var i=this.timeLb.string=e+"";this.tianNode.active=!0,1==i.length&&(this.tianNode.x=112)}}else this.timeLb.string="",this.tianNode.active=!1},e.prototype.showEndTime=function(){var t=d.default.ins.fesEndTime-s.default.ins.serverTime;if(t<=0)return this.initTask(),this.timeLb.string="\u5df2\u7ed3\u675f",void this.unschedule(this.showTime);this.timeLb.string=s.default.getFormatHMS(t)},e.prototype.hideThis=function(){o.default.opE.emit({action:o.default.UPD_FES_RED}),this.hide()},e.prototype.onBtnGet=function(){if(d.default.ins.isTaskLocked())h.default.ins.showTip("\u4eca\u65e5\u4efb\u52a1\u5df2\u5b8c\u6210");else{var t=d.default.ins,e=t.getFesPro(),i=t.getNowTaskData(),o=i.nums,a=t.getNowTaskPro(),r=i.val,s=[];for(var c in r){var u=r[c],f=this.imgNode.children[e],g=f.parent.convertToWorldSpaceAR(f.position),v={};v.itemId=c,v.worldPos=g,v.value=Number(u),s.push(v)}if(a>=o){for(var c in r)u=r[c],l.default.ins.addItem(c,Number(u));p.default.ins.open("ui/ui_flyAni",{itemDatas:s});var m=Number(t.getFesPro());n.platform.reportEvent(n.ERepEvt.fesTaskFinish,{id:m}),d.default.ins.finishFesTask(),this.initPanel()}else p.default.ins.open("ui/ui_preReward",{itemDatas:s})}},e.prototype.onBtnStart=function(){var t=d.default.ins.getFesLevelCost();f.default.ins.getPower()<t?p.default.ins.open("ui/ui_getRes",{itemId:"times"}):d.default.ins.isPuzzleLocked()?h.default.ins.showTip("\u660e\u5929\u5f00\u542f"):(d.default.ins.updPro(d.fesTaskKey.costPower,t),f.default.ins.addPower(-t),f.chgScene(f.sceneType.game,{gameType:f.gameType.festival}))},e.prototype.onBtnJig=function(){this.hideThis(),o.default.opE.emit({action:o.default.MAINJUMP,data:0,param:"festival"})},e.prototype.onBtnGo=function(){var t=d.default.ins.getNowTaskData();switch(this.hideThis(),t.get_by){case d.fesTaskKey.raceScore:case d.fesTaskKey.raceTimes:o.default.opE.emit({action:o.default.MAINJUMP,data:4});break;case d.fesTaskKey.costPower:case d.fesTaskKey.throughMain:c.default.levelDone?p.default.ins.open("ui/ui_selectMode",null):p.default.ins.open("ui/ui_lvInfo",null);break;case d.fesTaskKey.finishPuzzle:o.default.opE.emit({action:o.default.MAINJUMP,data:0})}},__decorate([y(cc.Label)],e.prototype,"proLb",void 0),__decorate([y(cc.Label)],e.prototype,"taskLb",void 0),__decorate([y(cc.Label)],e.prototype,"timeLb",void 0),__decorate([y(cc.Node)],e.prototype,"imgNode",void 0),__decorate([y(cc.Node)],e.prototype,"tianNode",void 0),__decorate([y(cc.Label)],e.prototype,"dayTimeLb",void 0),__decorate([y(cc.Label)],e.prototype,"costLb",void 0),__decorate([y(cc.Node)],e.prototype,"startBtn",void 0),__decorate([y(cc.Node)],e.prototype,"topNode",void 0),__decorate([y(cc.Node)],e.prototype,"upEggNode",void 0),__decorate([y(cc.Node)],e.prototype,"eggNode",void 0),__decorate([y(cc.Node)],e.prototype,"spineNode",void 0),__decorate([y(cc.Label)],e.prototype,"jigsawNum",void 0),__decorate([m],e)}(g.default);i.default=_,cc._RF.pop()},{bagMgr:"bagMgr",baseUI:"baseUI",evts:"evts",festivalMgr:"festivalMgr",global:"global",idx:"idx",mySafeArea:"mySafeArea",newJigMgr:"newJigMgr",pInfo:"pInfo",panelMgr:"panelMgr",res:"res",time:"time",tipMgr:"tipMgr"}],ui_flyAni:[function(t,e,i){"use strict";cc._RF.push(e,"32b780K1TRFS49kf6zFOjY+","ui_flyAni"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("mySafeArea"),n=t("res"),a=t("vb"),r=t("pInfo"),s=t("baseUI"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aniParent=null,e.flyPre=null,e.coinNode=null,e.coinLb=null,e.posArrsX=[[0],[0],[-75,75],[-150,0,150],[-225,-75,75,225],[-300,-150,0,150,300],[-150,0,150,-150,0,150],[-150,0,150,-225,-75,75,225],[-225,-75,75,225,-225,-75,75,225],[-150,0,150,-150,0,150,-150,0,150],[-150,0,150,-225,-75,75,225,-150,0,150]],e.posArrsY=[[0],[0],[0,0],[0,0,0],[0,0,0,0],[0,0,0,0,0],[90,90,90,-90,-90,-90],[90,90,90,-90,-90,-90,-90],[90,90,90,90,-90,-90,-90,-90],[180,180,180,0,0,0,-180,-180,-180],[180,180,180,0,0,0,0,-180,-180,-180]],e.nodesArr=[],e.itemDatas=null,e.hideCb=null,e.isShowCoin=!1,e.isAni=!1,e}return __extends(e,t),e.prototype.init=function(t){var e=this,i=t.itemDatas,s=t.hideCb,c=t.showCoin;i&&i.length||this.hide(),i.length>10&&(i.length=10),this.hideCb=s,this.itemDatas=i;var l=this.aniParent;this.coinLb.string=c+"",this.coinNode.active=!1,this.coinNode.y=cc.winSize.height/2-60-o.getSafeAreaRect().yMin;for(var d=function(t,o){var s=i[t];l.convertToNodeSpaceAR(s.worldPos,s.worldPos);var d=cc.instantiate(u.flyPre);d.getChildByName("lbl").getComponent(cc.Label).string="x"+s.value,d.active=!0,d.parent=l,d.position=s.worldPos,n.default.ins.getBundleByString("resSps").then(function(t){t.load("item/"+s.itemId,cc.SpriteFrame,function(t,i){!t&&e.node&&d&&d.isValid&&(d.getChildByName("spr").getComponent(cc.Sprite).spriteFrame=i)})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)}),!c&&0!=c||"coin"!=s.itemId||(u.coinNode.active=!0),u.nodesArr.push(d);var p=u.posArrsX[o],h=u.posArrsY[o],f=cc.v2(p[t],h[t]),g=cc.v2((p[t]+s.worldPos.x)/2,(Math.abs(s.worldPos.y)+200)*s.worldPos.y/s.worldPos.y),v=cc.v3(0,-cc.winSize.height/2),m=cc.v2(p[t]/2,500);switch(s.itemId){case"coin":v=cc.v3(-72,cc.winSize.height/2),m=cc.v2(p[t]-200,-500);break;case"times":v=cc.v3(174,cc.winSize.height/2),m=cc.v2(p[t]+200,-500)}cc.tween(d).delay(.2*t).bezierTo(.35,s.worldPos,g,f,cc.easeInOut(1.2)).to(.04,{scale:.9}).to(.066,{scale:1.1}).to(.12,{scale:.95}).to(.053,{scale:1}).call(function(){t==o-1&&(e.isAni=!0)}).delay(.2).bezierTo(.5,f,m,v,cc.easeInOut(.8)).call(function(){a.default.p(a.VEnum3.SHORT),"coin"==s.itemId&&(e.coinLb.string=r.default.ins.getCoin()+""),d.active=!1,t==o-1&&(e.hideCb&&e.hideCb(),e.hide())}).start()},u=this,p=0,h=i.length;p<h;p++)d(p,h)},e.prototype.skipAni=function(){var t=this;if(!this.isAni){this.isAni=!0;for(var e=this.itemDatas,i=function(i,n){var s=e[i],c=o.nodesArr[i];cc.Tween.stopAllByTarget(c);var l=o.posArrsX[n],d=o.posArrsY[n],u=cc.v2(l[i],d[i]);c.position=u;var p=cc.v3(0,-cc.winSize.height/2),h=cc.v2(l[i]/2,500);switch(s.itemId){case"coin":p=cc.v3(-72,cc.winSize.height/2),h=cc.v2(l[i]-200,-500);break;case"times":p=cc.v3(174,cc.winSize.height/2),h=cc.v2(l[i]+200,-500)}o.scheduleOnce(function(){cc.tween(c).bezierTo(.3,u,h,p,cc.easeInOut(.8)).call(function(){a.default.p(a.VEnum3.SHORT),"coin"==s.itemId&&(t.coinLb.string=r.default.ins.getCoin()+""),c.active=!1,i==n-1&&(t.hideCb&&t.hideCb(),t.hide())}).start()},.1*i)},o=this,n=0,s=e.length;n<s;n++)i(n,s)}},e.prototype.hideThis=function(){this.hide()},__decorate([d(cc.Node)],e.prototype,"aniParent",void 0),__decorate([d(cc.Node)],e.prototype,"flyPre",void 0),__decorate([d(cc.Node)],e.prototype,"coinNode",void 0),__decorate([d(cc.Label)],e.prototype,"coinLb",void 0),__decorate([l],e)}(s.default);i.default=u,cc._RF.pop()},{baseUI:"baseUI",mySafeArea:"mySafeArea",pInfo:"pInfo",res:"res",vb:"vb"}],ui_gamesetlattice:[function(t,e,i){"use strict";cc._RF.push(e,"26dfbJvCClAmpxj5mN5QzJI","ui_gamesetlattice"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("baseUI"),a=cc._decorator,r=a.ccclass,s=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.onBtnAdd=function(){var t;null===(t=o.platform.addGamesetlattice)||void 0===t||t.call(o.platform)},e.prototype.hideThis=function(){this.hide()},__decorate([r],e)}(n.default));i.default=s,cc._RF.pop()},{baseUI:"baseUI",idx:"idx"}],ui_getHeart:[function(t,e,i){"use strict";cc._RF.push(e,"d77caujPdlLWI+2MbwefgBC","ui_getHeart"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("cfgMgr"),a=t("lang"),r=t("panelMgr"),s=t("pInfo"),c=t("baseUI"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curConsLbls=null,e.restLifeLbls=null,e.needGoldLbl=null,e.normalNode=null,e.adNode=null,e.needGold=300,e.eventFunc=null,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this);var e=this.needGold;try{e=this.needGold=n.default.serverCfg.qw_line_rules.rules.relive.set.coin.val||300}catch(i){}this.needGoldLbl.string=e+""},e.prototype.init=function(t){var e=t.time,i=t.cb,o=t.closeCb,n=t.gType;(this.normalNode.active=n!=s.gameType.race&&n!=s.gameType.challenge)||(this.restLifeLbls.node.y=30),this.curConsLbls.string="\u5f53\u524d\u8fde\u80dc\uff1a"+s.default.ins.getConsWinTimes(),e<0?this.restLifeLbls.node.active=!1:this.restLifeLbls.string="\u5269\u4f59\u590d\u6d3b\u6b21\u6570\uff1a"+e,this.getCb=i,this.closeCb=o,this.gType=n,this.initAdDotEvent(n)},e.prototype.initAdDotEvent=function(t){switch(t){case s.gameType.challenge:this.adNode.adDotData="\u6bcf\u65e5\u6311\u6218-\u590d\u6d3b";break;case s.gameType.normal:this.adNode.adDotData="\u4e3b\u7ebf-\u590d\u6d3b";break;case s.gameType.practice:this.adNode.adDotData="\u7ec3\u4e60\u6a21\u5f0f-\u590d\u6d3b";break;case s.gameType.race:this.adNode.adDotData="\u8da3\u5473\u8d5b-\u590d\u6d3b"}},e.prototype.onGet=function(){var t=s.default.ins;t.getCoin()<this.needGold?r.default.ins.open("ui/ui_getRes",{itemId:"coin",gType:this.gType,useTo:a.getCoinFor.Rebirth}):(t.addCoin(-this.needGold),this.hideThis(),this.getCb(),this.eventDot("\u4f7f\u7528\u5143\u5b9d"))},e.prototype.onAdGet=function(){this.hideThis(),this.getCb(),this.eventDot("\u770b\u5e7f\u544a")},e.prototype.eventDot=function(t){var e="\u4f7f\u7528\u5143\u5b9d"==t;this.gType==s.gameType.normal?(e||!s.default.ins.isMaxAdCount())&&o.platform.reportEvent(o.ERepEvt.dungeonReview,{way:t}):this.gType==s.gameType.race&&(e||!s.default.ins.isMaxAdCount())&&o.platform.reportEvent(o.ERepEvt.raceReview,{way:t})},e.prototype.onClose=function(){this.hideThis(),this.closeCb()},e.prototype.hideThis=function(){this.hide()},__decorate([u(cc.Label)],e.prototype,"curConsLbls",void 0),__decorate([u(cc.Label)],e.prototype,"restLifeLbls",void 0),__decorate([u(cc.Label)],e.prototype,"needGoldLbl",void 0),__decorate([u(cc.Node)],e.prototype,"normalNode",void 0),__decorate([u(cc.Node)],e.prototype,"adNode",void 0),__decorate([d],e)}(c.default);i.default=p,cc._RF.pop()},{baseUI:"baseUI",cfgMgr:"cfgMgr",idx:"idx",lang:"lang",pInfo:"pInfo",panelMgr:"panelMgr"}],ui_getItem:[function(t,e,i){"use strict";cc._RF.push(e,"c5238cXPXJEF72dKgiQwbZ5","ui_getItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("res"),a=t("cfgMgr"),r=t("lang"),s=t("bagMgr"),c=t("panelMgr"),l=t("tipMgr"),d=t("pInfo"),u=t("baseUI"),p=cc._decorator,h=p.ccclass,f=p.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.typeSps=[],e.getBtnNode=null,e.adGetBtn=null,e.needGoldLbl=null,e.getNumLbl=null,e.getNum2Lbl=null,e.tipLbl=null,e.adNormal=null,e.adGray=null,e.nowGold=null,e}return __extends(e,t),e.prototype.init=function(t){var e=this,i=t.itemId,o=t.cb,r=t.closeCb,s=t.gType;this.gType=s,this.itemId=i,this.getCb=o,this.closeCb=r;var c=a.default.serverCfg,l=this.data={},u="\u9053\u5177",p="";this.tipLbl.node.active=!1,this.adNormal.active=!0,this.adGray.active=!1;var h=c.props.set;switch(this.nowGold.string=d.default.ins.getCoin()+"",i){case"qw_line_ticket":var f=d.default.ins.getTicketAdTimes(),g=c.qw_line_rules.rules.times.set.ad_times,v=g.max_val;this.ticketIsMax=f>=v,l.normalGet=l.adGet=g.val,u="\u6311\u6218\u5238",this.tipLbl.node.active=!0,this.tipLbl.string="\u4eca\u65e5\u5269\u4f59"+(v-f)+"\u6b21",this.ticketIsMax?(this.adGetBtn.enabled=!1,this.adNormal.active=!1,this.adGray.active=!0):(this.adGetBtn.enabled=!0,this.adNormal.active=!0,this.adGray.active=!1),p="\u8d2d\u4e70"+u;break;case"notice":case"random_notice":case"full_row_col":for(var m=0,y=h;m<y.length;m++){var _=y[m];if(_.key==i){l.needGold=_.price,l.normalGet=l.adGet=_.ad_to_nums,u=_.title;break}}p="\u8d2d\u4e70"+u;break;case"puzzle_pieces":for(var b=5,S=0,w=h;S<w.length;S++)if((N=w[S]).key==i){l.needGold=N.price,l.normalGet=l.adGet=N.ad_to_nums,u=N.title,N.daily_limit_times&&(b=Number(N.daily_limit_times)||5);break}var T=d.default.ins.getJigsawAdTimes();this.ticketIsMax=T>=b,this.tipLbl.node.active=!0,this.tipLbl.string="\u4eca\u65e5\u5269\u4f59"+(b-T)+"\u6b21",this.ticketIsMax?(this.adGetBtn.enabled=!1,this.adNormal.active=!1,this.adGray.active=!0):(this.adGetBtn.enabled=!0,this.adNormal.active=!0,this.adGray.active=!1),p="\u62fc\u56fe\u788e\u7247\u7528\u4e8e\u62fc\u56fe\u73a9\u6cd5\uff0c\n\u53ef\u4ee5\u901a\u8fc7\u6bcf\u65e5\u4efb\u52a1\u53ca\u4e3b\u7ebf\u5173\u5361\u83b7\u5f97\u3002";break;case"newYear_pieces":for(var I=5,D=0,k=h;D<k.length;D++){var N;if((N=k[D]).key==i){l.needGold=N.price,l.normalGet=l.adGet=N.ad_to_nums,u=N.title,N.daily_limit_times&&(I=Number(N.daily_limit_times)||5);break}}l.needGold=0,l.normalGet=l.adGet=5,u="\u65b0\u6625\u62fc\u56fe\u788e\u7247";var C=d.default.ins.getNewJigAdTimes();this.ticketIsMax=C>=I,this.tipLbl.node.active=!0,this.tipLbl.string="\u4eca\u65e5\u5269\u4f59"+(I-C)+"\u6b21",this.ticketIsMax?(this.adGetBtn.enabled=!1,this.adNormal.active=!1,this.adGray.active=!0):(this.adGetBtn.enabled=!0,this.adNormal.active=!0,this.adGray.active=!1),p="\u65b0\u6625\u6d3b\u52a8\u83b7\u53d6";break;case"puzzle_notice":for(var M=0,R=h;M<R.length;M++){var L=R[M];if(L.key==i){l.needGold=L.price,l.normalGet=l.adGet=L.ad_to_nums,u=L.title;break}}p="\u4f7f\u7528\u63d0\u793a\u53ef\u4ee5\u968f\u673a\u62fc\u597d\u4e00\u4e2a\u788e\u7247\u3002";break;case"puzzle_background":for(var P=0,A=h;P<A.length;P++){var E=A[P];if(E.key==i){l.needGold=E.price,l.normalGet=l.adGet=E.ad_to_nums,u=E.title;break}}p="\u5f00\u542f\u80cc\u666f\u53ef\u83b7\u5f97\u4e00\u5b9a\u65f6\u95f4\u7684\u80cc\u666f\u663e\u793a\u3002"}l.needGold?this.needGoldLbl.string=l.needGold+"":(this.getBtnNode.active=!1,this.adGetBtn.node.x=0),this.getNumLbl.string="x"+l.normalGet,this.getNum2Lbl.string=p,n.default.ins.getBundleByString("resSps").then(function(t){t.load("item/"+i,cc.SpriteFrame,function(t,i){!t&&e.node&&e.node.isValid&&e.typeSps.forEach(function(t){t.spriteFrame=i})})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)}),this.initAdDotEvent()},e.prototype.initAdDotEvent=function(){var t="\u62fc\u56fe";r.gemeTypeKey[this.gType]&&(t=r.gemeTypeKey[this.gType]),this.adGetBtn.node.adDotData=t+"-\u9053\u5177-"+r.reportKey[this.itemId]},e.prototype.hideThis=function(){this.hide()},e.prototype.hide=function(){var e;return null===(e=this.closeCb)||void 0===e||e.call(this),t.prototype.hide.call(this)},e.prototype.onGet=function(){d.default.ins.getCoin()<this.data.needGold?c.default.ins.open("ui/ui_getRes",{itemId:"coin",gType:this.gType,useTo:r.getCoinFor.Item}):(this.getItem(!1),this.buyEventDot("\u4f7f\u7528\u5143\u5b9d"))},e.prototype.onAdGet=function(){this.ticketIsMax?l.default.ins.showTip("\u4eca\u65e5\u5df2\u8fbe\u4e0a\u9650"):(this.getItem(!0),this.buyEventDot("\u770b\u5e7f\u544a"))},e.prototype.buyEventDot=function(t){var e="\u62fc\u56fe";r.gemeTypeKey[this.gType]&&(e=r.gemeTypeKey[this.gType]),!d.default.ins.isMaxAdCount()&&o.platform.reportEvent(o.ERepEvt.buyItem,{way:t,gameType:e,itemId:r.reportKey[this.itemId]})},e.prototype.getItem=function(t){var e=this,i=this.data,o=t?i.normalGet:i.adGet,n=this.typeSps[0].node,a=n.parent.convertToWorldSpaceAR(n.position);c.default.ins.open("ui/ui_flyAni",{itemDatas:[{itemId:this.itemId,worldPos:a,value:o}],hideCb:function(){var i;switch(e.itemId){case"qw_line_ticket":d.default.ins.addTicketAdTimes(),s.default.ins.addItem(e.itemId,o);break;case"notice":case"random_notice":case"full_row_col":s.default.ins.addItem(e.itemId,o),t||d.default.ins.addCoin(-e.data.needGold);break;case"puzzle_pieces":d.default.ins.addJigsawAdTimes(),s.default.ins.addItem(e.itemId,o);break;case"newYear_pieces":d.default.ins.addNewJigAdTimes(),s.default.ins.addItem(e.itemId,o);break;case"puzzle_notice":case"puzzle_background":s.default.ins.addItem(e.itemId,o)}null===(i=e.getCb)||void 0===i||i.call(e),e.hideThis()}})},__decorate([f([cc.Sprite])],e.prototype,"typeSps",void 0),__decorate([f(cc.Node)],e.prototype,"getBtnNode",void 0),__decorate([f(cc.Button)],e.prototype,"adGetBtn",void 0),__decorate([f(cc.Label)],e.prototype,"needGoldLbl",void 0),__decorate([f(cc.Label)],e.prototype,"getNumLbl",void 0),__decorate([f(cc.Label)],e.prototype,"getNum2Lbl",void 0),__decorate([f(cc.Label)],e.prototype,"tipLbl",void 0),__decorate([f(cc.Node)],e.prototype,"adNormal",void 0),__decorate([f(cc.Node)],e.prototype,"adGray",void 0),__decorate([f(cc.Label)],e.prototype,"nowGold",void 0),__decorate([h],e)}(u.default);i.default=g,cc._RF.pop()},{bagMgr:"bagMgr",baseUI:"baseUI",cfgMgr:"cfgMgr",idx:"idx",lang:"lang",pInfo:"pInfo",panelMgr:"panelMgr",res:"res",tipMgr:"tipMgr"}],ui_getRes:[function(t,e,i){"use strict";cc._RF.push(e,"5dcedloo3JKQKfpXRHkTJiZ","ui_getRes"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("res"),r=t("uData"),s=t("cfgMgr"),c=t("lang"),l=t("item"),d=t("bagMgr"),u=t("panelMgr"),p=t("tipMgr"),h=t("pInfo"),f=t("baseUI"),g=cc._decorator,v=g.ccclass,m=g.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.typeSps=[],e.iconSps=[],e.titleLb=null,e.iconSpr=null,e.proNodes=[],e.tarNodes=[],e.getLbs=[],e.tarNums=[],e.adNode=null,e.giftNode=null,e.packNode=null,e.doubleNode=null,e.packItems=[],e.priceLb=null,e.eventFunc=null,e.shopData=null,e.isDouble=!1,e}return __extends(e,t),e.prototype.init=function(t){var e=this,i=t.itemId,o=t.cb,n=t.gType,l=t.useTo;this.tarNodes[0].active=!1,this.tarNodes[1].active=!1,this.tarNodes[2].active=!1,this.itemId=i,this.closeCb=o;var d=l||"",u=s.default.serverCfg,p=this.data={};switch(i){case"times":this.titleLb.string="\u4f53\u529b\u4e0d\u8db3",this.iconSpr.spriteFrame=this.iconSps[1];var f=h.default.ins.getPowerAdTimes(),g=r.default.ins.getIsNewUser()?u.times.forUser.new_user.rules.level:u.times.forUser.all.rules.level,v=g[f];p.normalGet=p.adGet=v.rules.val,this.proNodes[1].active=!1,this.getLbs[0].string="+"+g[0].rules.val,this.getLbs[2].string="+"+g[1].rules.val,this.tarNums[0].string=f+"/1",this.tarNums[2].string=f+"/2",1===f&&(this.tarNodes[0].active=!0),this.adNode.adDotData="\u4e3b\u7ebf-\u4f53\u529b";break;case"coin":this.titleLb.string="\u5143\u5b9d\u4e0d\u8db3",this.iconSpr.spriteFrame=this.iconSps[0];var m=h.default.ins.getCoinAdTimes(),y=u.ad_coin_rules.rules.level,_=y[m];p.normalGet=p.adGet=_.rules.val;for(var b=0;b<3;b++)this.proNodes[b].active=!0,this.getLbs[b].string="+"+y[b].rules.val,m>b?(this.tarNums[b].string=b+1+"/"+(b+1),this.tarNodes[b].active=!0):this.tarNums[b].string=m+"/"+(b+1);var S="\u4e3b\u7ebf";c.gemeTypeKey[n]&&(S=c.gemeTypeKey[n]),this.adNode.adDotData=S+"-\u5143\u5b9d-"+d}a.default.ins.getBundleByString("resSps").then(function(t){t.load("item/"+i,cc.SpriteFrame,function(t,i){!t&&e.node&&e.node.isValid&&e.typeSps.forEach(function(t){t.spriteFrame=i})}),t.load("spine/light/action",sp.SkeletonData,function(t,i){if(!t&&e.node&&e.node.isValid){var o=new cc.Node,n=o.addComponent(sp.Skeleton);n.skeletonData=i,n.animation="animation",o.parent=e.iconSpr.node}})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)}),this.initPack()},e.prototype.hideThis=function(){var t;null===(t=this.closeCb)||void 0===t||t.call(this),this.hide()},e.prototype.initPack=function(){var t,e,i=s.default.serverCfg,o=("times"===this.itemId?null===(t=null==i?void 0:i.buy_stamina)||void 0===t?void 0:t.stamina:null===(e=null==i?void 0:i.buy_gold_coins)||void 0===e?void 0:e.gold_coins)["times"===this.itemId?"times2":"coin7"];if(o){this.packNode.active=!0,this.shopData=o;var n=o.key,a=h.default.ins.getShopUnreset(),r=o.double||0,c=a[n]||0,l=this.isDouble=this.doubleNode.active=c<r;this.packItems.forEach(function(t){t.node.active=!0});var d=o.props;for(var u in d){var p=Number(d[u]);l?(this.packItems[0].initByData(u,2*p),this.packItems[1].initByData(u,p),this.packItems[2].initByData(u,p)):(this.packItems[0].initByData(u,p),this.packItems[1].initByData(u,p),this.packItems[2].node.active=!1)}this.priceLb.string="\xa5"+o.price}else this.packNode.active=!1},e.prototype.onAdGet=function(){this.getItem(!0)},e.prototype.getItem=function(t){this.tarNodes[0].active=!1,this.tarNodes[1].active=!1,this.tarNodes[2].active=!1;var e=this.data,i=t?e.normalGet:e.adGet,a=h.default.ins,c=s.default.serverCfg;switch(this.itemId){case"times":a.addPower(i,!1),a.addPowerAdTimes(),this.proNodes[1].active=!1;var l=r.default.ins.getIsNewUser()?c.times.forUser.new_user.rules.level:c.times.forUser.all.rules.level,d=a.getPowerAdTimes(),p=l[d];e.normalGet=e.adGet=p.rules.val,1===d?(this.tarNodes[0].active=!0,this.tarNums[0].string=d+"/1",this.tarNums[2].string=d+"/2"):0===d&&(this.tarNodes[0].active=!0,this.tarNodes[2].active=!0,this.tarNums[0].string="1/1",this.tarNums[2].string="2/2"),!h.default.ins.isMaxAdCount()&&n.platform.reportEvent(n.ERepEvt.buyTimes);break;case"coin":a.addCoin(i,!1),a.addCoinAdTimes();var f=h.default.ins.getCoinAdTimes(),g=c.ad_coin_rules.rules.level[f];e.normalGet=e.adGet=g.rules.val;for(var v=0;v<3;v++)this.proNodes[v].active=!0,f>v?(this.tarNums[v].string=v+1+"/"+(v+1),this.tarNodes[v].active=!0):this.tarNums[v].string=f+"/"+(v+1);!h.default.ins.isMaxAdCount()&&n.platform.reportEvent(n.ERepEvt.buyCoins)}var m=this.iconSpr.node,y=m.parent.convertToWorldSpaceAR(m.position);u.default.ins.open("ui/ui_flyAni",{itemDatas:[{itemId:this.itemId,worldPos:y,value:i}],hideCb:function(){o.default.opE.emit({action:o.default.POWER_CHG}),o.default.opE.emit({action:o.default.COIN_CHG})}})},e.prototype.onDestroy=function(){cc.assetManager.releaseAsset(this.iconSpr.spriteFrame)},e.prototype.onBtnBuy=function(){var t=this;if(this.shopData){var e=this.isDouble?1:0,i=this.shopData.props,o=JSON.stringify(this.shopData.props);n.platform.reportEvent(n.ERepEvt.susPayment,{key:this.shopData.key}),n.platform.payment(this.shopData.key,this.shopData.price,e,o).then(function(){var e=[];for(var o in i){var a=i[o];t.isDouble&&(a*=2),d.default.ins.addItem(o,a);var r={};r.itemId=o,r.worldPos=t.packItems[0].node.parent.convertToWorldSpaceAR(t.packItems[0].node.position),r.value=a,e.push(r)}u.default.ins.open("ui/ui_flyAni",{itemDatas:e}),h.default.ins.addShopUnreset(t.shopData.key),t.initPack(),n.platform.reportEvent(n.ERepEvt.paymentResult,{key:t.shopData.key,success:1})}).catch(function(e){p.default.ins.showTip(e,!0),n.platform.reportEvent(n.ERepEvt.paymentResult,{key:t.shopData.key,success:0})})}},e.prototype.onBtnShop=function(){this.hideThis(),o.default.opE.emit({action:o.default.MAINJUMP,data:0}),u.default.ins.open("ui/ui_shopPack",null).then(function(){o.default.opE.emit({action:o.default.UPD_MAIN_RED})})},__decorate([m([cc.Sprite])],e.prototype,"typeSps",void 0),__decorate([m([cc.SpriteFrame])],e.prototype,"iconSps",void 0),__decorate([m(cc.Label)],e.prototype,"titleLb",void 0),__decorate([m(cc.Sprite)],e.prototype,"iconSpr",void 0),__decorate([m([cc.Node])],e.prototype,"proNodes",void 0),__decorate([m([cc.Node])],e.prototype,"tarNodes",void 0),__decorate([m([cc.Label])],e.prototype,"getLbs",void 0),__decorate([m([cc.Label])],e.prototype,"tarNums",void 0),__decorate([m(cc.Node)],e.prototype,"adNode",void 0),__decorate([m(cc.Node)],e.prototype,"giftNode",void 0),__decorate([m(cc.Node)],e.prototype,"packNode",void 0),__decorate([m(cc.Node)],e.prototype,"doubleNode",void 0),__decorate([m([l.default])],e.prototype,"packItems",void 0),__decorate([m(cc.Label)],e.prototype,"priceLb",void 0),__decorate([v],e)}(f.default);i.default=y,cc._RF.pop()},{bagMgr:"bagMgr",baseUI:"baseUI",cfgMgr:"cfgMgr",evts:"evts",idx:"idx",item:"item",lang:"lang",pInfo:"pInfo",panelMgr:"panelMgr",res:"res",tipMgr:"tipMgr",uData:"uData"}],ui_getReward:[function(t,e,i){"use strict";cc._RF.push(e,"e7f52YMQ3lPSrhdMRaASNUv","ui_getReward"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("res"),n=t("bagMgr"),a=t("festivalMgr"),r=t("levelMgr"),s=t("panelMgr"),c=t("pInfo"),l=t("game"),d=t("baseUI"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rew1Lbl=null,e.rew2Lbl=null,e.rew3Lbl=null,e.rew4Lbl=null,e.adGetBtn=null,e.typeSps=[],e}return __extends(e,t),e.prototype.init=function(t){var e=this,i=t.gold;this.goldNum=i;var n,r=this.pieceNum=1;this.rew1Lbl.string="x"+i,this.rew2Lbl.string="x"+r,this.rew3Lbl.string="x"+10*i,this.rew4Lbl.string="x"+10*r,this.initAdDotEvent();var s=l.default.type;n=s!==c.gameType.festival||a.default.ins.isJigsawMax()?"puzzle_pieces":"newYear_pieces",o.default.ins.getBundleByString("resSps").then(function(t){t.load("item/"+n,cc.SpriteFrame,function(t,i){!t&&e.node&&e.node.isValid&&e.typeSps.forEach(function(t){t.spriteFrame=i})})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})},e.prototype.tempGet=function(t){var e,i=t?10:1,o=c.default.ins.getCoin();c.default.ins.addCoin(this.goldNum*i),e=l.default.type!==c.gameType.festival||a.default.ins.isJigsawMax()?"puzzle_pieces":"newYear_pieces",n.default.ins.addItem(e,i);var d=this.goldNum*i,u=i,p=this.rew1Lbl.node,h=this.rew2Lbl.node,f=this.node,g=f.convertToWorldSpaceAR(p.position),v=f.convertToWorldSpaceAR(h.position);s.default.ins.open("ui/ui_flyAni",{itemDatas:[{itemId:"coin",worldPos:g,value:d},{itemId:e,worldPos:v,value:u}],hideCb:function(){c.chgScene(c.sceneType.main,{cb:r.default.ins.updJigAndPop})},showCoin:o}),this.hideThis()},e.prototype.hideThis=function(){this.hide()},e.prototype.onGet=function(){this.tempGet(!1)},e.prototype.onAdGet=function(){this.tempGet(!0)},e.prototype.initAdDotEvent=function(){l.default.type!==c.gameType.festival||a.default.ins.isJigsawMax()?this.adGetBtn.node.adDotData="\u4e3b\u7ebf\u5341\u500d\u5956\u52b1":this.adGetBtn.node.adDotData="\u6d3b\u52a8\u5341\u500d\u5956\u52b1"},__decorate([h(cc.Label)],e.prototype,"rew1Lbl",void 0),__decorate([h(cc.Label)],e.prototype,"rew2Lbl",void 0),__decorate([h(cc.Label)],e.prototype,"rew3Lbl",void 0),__decorate([h(cc.Label)],e.prototype,"rew4Lbl",void 0),__decorate([h(cc.Button)],e.prototype,"adGetBtn",void 0),__decorate([h([cc.Sprite])],e.prototype,"typeSps",void 0),__decorate([p],e)}(d.default);i.default=f,cc._RF.pop()},{bagMgr:"bagMgr",baseUI:"baseUI",festivalMgr:"festivalMgr",game:"game",levelMgr:"levelMgr",pInfo:"pInfo",panelMgr:"panelMgr",res:"res"}],ui_info:[function(t,e,i){"use strict";cc._RF.push(e,"68903bM3tFJxIGiJX3VlM6L","ui_info"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("baseUI"),n=cc._decorator,a=n.ccclass,r=n.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title=null,e.content=null,e}return __extends(e,t),e.prototype.init=function(t){var e=this,i=t.type;this.title.string=1==i?"\u7528\u6237\u534f\u8bae":"\u9690\u79c1\u653f\u7b56",cc.assetManager.loadBundle("other",function(t,o){t||o.load(i+"",cc.TextAsset,function(t,i){var o=e.content;!t&&o&&o.isValid&&(o.string=i.text)})})},e.prototype.hideThis=function(){t.prototype.hide.call(this)},__decorate([r(cc.Label)],e.prototype,"title",void 0),__decorate([r(cc.Label)],e.prototype,"content",void 0),__decorate([a],e)}(o.default);i.default=s,cc._RF.pop()},{baseUI:"baseUI"}],ui_jigFinish:[function(t,e,i){"use strict";cc._RF.push(e,"6948fUS92JKPqR9GQdGftvI","ui_jigFinish"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("res"),a=t("global"),r=t("jigsawMgr"),s=t("newJigMgr"),c=t("panelMgr"),l=t("baseUI"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.finishSpr=null,e.lightNode=null,e}return __extends(e,t),e.prototype.onLoad=function(){cc.tween(this.lightNode).by(3,{angle:-360}).repeatForever().start()},e.prototype.init=function(t){var e=this,i=t.themeId,o=t.themeType,c=i+1,l="pintu_"+c;1===o?r.default.ins:2===o&&(s.default.ins,l="fes_"+c),1===o?c<61?n.default.ins.getBundleByString("jigsaw").then(function(t){t.load(l,cc.SpriteFrame,function(t,i){!t&&e.node&&e.node.isValid&&(e.finishSpr.spriteFrame=i)})}).catch(function(t){console.error("RTool.ins.getBundleByString('jigsaw')",t)}):cc.assetManager.loadRemote(a.OssConfig.jigswawUrl+l+".jpg",{ext:a.headImgExt},function(t,i){!t&&e.node&&e.node.isValid&&(e.finishSpr.spriteFrame=new cc.SpriteFrame(i))}):n.default.ins.getBundleByString("jigsaw").then(function(t){t.load(l,cc.SpriteFrame,function(t,i){!t&&e.node&&e.node.isValid&&(e.finishSpr.spriteFrame=i)})}).catch(function(t){console.error("RTool.ins.getBundleByString('jigsaw')",t)})},e.prototype.hideThis=function(){this.hide()},e.prototype.onBtnBack=function(){c.default.ins.closeAllPanel(),o.default.opE.emit({action:o.default.MAINJUMP,data:2}),o.default.opE.emit({action:o.default.UPDJIGSAWGAME})},e.prototype.onBtnNext=function(){c.default.ins.closeAllPanel(),o.default.opE.emit({action:o.default.UPDJIGSAWGAME})},__decorate([p(cc.Sprite)],e.prototype,"finishSpr",void 0),__decorate([p(cc.Node)],e.prototype,"lightNode",void 0),__decorate([u],e)}(l.default);i.default=h,cc._RF.pop()},{baseUI:"baseUI",evts:"evts",global:"global",jigsawMgr:"jigsawMgr",newJigMgr:"newJigMgr",panelMgr:"panelMgr",res:"res"}],ui_jigTip:[function(t,e,i){"use strict";cc._RF.push(e,"8fafd+wZatAc4UtHon65T2w","ui_jigTip"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("baseUI"),n=cc._decorator,a=n.ccclass,r=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.okCb=null,e}return __extends(e,t),e.prototype.init=function(t){var e=t.okCb;this.okCb=e},e.prototype.onBtnEnsure=function(){this.okCb&&this.okCb(),this.hideThis()},e.prototype.hideThis=function(){this.hide()},__decorate([a],e)}(o.default));i.default=r,cc._RF.pop()},{baseUI:"baseUI"}],ui_jigsaw:[function(t,e,i){"use strict";cc._RF.push(e,"f553dAxt3lMRq5VspifJTH7","ui_jigsaw"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("jigsaw"),a=t("global"),r=t("baseUI"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.jigsawPre=null,e.bgNode=null,e.closeNode=null,e.jigsawItem=null,e}return __extends(e,t),e.prototype.onLoad=function(){if(this.node.height=cc.winSize.height,a.default.padScale){this.bgNode.scale=a.default.padScale;var t=(cc.view.getVisibleSize().width-720)/2;this.closeNode.x-=t}this.node.on(cc.Node.EventType.TOUCH_START,this.onTBe,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTM,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTE,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTC,this)},e.prototype.start=function(){},e.prototype.init=function(t){var e=t.theme_id,i=t.themeType,o=cc.instantiate(this.jigsawPre);o.parent=this.node,o.position=cc.v3(0,0),this.jigsawItem=o.getComponent(n.default),this.jigsawItem.initItem(e,i)},e.prototype.onTBe=function(t){var e=this.jigsawItem;e&&e.node.active&&e.onTBe(t)},e.prototype.onTM=function(t){var e=this.jigsawItem;e&&e.onTM(t)},e.prototype.onTE=function(t){var e=this.jigsawItem;e&&e.onTE(t)},e.prototype.onTC=function(t){var e=this.jigsawItem;e&&e.onTC(t)},e.prototype.hideThis=function(){this.hide(),o.default.opE.emit({action:o.default.UPDJIGSAWGAME})},e.prototype.onDestroy=function(){},__decorate([l(cc.Prefab)],e.prototype,"jigsawPre",void 0),__decorate([l(cc.Node)],e.prototype,"bgNode",void 0),__decorate([l(cc.Node)],e.prototype,"closeNode",void 0),__decorate([c],e)}(r.default);i.default=d,cc._RF.pop()},{baseUI:"baseUI",evts:"evts",global:"global",jigsaw:"jigsaw"}],ui_luckyGift:[function(t,e,i){"use strict";cc._RF.push(e,"6d3d4wIWL9INoHkuewVRpux","ui_luckyGift"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("cfgMgr"),n=t("baseUI"),a=t("com"),r=t("pInfo"),s=t("bagMgr"),c=t("panelMgr"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.giftsNode=null,e.btn_start=null,e.pointerNode=null,e.labTip=null,e.proGiftNode=null,e.giftsDatas=null,e.isCurPlayAni=!1,e.drawedTime=0,e.nowHaveTime=!1,e.crossedLevel=0,e.proMax=10,e.proGift=null,e.proGiftDatas=[],e}return __extends(e,t),e.prototype.start=function(){this.giftsDatas=o.default.serverCfg.lucky_gift.rules,this.pointRots=[0,22,67,112,157,202,247,292,337],this.isCurPlayAni=!1,this.proMax=10,this.proGiftDatas=[],this.proGift=[2,3,5,7,9],this.initData(),this.initPro(),this.initInfo(),this.initItems()},e.prototype.initData=function(){var t=r.default.ins;this.drawedTime=t.getLuckTimes(),this.nowHaveTime=t.getLuckyState(),this.crossedLevel=t.getRecordData().main.wTimes},e.prototype.initPro=function(){},e.prototype.updatePro=function(){},e.prototype.initInfo=function(){if(this.nowHaveTime)this.btn_start.enabled=!0,this.labTip.node.active=!1;else{this.btn_start.enabled=!1,this.labTip.node.active=!0;var t=2-this.crossedLevel%2;this.labTip.string="(\u518d\u901a\u8fc7"+t+"\u5173\u5373\u53ef\u62bd\u5956)"}},e.prototype.initItems=function(){for(var t=1;t<=8;t++){var e=this.giftsDatas[t-1],i=this.giftsNode.getChildByName(""+t);i.getChildByName("light").active=!1,i.getChildByName("lab").getComponent(cc.Label).string=e.title}},e.prototype.getProGift=function(){},e.prototype.onBtnStart=function(){var t=this;if(!this.isCurPlayAni){var e=a.default.ins.rad(1,8);this.playAni(e,!0,function(){r.default.ins.addLuckyTimes(),t.initData(),t.addGoodToData(t.giftsDatas[e-1],t.giftsNode.getChildByName(""+e).getChildByName("spr")),t.getProGift(),t.updatePro(t.drawedTime,t.proMax),t.initInfo()})}},e.prototype.addGoodToData=function(t,e){switch(t.props){case"notice":case"full_row_col":case"random_notice":s.default.ins.addItem(t.props,t.val);break;case"times":r.default.ins.addPower(t.val);break;case"coin":r.default.ins.addCoin(t.val)}var i=e.parent.convertToWorldSpaceAR(e.position);c.default.ins.open("ui/ui_flyAni",{itemDatas:[{itemId:t.props,worldPos:i,value:t.val}]})},e.prototype.playAni=function(t,e,i){var o=this;if(!this.isCurPlayAni){if(this.isCurPlayAni=!0,!e)return this.actionIndex(t),this.pointerNode.angle=-this.pointRots[t],void(this.isCurPlayAni=!1);var n=t,a=0;this.schedule(function t(){if(a+=1,o.actionIndex(a),a>15){var e=0;o.unschedule(t),o.schedule(function t(){e+=1,o.actionIndex(e),e>n&&(o.blingbling(n,function(){o.isCurPlayAni=!1,i&&i()}),o.unschedule(t))},.1)}},.1),this.pointerNode.angle=0;var r=720+this.pointRots[t],s=1.8+.1*t;cc.tween(this.pointerNode).to(s,{angle:-r}).call(function(){}).start()}},e.prototype.actionIndex=function(t){this.hideAllGiftLight();var e=t%8;0==e&&(e=8),this.giftsNode.getChildByName(""+e).getChildByName("light").active=!0},e.prototype.blingbling=function(t,e){var i=this;if(this.hideAllGiftLight(),t){var o=0;this.schedule(function n(){o+=1,i.giftsNode.getChildByName(""+t).getChildByName("light").active=o%2!=0,o>20&&(i.actionIndex(t),e&&e(),i.unschedule(n))},.05)}},e.prototype.hideAllGiftLight=function(){for(var t=1;t<=8;t++)this.giftsNode.getChildByName(""+t).getChildByName("light").active=!1},e.prototype.hideThis=function(){this.isCurPlayAni||this.hide()},__decorate([u(cc.Node)],e.prototype,"giftsNode",void 0),__decorate([u(cc.Button)],e.prototype,"btn_start",void 0),__decorate([u(cc.Node)],e.prototype,"pointerNode",void 0),__decorate([u(cc.Label)],e.prototype,"labTip",void 0),__decorate([u(cc.Node)],e.prototype,"proGiftNode",void 0),__decorate([d],e)}(n.default);i.default=p,cc._RF.pop()},{bagMgr:"bagMgr",baseUI:"baseUI",cfgMgr:"cfgMgr",com:"com",pInfo:"pInfo",panelMgr:"panelMgr"}],ui_lvInfo:[function(t,e,i){"use strict";cc._RF.push(e,"e1b77tK3Q9Hy5iP5k4ikNUN","ui_lvInfo"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("global"),n=t("festivalMgr"),a=t("levelMgr"),r=t("panelMgr"),s=t("pInfo"),c=t("main"),l=t("baseUI"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lvLB=null,e.numLv=null,e.diffLb=null,e.curLB=null,e.costLBL=null,e.costLBR=null,e.jigsawSp=null,e.kuangSp=null,e.matArr=[],e.aniSpr=null,e.boomSpine=null,e.isShow=!1,e}return __extends(e,t),e.prototype.start=function(){},e.prototype.init=function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.isShow=(null===(t=e[0])||void 0===t?void 0:t.isShow)||!1,this.kuangSp.setMaterial(0,this.matArr[0]),this.showLvInfo()},e.prototype.showLvInfo=function(){var t=this,e=s.default.ins,i=a.default.ins,o=e.getPuzzleLvl(),n=o-54*(Math.ceil(o/54)-1);this.lvLB.string="\u7b2c"+n+"\u5173";var r=i.getPuzzleInfo().size;this.numLv.string=r+"x"+r,this.diffLb.string=i.getLevelDiffStr(),this.curLB.string=e.getConsWinTimes()+"",this.costLBL.string=i.getLevelCost()+"/",this.costLBR.string=""+e.getPower();var c=new cc.Color(251,234,168);this.costLBR.node.color=i.getLevelCost()>e.getPower()?cc.Color.RED:c;var l=s.default.ins.getPuzzleLvl();if(l%9==1&&(this.isShow=!1),this.isShow){var d=this.updJigsaw(l-1);this.scheduleOnce(function(){t.showPopAni(d)},.34)}else this.updJigsaw(l)},e.prototype.updJigsaw=function(t){var e,i=this,o=(t-1)%a.default.ins.getPuzzleLvlCount(),n=Math.ceil(o/9)||1;return e=9==(e=o>=9*n?9:o>9*n-9?o%9:0)?0:e,a.default.ins.getJigsawIcon(n).then(function(t){t&&(i.jigsawSp.spriteFrame=t)}).catch(function(){console.error("getIconErr")}),this.jigsawSp.getMaterial(0).setProperty("height",e),e},e.prototype.showPopAni=function(t){var e=this;a.default.ins.getPuzzleSprFrame(s.default.ins.getPuzzleLvl()-1).then(function(i){if(e.node){e.aniSpr.spriteFrame=i;var o=t%3,n=Math.floor(t/3),a=e.aniSpr.node;a.x+=40*o,a.y-=40*n,a.scale=.1,cc.tween(a).to(.02,{scale:1.1}).to(.06,{scale:.7}).to(.1,{scale:1}).delay(.7).call(function(){e.boomSpine.node.active=!0,e.aniSpr.spriteFrame=null;var t=s.default.ins.getPuzzleLvl();e.updJigsaw(t)}).start()}})},e.prototype.onBtnStart=function(){var t=a.default.ins.getLevelCost();if(s.default.ins.getPower()<t)r.default.ins.open("ui/ui_getRes",{itemId:"times"});else{var e=this.costLBL.node.convertToWorldSpaceAR(cc.Vec3.ZERO),i=c.default.ins;i&&(i.blockComp.enabled=!0),i.usePower(-t,e),o.default.puzzlv=s.default.ins.getPuzzleLvl()-1,n.default.ins.updPro(n.fesTaskKey.costPower,t)}},e.prototype.hideThis=function(){this.kuangSp.setMaterial(0,this.matArr[1]),this.hide()},__decorate([p(cc.Label)],e.prototype,"lvLB",void 0),__decorate([p(cc.Label)],e.prototype,"numLv",void 0),__decorate([p(cc.Label)],e.prototype,"diffLb",void 0),__decorate([p(cc.Label)],e.prototype,"curLB",void 0),__decorate([p(cc.Label)],e.prototype,"costLBL",void 0),__decorate([p(cc.Label)],e.prototype,"costLBR",void 0),__decorate([p(cc.Sprite)],e.prototype,"jigsawSp",void 0),__decorate([p(cc.Sprite)],e.prototype,"kuangSp",void 0),__decorate([p(cc.Material)],e.prototype,"matArr",void 0),__decorate([p(cc.Sprite)],e.prototype,"aniSpr",void 0),__decorate([p(sp.Skeleton)],e.prototype,"boomSpine",void 0),__decorate([u],e)}(l.default);i.default=h,cc._RF.pop()},{baseUI:"baseUI",festivalMgr:"festivalMgr",global:"global",levelMgr:"levelMgr",main:"main",pInfo:"pInfo",panelMgr:"panelMgr"}],ui_mailInfo:[function(t,e,i){"use strict";cc._RF.push(e,"9f5988cQTZGpqvbdBk5aXo1","ui_mailInfo"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("item1"),a=t("mailMgr"),r=t("panelMgr"),s=t("baseUI"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollView=null,e.title=null,e.cont=null,e.itemPfb=null,e.awardNode=null,e.deleteNode=null,e._mailItem=[],e}return __extends(e,t),e.prototype.start=function(){},e.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0].id;this.mailId=i;var o=a.default.ins.serverMail;this.title.string=o[i].title,this.cont.string=o[i].msg,this.updateItem()},e.prototype.updateItem=function(t){var e=this;void 0===t&&(t=!0);var i=a.default.ins.mailInfo.mail[this.mailId],o=a.default.ins.serverMail,r=JSON.parse(o[this.mailId].props);if(t){for(var s in this.scrollView.content.children.forEach(function(t){e._mailItem.push(t)}),this.scrollView.content.removeAllChildren(),r)if(r.hasOwnProperty(s)){var c=this._mailItem.shift()||cc.instantiate(this.itemPfb);this.scrollView.content.addChild(c),c.getComponent(n.default).init(s,r[s],i)}if(this.scrollView.content.childrenCount){var l=(this.scrollView.content.children[0].width+5.5)*this.scrollView.content.childrenCount;this.scrollView.node.x=l>this.scrollView.node.width?-209:(this.scrollView.node.width-l)/2-209,l=Math.min(l,360),this.scrollView.node.width=l,this.scrollView.scrollToLeft()}}var d=Object.keys(r).length>0;this.awardNode.active=d&&i!=a.mailState.award,this.deleteNode.active=!this.awardNode.active},e.prototype.updMail=function(){},e.prototype.getAward=function(){if(a.default.ins.getAward(this.mailId)){for(var t=[],e=this.scrollView.content.childrenCount-1;e>=0;e--){var i=this.scrollView.content.children[e],o=i.parent.convertToWorldSpaceAR(i.position),s={};s.itemId=i.getComponent(n.default).key,s.worldPos=o,s.value=i.getComponent(n.default).countStr,t.push(s)}r.default.ins.open("ui/ui_flyAni",{itemDatas:t}),this.updateItem(!1)}},e.prototype.delete=function(){a.default.ins.deleteMail(this.mailId),this.hideThis(),o.default.opE.emit({action:o.default.UPDMAIL,data:{type:"delete",id:this.mailId}})},e.prototype.changereadState=function(){a.default.ins.readMail(this.mailId)&&o.default.opE.emit({action:o.default.UPDMAIL,data:{type:"read",id:this.mailId}})},e.prototype.hideThis=function(){this.hide()},e.prototype.onHide=function(){this.changereadState()},__decorate([d(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([d(cc.Label)],e.prototype,"title",void 0),__decorate([d(cc.Label)],e.prototype,"cont",void 0),__decorate([d(cc.Prefab)],e.prototype,"itemPfb",void 0),__decorate([d(cc.Node)],e.prototype,"awardNode",void 0),__decorate([d(cc.Node)],e.prototype,"deleteNode",void 0),__decorate([l],e)}(s.default);i.default=u,cc._RF.pop()},{baseUI:"baseUI",evts:"evts",item1:"item1",mailMgr:"mailMgr",panelMgr:"panelMgr"}],ui_mail:[function(t,e,i){"use strict";cc._RF.push(e,"e7ea9rOEC9HW6BXUtMwquOJ","ui_mail"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("lang"),a=t("mailItem"),r=t("mailMgr"),s=t("panelMgr"),c=t("tipMgr"),l=t("pInfo"),d=t("baseUI"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollView=null,e.mailPfb=null,e.emptyNode=null,e.getAllNode=null,e.eventFunc=null,e.isLoad=!1,e._mailItem=[],e.lastScrollPosition=0,e}return __extends(e,t),e.prototype.start=function(){},e.prototype.init=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];r.default.ins.getMail(this.updMail.bind(this)),this.scrollView.node.on("scrolling",function(){t.pageScroll()},this)},e.prototype.updMail=function(){var t=this;if(!this.isLoad&&this.scrollView){this.isLoad=!0;var e=this.scrollView.content;e.children.forEach(function(e){t._mailItem.push(e)}),e.removeAllChildren();var i=r.default.ins.mailInfo.mail,o=Object.keys(i);if(this.emptyNode.active=0==o.length,o.length){for(var n=this.mailPfb,s=r.default.ins,c=0;c<o.length;c++){var l=o[c];if(s.serverMail[l]){var d=s.mailInfo.mail[l],u=this._mailItem.shift();u||(u=cc.instantiate(n)),this.scrollView.content.addChild(u,0),u.active=!1,u.getComponent(a.default).init(Number(l),d)}}this.isLoad=!1,this.lastScrollPosition=0,this.updState({type:"load"}),this.scheduleOnce(this.pageScroll.bind(this,!1),0)}else this.isLoad=!1}},e.prototype.pageScroll=function(t){void 0===t&&(t=!0);var e=this.scrollView.content.children,i=this.scrollView.getScrollOffset().y;if(!(t&&Math.abs(i-this.lastScrollPosition)<1)){for(var o=this.scrollView.content.parent.height/2,n=0;n<e.length;n++){var a=e[n],r=a.convertToWorldSpaceAR(cc.Vec2.ZERO);(r=this.scrollView.content.parent.convertToNodeSpaceAR(r)).y+a.height/2<-o||r.y-a.height/2>o?a.children[0].active=!1:a.children[0].active=!0}this.lastScrollPosition=i}},e.prototype.showLoadAni=function(t){cc.tween(t).to(.5,{x:0},{easing:"backInOut"}).start()},e.prototype.showChangegAni=function(t){cc.tween(t).to(.2,{opacity:255}).start()},e.prototype.chgAni=function(t,e){void 0===e&&(e=0),t.active=!0,this.showChgAni?(t.opacity=0,this.scheduleOnce(this.showChangegAni.bind(this,t),.1*(e+1))):(t.x=(cc.winSize.width+t.width)/2,this.scheduleOnce(this.showLoadAni.bind(this,t),.05*e))},e.prototype.mailSort=function(){this.scrollView.content.children.sort(function(t,e){return t.getComponent(a.default).state-e.getComponent(a.default).state}),this.scrollView.content.getComponent(cc.Layout).updateLayout()},e.prototype.getItemById=function(t){for(var e=this.scrollView.content.children,i=0;i<e.length;i++){var o=e[i].getComponent(a.default);if(t===o.id)return{item:o,index:i}}},e.prototype.updState=function(t){var e=this,i=this.scrollView.content,o=r.default.ins.serverMail;if(t)if("keyAward"===t.type)i.children.forEach(function(t,i){var n=t.getComponent(a.default);o[n.id].props&&n.state!==r.mailState.award&&(n.updateState(r.mailState.award),e.chgAni(t,i))});else if("load"===t.type)this.mailSort(),i.children.forEach(function(t,i){e.chgAni(t,i)});else if("keyDelete"===t.type){var n=[];i.children.forEach(function(t,e){var i=t.getComponent(a.default);i.state===r.mailState.award&&n.push({node:i.node,index:e})}),n.forEach(function(t){i.children.splice(t.index,1),t.node.destroy(),i.getComponent(cc.Layout).updateLayout()})}else if("read"===t.type){if(t.id){var s=this.getItemById(t.id),c=r.default.ins.mailInfo.mail[t.id];s&&s.item&&(s.item.updateState(c),this.chgAni(s.item.node),this.mailSort())}}else if("delete"===t.type){var l=this.getItemById(t.id);l&&l.item.node.destroy(),this.scheduleOnce(function(){i.children.splice(l.index,1),e.mailSort()})}this.scheduleOnce(function(){e.emptyNode.active=0==e.scrollView.content.children.length,e.pageScroll.bind(e,!1)}),this.showChgAni||(this.showChgAni=!0)},e.prototype.keyDelete=function(){if(!this.isLoad){var t=0;Object.values(r.default.ins.mailInfo.mail).forEach(function(e){e===r.mailState.award&&t++}),t<=0?c.default.ins.showTip(n.lang[10005]):r.default.ins.deleteMail()}},e.prototype.keyAward=function(){if(!this.isLoad)if(Object.keys(r.default.ins.mailInfo.mail).length<=0)c.default.ins.showTip(n.lang[10006]);else{var t=l.default.ins.Mail,e=r.default.ins,i={};for(var o in t.mail)if(t.mail[o]!==r.mailState.award){var a=e.serverMail;if(o&&a[o]){var d=JSON.parse(a[o].props);for(var u in d)d.hasOwnProperty(u)&&(i[u]?i[u]+=Number(d[u]):i[u]=Number(d[u]))}}if(r.default.ins.getAward()){var p=[],h=this.getAllNode.parent.convertToWorldSpaceAR(this.getAllNode.position);for(var f in i){var g=i[f],v={};v.itemId=f,v.worldPos=h,v.value=g,p.push(v)}p.length&&(p.length>10&&(p.length=10),s.default.ins.open("ui/ui_flyAni",{itemDatas:p}))}else c.default.ins.showTip(n.lang[10006])}},e.prototype.onLoad=function(){this.eventFunc=this.onOperTap.bind(this),o.default.opE.on(this.eventFunc)},e.prototype.onDestroy=function(){o.default.opE.off(this.eventFunc),this.eventFunc=null},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.UPDMAIL:this.updState(t.data)}},e.prototype.hideThis=function(){this.hide()},__decorate([h(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([h(cc.Prefab)],e.prototype,"mailPfb",void 0),__decorate([h(cc.Node)],e.prototype,"emptyNode",void 0),__decorate([h(cc.Node)],e.prototype,"getAllNode",void 0),__decorate([p],e)}(d.default);i.default=f,cc._RF.pop()},{baseUI:"baseUI",evts:"evts",lang:"lang",mailItem:"mailItem",mailMgr:"mailMgr",pInfo:"pInfo",panelMgr:"panelMgr",tipMgr:"tipMgr"}],ui_newGift:[function(t,e,i){"use strict";cc._RF.push(e,"73028GmA1pEwZDKXT2TiRed","ui_newGift"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("cfgMgr"),r=t("item"),s=t("bagMgr"),c=t("panelMgr"),l=t("pInfo"),d=t("baseUI"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemsNode=null,e.itemPre=null,e.bgSpr=null,e.adGetBtn=null,e.hideCb=null,e}return __extends(e,t),e.prototype.init=function(){var t=this;a.default.serverCfg.props.set.forEach(function(e){if(Number(e.init_val)>0){var i=cc.instantiate(t.itemPre);i.active=!0,i.parent=t.itemsNode,i.getComponent(r.default).initByData(e.key,e.init_val)}}),this.adGetBtn.node.adDotData="\u65b0\u624b\u793c\u5305"},e.prototype.hideThis=function(){this.hide()},e.prototype.onAdGet=function(){this.getItem()},e.prototype.getItem=function(){for(var t=this,e=[],i=0,d=this.itemsNode.childrenCount;i<d;i++){var u=this.itemsNode.children[i],p=u.parent.convertToWorldSpaceAR(u.position),h={};h.itemId=u.getComponent(r.default).key,h.worldPos=p,h.value=u.getComponent(r.default).count,e.push(h)}a.default.serverCfg.props.set.forEach(function(t){s.default.ins.addItem(t.key,t.init_val,!0)}),!l.default.ins.isMaxAdCount()&&n.platform.reportEvent(n.ERepEvt.newGiftGet),l.default.ins.setIsGetNewGif(!0),c.default.ins.open("ui/ui_flyAni",{itemDatas:e,hideCb:function(){o.default.opE.emit({action:o.default.UPD_NEW_GIFT}),t.hideThis()}})},e.prototype.onDestroy=function(){cc.assetManager.releaseAsset(this.bgSpr.spriteFrame)},__decorate([h(cc.Node)],e.prototype,"itemsNode",void 0),__decorate([h(cc.Node)],e.prototype,"itemPre",void 0),__decorate([h(cc.Sprite)],e.prototype,"bgSpr",void 0),__decorate([h(cc.Button)],e.prototype,"adGetBtn",void 0),__decorate([p],e)}(d.default);i.default=f,cc._RF.pop()},{bagMgr:"bagMgr",baseUI:"baseUI",cfgMgr:"cfgMgr",evts:"evts",idx:"idx",item:"item",pInfo:"pInfo",panelMgr:"panelMgr"}],ui_preReward:[function(t,e,i){"use strict";cc._RF.push(e,"b1e17kl/lRDSpgVpOh23ktk","ui_preReward"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("item"),n=t("baseUI"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemsNode=null,e.itemPre=null,e}return __extends(e,t),e.prototype.init=function(t){var e=this;t.itemDatas.forEach(function(t){if(Number(t.value)>0){var i=cc.instantiate(e.itemPre);i.active=!0,i.parent=e.itemsNode,i.getComponent(o.default).initByData(t.itemId,t.value)}})},e.prototype.hideThis=function(){this.hide()},e.prototype.getItem=function(){},__decorate([s(cc.Node)],e.prototype,"itemsNode",void 0),__decorate([s(cc.Node)],e.prototype,"itemPre",void 0),__decorate([r],e)}(n.default);i.default=c,cc._RF.pop()},{baseUI:"baseUI",item:"item"}],ui_privacy:[function(t,e,i){"use strict";cc._RF.push(e,"a457crloztMaIIPhRnZ7Hh/","ui_privacy"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("panelMgr"),n=t("baseUI"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnService=null,e.btnPrivacy=null,e}return __extends(e,t),e.prototype.init=function(){var t=this.btnService.node,e=this.btnPrivacy.node;t.active=e.active=!0,t.on(cc.Node.EventType.TOUCH_END,function(){return o.default.ins.open("ui/ui_info",{type:1})},this),e.on(cc.Node.EventType.TOUCH_END,function(){return o.default.ins.open("ui/ui_info",{type:2})},this)},e.prototype.hideThis=function(){this.hide()},__decorate([s(cc.Label)],e.prototype,"btnService",void 0),__decorate([s(cc.Label)],e.prototype,"btnPrivacy",void 0),__decorate([r],e)}(n.default);i.default=c,cc._RF.pop()},{baseUI:"baseUI",panelMgr:"panelMgr"}],ui_quest:[function(t,e,i){"use strict";cc._RF.push(e,"70d40ATM1ZE3biriQn1uJF2","ui_quest"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("mySafeArea"),a=t("time"),r=t("cfgMgr"),s=t("lang"),c=t("questItem"),l=t("global"),d=t("taskMgr"),u=t("tipMgr"),p=t("loading"),h=t("baseUI"),f=cc._decorator,g=f.ccclass,v=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content=null,e.questItem=null,e.tLable=null,e.btnspf=[],e.btnsp=[],e.scrollView=null,e.top=null,e.bgNode=null,e.topBgSp=null,e.topBgSp1=null,e._taskTyp=d.taskChannel.daily,e.questPool=new cc.NodePool(c.default),e.lastScrollPosition=0,e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.node.height=cc.winSize.height,this.taskTyp=d.taskChannel.daily,this.tLable.font=p.DEFAULTFONT,l.default.padScale&&(this.bgNode.scale=l.default.padScale),this.scrollView.node.on("scrolling",function(){t.pageScroll(!0)},this),this.onResize()},e.prototype.start=function(){},e.prototype.loadItem=function(t,e,i){var o=this.questItem;if(t<i.length){var n=i[t];(r=this.questPool.get())||(r=cc.instantiate(o)),this.content.addChild(r),r.active=!1,r.zIndex=0,r.getComponent(c.default).init(e[n.key]),t++,this.scheduleOnce(this.loadItem.bind(this,t,e,i),0)}else{this.content.children.sort(function(t,e){var i=t.getComponent(c.default).taskData.data.state,o=e.getComponent(c.default).taskData.data.state;return i==o?0:i==d.taskState.Finish?-1:o==d.taskState.Finish?1:i==d.taskState.Rewared?1:o==d.taskState.Rewared?-1:void 0});for(var a=0;a<this.content.children.length;a++){var r;(r=this.content.children[a]).active=!0,this.showChgAni||(r.opacity=0,this.scheduleOnce(this.showChangegAni.bind(this,r),.1*(a+1)))}this.lastScrollPosition=0,this.scheduleOnce(this.pageScroll.bind(this,!1),0),this.showChgAni||(this.showChgAni=!0)}},e.prototype.initView=function(){var t=this;this.countTaskUpdTime();var e=r.default.serverCfg[this._taskTyp],i=d.default.getTaskByType(this._taskTyp);this.content.children.forEach(function(e){t.despawnNode(e)}),this.content.removeAllChildren();var o=null==e?void 0:e.rules;this.loadItem(0,i,o)},e.prototype.updTask=function(){this.initView()},e.prototype.countTaskUpdTime=function(){var t=a.default.ins.nextZeroTime/1e3;this.tLable.string=a.default.getFormatHMS(t),t<=0&&this.initView()},e.prototype.onEnable=function(){var t=this;o.default.opE.on(this.onOperTap.bind(this)),this.schedule(this.countTaskUpdTime,1,cc.macro.REPEAT_FOREVER),this.initView(),this.scheduleOnce(function(){t.top.y-=n.getSafeAreaRect().yMin})},e.prototype.onDisable=function(){o.default.opE.off(this.onOperTap.bind(this)),this.unschedule(this.countTaskUpdTime)},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.UPD_PANEL:this.updTask()}},e.prototype.pageSwitch=function(t,e){this._taskTyp!=e&&(e!=d.taskChannel.achieve?(this.taskTyp=e,this.initView()):u.default.ins.showTip(s.lang[10004]))},Object.defineProperty(e.prototype,"taskTyp",{set:function(t){this._taskTyp=t;var e=t==d.taskChannel.daily?0:1;this.btnsp[0].spriteFrame=this.btnspf[e],this.btnsp[1].spriteFrame=this.btnspf[1^e]},enumerable:!1,configurable:!0}),e.prototype.despawnNode=function(t){this.questPool.put(t)},e.prototype.onResize=function(){this.node.height=cc.winSize.height;var t=n.getSafeAreaRect().yMin,e=cc.winSize.height-1280-t;this.scrollView.node.height+=e,this.scrollView.content.height+=e,this.scrollView.content.parent.height+=e,this.topBgSp.height+=e,this.topBgSp1.height+=e},e.prototype.pageScroll=function(t){void 0===t&&(t=!0);var e=this.content.children,i=this.scrollView.getScrollOffset().y;if(!(t&&Math.abs(i-this.lastScrollPosition)<1)){for(var o=this.content.parent.height,n=0;n<e.length;n++){var a=e[n],r=a.convertToWorldSpaceAR(cc.Vec2.ZERO);(r=this.content.parent.convertToNodeSpaceAR(r)).y+110<-o||r.y-110>0?a.children[0].active=!1:a.children[0].active=!0}this.lastScrollPosition=i}},e.prototype.showChangegAni=function(t){cc.tween(t).to(.2,{opacity:255}).start()},e.prototype.hideThis=function(){this.hide()},__decorate([v(cc.Node)],e.prototype,"content",void 0),__decorate([v(cc.Prefab)],e.prototype,"questItem",void 0),__decorate([v(cc.Label)],e.prototype,"tLable",void 0),__decorate([v(cc.SpriteFrame)],e.prototype,"btnspf",void 0),__decorate([v(cc.Sprite)],e.prototype,"btnsp",void 0),__decorate([v(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([v(cc.Node)],e.prototype,"top",void 0),__decorate([v(cc.Node)],e.prototype,"bgNode",void 0),__decorate([v(cc.Node)],e.prototype,"topBgSp",void 0),__decorate([v(cc.Node)],e.prototype,"topBgSp1",void 0),__decorate([g],e)}(h.default);i.default=m,cc._RF.pop()},{baseUI:"baseUI",cfgMgr:"cfgMgr",evts:"evts",global:"global",lang:"lang",loading:"loading",mySafeArea:"mySafeArea",questItem:"questItem",taskMgr:"taskMgr",time:"time",tipMgr:"tipMgr"}],ui_raceTip:[function(t,e,i){"use strict";cc._RF.push(e,"62b5dz26olNypR9n2CUV7P8","ui_raceTip"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("res"),n=t("panelMgr"),a=t("pInfo"),r=t("baseUI"),s=t("chaptBtn"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnsNode=null,e.pageNodes=null,e.pageBaseTipSps=[],e.pageBaseScorll=null,e.pageBaseSlider=null,e.pageTutoTipSps=[],e.pageTutoScorll=null,e.pageTutoSlider=null,e.btnsComp=[],e.curPageIdx=1,e}return __extends(e,t),e.prototype.onLoad=function(){for(var t=this,e=function(e,o,n){var a=o[e].getComponent(s.default);a.setState(!1),n.push(a),o[e].on("click",function(){t.chgViewData(e)},i)},i=this,n=0,a=this.btnsNode.children,r=this.btnsComp,c=a.length;n<c;n++)e(n,a,r);this.pageBaseSlider.y=0,this.pageBaseScorll.scrollToTop(),this.pageBaseScorll.node.on("scrolling",this.scrollCbBase.bind(this),this);var l=function(e){var i=e+1;o.default.ins.getBundleByString("resSps").then(function(o){o.load("raceTip/img_bz_bznr"+i,cc.SpriteFrame,function(i,o){!i&&t.node&&t.node.isValid&&(t.pageBaseTipSps[e].spriteFrame=o)})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})};for(n=0;n<4;n++)l(n);this.pageTutoSlider.y=0,this.pageTutoScorll.scrollToTop(),this.pageTutoScorll.node.on("scrolling",this.scrollCbTuto.bind(this),this);var d=function(e){var i=e+1;o.default.ins.getBundleByString("resSps").then(function(o){o.load("raceTip/img_bz_jcjc"+i,cc.SpriteFrame,function(i,o){!i&&t.node&&t.node.isValid&&(t.pageTutoTipSps[e].spriteFrame=o)})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})};for(n=0;n<3;n++)d(n);this.chgViewData(0)},e.prototype.init=function(t){var e=t.pageIdx,i=t.closeCb;this.closeCb=i,this.chgViewData(e)},e.prototype.chgViewData=function(t){var e=this.curPageIdx;if(e!=t){this.pageNodes.children[0].active=!1,this.pageNodes.children[1].active=!1,this.pageNodes.children[2].active=!1,this.pageNodes.children[t].active=!0;var i=this.btnsComp;i[e].setState(!1),i[t].setState(!0),this.curPageIdx=t}},e.prototype.scrollCbBase=function(){var t=this.pageBaseScorll.getMaxScrollOffset(),e=(this.pageBaseScorll.getContentPosition().y-300)/t.y;e=(e=e>1?1:e)<0?0:e,this.pageBaseSlider.y=556*-e},e.prototype.scrollCbTuto=function(){var t=this.pageTutoScorll.getMaxScrollOffset(),e=(this.pageTutoScorll.getContentPosition().y-300)/t.y;e=(e=e>1?1:e)<0?0:e,this.pageTutoSlider.y=556*-e},e.prototype.hideThis=function(){this.hide()},e.prototype.hide=function(){var e;return null===(e=this.closeCb)||void 0===e||e.call(this),t.prototype.hide.call(this)},e.prototype.onBtnGuide=function(){a.chgScene(a.sceneType.guide)},e.prototype.onBtnTrain=function(){a.chgScene(a.sceneType.game,{gameType:a.gameType.practice})},e.prototype.onBtnContact=function(){n.default.ins.open("ui/ui_contentUs",null)},e.prototype.onDestroy=function(){o.default.ins.getBundleByString("resSps").then(function(t){for(var e=0;e<4;e++){var i=e+1;cc.assetManager.releaseAsset(t.get("raceTip/img_bz_bznr"+i,cc.SpriteFrame))}for(e=0;e<3;e++)i=e+1,cc.assetManager.releaseAsset(t.get("raceTip/img_bz_jcjc"+i,cc.SpriteFrame))}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})},__decorate([d(cc.Node)],e.prototype,"btnsNode",void 0),__decorate([d(cc.Node)],e.prototype,"pageNodes",void 0),__decorate([d([cc.Sprite])],e.prototype,"pageBaseTipSps",void 0),__decorate([d(cc.ScrollView)],e.prototype,"pageBaseScorll",void 0),__decorate([d(cc.Node)],e.prototype,"pageBaseSlider",void 0),__decorate([d([cc.Sprite])],e.prototype,"pageTutoTipSps",void 0),__decorate([d(cc.ScrollView)],e.prototype,"pageTutoScorll",void 0),__decorate([d(cc.Node)],e.prototype,"pageTutoSlider",void 0),__decorate([l],e)}(r.default);i.default=u,cc._RF.pop()},{baseUI:"baseUI",chaptBtn:"chaptBtn",pInfo:"pInfo",panelMgr:"panelMgr",res:"res"}],ui_rank:[function(t,e,i){"use strict";var o,n;cc._RF.push(e,"26842+g3mFAKqs5eUSbH3PX","ui_rank"),Object.defineProperty(i,"__esModule",{value:!0});var a,r=t("idx"),s=t("mySafeArea"),c=t("request"),l=t("res"),d=t("time"),u=t("uData"),p=t("lang"),h=t("global"),f=t("rankMgr"),g=t("tipMgr"),v=t("pInfo"),m=t("baseUI"),y=t("rankItem"),_=cc._decorator,b=_.ccclass,S=_.property;(a=o||(o={}))[a.mian=0]="mian",a[a.daily=1]="daily",a[a.race=2]="race",function(t){t[t.score=0]="score",t[t.win=1]="win"}(n||(n={}));var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollView=null,e.dataTagBtnsSps=[],e.levelTagBtnsSps=[],e.dayTypeBtnsSps=[],e.viewItem=null,e.rankTop=[],e.myRank=null,e.topNode=null,e.loadingNode=null,e.closeNode=null,e.bgSpr=null,e.type=f.rankType.Total,e.tag=f.rankTag.mainScore,e.levelTag=o.mian,e.dataTag=n.score,e.last_view_inner_y=-1,e.THEME_H=122,e.top_offest=61,e.itemCount=0,e.items=[],e.rankData=[],e.playAni=!0,e}return __extends(e,t),e.prototype.onLoad=function(){if(this.node.height=cc.winSize.height,h.default.padScale){this.bgSpr.node.scale=h.default.padScale;var t=(cc.view.getVisibleSize().width-720)/2;this.closeNode.x-=t}var e=this.node.height-1280;this.scrollView.node.height+=e,this.scrollView.node.getChildByName("view").height+=e,this.scrollView.vertical=!1;var i=d.default.ins.serverTime||Math.floor((new Date).getTime()/1e3);if(i-v.default.ins.getRankLastTimeData()>=3600){v.default.ins.setRankLastTimeData(i);var o=r.platform.getUserInfo(),n=this.myRank.getComponent(y.default);o?o.then(function(t){c.default.ins.updateUserInfo(t),n.setHeadSp(u.default.ins.getHeadImg())},function(){n.setDefaultHead()}):n.setDefaultHead()}},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){var e=s.getSafeAreaRect().yMin;t.topNode.y-=e,t.scrollView.node.y-=e/2,t.scrollView.node.getChildByName("view").height-=e,t.scrollView.content.y-=e/2,t.scrollView.node.on("scrolling",function(){t.RefreshThemesVisible()},t),t.loadingNode.position=t.scrollView.node.position,t.initData(),f.default.ins.uploadRankData()})},e.prototype.initData=function(){this.refreshData()},e.prototype.refreshData=function(){this.levelTag===o.mian?this.dataTag===n.score?this.tag=f.rankTag.mainScore:this.tag=f.rankTag.mainWin:this.levelTag===o.daily&&(this.dataTag===n.score?this.tag=f.rankTag.dailyScore:this.tag=f.rankTag.dailyWin),this.getRankdata()},e.prototype.getRankdata=function(){var t=this;f.default.ins.getRankDataByType(this.tag,this.type).then(function(e){t.dealData(e.data)},function(){t.dealData([])})},e.prototype.dealData=function(t){this.node&&(this.loadingNode.active=!1);var e=!1,i=[],o=f.default.ins.getMyRankDataByTag(this.tag,this.type)||0;if(t)for(var n in i=i.concat(t))if((a=i[n]).game_uid==u.default.ins.getUid()){a.nickname=u.default.ins.getName(),a.sort_value=o,a.game_uid=u.default.ins.getUid(),a.avatar=u.default.ins.getHeadImg(),e=!0;break}if(!e){var a={nickname:u.default.ins.getName(),sort_value:o,game_uid:u.default.ins.getUid(),avatar:u.default.ins.getHeadImg()};i.push(a)}i.sort(function(t,e){return e.sort_value-t.sort_value}),this.rankData=i,this.refreshPanel()},e.prototype.refreshPanel=function(){this.setMySelf(),this.itemCount=97;var t=this.THEME_H*this.itemCount+this.top_offest;this.scrollView.content.setContentSize(cc.size(cc.winSize.width,t)),this.last_view_inner_y=-1,this.scrollView.stopAutoScroll(),this.scrollView.scrollToTop();for(var e=0;e<3;e++){var i=this.rankData[e],o=this.rankTop[e];this.setRankTop(o,i)}this.RefreshThemesVisible()},e.prototype.RefreshThemesVisible=function(t){var e=this;void 0===t&&(t=0);var i=this.scrollView.getContentPosition();if(!(Math.abs(this.last_view_inner_y-i.y)<.01)){this.last_view_inner_y=i.y;for(var o,n,a,r,s,c,l=function(){o=-p*d.THEME_H-d.top_offest,n=d.scrollView.content.convertToWorldSpaceAR(cc.v2(0,o)),a=d.node.convertToNodeSpaceAR(n),r=a.y<-u||a.y+d.THEME_H>u,s=p;var t=p+3,i=d.rankData[t];if(r)d.items[s]&&(d.items[s].active=!1);else if(d.items[s]){d.setItemInfo(d.items[s],t,i);var l=d.playAni;if(l)return d.items[s].x=0,d.items[s].opacity=0,d.scheduleOnce(function(){e.items[s].active=!0,e.last_view_inner_y=-1,e.RefreshThemesVisible(p+1),l&&e.showChgAni(e.items[s])},.06),"break";d.items[s].x=0,d.items[s].opacity=255,d.items[s].active=!0}else{(c=cc.instantiate(d.viewItem)).active=!0,c.position=cc.v3(0,-p*d.THEME_H-d.top_offest),c.parent=d.scrollView.content,d.items[s]=c,d.setItemInfo(c,t,i);var h=d.playAni;if(h)return c.x=(cc.winSize.width+d.items[s].width)/2,c.opacity=255,d.scheduleOnce(function(){e.last_view_inner_y=-1,e.RefreshThemesVisible(p+1),h&&e.showLoadAni(c)},.02),"break";c.opacity=255,c.x=0}d.playAni=!1,p===d.itemCount-1&&d.scheduleOnce(function(){e.scrollView.vertical=!0},.5)},d=this,u=this.scrollView.node.height/4*3,p=t;p<this.itemCount&&"break"!==l();p++);}},e.prototype.setRankTop=function(t,e){var i=t.getComponent(y.default);e?(i.setRankData(e),i.setGameUid(e.game_uid),i.setScore(e.sort_value),e.game_uid==u.default.ins.getUid()?(i.setSkin(v.default.ins.getUsingSkin(),!1,!0),i.setNickName(u.default.ins.getName()),i.setHeadSp(u.default.ins.getHeadImg())):(i.setSkin(null==e?void 0:e.uSkin,!1,!0),i.setNickName(e.nickname),e.avatar?i.setHeadSp(e.avatar):i.setDefaultHead())):(i.setNickName("\u6682\u65e0"),i.setScore("0"),i.setDefaultHead())},e.prototype.setItemInfo=function(t,e,i,o){void 0===o&&(o=!1);var n=t.getComponent(y.default);n.setIdx(Number(e)+1+""),i?(n.setRankData(i),n.setGameUid(i.game_uid),n.setScore(i.sort_value),i.game_uid==u.default.ins.getUid()?(n.setSkin(v.default.ins.getUsingSkin(),o),n.setNickName(u.default.ins.getName()),n.setHeadSp(u.default.ins.getHeadImg())):(n.setSkin(null==i?void 0:i.uSkin),n.setNickName(i.nickname),i.avatar?n.setHeadSp(i.avatar):n.setDefaultHead())):(n.setNickName("\u6682\u65e0"),n.setScore("0"),n.setDefaultHead())},e.prototype.setMySelf=function(){var t=this.rankData;for(var e in t){var i=t[e];if(i.game_uid==u.default.ins.getUid()&&Number(e)<100)return void this.setItemInfo(this.myRank,e,i,!0)}var o=f.default.ins.getMyRankDataByTag(this.tag,this.type),n=this.myRank.getComponent(y.default);n.setSkin(v.default.ins.getUsingSkin(),!0),n.setGameUid(u.default.ins.getUid().toString()),n.setIdx("99+"),n.setNickName(u.default.ins.getName()),n.setScore(o+""),u.default.ins.getHeadImg()?n.setHeadSp(u.default.ins.getHeadImg()):n.setDefaultHead()},e.prototype.setHeadOnLine=function(t,e){var i=this;cc.assetManager.loadRemote(e,function(e,o){!e&&i.node&&i.node.isValid&&(t.spriteFrame=new cc.SpriteFrame(o))})},e.prototype.setDefaultHead=function(t){var e=this;l.default.ins.getBundleByString("resSps").then(function(i){i.load("common/head_1",cc.SpriteFrame,function(i,o){!i&&e.node&&e.node.isValid&&(t.spriteFrame=o)})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})},e.prototype.showLoadAni=function(t){cc.tween(t).to(.5,{x:0},{easing:"backInOut"}).start()},e.prototype.showChgAni=function(t){cc.tween(t).to(.5,{opacity:255}).start()},e.prototype.onBtnChgDayType=function(){this.initAni(),this.type==f.rankType.Total?(this.type=f.rankType.Today,this.refreshData(),this.dayTypeBtnsSps[0].active=!1,this.dayTypeBtnsSps[1].active=!0):this.type==f.rankType.Today&&(this.type=f.rankType.Total,this.refreshData(),this.dayTypeBtnsSps[0].active=!0,this.dayTypeBtnsSps[1].active=!1)},e.prototype.onBtnMain=function(){this.levelTag!==o.mian&&(this.initAni(),this.levelTag=o.mian,this.refreshData(),this.chgLevelTagBtns(!0))},e.prototype.onBtnDaily=function(){g.default.ins.showTip(p.lang[10004])},e.prototype.chgLevelTagBtns=function(t){this.levelTagBtnsSps[0].active=t,this.levelTagBtnsSps[1].active=!t,this.levelTagBtnsSps[2].active=!t,this.levelTagBtnsSps[3].active=t},e.prototype.onBtnChgDataType=function(){this.initAni(),this.dataTag==n.score?(this.dataTag=n.win,this.refreshData(),this.dataTagBtnsSps[0].active=!1,this.dataTagBtnsSps[1].active=!0):this.dataTag==n.win&&(this.dataTag=n.score,this.refreshData(),this.dataTagBtnsSps[0].active=!0,this.dataTagBtnsSps[1].active=!1)},e.prototype.initAni=function(){this.unscheduleAllCallbacks();for(var t=0,e=this.items.length;t<e;t++){var i=this.items[t];cc.Tween.stopAllByTarget(i),i&&(i.opacity=0)}this.scrollView.stopAutoScroll(),this.scrollView.scrollToTop(),this.scrollView.vertical=!1,this.playAni=!0},e.prototype.hideThis=function(){this.hide()},e.prototype.onDestroy=function(){cc.assetManager.releaseAsset(this.bgSpr.spriteFrame)},__decorate([S(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([S([cc.Node])],e.prototype,"dataTagBtnsSps",void 0),__decorate([S([cc.Node])],e.prototype,"levelTagBtnsSps",void 0),__decorate([S([cc.Node])],e.prototype,"dayTypeBtnsSps",void 0),__decorate([S(cc.Node)],e.prototype,"viewItem",void 0),__decorate([S([cc.Node])],e.prototype,"rankTop",void 0),__decorate([S(cc.Node)],e.prototype,"myRank",void 0),__decorate([S(cc.Node)],e.prototype,"topNode",void 0),__decorate([S(cc.Node)],e.prototype,"loadingNode",void 0),__decorate([S(cc.Node)],e.prototype,"closeNode",void 0),__decorate([S(cc.Sprite)],e.prototype,"bgSpr",void 0),__decorate([b],e)}(m.default);i.default=w,cc._RF.pop()},{baseUI:"baseUI",global:"global",idx:"idx",lang:"lang",mySafeArea:"mySafeArea",pInfo:"pInfo",rankItem:"rankItem",rankMgr:"rankMgr",request:"request",res:"res",time:"time",tipMgr:"tipMgr",uData:"uData"}],ui_rePlayRace:[function(t,e,i){"use strict";cc._RF.push(e,"c4091qoo9VDMa2r6HVCvPb+","ui_rePlayRace"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("uData"),n=t("lang"),a=t("rankMgr"),r=t("raceRankItem"),s=t("ui_rePlay"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollRank=null,e.selfRank=null,e.idxIconArr=[],e.rankLb=null,e.rankItem=null,e.rankLength=10,e}return __extends(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.rankLb.string=n.lang[40003],this.rankItem=this.scrollRank.content.children[0]},e.prototype.init=function(e){var i=e.curScore,n=e.continueCb;return __awaiter(this,void 0,void 0,function(){var e,s,c,l,d,u,p,h,f,g,v,m,y,_,b=this;return __generator(this,function(S){switch(S.label){case 0:return t.prototype.init.call(this,{curScore:i,continueCb:n}),[4,a.default.ins.getYdayRaceData()];case 1:for(e=S.sent(),s=[],e.data&&(s=[].concat(e.data)),c=this.rankLength-1,l=this.getRandomScoreArr(),d=[],u=o.default.ins,p={nick:u.getName(),score:i,idx:"",headUrl:u.getHeadImg()},s.sort(function(){return Math.random()-.5}),h=0,f=0;f<s.length&&!(f>=c);f++)g=s[f],v=u.getUid(),g.game_uid!=v&&(h++,d.push({nick:g.nickname,score:l[f].toString(),idx:"",headUrl:g.avatar}));if(d.length<c)for(m=c-d.length,y=0;y<m;y++)_="\u6e38\u5ba2"+this.getRandString(),d.push({nick:_,score:l[h+y].toString(),idx:"",headUrl:""});return d.push(p),d.sort(function(t,e){return parseInt(e.score)-parseInt(t.score)}),d.forEach(function(t,e){t.idx=(e+1).toString();var i=null;b.scrollRank.content.childrenCount>e?i=b.scrollRank.content.children[e]:(i=cc.instantiate(b.rankItem),b.scrollRank.content.addChild(i)),i.x=(cc.winSize.width+i.width)/2,b.scheduleOnce(function(){b.showLoadAni(i)},.05*e),i.getComponent(r.default).initItem(t,b.idxIconArr[e])}),this.selfRank.getComponent(r.default).initItem(p,this.idxIconArr[p.idx]),[2]}})})},e.prototype.showLoadAni=function(t){cc.tween(t).to(.5,{x:0},{easing:"backInOut"}).start()},e.prototype.getRandomScoreArr=function(){for(var t=[],e=this.rankLength-1,i=0;i<e;i++){var o=void 0,n=void 0;i<7?(o=100*(7-i),n=100*(8-i)):i>=7&&i<=8&&(o=-20*(i-8),n=-80*i+660);var a=Math.floor(Math.random()*(n-o))+o;t.push(a)}return t},e.prototype.getRandString=function(){for(var t=[],e=0;e<4;e++){var i,o=Math.floor(3*Math.random());i=0===o?Math.floor(26*Math.random())+65:1===o?Math.floor(26*Math.random())+97:Math.floor(10*Math.random())+48,t.push(i)}return String.fromCharCode.apply(String,t)},__decorate([d(cc.ScrollView)],e.prototype,"scrollRank",void 0),__decorate([d(r.default)],e.prototype,"selfRank",void 0),__decorate([d([cc.SpriteFrame])],e.prototype,"idxIconArr",void 0),__decorate([d(cc.Label)],e.prototype,"rankLb",void 0),__decorate([l],e)}(s.default);i.default=u,cc._RF.pop()},{lang:"lang",raceRankItem:"raceRankItem",rankMgr:"rankMgr",uData:"uData",ui_rePlay:"ui_rePlay"}],ui_rePlay:[function(t,e,i){"use strict";cc._RF.push(e,"24caeZaNyxM8KAZRT3lrCcp","ui_rePlay"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("res"),r=t("cfgMgr"),s=t("global"),c=t("bagMgr"),l=t("festivalMgr"),d=t("levelMgr"),u=t("panelMgr"),p=t("pInfo"),h=t("game"),f=t("baseUI"),g=cc._decorator,v=g.ccclass,m=g.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.endTitleNode=null,e.pauseTitleNode=null,e.shareBtn=null,e.shareIcon=null,e.shareCount=null,e.curLb=null,e.preLb=null,e.curScoreLbl=null,e.preBestScore=null,e}return __extends(e,t),e.prototype.onLoad=function(){o.default.opE.on(this.onOperTap.bind(this))},e.prototype.onOperTap=function(t){var e=null==t?void 0:t.action;if(e)switch(e){case o.default.SHOWVIDEOSHARE:h.default.type!=p.gameType.practice&&this.shareBtn&&(this.shareBtn.active=!0)}},e.prototype.init=function(t){var e=t.curScore,i=t.continueCb;this.continueCb=i;var o=this.endTitleNode.active=!i;this.pauseTitleNode.active=!!i,o&&n.platform.stopVideoRecord();var s=h.default.type,c=p.default.ins,l=this.shareIcon,u=this.shareCount,f=r.default.serverCfg.share_rules.rules,g=f.main_line.val,v=f.main_line.props;this.curScore=e,d.default.ins.getLevelCost();var m="\u5f53\u524d\u8fde\u80dc:",y="\u6700\u9ad8\u8fde\u80dc:",_=c.getConsWinTimes(),b=c.getRecordData().main.heWins||0;s==p.gameType.race&&(m="\u5f53\u524d\u79ef\u5206:",y="\u6700\u9ad8\u79ef\u5206:",_=e,b=c.getRecordData().race.hePoints||0,g=f.qw_line.val,v=f.qw_line.props),this.curLb.string=m,this.preLb.string=y,this.curScoreLbl.string=_+"",this.preBestScore.string=b+"",a.default.ins.getBundleByString("resSps").then(function(t){l.spriteFrame=t.get("item/"+v,cc.SpriteFrame)}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)}),u.string="+"+g,l.node.active=(s==p.gameType.race?c.getRaceShareTime():c.getNormalShareTime())<3},e.prototype.getPower=function(t){p.default.ins.addPower(t)},e.prototype.onContinue=function(){var t;this.hide(),null===(t=this.continueCb)||void 0===t||t.call(this)},e.prototype.onClose=function(){this.continueCb?this.onContinue():this.hideThis()},e.prototype.onShare=function(){var t=this;n.platform.shareVideoRecord().then(function(e){var i=t.shareIcon;if(1==e&&i&&i.isValid&&i.node.active){var o=h.default.type==p.gameType.race,n=p.default.ins,a=void 0,s=void 0,l=void 0,d=r.default.serverCfg.share_rules.rules;if(o){l=d.qw_line.val,s=d.qw_line.props;var f=n.getRaceShareTime();n.setRaceShareTime(f+1)}else l=d.main_line.val,s=d.main_line.props,f=n.getNormalShareTime(),n.setNormalShareTime(f+1);switch(s){case"coin":a=n.getCoin(),n.addCoin(l);break;case"times":n.addPower(l);break;default:c.default.ins.addItem(s,l)}var g=t.shareIcon.node.parent.convertToWorldSpaceAR(t.shareIcon.node.position);u.default.ins.open("ui/ui_flyAni",{itemDatas:[{itemId:s,worldPos:g,value:l}],showCoin:a}),t.shareBtn.active=!1}}).catch(function(){console.error("shareErr")})},e.prototype.onBtnGuide=function(){p.chgScene(p.sceneType.guide)},e.prototype.onBtnTrain=function(){p.chgScene(p.sceneType.game,{gameType:p.gameType.practice})},e.prototype.hideThis=function(){var t=h.default.type;t==p.gameType.race?(s.default.loadToRace=4,l.default.ins.updPro(l.fesTaskKey.raceScore,this.curScore)):t==p.gameType.challenge&&(s.default.loadToRace=3),t!=p.gameType.practice?(p.default.ins.recordGameResult(h.default.type,!1,this.curScore),p.chgScene(p.sceneType.main,{cb:void 0})):p.chgScene(p.sceneType.main)},__decorate([m(cc.Node)],e.prototype,"endTitleNode",void 0),__decorate([m(cc.Node)],e.prototype,"pauseTitleNode",void 0),__decorate([m(cc.Node)],e.prototype,"shareBtn",void 0),__decorate([m(cc.Sprite)],e.prototype,"shareIcon",void 0),__decorate([m(cc.Label)],e.prototype,"shareCount",void 0),__decorate([m(cc.Label)],e.prototype,"curLb",void 0),__decorate([m(cc.Label)],e.prototype,"preLb",void 0),__decorate([m(cc.Label)],e.prototype,"curScoreLbl",void 0),__decorate([m(cc.Label)],e.prototype,"preBestScore",void 0),__decorate([v],e)}(f.default);i.default=y,cc._RF.pop()},{bagMgr:"bagMgr",baseUI:"baseUI",cfgMgr:"cfgMgr",evts:"evts",festivalMgr:"festivalMgr",game:"game",global:"global",idx:"idx",levelMgr:"levelMgr",pInfo:"pInfo",panelMgr:"panelMgr",res:"res"}],ui_record:[function(t,e,i){"use strict";cc._RF.push(e,"5877d5aWgxD8Ls2f4nI5Jen","ui_record"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("baseUI"),n=t("pInfo"),a=t("chaptBtn"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e.viewItem=null,e.btnsNode=null,e.nameStrs={main:{gTimes:"\u6e38\u620f\u6b21\u6570",wTimes:"\u80dc\u5229\u6b21\u6570",heWins:"\u6700\u9ad8\u8fde\u80dc",winRate:"\u80dc\u7387"},daily:{gTimes:"\u6e38\u620f\u6b21\u6570",wTimes:"\u80dc\u5229\u6b21\u6570",winRate:"\u80dc\u7387"},race:{gTimes:"\u6e38\u620f\u6b21\u6570",tPoints:"\u603b\u79ef\u5206",hePoints:"\u6700\u9ad8\u79ef\u5206"}},e.allData={},e.btnsComp=[],e.rowSpace=108,e.top_offest=50,e.curPageIdx=1,e}return __extends(e,t),e.prototype.start=function(){for(var t=this,e=n.default.ins.getRecordData(),i=function(e,i,n){var r=i[e].getComponent(a.default);r.setState(!1),n.push(r),i[e].on("click",function(){t.chgViewData(e)},o)},o=this,r=0,s=this.btnsNode.children,c=this.btnsComp,l=s.length;r<l;r++)i(r,s,c);this.allData=Object.assign({},e),this.chgViewData(0)},e.prototype.chgViewData=function(t){var e=this.curPageIdx;if(e!=t){var i,o={},n={};switch(t){case 0:o=this.allData.main,n=this.nameStrs.main,i=o.wTimes/o.gTimes*100||0,o.winRate=i.toFixed(0)+"%";break;case 1:o=this.allData.daily,n=this.nameStrs.daily,i=o.wTimes/o.gTimes*100||0,o.winRate=i.toFixed(0)+"%";break;case 2:o=this.allData.race,n=this.nameStrs.race}this.initListView(o,n);var a=this.btnsComp;a[e].setState(!1),a[t].setState(!0),this.curPageIdx=t}},e.prototype.initListView=function(t,e){for(var i=0,o=this.view.content.childrenCount;i<o;i++)this.view.content.children[i].active=!1;var n=0;for(var a in e){var r,s=e[a],c=t[a]||0;"feTime"==a&&(c=this.timeFormat(c)),this.view.content.childrenCount>n?((r=this.view.content.children[n]).active=!0,r.getChildByName("name").getComponent(cc.Label).string=s,r.getChildByName("num").getComponent(cc.Label).string=c):((r=cc.instantiate(this.viewItem)).parent=this.view.content,r.y=-n*this.rowSpace-this.top_offest,r.active=!0,r.getChildByName("name").getComponent(cc.Label).string=s,r.getChildByName("num").getComponent(cc.Label).string=c),n++}},e.prototype.hideThis=function(){this.hide()},e.prototype.timeFormat=function(t,e){void 0===e&&(e=!0);var i=this.PrefixInteger;if(t<86400){var o=i(Math.floor(t/3600),2),n=i(Math.floor(t%3600/60),2),a=i(t%60,2);return e&&"00"==o?n+":"+a:o+":"+n+":"+a}return Math.floor(t/86400)+"d "+i(Math.floor(t%86400/3600),2)+":"+i(Math.floor(t%3600/60),2)+":"+i(t%60,2)},e.prototype.PrefixInteger=function(t,e){return(t/Math.pow(10,e)).toFixed(e).substring(2)},__decorate([c(cc.ScrollView)],e.prototype,"view",void 0),__decorate([c(cc.Node)],e.prototype,"viewItem",void 0),__decorate([c(cc.Node)],e.prototype,"btnsNode",void 0),__decorate([s],e)}(o.default);i.default=l,cc._RF.pop()},{baseUI:"baseUI",chaptBtn:"chaptBtn",pInfo:"pInfo"}],ui_reiGift:[function(t,e,i){"use strict";cc._RF.push(e,"9a9f1ncodlJC6kx1e5N1SaD","ui_reiGift"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("cfgMgr"),n=t("item"),a=t("bagMgr"),r=t("pInfo"),s=t("baseUI"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemSc=null,e.itemPre=null,e}return __extends(e,t),e.prototype.init=function(t){var e,i,s,c,l,d,u=t.serPacks,p={},h={},f=null===(i=null===(e=o.default.serverCfg)||void 0===e?void 0:e.shop_config)||void 0===i?void 0:i.gift,g={};if(f)for(var v in f){var m=f[v];g[m.key]=m,p[m.key]=m}var y=null===(c=null===(s=o.default.serverCfg)||void 0===s?void 0:s.buy_stamina)||void 0===c?void 0:c.stamina;if(y)for(var v in y)(b=y[v])&&(g[b.key]=b,h[b.key]=b);var _=null===(d=null===(l=o.default.serverCfg)||void 0===l?void 0:l.buy_gold_coins)||void 0===d?void 0:d.gold_coins;if(_)for(var v in _){var b;(b=_[v])&&(g[b.key]=b,h[b.key]=b)}this.itemSc.node.width=530;for(var S=0,w=u.length;S<w;S++){var T=u[S];if(T){var I=g[null==T?void 0:T.gift_id],D=p[null==T?void 0:T.gift_id],k=h[null==T?void 0:T.gift_id];if(D&&r.default.ins.addShopRecord(null==T?void 0:T.gift_id),k&&r.default.ins.addShopUnreset(null==T?void 0:T.gift_id),I&&I.props)for(var N=0;N<T.gift_num;N++)for(var v in I.props){var C=I.props[v];T.is_double&&(C*=2),a.default.ins.addItem(v,C);var M=cc.instantiate(this.itemPre);M.active=!0,this.itemSc.content.addChild(M),M.getComponent(n.default).initByData(v,C)}}}var R=this.itemSc.content.children[0].width*this.itemSc.content.childrenCount;this.itemSc.node.x=R>this.itemSc.node.width?-262:(this.itemSc.node.width-R)/2-262,R=Math.min(R,530),this.itemSc.node.width=R,this.itemSc.scrollToLeft()},e.prototype.hideThis=function(){this.hide()},__decorate([d(cc.ScrollView)],e.prototype,"itemSc",void 0),__decorate([d(cc.Node)],e.prototype,"itemPre",void 0),__decorate([l],e)}(s.default);i.default=u,cc._RF.pop()},{bagMgr:"bagMgr",baseUI:"baseUI",cfgMgr:"cfgMgr",item:"item",pInfo:"pInfo"}],ui_saveConfirm:[function(t,e,i){"use strict";cc._RF.push(e,"d358aGT1ddJ576hGkYJRnVO","ui_saveConfirm"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("time"),n=t("uData"),a=t("baseUI"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeLb=null,e.lvL=null,e.coinNumL=null,e.powerL=null,e.item1L=null,e.item2L=null,e.item3L=null,e.lvR=null,e.coinNumR=null,e.powerR=null,e.item1R=null,e.item2R=null,e.item3R=null,e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(t){var e,i,a,r,s,c,l=t.cData;this.timeLb.string=o.default.ins.formatDate(l.update_at);var d=this.chooseData=JSON.parse(l.user_data),u=n.default.ins.getLocalData();d&&(this.lvL.string=(null==d?void 0:d.puzzleLvl)||0,this.coinNumL.string=(null==d?void 0:d.coin)||0,this.powerL.string=(null==d?void 0:d.power)||0,this.item1L.string=(null===(e=null==d?void 0:d.bag)||void 0===e?void 0:e.random_notice)||0,this.item2L.string=(null===(i=null==d?void 0:d.bag)||void 0===i?void 0:i.full_row_col)||0,this.item3L.string=(null===(a=null==d?void 0:d.bag)||void 0===a?void 0:a.notice)||0),u&&(this.lvR.string=(null==u?void 0:u.puzzleLvl)||0,this.coinNumR.string=(null==u?void 0:u.coin)||0,this.powerR.string=(null==u?void 0:u.power)||0,this.item1R.string=(null===(r=null==u?void 0:u.bag)||void 0===r?void 0:r.random_notice)||0,this.item2R.string=(null===(s=null==u?void 0:u.bag)||void 0===s?void 0:s.full_row_col)||0,this.item3R.string=(null===(c=null==u?void 0:u.bag)||void 0===c?void 0:c.notice)||0)},e.prototype.hideThis=function(){this.hide()},e.prototype.onBtnRestore=function(){this.chooseData&&n.default.ins.restoreData(this.chooseData)},__decorate([c(cc.Label)],e.prototype,"timeLb",void 0),__decorate([c(cc.Label)],e.prototype,"lvL",void 0),__decorate([c(cc.Label)],e.prototype,"coinNumL",void 0),__decorate([c(cc.Label)],e.prototype,"powerL",void 0),__decorate([c(cc.Label)],e.prototype,"item1L",void 0),__decorate([c(cc.Label)],e.prototype,"item2L",void 0),__decorate([c(cc.Label)],e.prototype,"item3L",void 0),__decorate([c(cc.Label)],e.prototype,"lvR",void 0),__decorate([c(cc.Label)],e.prototype,"coinNumR",void 0),__decorate([c(cc.Label)],e.prototype,"powerR",void 0),__decorate([c(cc.Label)],e.prototype,"item1R",void 0),__decorate([c(cc.Label)],e.prototype,"item2R",void 0),__decorate([c(cc.Label)],e.prototype,"item3R",void 0),__decorate([s],e)}(a.default);i.default=l,cc._RF.pop()},{baseUI:"baseUI",time:"time",uData:"uData"}],ui_saveRestore:[function(t,e,i){"use strict";cc._RF.push(e,"3c546+ldmlAJ73ZKuAVm4Qb","ui_saveRestore"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("panelMgr"),a=t("tipMgr"),r=t("baseUI"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeL=null,e.lvL=null,e.coinNumL=null,e.timeR=null,e.lvR=null,e.coinNumR=null,e.infoL=null,e.infoR=null,e.nodeL=null,e.nodeR=null,e.userDatas=[],e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(t){var e=t.userDatas;this.rePanel(e)},e.prototype.rePanel=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,o,n,a,r,s,c,l,d,u,p,h;return __generator(this,function(f){switch(f.label){case 0:return this.userDatas=[],this.timeL.string="\u6682\u65e0\u6570\u636e",this.lvL.string="",this.coinNumL.string="0",this.timeR.string="\u6682\u65e0\u6570\u636e",this.lvR.string="",this.coinNumL.string="0",t?(e=t[0],i=t[1],e&&e.update_at?(a=e.update_at,r=new Date(a),s=r.getFullYear(),c=r.getMonth()+1,l=r.getDate(),this.timeL.string=s+"/"+c+"/"+l,o=JSON.parse(e.user_data),"localData"!=e.save_tag?[3,2]:(this.infoL.string="\u81ea\u52a8\u5907\u4efd",[4,this.compareData(o)])):[3,4]):[3,10];case 1:return o=f.sent(),[3,3];case 2:this.infoL.string="\u624b\u52a8\u5907\u4efd",f.label=3;case 3:return u=o.puzzleLvl||0,p=o.coin||0,this.lvL.string="\u5173\u5361\uff1a"+u,this.coinNumL.string=""+p,n=JSON.stringify(o),e.user_data=n,this.userDatas.push(e),[3,5];case 4:this.nodeL.active=!1,f.label=5;case 5:return i&&i.update_at?(a=i.update_at,r=new Date(a),s=r.getFullYear(),c=r.getMonth()+1,l=r.getDate(),this.timeR.string=s+"/"+c+"/"+l,d=JSON.parse(i.user_data),"localData"!=i.save_tag?[3,7]:(this.infoR.string="\u81ea\u52a8\u5907\u4efd",[4,this.compareData(d)])):[3,9];case 6:return d=f.sent(),[3,8];case 7:this.infoR.string="\u624b\u52a8\u5907\u4efd",f.label=8;case 8:return u=d.puzzleLvl||0,p=d.coin||0,this.lvR.string="\u5173\u5361\uff1a"+u,this.coinNumR.string=""+p,h=JSON.stringify(d),i.user_data=h,this.userDatas.push(i),[3,10];case 9:this.nodeR.active=!1,f.label=10;case 10:return[2]}})})},e.prototype.compareData=function(t){var e,i;return __awaiter(this,void 0,void 0,function(){var n,a,r,s,c,l;return __generator(this,function(d){switch(d.label){case 0:return o.platform.getCloudData?[4,o.platform.getCloudData()]:[3,2];case 1:n=d.sent(),d.label=2;case 2:return r=(null==t?void 0:t.puzzleLvl)||0,s=(null===(e=null==t?void 0:t.bag)||void 0===e?void 0:e.puzzle_pieces)||0,c=(null==n?void 0:n.puzzleLvl)||0,l=(null===(i=null==n?void 0:n.bag)||void 0===i?void 0:i.puzzle_pieces)||0,(a=r>c||s>l?t:n)?[2,a]:[2,t]}})})},e.prototype.hideThis=function(){this.hide()},e.prototype.onBtnCheck=function(t,e){var i=this.userDatas[e];i&&i.update_at?n.default.ins.open("ui/ui_saveConfirm",{cData:i}):a.default.ins.showTip("\u6682\u65e0\u6570\u636e")},__decorate([l(cc.Label)],e.prototype,"timeL",void 0),__decorate([l(cc.Label)],e.prototype,"lvL",void 0),__decorate([l(cc.Label)],e.prototype,"coinNumL",void 0),__decorate([l(cc.Label)],e.prototype,"timeR",void 0),__decorate([l(cc.Label)],e.prototype,"lvR",void 0),__decorate([l(cc.Label)],e.prototype,"coinNumR",void 0),__decorate([l(cc.Label)],e.prototype,"infoL",void 0),__decorate([l(cc.Label)],e.prototype,"infoR",void 0),__decorate([l(cc.Node)],e.prototype,"nodeL",void 0),__decorate([l(cc.Node)],e.prototype,"nodeR",void 0),__decorate([c],e)}(r.default);i.default=d,cc._RF.pop()},{baseUI:"baseUI",idx:"idx",panelMgr:"panelMgr",tipMgr:"tipMgr"}],ui_save:[function(t,e,i){"use strict";cc._RF.push(e,"37480ahHE1HO633f+vRt0/d","ui_save"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("request"),a=t("time"),r=t("uData"),s=t("panelMgr"),c=t("tipMgr"),l=t("baseUI"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeLb=null,e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(){var t=this;this.timeLb.string="\u6682\u65e0\u6570\u636e",n.default.ins.getServerData("").then(function(e){t.rePanel(e)}).catch(function(){t.rePanel(null)})},e.prototype.rePanel=function(t){if(this.userDatas=t,t&&t.data){var e=t.data,i=e[0],o=e[1],n=(null==i?void 0:i.update_at)||0,r=(null==o?void 0:o.update_at)||0,s=Math.max(n,r);if(s){var c=a.default.ins.formatDate(s);this.timeLb.string=c}else this.timeLb.string="\u6682\u65e0\u6570\u636e"}else this.timeLb.string="\u6682\u65e0\u6570\u636e"},e.prototype.hideThis=function(){this.hide()},e.prototype.onBtnSave=function(){o.platform.showLoading("\u5b58\u6863\u4e2d..."),n.default.ins.updateServerData(r.default.ins.getLocalData(),"backData").then(function(t){o.platform.hideLoading(),t.status?c.default.ins.showTip("\u5b58\u6863\u6210\u529f",!0):c.default.ins.showTip("\u7f51\u7edc\u62e5\u5835\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01",!0)}).catch(function(){o.platform.hideLoading(),c.default.ins.showTip("\u7f51\u7edc\u62e5\u5835\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01",!0)})},e.prototype.onBtnBack=function(){this.userDatas?s.default.ins.open("ui/ui_saveRestore",{userDatas:this.userDatas.data}):c.default.ins.showTip("\u6682\u65e0\u6570\u636e",!0)},__decorate([p(cc.Label)],e.prototype,"timeLb",void 0),__decorate([u],e)}(l.default);i.default=h,cc._RF.pop()},{baseUI:"baseUI",idx:"idx",panelMgr:"panelMgr",request:"request",time:"time",tipMgr:"tipMgr",uData:"uData"}],ui_selectMode:[function(t,e,i){"use strict";cc._RF.push(e,"b76f4TM2JlHOpD2hjHeOUlQ","ui_selectMode"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("pInfo"),n=t("baseUI"),a=t("cfgMgr"),r=t("panelMgr"),s=t("main"),c=t("festivalMgr"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.costNums=[],e.btnsNode=[],e.costs=[],e}return __extends(e,t),e.prototype.start=function(){this.initData()},e.prototype.initData=function(){var t=a.default.serverCfg.difficulty_rules.rules,e=[],i=10;for(var o in t){var n=t[o];i=Number(n.times_val),e.push(i)}this.costNums[0].string=e[0],this.costNums[1].string=e[2],this.costNums[2].string=e[3],this.costs=[e[0],e[2],e[3]]},e.prototype.onBtnStart=function(t,e){var i=5*Number(e),n=this.costs[Number(e)-1];if(o.default.ins.getPower()<n)r.default.ins.open("ui/ui_getRes",{itemId:"times"});else{var a=this.btnsNode[Number(e)-1].convertToWorldSpaceAR(cc.Vec3.ZERO),l=s.default.ins;l&&(l.blockComp.enabled=!0),c.default.ins.updPro(c.fesTaskKey.costPower,n),l.usePower(-n,a,i)}},e.prototype.hideThis=function(){this.hide()},__decorate([u([cc.Label])],e.prototype,"costNums",void 0),__decorate([u([cc.Node])],e.prototype,"btnsNode",void 0),__decorate([d],e)}(n.default);i.default=p,cc._RF.pop()},{baseUI:"baseUI",cfgMgr:"cfgMgr",festivalMgr:"festivalMgr",main:"main",pInfo:"pInfo",panelMgr:"panelMgr"}],ui_set:[function(t,e,i){"use strict";cc._RF.push(e,"c09d2zIpI5PIYKJIScOxgZY","ui_set"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("uData"),a=t("baseUI"),r=t("swBtn"),s=t("sound"),c=t("global"),l=t("res"),d=t("pConst"),u=t("panelMgr"),p=t("slider"),h=cc._decorator,f=h.ccclass,g=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.audioBtn=null,e.musicBtn=null,e.vibrateBtn=null,e.headImg=null,e.txt_name=null,e.txt_lv=null,e.versionLbl=null,e.btnService=null,e.btnPrivacy=null,e.bgmSlider=null,e.effSlider=null,e.isMusic=!0,e.isAudio=!0,e.isVb=!0,e}return __extends(e,t),e.prototype.start=function(){var t=n.default.ins.getSetting();this.isAudio=t.effectSound,this.isMusic=t.bgmSound,this.isVb=t.vibrate,this.upAudioBtn(),this.updateMusicBtn(),this.upVbBtn(),this.initData(),this.initSlider();var e=o.platform.version;if(e&&(this.versionLbl.string="v "+e),o.platform.string()==d.PFCode.Wechat||o.platform.isQQ){var i=this.btnService.node,a=this.btnPrivacy.node;i.active=a.active=!0,i.on(cc.Node.EventType.TOUCH_END,function(){return u.default.ins.open("ui/ui_info",{type:1})},this),a.on(cc.Node.EventType.TOUCH_END,function(){return u.default.ins.open("ui/ui_info",{type:2})},this)}},e.prototype.initData=function(){var t=this;this.txt_name.string=n.default.ins.getName();var e=n.default.ins.getHeadImg();e?cc.assetManager.loadRemote(e,{ext:c.headImgExt},function(e,i){t.node&&t.node.isValid&&(e?t.setDefaultHead():t.headImg.spriteFrame=new cc.SpriteFrame(i))}):this.setDefaultHead()},e.prototype.setDefaultHead=function(){var t=this;l.default.ins.getBundleByString("resSps").then(function(e){e.load("common/head_1",cc.SpriteFrame,function(e,i){!e&&t.node&&t.node.isValid&&(t.headImg.spriteFrame=i)})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})},e.prototype.onAudioBtnTap=function(){this.isAudio=!this.isAudio,this.upAudioBtn(),n.default.ins.setSetting({effectSound:this.isAudio})},e.prototype.upAudioBtn=function(){null!=this.audioBtn&&this.audioBtn.setState(this.isAudio)},e.prototype.onMusicBtnTap=function(){this.isMusic=!this.isMusic,n.default.ins.setSetting({bgmSound:this.isMusic}),this.updateMusicBtn()},e.prototype.updateMusicBtn=function(){s.default.ins[this.isMusic?"playBGM":"stopBGM"](),null!=this.musicBtn&&this.musicBtn.setState(this.isMusic)},e.prototype.onVibrateBtnTap=function(){this.isVb=!this.isVb,this.upVbBtn(),n.default.ins.setSetting({vibrate:this.isVb})},e.prototype.upVbBtn=function(){null!=this.vibrateBtn&&this.vibrateBtn.setState(this.isVb)},e.prototype.hideThis=function(){this.hide()},e.prototype.initSlider=function(){var t=n.default.ins.getSetting(),e=t.effectVolume,i=t.bgmVolume;this.bgmSlider.init(i),this.effSlider.init(e)},e.prototype.onSliderChange=function(t,e){var i;if("bgmVolume"!==e&&"effectVolume"!==e)return console.error("slider\u53c2\u6570\u9519\u4e86!!!!");n.default.ins.setSetting(((i={})[e]=t.progress,i)),s.default.ins[e]=t.progress},e.prototype.onBtnSkin=function(){},__decorate([g(r.default)],e.prototype,"audioBtn",void 0),__decorate([g(r.default)],e.prototype,"musicBtn",void 0),__decorate([g(r.default)],e.prototype,"vibrateBtn",void 0),__decorate([g(cc.Sprite)],e.prototype,"headImg",void 0),__decorate([g(cc.Label)],e.prototype,"txt_name",void 0),__decorate([g(cc.Label)],e.prototype,"txt_lv",void 0),__decorate([g(cc.Label)],e.prototype,"versionLbl",void 0),__decorate([g(cc.Label)],e.prototype,"btnService",void 0),__decorate([g(cc.Label)],e.prototype,"btnPrivacy",void 0),__decorate([g(p.default)],e.prototype,"bgmSlider",void 0),__decorate([g(p.default)],e.prototype,"effSlider",void 0),__decorate([f],e)}(a.default);i.default=v,cc._RF.pop()},{baseUI:"baseUI",global:"global",idx:"idx",pConst:"pConst",panelMgr:"panelMgr",res:"res",slider:"slider",sound:"sound",swBtn:"swBtn",uData:"uData"}],ui_sevenDay:[function(t,e,i){"use strict";cc._RF.push(e,"c6f14ub1LFHhI8ElFgzZRTz","ui_sevenDay"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("pConst"),r=t("request"),s=t("cfgMgr"),c=t("bagMgr"),l=t("panelMgr"),d=t("tipMgr"),u=t("pInfo"),p=t("baseUI"),h=t("dayReward"),f=cc._decorator,g=f.ccclass,v=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dayNodes=[],e.getBtnNode=null,e.hasGetNode=null,e.reciveReward={},e.aniData=[],e.canRecive=!1,e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(){for(var t=u.default.ins.getSevenDays(),e=u.default.ins.getSevenReward(),i=s.default.serverCfg.seven_day_reward.rules,o={},n=0,a=this.dayNodes.length;n<a;n++){var r=i[n].val,c=this.dayNodes[n];if(c.initItem(r),c.setDefault(),6===n&&c.setCanRecive(),n<t&&(c.setCanRecive(),n<e&&c.setRecived()),t>n&&n>=e)for(var l in this.aniData=this.aniData.concat(c.aniDatas),this.canRecive=!0,r){var d=r[l];o[l]?o[l]+=d:o[l]=d}}this.reciveReward=o,this.checkBtns()},e.prototype.checkBtns=function(){this.getBtnNode.active=this.canRecive,this.hasGetNode.active=!this.canRecive},e.prototype.onBtnGet=function(){var t=this;if(this.canRecive){this.canRecive=!1,this.checkBtns();for(var e=[],i=0,s=this.aniData.length;i<s;i++){var p=this.aniData[i],h={},f=p.itemId,g=Number(p.value);h.itemId=f,h.worldPos=p.itemNode.parent.convertToWorldSpaceAR(p.itemNode.position),h.value=g,e.push(h),c.default.ins.addItem(f,g)}var v=u.default.ins.getSevenDays();u.default.ins.setSevenReward(v),o.default.opE.emit({action:o.default.SIGN_RED});var m=u.default.ins.getSevenReward();for(i=0,s=this.dayNodes.length;i<s;i++){var y=this.dayNodes[i];y.setDefault(),6===i&&y.setCanRecive(),i<v&&(y.setCanRecive(),i<m&&y.setRecived())}if(n.platform.string()==a.PFCode.Bytedance){var _=n.platform.getSystemData();if(_){var b=0;switch(_.appName){case"Douyin":b=1;break;case"douyin_lite":b=2}var S=-1!=_.system.indexOf("iOS");b&&v<7&&!S&&r.default.ins.sendSevenCard(b,v+1)}}l.default.ins.open("ui/ui_flyAni",{itemDatas:e,hideCb:function(){t.hideThis()}})}else d.default.ins.showTip("\u5df2\u9886\u53d6")},e.prototype.hideThis=function(){this.hide()},__decorate([v([h.default])],e.prototype,"dayNodes",void 0),__decorate([v(cc.Node)],e.prototype,"getBtnNode",void 0),__decorate([v(cc.Node)],e.prototype,"hasGetNode",void 0),__decorate([g],e)}(p.default);i.default=m,cc._RF.pop()},{bagMgr:"bagMgr",baseUI:"baseUI",cfgMgr:"cfgMgr",dayReward:"dayReward",evts:"evts",idx:"idx",pConst:"pConst",pInfo:"pInfo",panelMgr:"panelMgr",request:"request",tipMgr:"tipMgr"}],ui_shopPack:[function(t,e,i){"use strict";cc._RF.push(e,"04bfcWd8wxNsb58fYw/OdLP","ui_shopPack"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("cfgMgr"),n=t("shopMgr"),a=t("baseUI"),r=t("chaptBtn"),s=t("packItem1"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemScroll=null,e.btnScroll=null,e.packItem=null,e.btnItem=null,e.btnsComp=[],e.curPageIdx=-1,e.datasArr=[],e.tabIds=[],e._packItem=[],e}return __extends(e,t),e.prototype.init=function(){var t,e,i=this,a=null===(e=null===(t=o.default.serverCfg)||void 0===t?void 0:t.shop_config)||void 0===e?void 0:e.gift;if(a){var s={};for(var c in a){var l=a[c],d=l.tag||0;l.is_shop&&(s[d]?s[d].push(l):(s[d]=[],s[d].push(l)))}var u=n.default.ins.getTabsRed();for(var p in s){var h=s[p];if(h){this.tabIds.push(p);var f=h[0].gift||"\u793c\u5305",g=cc.instantiate(this.btnItem);g.active=!0,g.parent=this.btnScroll.content;var v=g.getComponent(r.default);v.setLb(f),v.setState(!1),this.btnsComp.push(v),this.datasArr.push(h);var m=1;if(u[p])m=0;else for(var y=h.length,_=0;_<y;_++)0==(h[_].price||0)&&m++;v.setRed(m)}}var b=this.btnsComp.length,S=function(t){w.btnsComp[t].node.on("click",function(){i.chgViewData(t)},w)},w=this;for(_=0;_<b;_++)S(_);this.btnScroll.node.width=550;var T=this.btnScroll.content.children[0].width*this.btnScroll.content.childrenCount;this.btnScroll.node.x=T>this.btnScroll.node.width?-274:(this.btnScroll.node.width-T)/2-274,T=Math.min(T,550),this.btnScroll.node.width=T,this.btnScroll.scrollToLeft(),this.chgViewData(0)}},e.prototype.chgViewData=function(t){var e=this.curPageIdx;if(e!=t){var i=this.btnsComp,o=n.default.ins.getTabsRed();i[e]&&(i[e].setState(!1),i[e].setRed(0),o[this.tabIds[e]]=1),i[t]&&(i[t].setState(!0),o[this.tabIds[t]]=1),n.default.ins.setTabsRed(o),this.curPageIdx=t,this.initListView()}},e.prototype.initListView=function(){var t=this,e=this.itemScroll.content;e.children.forEach(function(e){t._packItem.push(e)}),e.removeAllChildren();for(var i=this.datasArr[this.curPageIdx],o=i.length,n=0;n<o;n++){var a=i[n],r=this._packItem.shift();r||(r=cc.instantiate(this.packItem)),r.active=!0,r.parent=e,r.getComponent(s.default).initItem(a)}e.setContentSize(580,182*o)},e.prototype.hideThis=function(){t.prototype.hide.call(this)},__decorate([d(cc.ScrollView)],e.prototype,"itemScroll",void 0),__decorate([d(cc.ScrollView)],e.prototype,"btnScroll",void 0),__decorate([d(cc.Node)],e.prototype,"packItem",void 0),__decorate([d(cc.Node)],e.prototype,"btnItem",void 0),__decorate([l],e)}(a.default);i.default=u,cc._RF.pop()},{baseUI:"baseUI",cfgMgr:"cfgMgr",chaptBtn:"chaptBtn",packItem1:"packItem1",shopMgr:"shopMgr"}],ui_sidebar:[function(t,e,i){"use strict";cc._RF.push(e,"d0be4dW861Nob8k4ZQf0SYa","ui_sidebar"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("evts"),n=t("idx"),a=t("res"),r=t("panelMgr"),s=t("pInfo"),c=t("baseUI"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getBtn=null,e.intoBtn=null,e.tipNode=null,e.exampleNode=null,e.exampleSpr=null,e.exampleTxtNode=null,e}return __extends(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.loadSp()},e.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.updateSliderStatus()},e.prototype.loadSp=function(){var t=this,e=null,i=cc.sys.platform===cc.sys.ALIPAY_GAME?"ali":"tt";this.exampleTxtNode.active=cc.sys.platform==cc.sys.ALIPAY_GAME,a.default.ins.getBundleByString("resSps").then(function(o){o.loadDir("platform/"+i,cc.SpriteFrame,function(i,o){!i&&t.node&&t.node.isValid&&o.forEach(function(i){if(-1!==i.name.indexOf("txt"));else if(-1!==i.name.indexOf("exa"))if(cc.sys.platform===cc.sys.BYTEDANCE_GAME)e=cc.v3(0,90,0),t.exampleSpr.spriteFrame=i,t.exampleSpr.node.position=e;else if(cc.sys.platform===cc.sys.ALIPAY_GAME)if(e=cc.v3(-132,35,0),-1!==i.name.indexOf("exa1"))t.exampleSpr.spriteFrame=i,t.exampleSpr.node.position=e;else{var o=new cc.Node;o.addComponent(cc.Sprite).spriteFrame=i,o.parent=t.exampleNode,e.x+=264,o.position=e}})})}).catch(function(t){console.error("RTool.ins.getBundleByString('resSps')",t)})},e.prototype.updateSliderStatus=function(){var t=this.bySlider=n.platform.bySlider;this.getBtn.active=t,this.intoBtn.active=!t,s.default.ins.getIsGetSlider()?(this.getBtn.active=!1,this.intoBtn.active=!1,this.tipNode.active=!0):this.tipNode.active=!1},e.prototype.onGet=function(){var t=this;s.default.ins.addCoin(20),s.default.ins.setIsGetSlider(!0);var e=this.getBtn.parent.convertToWorldSpaceAR(this.getBtn.position);r.default.ins.open("ui/ui_flyAni",{itemDatas:[{itemId:"coin",worldPos:e,value:20}],hideCb:function(){t.hideThis(),o.default.opE.emit({action:o.default.Slider_Chg})}})},e.prototype.onInto=function(){n.platform.navigateToScene(),this.hideThis()},e.prototype.hideThis=function(){this.hide()},e.prototype.onDestroy=function(){},__decorate([u(cc.Node)],e.prototype,"getBtn",void 0),__decorate([u(cc.Node)],e.prototype,"intoBtn",void 0),__decorate([u(cc.Node)],e.prototype,"tipNode",void 0),__decorate([u(cc.Node)],e.prototype,"exampleNode",void 0),__decorate([u(cc.Sprite)],e.prototype,"exampleSpr",void 0),__decorate([u(cc.Node)],e.prototype,"exampleTxtNode",void 0),__decorate([d],e)}(c.default);i.default=p,cc._RF.pop()},{baseUI:"baseUI",evts:"evts",idx:"idx",pInfo:"pInfo",panelMgr:"panelMgr",res:"res"}],ui_skinInfo:[function(t,e,i){"use strict";cc._RF.push(e,"7c070pF1aJJsYPevQtZg0rw","ui_skinInfo"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("uData"),n=t("lang"),a=t("head"),r=t("skinMgr"),s=t("tipMgr"),c=t("pInfo"),l=t("baseUI"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skinName=null,e.skinDesc=null,e.buyBtn=null,e.videoBtn=null,e.useBtn=null,e.headComp=null,e.bgSp=null,e.nameFrameSp=null,e.roleNode=null,e.frameBg=null,e.needCoin=null,e.needPro=null,e}return __extends(e,t),e.prototype.start=function(){},e.prototype.init=function(t){var e,i=this,n=t.ref,a=t.skinId,s=t.showNode,c=t.unlockState,l=r.default.ins.getSkinData(a,n),d=l.name,u=l.desc,p=l.unlockType,h=l.unlockValue;switch(this.skinName.string=d,this.skinDesc.string=u,this.skinId=a,this.ref=n,this.unlockValue=h,this.headComp.node.parent.active=a===r.SkinIdEnum.headFrame,this.bgSp.node.active=a===r.SkinIdEnum.bg,this.roleNode.active=a===r.SkinIdEnum.role,this.nameFrameSp.node.parent.active=a===r.SkinIdEnum.nameFrame,this.buyBtn.active=2===p&&c===r.SkinState.lock,this.videoBtn.active=1===p&&c===r.SkinState.lock,this.useBtn.active=r.SkinState.using!==c&&r.SkinState.lock!==c,p){case r.SkinUnlockType.coin:this.setCoin();break;case r.SkinUnlockType.video:this.setVideoPro()}var f=null===(e=s.getComponent(cc.Sprite))||void 0===e?void 0:e.spriteFrame;switch(a){case r.SkinIdEnum.role:this.roleNode.removeAllChildren();var g=cc.instantiate(s);g.y=-100,this.roleNode.addChild(g);break;case r.SkinIdEnum.bg:this.bgSp.spriteFrame=f;break;case r.SkinIdEnum.nameFrame:this.nameFrameSp.spriteFrame=f;break;case r.SkinIdEnum.headFrame:var v=o.default.ins.getHeadImg();this.headComp.loadHeadImg(v,n)}this.scheduleOnce(function(){i.setCloseBtnPos()})},e.prototype.hideThis=function(){this.hide()},e.prototype.setCoin=function(){this.needCoin.string=this.unlockValue.toString()},e.prototype.setVideoPro=function(){var t=c.default.ins.getSkinAdPro(this.skinId,this.ref);void 0!==t&&(this.needPro.string=t+"/"+this.unlockValue,t>=this.unlockValue&&(r.default.ins.addSkin(this.skinId,this.ref),this.videoBtn.active=!1,this.useBtn.active=!0))},e.prototype.setCloseBtnPos=function(){this.closeBtn.node.x=this.frameBg.width/2+this.frameBg.x-this.closeBtn.node.width/2-15,this.closeBtn.node.y=this.frameBg.height/2+this.frameBg.y-this.closeBtn.node.height/2-15},e.prototype.onBtnUseSkin=function(){this.hide(),r.default.ins.usingSkin(this.skinId,this.ref)},e.prototype.onBtnCoin=function(){c.default.ins.getCoin()>=this.unlockValue?(c.default.ins.addCoin(-this.unlockValue),r.default.ins.addSkin(this.skinId,this.ref),this.buyBtn.active=!1,this.useBtn.active=!0,s.default.ins.showTip("\u8d2d\u4e70\u6210\u529f")):s.default.ins.showTip(n.lang[10001])},e.prototype.onBtnVideo=function(){c.default.ins.addSkinAdPro(this.skinId,this.ref),this.setVideoPro()},__decorate([p(cc.Label)],e.prototype,"skinName",void 0),__decorate([p(cc.Label)],e.prototype,"skinDesc",void 0),__decorate([p(cc.Node)],e.prototype,"buyBtn",void 0),__decorate([p(cc.Node)],e.prototype,"videoBtn",void 0),__decorate([p(cc.Node)],e.prototype,"useBtn",void 0),__decorate([p(a.default)],e.prototype,"headComp",void 0),__decorate([p(cc.Sprite)],e.prototype,"bgSp",void 0),__decorate([p(cc.Sprite)],e.prototype,"nameFrameSp",void 0),__decorate([p(cc.Node)],e.prototype,"roleNode",void 0),__decorate([p(cc.Node)],e.prototype,"frameBg",void 0),__decorate([p(cc.Label)],e.prototype,"needCoin",void 0),__decorate([p(cc.Label)],e.prototype,"needPro",void 0),__decorate([u],e)}(l.default);i.default=h,cc._RF.pop()},{baseUI:"baseUI",head:"head",lang:"lang",pInfo:"pInfo",skinMgr:"skinMgr",tipMgr:"tipMgr",uData:"uData"}],ui_skin:[function(t,e,i){"use strict";cc._RF.push(e,"d45c3iSApZP3p940Sl9LSeE","ui_skin"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("baseUI"),n=t("pInfo"),a=t("uData"),r=t("chgBtn"),s=t("skinContent"),c=t("head"),l=t("res"),d=t("skinMgr"),u=t("evts"),p=cc._decorator,h=p.ccclass,f=p.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollView=null,e.btnsNode=null,e.headComp=null,e.pNameTxt=null,e.bgSp=null,e.roleNode=null,e.curPageIdx=1,e.contentArr=[],e.btnsComp=[],e}return __extends(e,t),e.prototype.onLoad=function(){var t=this;this.eventFunc=this.onOperTap.bind(this),u.default.opE.on(this.eventFunc),this.scrollView.content.parent.children.forEach(function(e){t.contentArr.push(e.getComponent(s.default)),e.active=!1});for(var e=function(e,o,n){n.push(o[e].getComponent(r.default)),o[e].on("click",function(){t.chgViewData(e)},i)},i=this,o=0,n=this.btnsNode.children,a=this.btnsComp,c=n.length;o<c;o++)e(o,n,a)},e.prototype.start=function(){this.chgViewData(0),l.default.ins.getBundleByString("resSps").then(function(t){t.preloadDir("game/skin")}),l.default.ins.getBundleByString("prefab").then(function(t){t.preloadDir("skin")})},e.prototype.onDestroy=function(){u.default.opE.off(this.eventFunc),this.eventFunc=null},e.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=n.default.ins.getUsingSkin(),o=a.default.ins.getHeadImg();if(this.pNameTxt.string=a.default.ins.getName(),this.headComp.loadHeadImg(o),i)for(var r in i){var s=r,c=i[r];this.updateShow(s,c)}},e.prototype.hideThis=function(){this.hide()},e.prototype.chgViewData=function(t){var e=this.curPageIdx;if(e!=t){var i={0:d.SkinIdEnum.bg,1:d.SkinIdEnum.headFrame,2:d.SkinIdEnum.nameFrame,3:d.SkinIdEnum.role},o=d.default.ins.getSkinConfig(i[t]);this.contentArr[t].initContent(o),this.changeBtnState(e,t),this.changeContentState(e,t),this.curPageIdx=t}},e.prototype.changeBtnState=function(t,e){var i=this.btnsComp;i[t].setState(!1),i[e].setState(!0)},e.prototype.changeContentState=function(t,e){var i=this.contentArr,o=this.scrollView;i[t].node.active=!1,i[e].node.active=!0,o.content=i[e].node,o.scrollToTop(.1)},e.prototype.onOperTap=function(t){if((null==t?void 0:t.action)===u.default.SKIN_CHG&&t.data&&t.data.isUse){var e=t.data,i=e.skinId,o=e.ref;this.updateShow(i,o)}},e.prototype.updateShow=function(t,e){switch(t){case d.SkinIdEnum.bg:d.default.ins.updateBg(e,this.bgSp);break;case d.SkinIdEnum.role:d.default.ins.updateRole(e,this.roleNode)}},__decorate([f(cc.ScrollView)],e.prototype,"scrollView",void 0),__decorate([f(cc.Node)],e.prototype,"btnsNode",void 0),__decorate([f(c.default)],e.prototype,"headComp",void 0),__decorate([f(cc.Label)],e.prototype,"pNameTxt",void 0),__decorate([f(cc.Sprite)],e.prototype,"bgSp",void 0),__decorate([f(cc.Node)],e.prototype,"roleNode",void 0),__decorate([h],e)}(o.default);i.default=g,cc._RF.pop()},{baseUI:"baseUI",chgBtn:"chgBtn",evts:"evts",head:"head",pInfo:"pInfo",res:"res",skinContent:"skinContent",skinMgr:"skinMgr",uData:"uData"}],ui_tip:[function(t,e,i){"use strict";cc._RF.push(e,"ed9b2LsSfRIso6X0TSRTqgj","ui_tip"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("loading"),n=t("baseUI"),a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showLab=null,e.tNode=null,e}return __extends(e,t),e.prototype.init=function(t,e){var i=this;this.showLab.font=e?"":o.DEFAULTFONT,this.showLab.fontSize=e?35:40,this.showLab.string=t,this.tNode.scale=0,this.showLab.scheduleOnce(function(){i.tNode.height=i.showLab.node.height+30},0),cc.Tween.stopAllByTarget(this.tNode),this.tNode.setPosition(cc.v2()),this.onShow()},e.prototype.onShow=function(){cc.tween(this.tNode).parallel(cc.tween(this.tNode).to(.2,{scale:1}),cc.tween(this.tNode).to(2,{y:120})).delay(.1).to(.2,{scale:0}).start()},__decorate([s(cc.Label)],e.prototype,"showLab",void 0),__decorate([s(cc.Node)],e.prototype,"tNode",void 0),__decorate([r],e)}(n.default);i.default=c,cc._RF.pop()},{baseUI:"baseUI",loading:"loading"}],ui_userInfo:[function(t,e,i){"use strict";cc._RF.push(e,"9f7e3P8qDRIJYoimVo/XyP9","ui_userInfo"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("request"),n=t("uData"),a=t("head"),r=t("skinMgr"),s=t("pInfo"),c=t("baseUI"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lsTxt=null,e.raceScoreTxt=null,e.normalScoreTxt=null,e.jigsawTxt=null,e.achiTxt=null,e.headTxt=null,e.bgTxt=null,e.nameTxt=null,e.roleTxt=null,e.headComp=null,e.pNameTxt=null,e.nameSpr=null,e.bgSpr=null,e.girlNode=null,e}return __extends(e,t),e.prototype.init=function(t){var e,i=this,a=t.gameUid,r=t.baseData,c={},l=n.default.ins,d=s.default.ins,u="",p="";a==l.getUid()?(u=l.getName(),p=l.getHeadImg(),c.recordData=JSON.parse(JSON.stringify(d.getRecordData())),c.jigFin=d.getHasFinJig(),c.mySkin=d.getMySkin(),c.uSkin=d.getUsingSkin(),this.rePanel(c)):(r&&(u=r.nickname,p=r.avatar,c.uSkin=null===(e=null==r?void 0:r.extra_data)||void 0===e?void 0:e.usingSkin),o.default.ins.getUserDataByUid(a).then(function(t){if(t&&i.node&&i.node.isValid){var e=t.data;e&&(c.recordData=null==e?void 0:e.recordData,c.jigFin=null==e?void 0:e.hasFinJig,c.mySkin=null==e?void 0:e.mySkin),i.rePanel(c)}}));var h=u;h.length>7&&(h=h.substring(0,6)+"..."),this.pNameTxt.string=h,this.headComp.loadHeadImg(p)},e.prototype.rePanel=function(t){var e,i,o,n,a,s,c,l,d,u,p,h,f,g,v,m,y,_;if(t){var b=r.default.ins,S=(null===(e=null==t?void 0:t.uSkin)||void 0===e?void 0:e.headFrame)||1;b.updateHeadFrame(S,this.headComp.bg);var w=(null===(i=null==t?void 0:t.uSkin)||void 0===i?void 0:i.nameFrame)||1;b.updateNameFrame(w,this.nameSpr);var T=(null===(o=null==t?void 0:t.uSkin)||void 0===o?void 0:o.bg)||1;b.updateBg(T,this.bgSpr);var I=(null===(n=null==t?void 0:t.uSkin)||void 0===n?void 0:n.role)||1;b.updateRole(I,this.girlNode),this.headTxt.string=(null===(s=null===(a=null==t?void 0:t.mySkin)||void 0===a?void 0:a.headFrame)||void 0===s?void 0:s.length)||1,this.bgTxt.string=(null===(l=null===(c=null==t?void 0:t.mySkin)||void 0===c?void 0:c.bg)||void 0===l?void 0:l.length)||1,this.nameTxt.string=(null===(u=null===(d=null==t?void 0:t.mySkin)||void 0===d?void 0:d.nameFrame)||void 0===u?void 0:u.length)||1,this.roleTxt.string=(null===(h=null===(p=null==t?void 0:t.mySkin)||void 0===p?void 0:p.role)||void 0===h?void 0:h.length)||1,this.lsTxt.string=(null===(g=null===(f=null==t?void 0:t.recordData)||void 0===f?void 0:f.main)||void 0===g?void 0:g.heWins)||0,this.raceScoreTxt.string=(null===(m=null===(v=null==t?void 0:t.recordData)||void 0===v?void 0:v.race)||void 0===m?void 0:m.hePoints)||0,this.normalScoreTxt.string=(null===(_=null===(y=null==t?void 0:t.recordData)||void 0===y?void 0:y.main)||void 0===_?void 0:_.tPoints)||0;var D=0;if(t.jigFin)for(var k in t.jigFin)t.jigFin[k]&&D++;this.jigsawTxt.string=""+D,this.achiTxt.string="0"}},e.prototype.hideThis=function(){this.hide()},__decorate([u(cc.Label)],e.prototype,"lsTxt",void 0),__decorate([u(cc.Label)],e.prototype,"raceScoreTxt",void 0),__decorate([u(cc.Label)],e.prototype,"normalScoreTxt",void 0),__decorate([u(cc.Label)],e.prototype,"jigsawTxt",void 0),__decorate([u(cc.Label)],e.prototype,"achiTxt",void 0),__decorate([u(cc.Label)],e.prototype,"headTxt",void 0),__decorate([u(cc.Label)],e.prototype,"bgTxt",void 0),__decorate([u(cc.Label)],e.prototype,"nameTxt",void 0),__decorate([u(cc.Label)],e.prototype,"roleTxt",void 0),__decorate([u(a.default)],e.prototype,"headComp",void 0),__decorate([u(cc.Label)],e.prototype,"pNameTxt",void 0),__decorate([u(cc.Sprite)],e.prototype,"nameSpr",void 0),__decorate([u(cc.Sprite)],e.prototype,"bgSpr",void 0),__decorate([u(cc.Node)],e.prototype,"girlNode",void 0),__decorate([d],e)}(c.default);i.default=p,cc._RF.pop()},{baseUI:"baseUI",head:"head",pInfo:"pInfo",request:"request",skinMgr:"skinMgr",uData:"uData"}],uvAni:[function(t,e,i){"use strict";cc._RF.push(e,"41094vwy3ZOuZaeoTXDRToI","uvAni"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=(o.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgMat=null,e.time=0,e._speed=.5,e}return __extends(e,t),e.prototype.start=function(){var t=this.getComponent(cc.Sprite);this.bgMat=t.getMaterial(0),this.time=0},Object.defineProperty(e.prototype,"speed",{set:function(t){this._speed=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stop",{set:function(t){this.isStop=t},enumerable:!1,configurable:!0}),e.prototype.update=function(t){this.isStop||(this.time+=t*this._speed,this.bgMat.setProperty("time",this.time))},__decorate([n],e)}(cc.Component));i.default=a,cc._RF.pop()},{}],vb:[function(t,e,i){"use strict";var o;cc._RF.push(e,"1a0307mRBFNnr9D0weC/cVX","vb"),Object.defineProperty(i,"__esModule",{value:!0}),i.VEnum3=void 0;var n,a=t("idx"),r=t("pConst"),s=t("uData");(n=o=i.VEnum3||(i.VEnum3={}))[n.SHORT=0]="SHORT",n[n.LONG=1]="LONG",n[n.DOUBLE=2]="DOUBLE";var c=function(){function t(){}return t.p=function(t){if(s.default.ins.getSetting().vibrate)switch(t){case o.SHORT:a.platform.vibrate(r.VEnum4.SHORT);break;case o.LONG:a.platform.vibrate(r.VEnum4.LONG);break;case o.DOUBLE:a.platform.vibrate(r.VEnum4.LONG);var e=cc.director.getScene().getChildByName("Canvas");cc.tween(e).delay(.4).call(function(){a.platform.vibrate(r.VEnum4.LONG)}).start()}},t}();i.default=c,cc._RF.pop()},{idx:"idx",pConst:"pConst",uData:"uData"}],veBtn:[function(t,e,i){"use strict";cc._RF.push(e,"eb0f04Zrj5E9omuqiykJWJz","veBtn"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("adC"),n=t("com"),a=t("evts"),r=t("idx"),s=t("pConst"),c=t("request"),l=t("res"),d=t("sound"),u=t("lang"),p=t("tipMgr"),h=t("pInfo"),f=cc._decorator,g=f.ccclass,v=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.videoSource="",e.videoDuration=o.VEnum2.MEDIUM,e.onWatchEndEvent=null,e.adSp=null,e.cb=null,e.eCb=null,e}return __extends(e,t),e.prototype.onLoad=function(){r.platform.preloadVideo(o.VEnum[this.videoDuration]),this.adSp||(this.adSp=this.node.getChildByName("bg").getChildByName("img_gk_ds").getComponent(cc.Sprite)),this.setShareIcon()},e.prototype.onEnable=function(){this.node.on("click",this.onClick,this),this.eCb=this.onOperTap.bind(this),a.default.opE.on(this.eCb)},e.prototype.onDisable=function(){this.node.off("click",this.onClick,this),a.default.opE.off(this.eCb),this.eCb=null},e.prototype.onOperTap=function(t){switch(t.action){case a.default.AD_MAX:this.setShareIcon()}},e.prototype.onClick=function(t){var e=this;if((!t||t.interactable)&&null!=this.onWatchEndEvent&&(null==this.cb||this.cb())){var i=n.default.ins.a(this.node,1),o=h.default.ins.isMaxShareCount(),a=h.default.ins.isMaxAdCount();if(o&&a)return void p.default.ins.showTip(u.lang[10009]);if(a)return void r.platform.share().then(function(o){o&&(i(),e.onWatchEndEvent&&cc.Component.EventHandler.emitEvents([e.onWatchEndEvent],t),h.default.ins.addShareCount())}).catch(function(t){console.error(t)});var l=this.node.adDotData||e.onWatchEndEvent.customEventData;r.platform.doWatchAD({videoSource:this.videoSource,videoDuration:this.videoDuration,sequenceInfo:null}).then(function(){d.default.ins.playBGM(),i(),e.onWatchEndEvent&&cc.Component.EventHandler.emitEvents([e.onWatchEndEvent],t),h.default.ins.addAdCount(),c.default.ins.adDot(l,1)}).catch(function(t){switch(d.default.ins.playBGM(),i(),t){case s.VideoFailCode.NO_AD:p.default.ins.showTip(u.lang[1e4]),c.default.ins.adDot(l,0);break;case s.VideoFailCode.CANCELED:c.default.ins.adDot(l,2)}})}},e.prototype.setBeforeWatchCheckHandler=function(t){this.cb=t},e.prototype.setShareIcon=function(){this.adSp&&h.default.ins.isMaxAdCount()&&(this.adSp.node.$isShare||(l.default.ins.lSF("common/lupin_2",this.adSp),this.adSp.node.$isShare=!0))},__decorate([v(cc.String)],e.prototype,"videoSource",void 0),__decorate([v(cc.Component.EventHandler)],e.prototype,"onWatchEndEvent",void 0),__decorate([v(cc.Sprite)],e.prototype,"adSp",void 0),__decorate([g],e)}(cc.Component);i.default=m,cc._RF.pop()},{adC:"adC",com:"com",evts:"evts",idx:"idx",lang:"lang",pConst:"pConst",pInfo:"pInfo",request:"request",res:"res",sound:"sound",tipMgr:"tipMgr"}],vivo:[function(t,e,i){"use strict";cc._RF.push(e,"b8e25IkG9NO4atNG91lT1oB","vivo"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(){},cc._RF.pop()},{}],wormSp:[function(t,e,i){"use strict";cc._RF.push(e,"5d0d4CPN3hK1I6Lx4gDVS6P","wormSp"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("com"),n=cc._decorator,a=n.ccclass,r=n.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spine=null,e.countLbl=null,e.idles=["","2","3"],e}return __extends(e,t),e.prototype.onLoad=function(){this.spine.setCompleteListener(this._playIdle.bind(this)),this._playIdle()},e.prototype.init=function(t){this.curCount=0,this.maxCount=t,this.countLbl.string=this.curCount+"/"+this.maxCount},e.prototype.addCount=function(){var t=this.curCount=this.curCount+1;t==this.maxCount&&this.playDone(),this.countLbl.string=t+"/"+this.maxCount},e.prototype._playIdle=function(){this.isDone||(this.spine.animation="idle"+this.idles[o.default.ins.rad(0,2)])},e.prototype.playDone=function(){this.isDone=!0;var t=this.spine;t.loop=!1,t.animation="xiaoshi"},__decorate([r(sp.Skeleton)],e.prototype,"spine",void 0),__decorate([r(cc.Label)],e.prototype,"countLbl",void 0),__decorate([a],e)}(cc.Component);i.default=s,cc._RF.pop()},{com:"com"}],worm:[function(t,e,i){"use strict";cc._RF.push(e,"fd1faxCdE9AcbmxbzuujTdp","worm"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,a=o.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sps=[],e.sp=null,e}return __extends(e,t),e.prototype.init=function(t){this.sp.spriteFrame=this.sps[t]},__decorate([a([cc.SpriteFrame])],e.prototype,"sps",void 0),__decorate([a(cc.Sprite)],e.prototype,"sp",void 0),__decorate([n],e)}(cc.Component);i.default=r,cc._RF.pop()},{}],wx:[function(t,e,i){"use strict";cc._RF.push(e,"d8c17AniaBK/rPvMyFh2kSV","wx"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("idx"),n=t("env"),a=t("evts"),r=t("pConst"),s=t("uData"),c=t("c"),l=t("adC"),d=t("com"),u=t("sound"),p=t("time"),h=t("pf"),f=t("errorCode"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSharing=!1,e.sdkSwitch=r.DefaultSDKSwitch,e.videoCheckedMap={},e.videoCheckedLastT={},e.videoMap={},e.isLoading=!1,e.isLoggedIn=!1,e.onHideT=0,e.noAd=!1,e.noVideo=!1,e.lastInterAdShowT=0,e.switchesInitd=!1,e.ta=null,e._share_callback=null,e.interstitialAd=null,e.interAdReady=!1,e.m_bInitBanner=null,e.m_bBannerShowed=!1,e.m_banner=null,e.SetUserCloudStorage=function(t,e,i){var o=new Date;wx.setUserCloudStorage({KVDataList:[{key:"level",value:t.toString()+"#"+o.getTime().toString()+"#"+e.toString()+"#"+i.toString()}],success:function(){},fail:function(){}})},e.onKeyboardComplete=wx.onKeyboardComplete,e.requirePrivacyAuthorize=e.canUse("2.32.3")&&wx.requirePrivacyAuthorize,e}return __extends(e,t),Object.defineProperty(e.prototype,"appId",{get:function(){return"wx6ff5aa14de283fd7"},enumerable:!1,configurable:!0}),e.prototype.string=function(){return r.PFCode.Wechat},e.prototype.init=function(){this.initVersion(),this.initWechatListener(),this.initCommonSetting(),this.initTga()},e.prototype.initVersion=function(){var t,e;this.version=wx.getAccountInfoSync&&(null===(e=null===(t=wx.getAccountInfoSync())||void 0===t?void 0:t.miniProgram)||void 0===e?void 0:e.version)},e.prototype.initTga=function(){},e.prototype.isSwitchedInitd=function(){},e.prototype.initWechatListener=function(){var t=this;wx.onShow(function(e){u.default.ins.playBGM(),a.default.plE.emit({onShow:!0,isSharing:t.isSharing}),s.default.ins.syncLaunchOption(e),t.isSharing||t.reenter(),t._share_callback&&t._share_callback()}),wx.onHide(function(){t.onHideT=p.default.ins.serverTime,a.default.plE.emit({onHide:!0})}),wx.onError(function(t){n.env.mode!==n.EM.PROD&&wx.showModal({title:t.message||"\u5f02\u5e38\u62a5\u9519",content:t.stack||"",showCancel:!1,confirmText:"\u597d\u7684"})}),wx.onShareAppMessage(function(){return r.SDKConfig.shareData()}),wx.showShareMenu({withShareTicket:!0}),this.canUse("2.0.2")||"qq"===this.getSystemData().AppPlatform&&wx.onMemoryWarning(function(){wx.triggerGC()});var e=wx.getUpdateManager();e.onCheckForUpdate(function(){}),e.onUpdateFailed(function(){}),e.onUpdateReady(function(){wx.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u662f\u5426\u91cd\u542f\u5c0f\u6e38\u620f\uff1f",success:function(t){t.confirm&&e.applyUpdate()}})})},e.prototype.initCommonSetting=function(){s.default.ins.syncLaunchOption(wx.getLaunchOptionsSync()),wx.getNetworkType({success:function(t){s.default.ins.network=t},fail:function(){}}),a.default.chE.on(function(){})},e.prototype.setAccountID=function(){},e.prototype.login=function(){return new Promise(function(t,e){wx.login({success:function(i){i&&i.code?(o.platform.cloud||(o.platform.cloud=wx.cloud&&wx.cloud.init&&(wx.cloud.init({env:""}),o.platform.cloud=wx.cloud))).callFunction({name:"gOpenId",success:function(e){var o=e.result;if(o)if("string"==typeof o)try{var n=JSON.parse(o);i.openid=n.i}catch(e){}else i.openid=o.i;t(i)},fail:function(t){console.error("err:",t),e(f.errorCode.PF_CLOUD_ERR)}}):(console.warn("\u5fae\u4fe1\u767b\u9646\u5931\u8d25\uff1aempty code"),t(f.errorCode.LOGIN_ERR))},fail:function(t){var i="";null!=t&&null!=t.errMsg&&(i=t.errMsg),console.warn("\u5fae\u4fe1\u767b\u9646\u5931\u8d25\uff1a",i),e(f.errorCode.LOGIN_ERR)}})})},e.prototype.initCloud=function(){return new Promise(function(t){wx.login({success:function(){var e;(null===(e=wx.cloud)||void 0===e?void 0:e.init)&&(o.platform.cloud=wx.cloud.init({env:""}),o.platform.cloud=wx.cloud,t(o.platform.syncTime()))},fail:function(){t(null)}})})},e.prototype.syncTime=function(){return new Promise(function(t){var e=o.platform.cloud||(o.platform.cloud=wx.cloud);e?e.callFunction({name:"gTime",success:function(e){var i,o=e.result;if(o)if("string"==typeof o)try{i=JSON.parse(o).t}catch(e){}else i=o.t;t(i||null)},fail:function(){return t(null)}}):t(null)})},e.prototype.getCloudData=function(){var t,e=o.platform.cloud||(o.platform.cloud=wx.cloud&&wx.cloud.init&&(wx.cloud.init({env:""}),o.platform.cloud=wx.cloud));if(e){var i=e.database();if(i){var n=i.collection("userData");t=o.platform._check(n)}}return t},e.prototype._check=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,new Promise(function(e){t.where({}).get().then(function(t){if(t){o.platform.isCheck=!0;var i=t.data;if(i&&i.length){var n=i[0];o.platform.dbId=n._id;try{var a=JSON.parse(n.uData);e(a)}catch(r){e(null)}}else e(null)}else e(null)}).catch(function(t){console.error(t),e(null)})})]})})},e.prototype.setCloudData=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,a,r;return __generator(this,function(s){switch(s.label){case 0:return(e=this).isSaving?[2]:(i=o.platform.cloud||(o.platform.cloud=wx.cloud&&wx.cloud.init&&(wx.cloud.init({env:""}),o.platform.cloud=wx.cloud)))?[4,i.database()]:[3,2];case 1:if(!(n=s.sent()))return[2];e.isSaving=!0,a=n.collection("userData"),r=Promise.resolve(),e.isCheck||(r=this._check(a)),r.then(function(){e.dbId?a.doc(e.dbId).update({data:{uData:t}}).then(function(t){console.log(t),o.platform.isSaving=!1}):a.add({data:{uData:t}}).then(function(t){o.platform.dbId=t.id,o.platform.isSaving=!1})}).catch(function(t){return console.error("\u5199\u5165\u5931\u8d25",t),e.isSaving=!1}),s.label=2;case 2:return[2]}})})},e.prototype.getUserInfo=function(){return new Promise(function(t,e){wx.getSetting({success:function(i){if(i.authSetting["scope.userInfo"])wx.getUserInfo({success:function(e){t(e.userInfo)},fail:function(){e(null)}});else{var o=wx.createUserInfoButton({type:"text",text:"\u83b7\u53d6\u7528\u6237\u4fe1\u606f",style:{left:-999,top:-999,width:2,height:1,lineHeight:40,backgroundColor:"#00000000",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4,borderColor:"#ffffff",borderWidth:0}});o.onTap(function(e){o.destroy(),t(e.userInfo)})}}})})},e.prototype.reenter=function(){},e.prototype.getStorage=function(t){try{var e=wx.getStorageSync(t);return null==e||""==e?null:JSON.parse(e)}catch(i){}},e.prototype.setStorage=function(t,e){try{wx.setStorageSync(t,JSON.stringify(e))}catch(i){}},e.prototype.clearStorage=function(){try{wx.clearStorageSync()}catch(t){}},e.prototype.removeStorage=function(t){try{wx.removeStorageSync(t)}catch(e){}},e.prototype.trackLogin=function(){},e.prototype.trackUserSet=function(){},e.prototype.trackUserSetOnce=function(){},e.prototype.trackEvent=function(){},e.prototype.getSeq=function(){},e.prototype.consumeSeq=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return t.sequenceInfo.type!=r.STDSeqType.VIDEO?[3,2]:[4,this.doWatchAD(t)];case 1:e.sent(),this.doShare(),e.label=2;case 2:return[2]}})})},e.prototype.doWatchAD=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,o,n;return __generator(this,function(){if(!this.noAd){if(!this.noVideo)return a.default.adE.emit(c.ADE.VIDEO),i=l.VEnum[null!==(e=t.videoDuration)&&void 0!==e?e:30],this.preloadVideo(i)?null==(o=this.videoMap[i])?(a.default.adE.emit(c.ADE.VIDEO_END),[2,Promise.reject(r.VideoFailCode.NO_AD)]):(this.showLoading(),n=this,[2,new Promise(function(t,e){o.onClose(function i(n){null!=o&&o.offClose(i),null!=n&&n.isEnded?(a.default.adE.emit(c.ADE.VIDEO_END),t(1)):(a.default.adE.emit(c.ADE.VIDEO_END),e(r.VideoFailCode.CANCELED))}),o.show().then(function(){}).catch(function(){a.default.adE.emit(c.ADE.VIDEO_END),o.destroy(),n.videoMap[i]=null,e(r.VideoFailCode.NO_AD)}).then(function(){n.hideLoading()})})]):(a.default.adE.emit(c.ADE.VIDEO_END),[2,Promise.reject(r.VideoFailCode.NO_AD)]);Promise.reject(r.VideoFailCode.NO_AD)}return[2]})})},e.prototype.doShare=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2]})})},e.prototype.canUse=function(t){return d.default.ins.compareVersion(this.getSystemData().SDKVersion,t)>=0},e.prototype.getSystemData=function(){if(null==this.systemInfoCache)try{this.systemInfoCache=wx.getSystemInfoSync()}catch(t){return r.DefaultSystemInfo}return this.systemInfoCache},e.prototype.getSwitches=function(){},e.prototype.vibrate=function(t){t==r.VEnum4.SHORT?wx.vibrateShort({type:"medium"}):t==r.VEnum4.LONG&&wx.vibrateLong()},e.prototype.preloadVideo=function(t){if(!this.canUse("2.0.4"))return!1;var e=this.videoCheckedMap[t];if(e)return e;var i=this.videoCheckedLastT[t],o=Date.now();if(!e&&(null==i||o-i>=r.SDKConfig.videoCoolTime)){var n=this.videoMap[t];if(null==n){var a=this;n=wx.createRewardedVideoAd({adUnitId:t,multiton:!0}),this.videoMap[t]=n,n.onLoad(function(){a.videoCheckedMap[t]=!0,a.videoCheckedLastT[t]=Date.now()}),n.onError(function(){a.videoMap[t]=null,a.videoCheckedMap[t]=!1,a.videoCheckedLastT[t]=Date.now(),n.destroy()})}null!=n&&n.load()}return!1},e.prototype.showModal=function(t){return new Promise(function(e){wx.showModal(Object.assign(Object.assign({},t),{success:function(t){t.confirm?e(!0):t.cancel&&e(!1)},fail:function(){e(!1)}}))})},e.prototype.refreshGame=function(){wx.restartMiniProgram?wx.restartMiniProgram({fail:function(){wx.exitMiniProgram()},path:""}):wx.exitMiniProgram()},e.prototype.showLoading=function(){this.canUse("1.1.0")&&(this.isLoading=!0,wx.showLoading({title:"\u52a0\u8f7d\u4e2d",mask:!0}))},e.prototype.hideLoading=function(){this.canUse("1.1.0")&&this.isLoading&&(wx.hideLoading(),this.isLoading=!1)},e.prototype.log=function(){},e.prototype.getMenuBounding=function(){},e.prototype.createShareImage=function(){},e.prototype.drawImage=function(){},e.prototype.preloadInterstitialAD=function(){},e.prototype.showInterstitialAD=function(){},e.prototype.canShowBanner=function(){},e.prototype.getBannerSize=function(){},e.prototype.showBanner=function(){},e.prototype.hideBanner=function(){},e.prototype.getSubscribeCnt=function(){},e.prototype.subscribe=function(){},e.prototype.startVideoRecord=function(){},e.prototype.pauseVideoRecord=function(){},e.prototype.resumeVideoRecord=function(){},e.prototype.stopVideoRecord=function(){},e.prototype.hasVideoRecord=function(){return!1},e.prototype.shareVideoRecord=function(){},e.prototype.uploadAdEvent=function(){},e.prototype.addShortcut=function(){},e.prototype.reportEvent=function(t,e){wx.reportEvent(t,e)},e.prototype.PostMessage=function(t,e,i){wx.getOpenDataContext().postMessage({Even:t,Value1:e,Value2:i})},e.prototype.GetOpenDataContext=function(){return wx.getOpenDataContext()},e.prototype.share=function(){var t=this;return new Promise(function(e){var i=r.SDKConfig.shareData();wx.shareAppMessage({title:i.title,imageUrl:i.imageUrl,query:i.query}),t._share_time=(new Date).getTime(),t._share_callback=function(){var i=t._share_time;t._share_time=t._share_callback=null,u.default.ins.playBGM(),i>0&&(new Date).getTime()-i>=3e3?e(1):e(0)}})},e.prototype.getUserProfile=function(){},e.prototype.subScriptionUpdate=function(){this.canUse("2.32.1")&&wx.getSetting({withSubscriptions:!0,success:function(t){var e=t.subscriptionsSetting,i=e.mainSwitch,o=e.itemSettings;(!o&&!i||o&&"accept"!=o.SYS_MSG_TYPE_INTERACTIVE)&&wx.requestSubscribeSystemMessage({msgTypeList:["SYS_MSG_TYPE_WHATS_NEW"],success:function(){}})}})},e}(h.default);i.default=g,cc._RF.pop()},{adC:"adC",c:"c",com:"com",env:"env",errorCode:"errorCode",evts:"evts",idx:"idx",pConst:"pConst",pf:"pf",sound:"sound",time:"time",uData:"uData"}]},{},["request","Creator","IServerCfg","NumberUtils","PopupLoading","Puzzle","PuzzleCell","PuzzleLine","Solver","Utility","adC","ali","androidP","bagMgr","banner","baseUI","c","cfgMgr","challengeMgr","chaptBtn","chapterItem","chgBtn","com","dateItem","dayReward","dynamicBtnBg","env","errorCode","evts","festivalMgr","game","global","grid","guide","h5","head","heart","hedge","ice","idx","iosP","item","item1","jigMenu","jigsaw","jigsawMgr","lang","levelItem","levelMgr","loading","loadingAni","mailItem","mailMgr","main","mySafeArea","nameFrame","nativeP","newJigMgr","pConst","pInfo","packItem","packItem1","page_challenge","page_jigsaw","page_level","page_race","page_shop","panelMgr","pf","fly","flyio","qq","questItem","raceRankItem","random_notice","rankItem","rankMgr","res","scrollView","shopItem","shopItem1","shopMgr","skinBg","skinContent","skinHeadFrame","skinItemBase","skinMgr","skinNameFrame","skinRole","slider","sound","swBtn","tE","taskMgr","tb","time","tipMgr","toast","top","tt","uData","ui_backReward","ui_challengeInfo","ui_chapter","ui_chapterDone","ui_contentUs","ui_deskReward","ui_festival","ui_flyAni","ui_gamesetlattice","ui_getHeart","ui_getItem","ui_getRes","ui_getReward","ui_info","ui_jigFinish","ui_jigTip","ui_jigsaw","ui_luckyGift","ui_lvInfo","ui_mail","ui_mailInfo","ui_newGift","ui_preReward","ui_privacy","ui_quest","ui_raceTip","ui_rank","ui_rePlay","ui_rePlayRace","ui_record","ui_reiGift","ui_save","ui_saveConfirm","ui_saveRestore","ui_selectMode","ui_set","ui_sevenDay","ui_shopPack","ui_sidebar","ui_skin","ui_skinInfo","ui_tip","ui_userInfo","uvAni","vb","veBtn","vivo","worm","wormSp","wx","temp"]);